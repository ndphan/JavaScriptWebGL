{"version":3,"file":"index.js","mappings":"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","sources":["webpack://ExampleApp/webpack/universalModuleDefinition","webpack://ExampleApp/./src/Core/WebGL/Shaders/LightFragmentShader.glsl","webpack://ExampleApp/./src/Core/Common/Timer.ts","webpack://ExampleApp/./src/AssetLoader/VertexParser.ts","webpack://ExampleApp/./src/Manager/EntityManager.ts","webpack://ExampleApp/./node_modules/gl-matrix/esm/vec2.js","webpack://ExampleApp/./src/Core/EngineEntity/ModelObject2d.ts","webpack://ExampleApp/./src/Core/Physics/CollisionDetection.ts","webpack://ExampleApp/./src/Core/Camera.ts","webpack://ExampleApp/./src/Core/Builder/ConfigMapBuilder.ts","webpack://ExampleApp/./src/Entity/BasicSprite.ts","webpack://ExampleApp/./src/AssetLoader/BitmapConfigParser.ts","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat2.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat2d.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat3.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat4.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/vec3.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/vec4.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/quat.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/quat2.js","webpack://ExampleApp/./src/AssetLoader/ResourceResolver.ts","webpack://ExampleApp/./src/Core/WebGL/ShaderProgram/ShaderColourProgram.ts","webpack://ExampleApp/./src/Core/WebGL/EntityProgram/EntityColorProgram.ts","webpack://ExampleApp/./src/Entity/SpriteMoveable.ts","webpack://ExampleApp/./src/Core/Data/RenderOption.ts","webpack://ExampleApp/./src/Core/WebGL/Base/ProgramReference.ts","webpack://ExampleApp/./src/Core/Data/Colour.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/ShadowLightFragmentShader.glsl","webpack://ExampleApp/./src/Core/Renderer.ts","webpack://ExampleApp/./src/Core/EngineEntity/CameraFollower.ts","webpack://ExampleApp/./ExampleApp/RacingGame.ts","webpack://ExampleApp/./ExampleApp/CrystalCollectorGame.ts","webpack://ExampleApp/./src/Manager/ObjectManager.ts","webpack://ExampleApp/./src/Entity/SpriteModel.ts","webpack://ExampleApp/./src/Core/Builder/VertexBuilder.ts","webpack://ExampleApp/./src/Entity/Moveable.ts","webpack://ExampleApp/./src/Core/Data/RenderUnit.ts","webpack://ExampleApp/./src/Core/Common/SubscriberPool.ts","webpack://ExampleApp/./src/Entity/Object3d.ts","webpack://ExampleApp/./src/Core/Data/PlaneType.ts","webpack://ExampleApp/./src/Core/EngineEntity/Position.ts","webpack://ExampleApp/./src/Core/Font/Font.ts","webpack://ExampleApp/./src/Core/Data/TextureVertexModel.ts","webpack://ExampleApp/./src/Core/EngineEntity/EngineObject.ts","webpack://ExampleApp/./src/Core/Data/Light.ts","webpack://ExampleApp/./src/Core/WebGL/Base/BaseProgram.ts","webpack://ExampleApp/./src/Core/Events.ts","webpack://ExampleApp/./src/Core/EngineEntity/ModelObject3d.ts","webpack://ExampleApp/./src/AssetLoader/FntFontReader.ts","webpack://ExampleApp/./src/Core/Data/VertexModel.ts","webpack://ExampleApp/./src/Core/Data/Resource.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/RGBVertexShader.glsl","webpack://ExampleApp/./src/Core/EngineEntity/ModelPosition.ts","webpack://ExampleApp/./src/Core/EngineEntity/EngineMap.ts","webpack://ExampleApp/./src/Core/Common/IdGenerator.ts","webpack://ExampleApp/./src/Core/Builder/ShaderEntityBuilder.ts","webpack://ExampleApp/./src/Core/Buffer/Texture.ts","webpack://ExampleApp/./src/Core/WebGL/EntityProgram/Entity3DProgram.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/PassthroughVertexShader.glsl","webpack://ExampleApp/./src/Core/EngineDebugger.ts","webpack://ExampleApp/./src/Core/Common/NotificationQueue.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/ShadowLightVertexShader.glsl","webpack://ExampleApp/./src/Entity/PlaneColour.ts","webpack://ExampleApp/./src/Manager/EntityManager2d.ts","webpack://ExampleApp/./src/Entity/TriangleColour2d.ts","webpack://ExampleApp/./src/Core/Data/FontMetaData.ts","webpack://ExampleApp/./src/Core/EngineEntity/ModelObjectRect3d.ts","webpack://ExampleApp/./src/Core/Updater.ts","webpack://ExampleApp/./src/Core/EngineHelper.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/LightVertexShader.glsl","webpack://ExampleApp/./src/Core/WebGL/Shaders/RGBFragmentShader.glsl","webpack://ExampleApp/./src/Entity/Plane3d.ts","webpack://ExampleApp/./ExampleApp/Sphere.ts","webpack://ExampleApp/./src/Core/Data/Rect2d.ts","webpack://ExampleApp/./src/Core/WebGL/Base/WebGLContext.ts","webpack://ExampleApp/./src/Core/WorldDelegate.ts","webpack://ExampleApp/./src/Core/Data/ModelData.ts","webpack://ExampleApp/./src/index.ts","webpack://ExampleApp/./src/Core/App.ts","webpack://ExampleApp/./node_modules/gl-matrix/esm/common.js","webpack://ExampleApp/./src/Core/Data/Coordinate.ts","webpack://ExampleApp/./src/Core/EngineEntity/EngineObjectHelper.ts","webpack://ExampleApp/./src/Core/Physics/EngineMath.ts","webpack://ExampleApp/./ExampleApp/Ground3d.ts","webpack://ExampleApp/./src/Core/Physics/Physics.ts","webpack://ExampleApp/./src/Core/Data/Rect3d.ts","webpack://ExampleApp/./src/Entity/Plane2d.ts","webpack://ExampleApp/./src/Entity/LineColour.ts","webpack://ExampleApp/./src/Core/Data/Vector2d.ts","webpack://ExampleApp/./src/Core/EngineEntity/ShaderEntity.ts","webpack://ExampleApp/./src/Core/WebGL/ShaderProgram/Shader3DProgram.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/ShadowDepthFragmentShader.glsl","webpack://ExampleApp/./src/Core/Buffer/ArrayBuffer.ts","webpack://ExampleApp/./ExampleApp/ExampleApp.ts","webpack://ExampleApp/./src/Core/Data/ColourVertexModel.ts","webpack://ExampleApp/./ExampleApp/Cube.ts","webpack://ExampleApp/webpack/bootstrap","webpack://ExampleApp/webpack/runtime/define property getters","webpack://ExampleApp/webpack/runtime/hasOwnProperty shorthand","webpack://ExampleApp/webpack/runtime/make namespace object","webpack://ExampleApp/./ExampleApp/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ExampleApp\"] = factory();\n\telse\n\t\troot[\"ExampleApp\"] = factory();\n})(self, () => {\nreturn ","export default \"precision mediump float;\\r\\nprecision mediump int;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\n\\r\\nuniform sampler2D texture;\\r\\nuniform sampler2D shadowMap;\\r\\nuniform float numLights;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n    gl_FragColor = surfaceColor;\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec3 n = normalize(v_normal);\\r\\n  vec3 l = normalize(v_light1_pos);\\r\\n  float cosTheta = clamp(dot(n, l), 0.0, 1.0);\\r\\n\\r\\n  vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n  vec3 diffuse = v_diffuseCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n  vec3 ambient = light1.ambientCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n\\r\\n  vec3 linearColor = ambient + v_attenuation * diffuse * cosTheta;\\r\\n\\r\\n  vec3 gamma = vec3(1.0 / 2.2);\\r\\n  gl_FragColor = vec4(pow(linearColor, gamma), surfaceColor.a);\\r\\n}\";","export default class Timer {\r\n  _start: number = Date.now();\r\n  _end: number;\r\n  start(): Timer {\r\n    this._start = Date.now();\r\n    return this;\r\n  }\r\n  peak(): number {\r\n    return Date.now() - this._start;\r\n  }\r\n  stop(): number {\r\n    this._end = Date.now();\r\n    const elapsed = this._end - this._start;\r\n    this._start = this._end;\r\n    return elapsed;\r\n  }\r\n}\r\n","class VertexParser {\r\n  vertices: number[];\r\n\r\n  constructor(raw: string | number[]) {\r\n    if (typeof raw === \"string\") {\r\n      this.vertices = raw.split(\",\").map(parseFloat);\r\n    } else if (raw instanceof Array) {\r\n      this.vertices = raw;\r\n    } else {\r\n      console.error(\"Unexpected obj type\");\r\n    }\r\n  }\r\n}\r\n\r\nexport default VertexParser;\r\n","import EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect3d from \"../Core/Data/Rect3d\";\r\nimport Position from \"../Core/EngineEntity/Position\";\r\n\r\nclass EntityManager extends EngineObject {\r\n  entities: EngineObject[] = [];\r\n\r\n  setPosition(position: Position) {\r\n    this.entities.forEach((e) => e.setPosition(position));\r\n  }\r\n\r\n  center(x: number, y: number, z: number) {\r\n    super.center(x, y, z);\r\n    this.entities.forEach((e) => e.center(x, y, z));\r\n  }\r\n\r\n  rotateOrigin(x: number, y: number, z: number) {\r\n    super.rotateOrigin(x, y, z);\r\n    this.entities.forEach((e) => e.rotateOrigin(x, y, z));\r\n  }\r\n\r\n  rotateOriginRect(rect: Rect3d) {\r\n    this.rotateOrigin(rect.x, rect.y, rect.z);\r\n  }\r\n\r\n  rotateX(x: number) {\r\n    this.angleX(x);\r\n  }\r\n\r\n  rotateY(y: number) {\r\n    this.angleY(y);\r\n  }\r\n\r\n  rotateZ(z: number) {\r\n    this.angleZ(z);\r\n  }\r\n\r\n  angleX(x: number) {\r\n    super.angleX(x);\r\n    this.entities.forEach((e) => e.angleX(x));\r\n  }\r\n\r\n  angleY(y: number) {\r\n    super.angleY(y);\r\n    this.entities.forEach((e) => e.angleY(y));\r\n  }\r\n\r\n  angleZ(z: number) {\r\n    super.angleZ(z);\r\n    this.entities.forEach((e) => e.angleZ(z));\r\n  }\r\n\r\n  scaleX(x: number) {\r\n    super.scaleX(x);\r\n    this.entities.forEach((e) => e.scaleX(x));\r\n  }\r\n\r\n  scaleY(y: number) {\r\n    super.scaleY(y);\r\n    this.entities.forEach((e) => e.scaleY(y));\r\n  }\r\n\r\n  scaleZ(z: number) {\r\n    super.scaleZ(z);\r\n    this.entities.forEach((e) => e.scaleZ(z));\r\n  }\r\n\r\n  scale(x: number, y: number, z: number) {\r\n    super.scale(x, y, z);\r\n    this.entities.forEach((e) => e.scale(x, y, z));\r\n  }\r\n\r\n  translate(dx: number, dy: number, dz: number) {\r\n    super.translate(dx, dy, dz);\r\n    this.entities.forEach((e) => e.translate(dx, dy, dz));\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    super.init(engineHelper);\r\n    this.entities.forEach((a) => a.init(engineHelper));\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    if (this.hidden) {\r\n      return;\r\n    }\r\n    this.entities.forEach((entity) => entity.render(engineHelper));\r\n    super.render(engineHelper);\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    if (this.hidden) {\r\n      return;\r\n    }\r\n    this.entities.forEach((entity) => entity.update(engineHelper));\r\n    super.update(engineHelper);\r\n  }\r\n\r\n  setTop(isTop: boolean) {\r\n    super.setTop(isTop);\r\n    this.entities.forEach((entity) => entity.setTop(isTop));\r\n  }\r\n\r\n  set hidden(value: boolean) {\r\n    super.setHidden(value);\r\n    this.entities.forEach((entity) => (entity.hidden = value));\r\n  }\r\n}\r\n\r\nexport default EntityManager;\r\n","import * as glMatrix from \"./common.js\";\n\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  return out;\n}\n\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n    y = b[1] - a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n    y = b[1] - a[1];\n  return x * x + y * y;\n}\n\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0],\n    y = a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0],\n    y = a[1];\n  return x * x + y * y;\n}\n\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\nexport function normalize(out, a) {\n  var x = a[0],\n    y = a[1];\n  var len = x * x + y * y;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n    ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec2} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n    p1 = a[1] - b[1],\n    sinC = Math.sin(rad),\n    cosC = Math.cos(rad);\n\n  //perform rotation and translate to correct position\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n\n/**\n * Get the smallest angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    bx = b[0],\n    by = b[1];\n  return Math.abs(Math.atan2(ay * bx - ax * by, ax * bx + ay * by));\n}\n\n/**\n * Get the signed angle in the interval [-pi,pi] between two 2D vectors (positive if `a` is to the right of `b`)\n * \n * @param {ReadonlyVec2} a The first vector\n * @param {ReadonlyVec2} b The second vector\n * @returns {number} The signed angle in radians\n */\nexport function signedAngle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    bx = b[0],\n    by = b[1];\n  return Math.atan2(ax * by - ay * bx, ax * bx + ay * by);\n}\n\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1];\n  var b0 = b[0],\n    b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n\n/**\n * Alias for {@link vec2.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 2;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n    return a;\n  };\n}();","import ShaderEntityBuilder from \"../Builder/ShaderEntityBuilder\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport RenderOption, { RenderType, ShaderType } from \"../Data/RenderOption\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport EngineObject from \"./EngineObject\";\r\n\r\nexport default class ModelObject2d extends EngineObject {\r\n  public vertexModel: TextureVertexModel;\r\n\r\n  constructor(rect: Rect2d, vertexModel: TextureVertexModel) {\r\n    super();\r\n    this.vertexModel = vertexModel;\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.RECTANGLE;\r\n    renderOpt.shaderType = ShaderType.TWO_DIMENSION;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .createTexture(this.vertexModel.textureSource)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import Vector2d from \"../Data/Vector2d\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport { vec2, vec4, mat4 } from \"gl-matrix\";\r\nimport Plane3d from \"../../Entity/Plane3d\";\r\nimport { BaseCamera } from \"../Camera\";\r\nimport Position from \"../EngineEntity/Position\";\r\n\r\nexport class Collision {\r\n  willIntersect: boolean;\r\n  isIntersect: boolean;\r\n  minDeintersectDistance: Vector2d;\r\n}\r\n\r\nexport class CollisionDetection {\r\n  static rotate(x: number, y: number, rotate: Position) {\r\n    const center: vec2 = vec2.fromValues(x, y);\r\n    vec2.rotate(\r\n      center,\r\n      center,\r\n      vec2.fromValues(rotate.originX, rotate.originY),\r\n      Math.PI * (2 - rotate.az / 180)\r\n    );\r\n    return { x: center[0], y: center[1] };\r\n  }\r\n  static getLength(x1: number, y1: number, x2: number, y2: number) {\r\n    return Math.sqrt(\r\n      Math.abs((x1 - x2) * (x1 - x2)) + Math.abs((y1 - y2) * (y1 - y2))\r\n    );\r\n  }\r\n  static isCollidingRect(\r\n    x1: number,\r\n    y1: number,\r\n    width1: number,\r\n    height1: number,\r\n    x2: number,\r\n    y2: number,\r\n    width2: number,\r\n    height2: number\r\n  ) {\r\n    return (\r\n      CollisionDetection.getLength(x1, 0, x2, 0) <\r\n        width1 / 2.0 + width2 / 2.0 &&\r\n      CollisionDetection.getLength(y1, 0, y2, 0) < height1 / 2.0 + height2 / 2.0\r\n    );\r\n  }\r\n\r\n  static isRectInRect(rect1: Rect2d, rect2: Rect2d): boolean {\r\n    return !(\r\n      rect1.x + rect1.width / 2.0 < rect2.x - rect2.width / 2.0 ||\r\n      rect1.y + rect1.height / 2.0 < rect2.y - rect2.height / 2.0 ||\r\n      rect1.x - rect1.width / 2.0 > rect2.x + rect2.width / 2.0 ||\r\n      rect1.y - rect1.height / 2.0 > rect2.y + rect2.height / 2.0\r\n    );\r\n  }\r\n\r\n  static isPointInRect(rect: Rect2d, coord: Coordinate): boolean {\r\n    return this.isCollidingRect(\r\n      rect.x,\r\n      rect.y,\r\n      rect.width,\r\n      rect.height,\r\n      coord.x,\r\n      coord.y,\r\n      0.01,\r\n      0.01\r\n    );\r\n  }\r\n  static isPointInPlane3d(\r\n    camera: BaseCamera,\r\n    obj: Plane3d,\r\n    x: number,\r\n    y: number\r\n  ): boolean {\r\n    const mvp = mat4.multiply(\r\n      mat4.create(),\r\n      camera.frustum,\r\n      mat4.multiply(mat4.create(), camera.viewMatrix, obj.getModel())\r\n    );\r\n\r\n    const r1: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[0].vertex,\r\n      mvp\r\n    );\r\n    if (r1[2] > 1.0) return false;\r\n\r\n    const r2: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[1].vertex,\r\n      mvp\r\n    );\r\n    if (r2[2] > 1.0) return false;\r\n\r\n    const r3: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[2].vertex,\r\n      mvp\r\n    );\r\n    if (r3[2] > 1.0) return false;\r\n\r\n    const r4: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[3].vertex,\r\n      mvp\r\n    );\r\n    if (r4[2] > 1.0) return false;\r\n\r\n    const rectPolygon = [\r\n      [r1[0], r1[1]],\r\n      [r2[0], r2[1]],\r\n      [r4[0], r4[1]],\r\n      [r3[0], r3[1]],\r\n    ];\r\n    return this.pointInPolygon([x, y], rectPolygon);\r\n  }\r\n  static pointInPolygon = (point: number[], polygon: number[][]) => {\r\n    const x = point[0];\r\n    const y = point[1];\r\n\r\n    let inside = false;\r\n    for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\r\n      const xi = polygon[i][0];\r\n      const yi = polygon[i][1];\r\n      const xj = polygon[j][0];\r\n      const yj = polygon[j][1];\r\n\r\n      const intersect =\r\n        yi > y != yj > y && x < ((xj - xi) * (y - yi)) / (yj - yi) + xi;\r\n      if (intersect) {\r\n        inside = !inside;\r\n      }\r\n    }\r\n\r\n    return inside;\r\n  };\r\n  static toClipSpace(pos: Coordinate, mvp: mat4) {\r\n    const vec4Trans = vec4.transformMat4(\r\n      vec4.create(),\r\n      vec4.set(vec4.create(), pos.x, pos.y, pos.z, 1.0),\r\n      mvp\r\n    );\r\n\r\n    const vec4Norm = vec4.scale(vec4.create(), vec4Trans, 1.0 / vec4Trans[3]);\r\n    return vec4.set(\r\n      vec4.create(),\r\n      (vec4Norm[0] + 1.0) / 2.0,\r\n      (vec4Norm[1] + 1.0) / 2.0,\r\n      vec4Norm[2],\r\n      1.0\r\n    );\r\n  }\r\n}\r\n\r\nexport class Polygon {\r\n  points: Vector2d[];\r\n  edges: Vector2d[];\r\n  center: Vector2d;\r\n  max = 0;\r\n  min = 0;\r\n  subtractCenter(p: Polygon): Vector2d {\r\n    return this.center.subtract(p.center);\r\n  }\r\n  offset(v: Vector2d) {\r\n    this.points.forEach((point) => point.add(v));\r\n  }\r\n  area(v1: Vector2d, v2: Vector2d): number {\r\n    return v1.x * v2.y - v2.x * v1.y;\r\n  }\r\n  calculateCentre(): Vector2d {\r\n    const centroid = Vector2d.newVector(0, 0);\r\n    let totalSignedArea = 0.0;\r\n    const vertexCount = this.points.length;\r\n    for (let i = 0; i < vertexCount; ++i) {\r\n      const vertex = this.points[i];\r\n      let nextVertex;\r\n      if (i == vertexCount - 1) {\r\n        nextVertex = this.points[0];\r\n      } else {\r\n        nextVertex = this.points[i + 1];\r\n      }\r\n      const area = this.area(vertex, nextVertex);\r\n      totalSignedArea += area;\r\n      centroid.x += (vertex.x + nextVertex.x) * area;\r\n      centroid.y += (vertex.y + nextVertex.y) * area;\r\n    }\r\n    centroid.x /= 3.0 * totalSignedArea;\r\n    centroid.y /= 3.0 * totalSignedArea;\r\n    return centroid;\r\n  }\r\n  polygonProjection(axis: Vector2d, polygon: Polygon) {\r\n    let dotProduct: number = axis.dot(polygon.points[0]);\r\n    polygon.min = dotProduct;\r\n    polygon.max = dotProduct;\r\n    for (let i = 0; i < polygon.points.length; i++) {\r\n      const point = polygon.points[i];\r\n      dotProduct = point.dot(axis);\r\n      if (dotProduct < polygon.min) {\r\n        polygon.min = dotProduct;\r\n      } else if (dotProduct > polygon.max) {\r\n        polygon.max = dotProduct;\r\n      }\r\n    }\r\n  }\r\n  boundaryDistance(\r\n    minA: number,\r\n    maxA: number,\r\n    minB: number,\r\n    maxB: number\r\n  ): number {\r\n    if (minA < minB) {\r\n      return minB - maxA;\r\n    } else {\r\n      return minA - maxB;\r\n    }\r\n  }\r\n  isCollision(polygonB: Polygon, velocity?: Vector2d): Collision {\r\n    const result = new Collision();\r\n    result.isIntersect = true;\r\n    result.willIntersect = true;\r\n    const edgeCountA: number = this.edges.length;\r\n    const edgeCountB: number = polygonB.edges.length;\r\n    let minIntervalDistance = Infinity;\r\n    let translationAxis = new Vector2d();\r\n    let edge: Vector2d;\r\n    for (let edgeIndex = 0; edgeIndex < edgeCountA + edgeCountB; edgeIndex++) {\r\n      if (edgeIndex < edgeCountA) {\r\n        edge = this.edges[edgeIndex];\r\n      } else {\r\n        edge = polygonB.edges[edgeIndex - edgeCountA];\r\n      }\r\n      const axis = Vector2d.newVector(-edge.y, edge.x).normalise();\r\n      this.polygonProjection(axis, this);\r\n      this.polygonProjection(axis, polygonB);\r\n\r\n      if (\r\n        this.boundaryDistance(this.min, this.max, polygonB.min, polygonB.max) >\r\n        0\r\n      ) {\r\n        result.isIntersect = false;\r\n      }\r\n\r\n      if (velocity) {\r\n        const velocityProjection: number = axis.dot(velocity);\r\n        if (velocityProjection < 0) {\r\n          this.min += velocityProjection;\r\n        } else {\r\n          this.max += velocityProjection;\r\n        }\r\n      }\r\n\r\n      let intervalDistance: number = this.boundaryDistance(\r\n        this.min,\r\n        this.max,\r\n        polygonB.min,\r\n        polygonB.max\r\n      );\r\n      if (intervalDistance > 0) {\r\n        result.willIntersect = false;\r\n      }\r\n\r\n      if (!result.isIntersect && !result.willIntersect) {\r\n        break;\r\n      }\r\n\r\n      intervalDistance = Math.abs(intervalDistance);\r\n      if (intervalDistance < minIntervalDistance) {\r\n        minIntervalDistance = intervalDistance;\r\n        translationAxis = axis;\r\n        const distance: Vector2d = this.subtractCenter(polygonB);\r\n        if (distance.dot(translationAxis) < 0) {\r\n          translationAxis = translationAxis.negate();\r\n        }\r\n      }\r\n    }\r\n    if (result.willIntersect) {\r\n      result.minDeintersectDistance = translationAxis.scale(\r\n        minIntervalDistance\r\n      ) as Vector2d;\r\n    }\r\n    return result;\r\n  }\r\n}\r\n","import { mat4, quat, vec3 } from \"gl-matrix\";\r\nimport ModelPosition from \"./EngineEntity/ModelPosition\";\r\nimport { EngineEvent } from \"./Events\";\r\nimport Coordinate from \"./Data/Coordinate\";\r\nimport Timer from \"./Common/Timer\";\r\nimport Rect3d from \"./Data/Rect3d\";\r\nimport Rect2d from \"./Data/Rect2d\";\r\nimport { CollisionDetection } from \"./Physics/CollisionDetection\";\r\n\r\nexport interface CameraOptions {\r\n  maxFov: number;\r\n  near: number;\r\n  far: number;\r\n  experimental?: {\r\n    enabled?: boolean;\r\n    inverseAngleY?: boolean;\r\n  };\r\n  isFovMax: boolean;\r\n  fov: number;\r\n  left?: number;\r\n  right?: number;\r\n  bottom?: number;\r\n  top?: number;\r\n  projection?: 'frustum' | 'perspective';\r\n  renderMode: '2d' | '3d';\r\n  aspect?: number;\r\n}\r\n\r\nexport class BaseCamera extends ModelPosition {\r\n  public aspect: number;\r\n  public frustum: mat4;\r\n  public viewMatrix: mat4;\r\n\r\n  protected zoomScale: Coordinate = { x: 2, y: 2, z: 2 };\r\n  protected baseTranslate: Coordinate = { x: -1, y: -1, z: 0 };\r\n  public fov: number;\r\n  public near: number;\r\n  public far: number;\r\n  protected cameraOptions: CameraOptions;\r\n\r\n  protected _isUpdateView = true;\r\n\r\n  private interval: NodeJS.Timeout | undefined;\r\n  private steps: number;\r\n  private _moveTime: number;\r\n  private dx: number;\r\n  private dy: number;\r\n  private dz: number;\r\n  private tx: number;\r\n  private ty: number;\r\n  private tz: number;\r\n  private timer: Timer = new Timer();\r\n\r\n\r\n\r\n  public clearPan() {\r\n    if (this.interval) {\r\n      clearInterval(this.interval);\r\n      this.interval = undefined;\r\n    }\r\n  }\r\n\r\n  protected pan(\r\n    time: number,\r\n    speed: number,\r\n    x?: number,\r\n    y?: number,\r\n    z?: number\r\n  ) {\r\n    this.clearPan();\r\n    this.steps = time;\r\n    this._moveTime = time;\r\n    if (x !== undefined) {\r\n      this.dx = x - this.position.x;\r\n      this.tx = x;\r\n    } else {\r\n      this.dx = 0;\r\n      this.tx = this.position.x;\r\n    }\r\n\r\n    if (y !== undefined) {\r\n      this.dy = y - this.position.y;\r\n      this.ty = y;\r\n    } else {\r\n      this.dy = 0;\r\n      this.ty = this.position.y;\r\n    }\r\n\r\n    if (z !== undefined) {\r\n      this.dz = z - this.position.z;\r\n      this.tz = z;\r\n    } else {\r\n      this.dz = 0;\r\n      this.tz = this.position.z;\r\n    }\r\n\r\n    this.timer.start();\r\n    this.interval = setInterval(() => {\r\n      const time = this.timer.peak();\r\n      if (this.steps > 0) {\r\n        this.steps -= time;\r\n\r\n        if (this.steps <= 0) {\r\n          this.position.x = this.tx;\r\n          this.position.y = this.ty;\r\n          this.position.z = this.tz;\r\n          this.clearPan();\r\n        } else {\r\n          this.position.x += (this.dx * time) / this._moveTime;\r\n          this.position.y += (this.dy * time) / this._moveTime;\r\n          this.position.z += (this.dz * time) / this._moveTime;\r\n        }\r\n        this.updateProjectionView();\r\n      } else {\r\n        this.position.x = this.tx;\r\n        this.position.y = this.ty;\r\n        this.position.z = this.tz;\r\n        this.clearPan();\r\n        this.updateProjectionView();\r\n      }\r\n      this.timer.start();\r\n    }, speed);\r\n  }\r\n\r\n  isOutOfBound(bound: Rect3d, pos: Rect3d): boolean {\r\n    return false;\r\n  }\r\n\r\n  updateProjectionView = () => {\r\n    this._isUpdateView = true;\r\n  };\r\n\r\n  isUpdateView() {\r\n    return this._isUpdateView;\r\n  }\r\n\r\n  commitProjectionView = () => {\r\n    this._isUpdateView = false;\r\n\r\n\r\n    let quatRotationxyz = quat.create();\r\n    quatRotationxyz = quat.rotateX(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ax)\r\n    );\r\n    quatRotationxyz = quat.rotateY(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ay)\r\n    );\r\n    quatRotationxyz = quat.rotateZ(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.az)\r\n    );\r\n    quatRotationxyz = quat.normalize(quatRotationxyz, quatRotationxyz);\r\n\r\n    const dest = mat4.create();\r\n\r\n    const quatMat = mat4.create();\r\n    mat4.fromQuat(quatMat, quatRotationxyz);\r\n    mat4.multiply(dest, dest, quatMat);\r\n\r\n    const pos = vec3.fromValues(\r\n      -this.position.x,\r\n      -this.position.y,\r\n      -this.position.z\r\n    );\r\n    mat4.translate(dest, dest, pos);\r\n\r\n    this.viewMatrix = dest;\r\n\r\n  };\r\n\r\n  frustumMatrix = (): mat4 => {\r\n    const left = this.cameraOptions.left ?? -this.aspect;\r\n    const right = this.cameraOptions.right ?? this.aspect;\r\n    const bottom = this.cameraOptions.bottom ?? -1;\r\n    const top = this.cameraOptions.top ?? 1;\r\n\r\n    return mat4.frustum(\r\n      mat4.create(),\r\n      left,\r\n      right,\r\n      bottom,\r\n      top,\r\n      this.near,\r\n      this.far\r\n    );\r\n  };\r\n\r\n  public perspective(): mat4 {\r\n    return mat4.perspective(\r\n      mat4.create(),\r\n      this.degreesToRadians(this.fov),\r\n      this.aspect,\r\n      this.near,\r\n      this.far\r\n    );\r\n  };\r\n\r\n  updateProjectionMatrix = () => {\r\n    if (this.cameraOptions?.projection === 'frustum') {\r\n      this.frustum = this.frustumMatrix();\r\n    } else {\r\n      this.frustum = this.perspective();\r\n    }\r\n  };\r\n\r\n  angleX(dx: number) {\r\n    this.position.ax -= dx;\r\n    if (this.position.ax > 90) {\r\n      const diff = 90;\r\n      this.position.ax = diff;\r\n    } else if (this.position.ax < -90) {\r\n      const diff = -90;\r\n      this.position.ax = diff;\r\n    }\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  angleZ(dz: number) {\r\n    this.position.az += dz;\r\n    if (this.position.az > 360) {\r\n      const diff = this.position.az - 360;\r\n      this.position.az = diff;\r\n    } else if (this.position.az < 0) {\r\n      const diff = this.position.az + 360;\r\n      this.position.az = diff;\r\n    }\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  angleY(dy: number) {\r\n    if (this.cameraOptions?.experimental?.inverseAngleY) {\r\n      if (dy) {\r\n        dy *= -1;\r\n      }\r\n    }\r\n    this.position.ay += dy;\r\n    if (this.position.ay > 360) {\r\n      const diff = this.position.ay - 360;\r\n      this.position.ay = diff;\r\n    } else if (this.position.ay < 0) {\r\n      const diff = this.position.ay + 360;\r\n      this.position.ay = diff;\r\n    }\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  zoomIn(delta: number) {\r\n    this.fov -= delta;\r\n    this.fov = Math.max(delta, this.fov);\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  zoomOut(delta: number) {\r\n    const maxFovAspect = (Math.atan(1.0 / this.aspect) * 360.0) / Math.PI;\r\n    this.fov += delta;\r\n    this.fov = Math.min(\r\n      Math.min(this.cameraOptions.maxFov || maxFovAspect, maxFovAspect),\r\n      this.fov\r\n    );\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  public setupCamera(\r\n    cameraOptions: CameraOptions,\r\n    aspectRatio: number,\r\n    canvas: HTMLCanvasElement\r\n  ) {\r\n    this.cameraOptions = cameraOptions || {};\r\n    const aspect = cameraOptions.aspect || canvas.width / canvas.height;\r\n\r\n    // Always update camera parameters from options\r\n    this.near = cameraOptions.near ?? 0.01;\r\n    this.far = cameraOptions.far ?? 1000.0;\r\n    this.aspect = aspect;\r\n\r\n    // Set frustum projection parameters if provided\r\n    if (cameraOptions.projection === 'frustum') {\r\n      // Ensure frustum values are properly set based on aspect ratio if not provided\r\n      if (!this.cameraOptions.left) {\r\n        this.cameraOptions.left = cameraOptions.left ?? -aspect;\r\n      }\r\n      if (!this.cameraOptions.right) {\r\n        this.cameraOptions.right = cameraOptions.right ?? aspect;\r\n      }\r\n      if (!this.cameraOptions.bottom) {\r\n        this.cameraOptions.bottom = cameraOptions.bottom ?? -1;\r\n      }\r\n      if (!this.cameraOptions.top) {\r\n        this.cameraOptions.top = cameraOptions.top ?? 1;\r\n      }\r\n    }\r\n\r\n    if (this.cameraOptions.experimental?.enabled) {\r\n      const width = canvas.offsetWidth;\r\n      const height = canvas.offsetHeight;\r\n      const zoom = {\r\n        x: width <= height ? 2 : (2 * aspectRatio) / (width / height),\r\n        y: height <= width ? 2 : (2 * aspectRatio) / (width / height),\r\n        z: 1,\r\n      };\r\n      this.setZoom(zoom);\r\n\r\n      this.setBaseTranslate({\r\n        x: -1 + (2 - zoom.x) / 2,\r\n        y: -1 + (2 - zoom.y) / 2,\r\n        z: 0,\r\n      });\r\n    }\r\n\r\n    if (cameraOptions.projection !== 'frustum') {\r\n      let fov = cameraOptions.fov ?? 45.0;\r\n      if (cameraOptions.isFovMax) {\r\n        const maxFovAspect = (Math.atan(1.0 / aspect) * 360.0) / Math.PI;\r\n        fov = maxFovAspect;\r\n      }\r\n      this.fov = fov;\r\n    }\r\n\r\n    this.updateProjectionMatrix();\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  setZoom(zoom: Coordinate) {\r\n    this.zoomScale = zoom;\r\n  }\r\n\r\n  setBaseTranslate(baseTranslate: Coordinate) {\r\n    this.baseTranslate = baseTranslate;\r\n  }\r\n\r\n  /**\r\n   * Orients the camera to look at a target point in world space.\r\n   * @param targetX X coordinate of the target\r\n   * @param targetY Y coordinate of the target\r\n   * @param targetZ Z coordinate of the target\r\n   */\r\n  lookAt(targetX: number, targetY: number, targetZ: number) {\r\n    const dx = targetX - this.position.x;\r\n    const dy = targetY - this.position.y;\r\n    const dz = targetZ - this.position.z;\r\n\r\n    // Calculate yaw (ay) - rotation around Y axis\r\n    this.position.ay = Math.atan2(-dx, -dz) * 180 / Math.PI;\r\n\r\n    // Calculate pitch (ax) - rotation around X axis\r\n    const horizontalDistance = Math.sqrt(dx * dx + dz * dz);\r\n    this.position.ax = Math.atan2(-dy, horizontalDistance) * 180 / Math.PI;\r\n\r\n    // Reset roll (az) to 0\r\n    this.position.az = 0;\r\n\r\n    this.rotateOrigin(this.position.x, this.position.y, this.position.z);\r\n\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  /**\r\n   * Third-person camera that follows a target from behind\r\n   * @param targetX Target's X position\r\n   * @param targetY Target's Y position\r\n   * @param targetZ Target's Z position\r\n   * @param targetRotation Target's rotation in radians\r\n   * @param distance Distance behind target\r\n   * @param height Height above target\r\n   */\r\n  followBehind(\r\n    targetX: number,\r\n    targetY: number,\r\n    targetZ: number,\r\n    targetRotation: number,\r\n    distance: number = 8,\r\n    height: number = 3\r\n  ) {\r\n    // Calculate camera position behind the target based on target rotation\r\n    const cameraX = targetX - Math.sin(targetRotation) * distance;\r\n    const cameraZ = targetZ - Math.cos(targetRotation) * distance;\r\n    const cameraY = targetY + height;\r\n\r\n    // Position camera\r\n    this.center(cameraX, cameraY, cameraZ);\r\n    \r\n    // Match camera rotation to target\r\n    this.position.ay = targetRotation * (180 / Math.PI);\r\n    \r\n    this.updateProjectionView();\r\n  }\r\n}\r\n\r\nclass Camera2d extends BaseCamera {\r\n  protected INTERVAL_TIME = 10;\r\n  protected bound = new Rect2d(0, 0, 1, 1);\r\n\r\n  public distanceEvent(event: EngineEvent): Coordinate {\r\n    return new Coordinate(event.x + this.position.x, this.position.y + event.y);\r\n  }\r\n\r\n  updateProjectionMatrix = () => {\r\n    const translateSpace = mat4.create();\r\n    mat4.translate(\r\n      translateSpace,\r\n      translateSpace,\r\n      vec3.fromValues(\r\n        this.baseTranslate.x,\r\n        this.baseTranslate.y,\r\n        this.baseTranslate.z\r\n      )\r\n    );\r\n    mat4.scale(\r\n      translateSpace,\r\n      translateSpace,\r\n      vec3.fromValues(this.zoomScale.x, this.zoomScale.y, 1.0)\r\n    );\r\n    this.frustum = translateSpace;\r\n  };\r\n\r\n  zoomIn(delta: number) {\r\n    this.zoomScale.x += delta;\r\n    this.zoomScale.y += delta;\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  zoomOut(delta: number) {\r\n    this.zoomScale.x = Math.max(0.1, this.zoomScale.x - delta);\r\n    this.zoomScale.y = Math.max(0.1, this.zoomScale.y - delta);\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  public isOutOfBound(pos: Rect2d): boolean {\r\n    this.bound.x = this.position.x + this.bound.width / 2.0;\r\n    this.bound.y = this.position.y + this.bound.height / 2.0;\r\n    return !CollisionDetection.isRectInRect(this.bound, pos);\r\n  }\r\n\r\n  public pan2d(time: number, x?: number, y?: number) {\r\n    super.pan(time, this.INTERVAL_TIME, x, y);\r\n  }\r\n\r\n  public pan2dDif(time: number, dx?: number, dy?: number) {\r\n    const { x, y } = this.position;\r\n    super.pan(time, this.INTERVAL_TIME, x + (dx ?? 0), y + (dy ?? 0));\r\n  }\r\n}\r\n\r\nclass Camera3d extends BaseCamera {\r\n  protected INTERVAL_TIME = 10;\r\n\r\n  public pan3d(time: number, x?: number, y?: number, z?: number) {\r\n    super.pan(time, this.INTERVAL_TIME, x, y, z);\r\n  }\r\n}\r\n\r\nclass Camera {\r\n  public camera3d = new Camera3d();\r\n  public camera2d = new Camera2d();\r\n  public height: number;\r\n  public width: number;\r\n  public renderMode: '2d' | '3d' = '2d'; // Default to 2D mode\r\n\r\n  public setupCamera(\r\n    cameraOptions: CameraOptions,\r\n    aspectRatio: number,\r\n    canvas: HTMLCanvasElement,\r\n    renderMode?: '2d' | '3d'\r\n  ) {\r\n    // Set render mode, default to 2D unless 3D is explicitly requested\r\n    this.renderMode = renderMode || cameraOptions.renderMode || '2d';\r\n\r\n    if (this.renderMode === '3d') {\r\n      this.camera3d.setupCamera(cameraOptions, aspectRatio || 1, canvas);\r\n    } else {\r\n      this.camera2d.setupCamera(cameraOptions, aspectRatio || 1, canvas);\r\n    }\r\n\r\n    this.height = canvas.height;\r\n    this.width = canvas.width;\r\n  }\r\n\r\n  public commitProjectionView() {\r\n    if (this.renderMode === '3d') {\r\n      if (this.camera3d.isUpdateView()) {\r\n        this.camera3d.commitProjectionView();\r\n      }\r\n    } else {\r\n      if (this.camera2d.isUpdateView()) {\r\n        this.camera2d.commitProjectionView();\r\n      }\r\n    }\r\n  }\r\n\r\n  public getActiveCamera(): BaseCamera {\r\n    return this.renderMode === '3d' ? this.camera3d : this.camera2d;\r\n  }\r\n\r\n  public getActiveFrustum(): any {\r\n    return this.renderMode === '3d' ? this.camera3d.frustum : this.camera2d.frustum;\r\n  }\r\n}\r\n\r\nexport default Camera;\r\n","import BasicSprite from \"../../Entity/BasicSprite\";\r\nimport LineColour from \"../../Entity/LineColour\";\r\nimport Moveable from \"../../Entity/Moveable\";\r\nimport Plane2d from \"../../Entity/Plane2d\";\r\nimport Plane3d from \"../../Entity/Plane3d\";\r\nimport PlaneColour from \"../../Entity/PlaneColour\";\r\nimport SpriteModel from \"../../Entity/SpriteModel\";\r\nimport SpriteMoveable from \"../../Entity/SpriteMoveable\";\r\nimport TriangleColour2d from \"../../Entity/TriangleColour2d\";\r\nimport Colour from \"../Data/Colour\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport PlaneType from \"../Data/PlaneType\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport EngineObject, { EngineEntity } from \"../EngineEntity/EngineObject\";\r\nimport Position from \"../EngineEntity/Position\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport Events, { EngineEvent } from \"../Events\";\r\nimport { FontReference } from \"../Font/Font\";\r\nimport Physics from \"../Physics/Physics\";\r\n\r\nexport type OnClickType = (\r\n  event: EngineEvent,\r\n  engineHelper: EngineHelper,\r\n  object: EngineObject\r\n) => boolean | undefined;\r\n\r\nclass ConfigMapBuilder {\r\n  engineHelper: EngineHelper;\r\n  objects: EngineObject[];\r\n  texts: FontReference[];\r\n  ref: { [key: string]: any };\r\n  anchor: { [key: string]: any };\r\n\r\n  constructor(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n    this.objects = [];\r\n    this.ref = {};\r\n    this.anchor = {};\r\n    this.texts = [];\r\n  }\r\n\r\n  build(map: any) {\r\n    for (const prop in map) {\r\n      if (map.hasOwnProperty(prop)) {\r\n        if (prop.startsWith(\"$\")) {\r\n          this.ref[prop] = map[prop];\r\n        } else if (prop.startsWith(\"+\")) {\r\n          this.anchor[prop] = map[prop];\r\n        } else {\r\n          let object = map[prop];\r\n          this.initObjectPosition(object);\r\n          if (object.$ref && this.ref[object.$ref]) {\r\n            // merge ref with object\r\n            object = {\r\n              ...this.ref[object.$ref],\r\n              ...object,\r\n            };\r\n          }\r\n          if (object.$anchor && this.anchor[object.$anchor]) {\r\n            const anchor = this.anchor[object.$anchor];\r\n            // translate anchor\r\n            if (object.type === \"Font\") {\r\n              object.position.x += anchor.position.x;\r\n              object.position.y += anchor.position.y;\r\n            } else {\r\n              object.position.x += anchor.position.x;\r\n              object.position.y += anchor.position.y;\r\n              object.position.width += anchor.position.width;\r\n              object.position.height += anchor.position.height;\r\n            }\r\n          }\r\n          this.buildModel(object);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  initObjectPosition(object: any) {\r\n    if (!object.position) {\r\n      object.position = { x: 0, y: 0, height: 0, width: 0 };\r\n    } else {\r\n      if (!object.position.x) {\r\n        object.position.x = 0;\r\n      }\r\n      if (!object.position.y) {\r\n        object.position.y = 0;\r\n      }\r\n      if (!object.position.width) {\r\n        object.position.width = 0;\r\n      }\r\n      if (!object.position.height) {\r\n        object.position.height = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  buildModel(\r\n    config: ConfigEntity\r\n  ): ConfigEntityConcreteType[ConfigEntity[\"type\"]] {\r\n    if (!config.type) {\r\n      console.error(\"unable to parse empty type for object\", config);\r\n      return null as any;\r\n    }\r\n    let obj: EngineObject | FontReference = null as any;\r\n    if (config.type === \"Plane2D\") {\r\n      obj = this.createPlane2D(\r\n        config.model,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Plane3D\") {\r\n      obj = this.createPlane3D(\r\n        config.model,\r\n        this.createRect3d(config.position, config.isCentre),\r\n        config.hasPhysics,\r\n        config.planeType\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Triangle\") {\r\n      obj = this.createTriangle(\r\n        config.rgba,\r\n        this.createRect2d(config.position, config.isCentre)\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"SpriteMoveable\") {\r\n      obj = this.createSpriteMoveable(\r\n        config.spriteModel,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics,\r\n        config.ticks\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Moveable\") {\r\n      obj = this.createMoveable(\r\n        config.model,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Sprite\") {\r\n      obj = this.createSprite(\r\n        config.spriteModel,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics,\r\n        config.ticks\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Font\") {\r\n      obj = this.createText(\r\n        config.texture,\r\n        this.createCoordinate(config.position),\r\n        config.fontSize,\r\n        config.text\r\n      );\r\n      obj.id = config.id;\r\n    } else if (config.type === \"Colour\") {\r\n      obj = this.createColour(\r\n        config.rgba,\r\n        this.createRect2d(config.position, config.isCentre)\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Line\") {\r\n      obj = this.createLineColour(\r\n        config.rgba,\r\n        config.point1,\r\n        config.point2,\r\n        config.thickness\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else {\r\n      console.warn(`Unable to find entity of type ${config.type}`);\r\n    }\r\n    if (obj instanceof EngineObject) {\r\n      obj.$id = config.id || obj.$id;\r\n      obj.data = config.data;\r\n      obj.isLastEvent = config.isLastEvent || false;\r\n    }\r\n\r\n    if (obj instanceof EngineObject || obj instanceof FontReference) {\r\n      if (config.isTop) {\r\n        obj.setTop(true);\r\n      }\r\n    }\r\n\r\n    if (obj instanceof EngineObject && config.clone) {\r\n      obj.setClone(true);\r\n    }\r\n\r\n    // @ts-expect-error ignore\r\n    return obj;\r\n  }\r\n\r\n  hookCustomHandler(config: ConfigEntity, object: EngineObject) {\r\n    if (config.render) {\r\n      let _renderCustom;\r\n      if (typeof window[config.render] === \"function\") {\r\n        _renderCustom = window[config.render].bind(object);\r\n      } else if (typeof config.render === \"function\") {\r\n        _renderCustom = config.render;\r\n      } else {\r\n        _renderCustom = () => {};\r\n      }\r\n      const _render = object.render.bind(object);\r\n      object.render = (engineHelper: EngineHelper) => {\r\n        _render(engineHelper);\r\n        _renderCustom(engineHelper);\r\n      };\r\n    }\r\n    if (config.update) {\r\n      let _updateCustom;\r\n      if (typeof window[config.update] === \"function\") {\r\n        _updateCustom = window[config.update].bind(object);\r\n      } else if (typeof config.update === \"function\") {\r\n        _updateCustom = config.update;\r\n      } else {\r\n        _updateCustom = () => {};\r\n      }\r\n      const _update = object.update.bind(object);\r\n      object.update = (engineHelper: EngineHelper) => {\r\n        _update(engineHelper);\r\n        _updateCustom(engineHelper);\r\n      };\r\n    }\r\n\r\n    const onClickedDefined =\r\n      config.onClick && typeof config.onClick === \"function\";\r\n    if (config.event) {\r\n      let _eventCustom;\r\n      if (typeof window[config.event] === \"function\") {\r\n        _eventCustom = window[config.event].bind(object);\r\n      } else if (typeof config.event === \"function\") {\r\n        _eventCustom = config.event;\r\n      } else {\r\n        _eventCustom = () => {};\r\n      }\r\n      const _event = object.event.bind(object) as EngineEntity[\"event\"];\r\n      object.event = (event: EngineEvent, engineHelper: EngineHelper) => {\r\n        let shouldPropagate = true;\r\n        // only stop propagation if the event returns false\r\n        shouldPropagate =\r\n          shouldPropagate && _event(event, engineHelper) !== false;\r\n        shouldPropagate =\r\n          shouldPropagate &&\r\n          _eventCustom(event, engineHelper, object) !== false;\r\n        if (onClickedDefined) {\r\n          shouldPropagate =\r\n            shouldPropagate &&\r\n            this.isClicked(event, engineHelper, object, config.onClick) !==\r\n              false;\r\n        }\r\n        return shouldPropagate;\r\n      };\r\n    } else if (onClickedDefined) {\r\n      const _event = object.event.bind(object);\r\n      object.event = (event: EngineEvent, engineHelper: EngineHelper) => {\r\n        let shouldPropagate = _event(event, engineHelper) !== false;\r\n        shouldPropagate =\r\n          shouldPropagate &&\r\n          this.isClicked(event, engineHelper, object, config.onClick) !== false;\r\n        return shouldPropagate;\r\n      };\r\n    }\r\n  }\r\n\r\n  isClicked(\r\n    event: EngineEvent,\r\n    engineHelper: EngineHelper,\r\n    object: EngineObject,\r\n    onClick: OnClickType\r\n  ) {\r\n    if (\r\n      event.eventType === Events.UP &&\r\n      engineHelper.isClicked(event, object.getRect2()) &&\r\n      object.hidden === false\r\n    ) {\r\n      return onClick.bind(object)(event, engineHelper, object);\r\n    }\r\n  }\r\n\r\n  createRect2d(position: Position, isCentre: boolean): Rect2d {\r\n    const rect = new Rect2d(\r\n      Number(position.x),\r\n      Number(position.y),\r\n      Number(position.width),\r\n      Number(position.height),\r\n      0\r\n    );\r\n    return isCentre ? rect.center() : rect;\r\n  }\r\n\r\n  createRect3d(position: Position, isCentre: boolean): Rect3d {\r\n    const rect = new Rect3d(\r\n      Number(position.x),\r\n      Number(position.y),\r\n      Number(position.z),\r\n      Number(position.width),\r\n      Number(position.height),\r\n      Number(position.length)\r\n    );\r\n    return isCentre ? rect.center() : rect;\r\n  }\r\n\r\n  createCoordinate(position: any): Coordinate {\r\n    return new Coordinate(Number(position.x), Number(position.y), 0);\r\n  }\r\n\r\n  createText(\r\n    texture: string,\r\n    pos: Coordinate,\r\n    fontSize: number,\r\n    text: string\r\n  ): FontReference {\r\n    const textRef = FontReference.newFont(pos, texture, 0)\r\n      .setText(text)\r\n      .setFontSize(fontSize);\r\n    this.texts.push(textRef);\r\n    return textRef;\r\n  }\r\n\r\n  createLineColour(\r\n    rgba: Colour,\r\n    point1: Coordinate,\r\n    point2: Coordinate,\r\n    thickness: number\r\n  ): EngineObject {\r\n    const colour = new LineColour(point1, point2, thickness, rgba);\r\n    this.objects.push(colour);\r\n    return colour;\r\n  }\r\n\r\n  createColour(rgba: Colour, location: Rect2d): EngineObject {\r\n    const colour = new PlaneColour(location, rgba);\r\n    this.objects.push(colour);\r\n    return colour;\r\n  }\r\n\r\n  createSpriteMoveable(\r\n    model: string[],\r\n    location: Rect2d,\r\n    hasPhysics: boolean,\r\n    ticks: number\r\n  ): EngineObject {\r\n    const spriteModel = new SpriteModel(location, ticks || 120.0, model);\r\n    const obj = new SpriteMoveable(location, spriteModel);\r\n    spriteModel.position.z = -1;\r\n    spriteModel.scaleZ(0);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj, obj.physics);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createMoveable(\r\n    model: string,\r\n    location: Rect2d,\r\n    hasPhysics: boolean\r\n  ): EngineObject {\r\n    const obj = new Plane2d(location, model);\r\n    obj.setLayer(-1);\r\n\r\n    const moveable = new Moveable();\r\n    moveable.entities.push(obj);\r\n    moveable.rotateZ(180.0);\r\n    moveable.setRect(location);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(moveable, moveable.physics);\r\n    }\r\n    moveable.updatePhysicsPosition();\r\n    this.objects.push(moveable);\r\n    return moveable;\r\n  }\r\n\r\n  createSprite(\r\n    model: string[],\r\n    location: Rect2d,\r\n    hasPhysics: boolean,\r\n    ticks: number\r\n  ): EngineObject {\r\n    const spriteModel = new SpriteModel(location, ticks || 120.0, model);\r\n    const obj = new BasicSprite(location, spriteModel);\r\n    spriteModel.position.z = -1;\r\n    spriteModel.rotateZ(180.0);\r\n    spriteModel.scaleZ(0);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj, obj.physics);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createPlane2D(\r\n    model: string,\r\n    location: Rect2d,\r\n    hasPhysics: boolean\r\n  ): EngineObject {\r\n    const obj = new Plane2d(location, model);\r\n    obj.rotateZ(180.0);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createPlane3D(\r\n    model: string,\r\n    location: Rect3d,\r\n    hasPhysics: boolean,\r\n    plane: PlaneType\r\n  ): EngineObject {\r\n    const vertexModel = this.engineHelper.newVertexModel(model, plane);\r\n    const obj = new Plane3d(location, vertexModel);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createTriangle(rgba: Colour, location: Rect2d): EngineObject {\r\n    const obj = new TriangleColour2d(location, rgba);\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n}\r\n\r\nexport type ConfigEntityTypes = keyof ConfigEntityConcreteType;\r\n\r\nexport type ConfigEntityConcreteType = {\r\n  Line: LineColour;\r\n  Plane2D: Plane2d;\r\n  Colour: PlaneColour;\r\n  Font: FontReference;\r\n  Plane3D: Plane3d;\r\n  Triangle: TriangleColour2d;\r\n  SpriteMoveable: SpriteMoveable;\r\n  Moveable: Moveable;\r\n  Sprite: BasicSprite;\r\n};\r\n\r\nexport class ConfigEntity {\r\n  id: string;\r\n  type: ConfigEntityTypes;\r\n  position: Position;\r\n  point1: Coordinate;\r\n  point2: Coordinate;\r\n  thickness: number;\r\n  rgba: Colour;\r\n  model: string;\r\n  hasPhysics: boolean;\r\n  clone: boolean;\r\n  fontSize: number;\r\n  text: string;\r\n  ticks: number;\r\n  spriteModel: string[];\r\n  texture: string;\r\n  render: string;\r\n  update: string;\r\n  event: string;\r\n  script: string;\r\n  isTop: boolean;\r\n  onClick: OnClickType;\r\n  data: object;\r\n  isCentre: boolean;\r\n  planeType: PlaneType;\r\n  isLastEvent: boolean;\r\n}\r\n\r\nexport type ConfigBuilder = {\r\n  entity: { [key: string]: ConfigEntity };\r\n  script: string;\r\n};\r\n\r\nexport default ConfigMapBuilder;\r\n","import Rect2d from \"../Core/Data/Rect2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Moveable from \"./Moveable\";\r\nimport SpriteModel from \"./SpriteModel\";\r\n\r\nclass BasicSprite extends Moveable {\r\n  spriteModel: SpriteModel;\r\n\r\n  constructor(rect: Rect2d, spriteModel: SpriteModel) {\r\n    super();\r\n    this.spriteModel = spriteModel;\r\n    this.spriteModel.setRect(rect);\r\n    this.entities.push(this.spriteModel);\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.spriteModel.render(engineHelper);\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    this.spriteModel.update(engineHelper);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    super.init(engineHelper);\r\n    this.setRect(this.spriteModel.getRect());\r\n    this.updatePhysicsPosition();\r\n  }\r\n}\r\n\r\nexport default BasicSprite;\r\n","interface BitmapData {\r\n  [key: string]: number[];\r\n}\r\n\r\nclass BitmapConfigParser {\r\n  map: BitmapData;\r\n  raw: BitmapData;\r\n  private source: string;\r\n  private readonly SOURCE_KEY = \"$source =\";\r\n\r\n  constructor(\r\n    raw: string,\r\n    bitmapWidth: number,\r\n    bitmapHeight: number,\r\n    precision: number\r\n  ) {\r\n    this.map = raw\r\n      .split(\"\\n\")\r\n      .map((line) =>\r\n        this.processLine(bitmapWidth, bitmapHeight, precision, line)\r\n      )\r\n      .filter((e) => !!e)\r\n      .reduce((sum, next) => ({ ...sum, ...next }));\r\n\r\n    this.raw = raw\r\n      .split(\"\\n\")\r\n      .map((line) => this.processRawLine(line))\r\n      .filter((e) => !!e)\r\n      .reduce((sum, next) => ({ ...sum, ...next })) as BitmapData;\r\n  }\r\n\r\n  processRawLine(line: string) {\r\n    if (line.startsWith(this.SOURCE_KEY)) {\r\n      this.source = line\r\n        .substr(line.indexOf(this.SOURCE_KEY) + this.SOURCE_KEY.length)\r\n        .trim()\r\n        .replace(\"\\r\", \"\")\r\n        .replace(\"\\n\", \"\");\r\n\r\n      if (window.location.origin === \"file://\") {\r\n        console.info(\r\n          \"file based loading should not have ./ in front of the source\"\r\n        );\r\n      }\r\n\r\n      return;\r\n    } else {\r\n      return this.processTextureLine(line);\r\n    }\r\n  }\r\n\r\n  private processTextureLine(line: string) {\r\n    const seperator = \"\\u0020\";\r\n    const nameindex = line.indexOf(seperator);\r\n    const key = line.substr(0, nameindex);\r\n    let temp = line.substr(nameindex + 1);\r\n    temp = temp.substr(temp.indexOf(seperator) + 1);\r\n    const leftindex = temp.indexOf(seperator);\r\n    const left = parseFloat(temp.substr(0, leftindex + 1));\r\n    temp = temp.substr(leftindex + 1);\r\n    const topindex = temp.indexOf(seperator);\r\n    const top = parseFloat(temp.substr(0, topindex));\r\n    temp = temp.substr(topindex + 1);\r\n    const widthIndex = temp.indexOf(seperator);\r\n    const width = parseFloat(temp.substr(0, widthIndex));\r\n    temp = temp.substr(widthIndex);\r\n    const height = parseFloat(temp);\r\n    return {\r\n      [key]: [left, top, width, height],\r\n    };\r\n  }\r\n\r\n  processLine(\r\n    bitmapWidth: number,\r\n    bitmapHeight: number,\r\n    precision: number,\r\n    line: string\r\n  ) {\r\n    const seperator = \"\\u0020\";\r\n\r\n    const nameindex = line.indexOf(seperator);\r\n    const key = line.substr(0, nameindex);\r\n\r\n    let temp = line.substr(nameindex + 1);\r\n    temp = temp.substr(temp.indexOf(seperator) + 1);\r\n\r\n    const leftindex = temp.indexOf(seperator);\r\n    const left = parseFloat(temp.substr(0, leftindex + 1));\r\n\r\n    temp = temp.substr(leftindex + 1);\r\n    const topindex = temp.indexOf(seperator);\r\n    const top = parseFloat(temp.substr(0, topindex));\r\n\r\n    temp = temp.substr(topindex + 1);\r\n    const widthIndex = temp.indexOf(seperator);\r\n    const width = parseFloat(temp.substr(0, widthIndex));\r\n\r\n    temp = temp.substr(widthIndex);\r\n    const height = parseFloat(temp);\r\n\r\n    return {\r\n      [key]: [\r\n        (left + width) / bitmapWidth - precision,\r\n        (height + top) / bitmapHeight - precision,\r\n        (left + width) / bitmapWidth - precision,\r\n        top / bitmapHeight + precision,\r\n        left / bitmapWidth + precision,\r\n        top / bitmapHeight + precision,\r\n        left / bitmapWidth + precision,\r\n        (top + height) / bitmapHeight - precision,\r\n      ],\r\n    };\r\n  }\r\n\r\n  getMap(): BitmapData {\r\n    return this.map;\r\n  }\r\n\r\n  getTextureSource(): string {\r\n    return this.source;\r\n  }\r\n}\r\n\r\nexport default BitmapConfigParser;\r\n","import * as glMatrix from \"./common.js\";\n\n/**\n * 2x2 Matrix\n * @module mat2\n */\n\n/**\n * Creates a new identity mat2\n *\n * @returns {mat2} a new 2x2 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat2 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat2} a matrix to clone\n * @returns {mat2} a new 2x2 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Copy the values from one mat2 to another\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Set a mat2 to the identity matrix\n *\n * @param {mat2} out the receiving matrix\n * @returns {mat2} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Create a new mat2 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out A new 2x2 matrix\n */\nexport function fromValues(m00, m01, m10, m11) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n\n/**\n * Set the components of a mat2 to the given values\n *\n * @param {mat2} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out\n */\nexport function set(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n\n/**\n * Transpose the values of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n\n  // Calculate the determinant\n  var det = a0 * a3 - a2 * a1;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\nexport function adjoint(out, a) {\n  // Caching this value is necessary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat2\n *\n * @param {ReadonlyMat2} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n\n/**\n * Multiplies two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n\n/**\n * Rotates a mat2 by the given angle\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n\n/**\n * Scales the mat2 by the dimensions in the given vec2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to rotate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat2} out\n **/\nexport function scale(out, a, v) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var v0 = v[0],\n    v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.rotate(dest, dest, rad);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.scale(dest, dest, vec);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat2} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n\n/**\n * Returns a string representation of a mat2\n *\n * @param {ReadonlyMat2} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat2\n *\n * @param {ReadonlyMat2} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3]);\n}\n\n/**\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\n * @param {ReadonlyMat2} L the lower triangular matrix\n * @param {ReadonlyMat2} D the diagonal matrix\n * @param {ReadonlyMat2} U the upper triangular matrix\n * @param {ReadonlyMat2} a the input matrix to factorize\n */\n\nexport function LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n\n/**\n * Adds two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat2} a The first matrix.\n * @param {ReadonlyMat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat2} a The first matrix.\n * @param {ReadonlyMat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n\n/**\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2} out the receiving vector\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n\n/**\n * Alias for {@link mat2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat2.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 2x3 Matrix\n * @module mat2d\n * @description\n * A mat2d contains six elements defined as:\n * <pre>\n * [a, b,\n *  c, d,\n *  tx, ty]\n * </pre>\n * This is a short form for the 3x3 matrix:\n * <pre>\n * [a, b, 0,\n *  c, d, 0,\n *  tx, ty, 1]\n * </pre>\n * The last column is ignored so the array is shorter and operations are faster.\n */\n\n/**\n * Creates a new identity mat2d\n *\n * @returns {mat2d} a new 2x3 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat2d initialized with values from an existing matrix\n *\n * @param {ReadonlyMat2d} a matrix to clone\n * @returns {mat2d} a new 2x3 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n\n/**\n * Copy the values from one mat2d to another\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {mat2d} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n\n/**\n * Set a mat2d to the identity matrix\n *\n * @param {mat2d} out the receiving matrix\n * @returns {mat2d} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n\n/**\n * Create a new mat2d with the given values\n *\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} A new mat2d\n */\nexport function fromValues(a, b, c, d, tx, ty) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n\n/**\n * Set the components of a mat2d to the given values\n *\n * @param {mat2d} out the receiving matrix\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} out\n */\nexport function set(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n\n/**\n * Inverts a mat2d\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {mat2d | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var aa = a[0],\n    ab = a[1],\n    ac = a[2],\n    ad = a[3];\n  var atx = a[4],\n    aty = a[5];\n  var det = aa * ad - ab * ac;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat2d\n *\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n\n/**\n * Multiplies two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n\n/**\n * Rotates a mat2d by the given angle\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n\n/**\n * Scales the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to translate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat2d} out\n **/\nexport function scale(out, a, v) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var v0 = v[0],\n    v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n\n/**\n * Translates the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to translate\n * @param {ReadonlyVec2} v the vec2 to translate the matrix by\n * @returns {mat2d} out\n **/\nexport function translate(out, a, v) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var v0 = v[0],\n    v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.rotate(dest, dest, rad);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n    c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.scale(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat2d} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.translate(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat2d} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n\n/**\n * Returns a string representation of a mat2d\n *\n * @param {ReadonlyMat2d} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat2d(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat2d\n *\n * @param {ReadonlyMat2d} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + 1);\n}\n\n/**\n * Adds two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2d} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n\n/**\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2d} out the receiving vector\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2d} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat2d} a The first matrix.\n * @param {ReadonlyMat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat2d} a The first matrix.\n * @param {ReadonlyMat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n\n/**\n * Alias for {@link mat2d.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat2d.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 3x3 Matrix\n * @module mat3\n */\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {ReadonlyMat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20;\n\n  // Calculate the determinant\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat3\n *\n * @param {ReadonlyMat3} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  var b00 = b[0],\n    b01 = b[1],\n    b02 = b[2];\n  var b10 = b[3],\n    b11 = b[4],\n    b12 = b[5];\n  var b20 = b[6],\n    b21 = b[7],\n    b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to translate\n * @param {ReadonlyVec2} v vector to translate by\n * @returns {mat3} out\n */\nexport function translate(out, a, v) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a10 = a[3],\n    a11 = a[4],\n    a12 = a[5],\n    a20 = a[6],\n    a21 = a[7],\n    a22 = a[8],\n    x = v[0],\n    y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a10 = a[3],\n    a11 = a[4],\n    a12 = a[5],\n    a20 = a[6],\n    a21 = a[7],\n    a22 = a[8],\n    s = Math.sin(rad),\n    c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat3} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n    c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat3} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to copy\n * @returns {mat3} out\n **/\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Calculates a 3x3 matrix from the given quaternion\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat3} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n\n/**\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n *\n * @returns {mat3} out\n */\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n\n/**\n * Generates a 2D projection matrix with the given bounds\n *\n * @param {mat3} out mat3 frustum matrix will be written into\n * @param {number} width Width of your gl context\n * @param {number} height Height of gl context\n * @returns {mat3} out\n */\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat3\n *\n * @param {ReadonlyMat3} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8]);\n}\n\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7],\n    a8 = a[8];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7],\n    b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n    var a12 = a[6],\n      a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b0 = a00 * a11 - a01 * a10;\n  var b1 = a00 * a12 - a02 * a10;\n  var b2 = a01 * a12 - a02 * a11;\n  var b3 = a20 * a31 - a21 * a30;\n  var b4 = a20 * a32 - a22 * a30;\n  var b5 = a21 * a32 - a22 * a31;\n  var b6 = a00 * b5 - a01 * b4 + a02 * b3;\n  var b7 = a10 * b5 - a11 * b4 + a12 * b3;\n  var b8 = a20 * b2 - a21 * b1 + a22 * b0;\n  var b9 = a30 * b2 - a31 * b1 + a32 * b0;\n\n  // Calculate the determinant\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n}\n\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n\n  // Cache only the current line of the second matrix\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\nexport function translate(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n  return out;\n}\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11];\n\n  // Construct the elements of the rotation matrix\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw;\n  //Only scale if it makes sense\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion parameter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n  return out;\n}\n\n/**\n * Decomposes a transformation matrix into its rotation, translation\n * and scale components. Returns only the rotation component\n * @param  {quat} out_r Quaternion to receive the rotation component\n * @param  {vec3} out_t Vector to receive the translation vector\n * @param  {vec3} out_s Vector to receive the scaling factor\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @returns {quat} out_r\n */\nexport function decompose(out_r, out_t, out_s, mat) {\n  out_t[0] = mat[12];\n  out_t[1] = mat[13];\n  out_t[2] = mat[14];\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  var is1 = 1 / out_s[0];\n  var is2 = 1 / out_s[1];\n  var is3 = 1 / out_s[2];\n  var sm11 = m11 * is1;\n  var sm12 = m12 * is2;\n  var sm13 = m13 * is3;\n  var sm21 = m21 * is1;\n  var sm22 = m22 * is2;\n  var sm23 = m23 * is3;\n  var sm31 = m31 * is1;\n  var sm32 = m32 * is2;\n  var sm33 = m33 * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out_r[3] = 0.25 * S;\n    out_r[0] = (sm23 - sm32) / S;\n    out_r[1] = (sm31 - sm13) / S;\n    out_r[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out_r[3] = (sm23 - sm32) / S;\n    out_r[0] = 0.25 * S;\n    out_r[1] = (sm12 + sm21) / S;\n    out_r[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out_r[3] = (sm31 - sm13) / S;\n    out_r[0] = (sm12 + sm21) / S;\n    out_r[1] = 0.25 * S;\n    out_r[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out_r[3] = (sm12 - sm21) / S;\n    out_r[0] = (sm31 + sm13) / S;\n    out_r[1] = (sm23 + sm32) / S;\n    out_r[2] = 0.25 * S;\n  }\n  return out_r;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     mat4.translate(dest, dest, origin);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *     mat4.translate(dest, dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n  return out;\n}\n\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\nexport var perspective = perspectiveNO;\n\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\nexport var ortho = orthoNO;\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} target Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n    eyey = eye[1],\n    eyez = eye[2],\n    upx = up[0],\n    upy = up[1],\n    upz = up[2];\n  var z0 = eyex - target[0],\n    z1 = eyey - target[1],\n    z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n  var x0 = upy * z2 - upz * z1,\n    x1 = upz * z0 - upx * z2,\n    x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8] + a[9] * a[9] + a[10] * a[10] + a[11] * a[11] + a[12] * a[12] + a[13] * a[13] + a[14] * a[14] + a[15] * a[15]);\n}\n\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var a8 = a[8],\n    a9 = a[9],\n    a10 = a[10],\n    a11 = a[11];\n  var a12 = a[12],\n    a13 = a[13],\n    a14 = a[14],\n    a15 = a[15];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  var b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  var b8 = b[8],\n    b9 = b[9],\n    b10 = b[10],\n    b11 = b[11];\n  var b12 = b[12],\n    b13 = b[13],\n    b14 = b[14],\n    b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  out[2] = glMatrix.round(a[2]);\n  return out;\n}\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n\n/**\n * Performs a spherical linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function slerp(out, a, b, t) {\n  var angle = Math.acos(Math.min(Math.max(dot(a, b), -1), 1));\n  var sinTotal = Math.sin(angle);\n  var ratioA = Math.sin((1 - t) * angle) / sinTotal;\n  var ratioB = Math.sin(t * angle) / sinTotal;\n  out[0] = ratioA * a[0] + ratioB * b[0];\n  out[1] = ratioA * a[1] + ratioB * b[1];\n  out[2] = ratioA * a[2] + ratioB * b[2];\n  return out;\n}\n\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec3} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q normalized quaternion to transform with\n * @returns {vec3} out\n */\nexport function transformQuat(out, a, q) {\n  // Fast Vector Rotation using Quaternions by Robert Eisele\n  // https://raw.org/proof/vector-rotation-using-quaternions/\n\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3];\n  var vx = a[0],\n    vy = a[1],\n    vz = a[2];\n\n  // t = q x v\n  var tx = qy * vz - qz * vy;\n  var ty = qz * vx - qx * vz;\n  var tz = qx * vy - qy * vx;\n\n  // t = 2t\n  tx = tx + tx;\n  ty = ty + ty;\n  tz = tz + tz;\n\n  // v + w t + q x t\n  out[0] = vx + qw * tx + qy * tz - qz * ty;\n  out[1] = vy + qw * ty + qz * tx - qx * tz;\n  out[2] = vz + qw * tz + qx * ty - qy * tx;\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2];\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    bx = b[0],\n    by = b[1],\n    bz = b[2],\n    mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz)),\n    cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 3;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  out[2] = glMatrix.round(a[2]);\n  out[3] = glMatrix.round(a[3]);\n  return out;\n}\n\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} out the receiving vector\n * @param {ReadonlyVec4} u the first vector\n * @param {ReadonlyVec4} v the second vector\n * @param {ReadonlyVec4} w the third vector\n * @returns {vec4} result\n */\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n    B = v[0] * w[2] - v[2] * w[0],\n    C = v[0] * w[3] - v[3] * w[0],\n    D = v[1] * w[2] - v[2] * w[1],\n    E = v[1] * w[3] - v[3] * w[1],\n    F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec4} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n\n  // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n  var v1, v2, v3, v4;\n  var s1, s2;\n  var rand;\n  rand = glMatrix.RANDOM();\n  v1 = rand * 2 - 1;\n  v2 = (4 * glMatrix.RANDOM() - 2) * Math.sqrt(rand * -rand + rand);\n  s1 = v1 * v1 + v2 * v2;\n  rand = glMatrix.RANDOM();\n  v3 = rand * 2 - 1;\n  v4 = (4 * glMatrix.RANDOM() - 2) * Math.sqrt(rand * -rand + rand);\n  s2 = v3 * v3 + v4 * v4;\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2],\n    w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q normalized quaternion to transform with\n * @returns {vec4} out\n */\nexport function transformQuat(out, a, q) {\n  // Fast Vector Rotation using Quaternions by Robert Eisele\n  // https://raw.org/proof/vector-rotation-using-quaternions/\n\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3];\n  var vx = a[0],\n    vy = a[1],\n    vz = a[2];\n\n  // t = q x v\n  var tx = qy * vz - qz * vy;\n  var ty = qz * vx - qx * vz;\n  var tz = qx * vy - qy * vx;\n\n  // t = 2t\n  tx = tx + tx;\n  ty = ty + ty;\n  tz = tz + tz;\n\n  // v + w t + q x t\n  out[0] = vx + qw * tx + qy * tz - qz * ty;\n  out[1] = vy + qw * ty + qz * tx - qx * tz;\n  out[2] = vz + qw * tz + qx * ty - qy * tx;\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec4.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 4;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n\n/**\n * Quaternion in the format XYZW\n * @module quat\n */\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Set a quat to the identity quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Sets a quat from the given angle and rotation axis,\n * then returns it.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyVec3} axis the axis around which to rotate\n * @param {Number} rad the angle in radians\n * @returns {quat} out\n **/\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n\n/**\n * Gets the rotation axis and angle for a given\n *  quaternion. If a quaternion is created with\n *  setAxisAngle, this method will return the same\n *  values as providied in the original parameter list\n *  OR functionally equivalent values.\n * Example: The quaternion formed by axis [0, 0, 1] and\n *  angle -90 is the same as the quaternion formed by\n *  [0, 0, 1] and 270. This method favors the latter.\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\n * @return {Number}     Angle, in radians, of the rotation\n */\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n  return rad;\n}\n\n/**\n * Gets the angular distance between two unit quaternions\n *\n * @param  {ReadonlyQuat} a     Origin unit quaternion\n * @param  {ReadonlyQuat} b     Destination unit quaternion\n * @return {Number}     Angle, in radians, between the two quaternions\n */\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n\n/**\n * Multiplies two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n */\nexport function multiply(out, a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2],\n    bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bx = Math.sin(rad),\n    bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var by = Math.sin(rad),\n    bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n\n/**\n * Rotates a quaternion by the given angle about the Z axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bz = Math.sin(rad),\n    bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n\n/**\n * Calculates the W component of a quat from the X, Y, and Z components.\n * Assumes that quaternion is 1 unit in length.\n * Any existing W component will be ignored.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate W component of\n * @returns {quat} out\n */\nexport function calculateW(out, a) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n\n/**\n * Calculate the exponential of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\nexport function exp(out, a) {\n  var x = a[0],\n    y = a[1],\n    z = a[2],\n    w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n\n/**\n * Calculate the natural logarithm of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\nexport function ln(out, a) {\n  var x = a[0],\n    y = a[1],\n    z = a[2],\n    w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n\n/**\n * Calculate the scalar power of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @param {Number} b amount to scale the quaternion by\n * @returns {quat} out\n */\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n\n/**\n * Performs a spherical linear interpolation between two quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2],\n    bw = b[3];\n  var omega, cosom, sinom, scale0, scale1;\n\n  // calc cosine\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\n  // adjust signs (if necessary)\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  }\n  // calculate coefficients\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  }\n  // calculate final values\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n\n/**\n * Generates a random unit quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n\n/**\n * Calculates the inverse of a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate inverse of\n * @returns {quat} out\n */\nexport function invert(out, a) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0;\n\n  // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate conjugate of\n * @returns {quat} out\n */\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Creates a quaternion from the given 3x3 rotation matrix.\n *\n * NOTE: The resultant quaternion is not normalized, so you should be sure\n * to renormalize the quaternion yourself where necessary.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyMat3} m rotation matrix\n * @returns {quat} out\n * @function\n */\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n  return out;\n}\n\n/**\n * Creates a quaternion from the given euler angle x, y, z using the provided intrinsic order for the conversion.\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x Angle to rotate around X axis in degrees.\n * @param {Number} y Angle to rotate around Y axis in degrees.\n * @param {Number} z Angle to rotate around Z axis in degrees.\n * @param {'xyz'|'xzy'|'yxz'|'yzx'|'zxy'|'zyx'} order Intrinsic order for conversion, default is zyx.\n * @returns {quat} out\n * @function\n */\nexport function fromEuler(out, x, y, z) {\n  var order = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : glMatrix.ANGLE_ORDER;\n  var halfToRad = Math.PI / 360;\n  x *= halfToRad;\n  z *= halfToRad;\n  y *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  switch (order) {\n    case \"xyz\":\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n      break;\n    case \"xzy\":\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n      break;\n    case \"yxz\":\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n      break;\n    case \"yzx\":\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n      break;\n    case \"zxy\":\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n      break;\n    case \"zyx\":\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n      break;\n    default:\n      throw new Error('Unknown angle order ' + order);\n  }\n  return out;\n}\n\n/**\n * Returns a string representation of a quaternion\n *\n * @param {ReadonlyQuat} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\nexport var clone = vec4.clone;\n\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\nexport var fromValues = vec4.fromValues;\n\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the source quaternion\n * @returns {quat} out\n * @function\n */\nexport var copy = vec4.copy;\n\n/**\n * Set the components of a quat to the given values\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} out\n * @function\n */\nexport var set = vec4.set;\n\n/**\n * Adds two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n * @function\n */\nexport var add = vec4.add;\n\n/**\n * Alias for {@link quat.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Scales a quat by a scalar number\n *\n * @param {quat} out the receiving vector\n * @param {ReadonlyQuat} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {quat} out\n * @function\n */\nexport var scale = vec4.scale;\n\n/**\n * Calculates the dot product of two quat's\n *\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\nexport var dot = vec4.dot;\n\n/**\n * Performs a linear interpolation between two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n * @function\n */\nexport var lerp = vec4.lerp;\n\n/**\n * Calculates the length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport var length = vec4.length;\n\n/**\n * Alias for {@link quat.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Calculates the squared length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\nexport var squaredLength = vec4.squaredLength;\n\n/**\n * Alias for {@link quat.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\nexport var normalize = vec4.normalize;\n\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat} a The first quaternion.\n * @param {ReadonlyQuat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport var exactEquals = vec4.exactEquals;\n\n/**\n * Returns whether or not the quaternions point approximately to the same direction.\n *\n * Both quaternions are assumed to be unit length.\n *\n * @param {ReadonlyQuat} a The first unit quaternion.\n * @param {ReadonlyQuat} b The second unit quaternion.\n * @returns {Boolean} True if the quaternions are equal, false otherwise.\n */\nexport function equals(a, b) {\n  return Math.abs(vec4.dot(a, b)) >= 1 - glMatrix.EPSILON;\n}\n\n/**\n * Sets a quaternion to represent the shortest rotation from one\n * vector to another.\n *\n * Both vectors are assumed to be unit length.\n *\n * @param {quat} out the receiving quaternion.\n * @param {ReadonlyVec3} a the initial vector\n * @param {ReadonlyVec3} b the destination vector\n * @returns {quat} out\n */\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n\n/**\n * Performs a spherical linear interpolation with two control points\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {ReadonlyQuat} c the third operand\n * @param {ReadonlyQuat} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n\n/**\n * Sets the specified quaternion with values corresponding to the given\n * axes. Each axis is a vec3 and is expected to be unit length and\n * perpendicular to all other specified axes.\n *\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\n * @returns {quat} out\n */\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as quat from \"./quat.js\";\nimport * as mat4 from \"./mat4.js\";\n\n/**\n * Dual Quaternion<br>\n * Format: [real, dual]<br>\n * Quaternion format: XYZW<br>\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\n * @module quat2\n */\n\n/**\n * Creates a new identity dual quat\n *\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\n */\nexport function create() {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n  dq[3] = 1;\n  return dq;\n}\n\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat2} a dual quaternion to clone\n * @returns {quat2} new dual quaternion\n * @function\n */\nexport function clone(a) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n\n/**\n * Creates a new dual quat initialized with the given values\n *\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component\n * @param {Number} y2 Y component\n * @param {Number} z2 Z component\n * @param {Number} w2 W component\n * @returns {quat2} new dual quaternion\n * @function\n */\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n\n/**\n * Creates a new dual quat from the given values (quat and translation)\n *\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component (translation)\n * @param {Number} y2 Y component (translation)\n * @param {Number} z2 Z component (translation)\n * @returns {quat2} new dual quaternion\n * @function\n */\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n    ay = y2 * 0.5,\n    az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n\n/**\n * Creates a dual quat from a quaternion and a translation\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyQuat} q a normalized quaternion\n * @param {ReadonlyVec3} t translation vector\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\nexport function fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n    ay = t[1] * 0.5,\n    az = t[2] * 0.5,\n    bx = q[0],\n    by = q[1],\n    bz = q[2],\n    bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n\n/**\n * Creates a dual quat from a translation\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyVec3} t translation vector\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\nexport function fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n\n/**\n * Creates a dual quat from a quaternion\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyQuat} q the quaternion\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\nexport function fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n\n/**\n * Creates a new dual quat from a matrix (4x4)\n *\n * @param {quat2} out the dual quaternion\n * @param {ReadonlyMat4} a the matrix\n * @returns {quat2} dual quat receiving operation result\n * @function\n */\nexport function fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = quat.create();\n  mat4.getRotation(outer, a);\n  var t = new glMatrix.ARRAY_TYPE(3);\n  mat4.getTranslation(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n\n/**\n * Copy the values from one dual quat to another\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the source dual quaternion\n * @returns {quat2} out\n * @function\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n\n/**\n * Set a dual quat to the identity dual quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @returns {quat2} out\n */\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n\n/**\n * Set the components of a dual quat to the given values\n *\n * @param {quat2} out the receiving quaternion\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component\n * @param {Number} y2 Y component\n * @param {Number} z2 Z component\n * @param {Number} w2 W component\n * @returns {quat2} out\n * @function\n */\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n\n/**\n * Gets the real part of a dual quat\n * @param  {quat} out real part\n * @param  {ReadonlyQuat2} a Dual Quaternion\n * @return {quat} real part\n */\nexport var getReal = quat.copy;\n\n/**\n * Gets the dual part of a dual quat\n * @param  {quat} out dual part\n * @param  {ReadonlyQuat2} a Dual Quaternion\n * @return {quat} dual part\n */\nexport function getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n\n/**\n * Set the real component of a dual quat to the given quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat} q a quaternion representing the real part\n * @returns {quat2} out\n * @function\n */\nexport var setReal = quat.copy;\n\n/**\n * Set the dual component of a dual quat to the given quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat} q a quaternion representing the dual part\n * @returns {quat2} out\n * @function\n */\nexport function setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n\n/**\n * Gets the translation of a normalized dual quat\n * @param  {vec3} out translation\n * @param  {ReadonlyQuat2} a Dual Quaternion to be decomposed\n * @return {vec3} translation\n */\nexport function getTranslation(out, a) {\n  var ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n\n/**\n * Translates a dual quat by the given vector\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {quat2} out\n */\nexport function translate(out, a, v) {\n  var ax1 = a[0],\n    ay1 = a[1],\n    az1 = a[2],\n    aw1 = a[3],\n    bx1 = v[0] * 0.5,\n    by1 = v[1] * 0.5,\n    bz1 = v[2] * 0.5,\n    ax2 = a[4],\n    ay2 = a[5],\n    az2 = a[6],\n    aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n\n/**\n * Rotates a dual quat around the X axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\nexport function rotateX(out, a, rad) {\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateX(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat around the Y axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\nexport function rotateY(out, a, rad) {\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateY(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat around the Z axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\nexport function rotateZ(out, a, rad) {\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateZ(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat by a given quaternion (a * q)\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {ReadonlyQuat} q quaternion to rotate by\n * @returns {quat2} out\n */\nexport function rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3],\n    ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n\n/**\n * Rotates a dual quat by a given quaternion (q * a)\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat} q quaternion to rotate by\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @returns {quat2} out\n */\nexport function rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3],\n    bx = a[0],\n    by = a[1],\n    bz = a[2],\n    bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat around a given axis. Does the normalisation automatically\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @param {Number} rad how far the rotation should be\n * @returns {quat2} out\n */\nexport function rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < glMatrix.EPSILON) {\n    return copy(out, a);\n  }\n  var axisLength = Math.sqrt(axis[0] * axis[0] + axis[1] * axis[1] + axis[2] * axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n    ay1 = a[1],\n    az1 = a[2],\n    aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n\n/**\n * Adds two dual quat's\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {quat2} out\n * @function\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n\n/**\n * Multiplies two dual quat's\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {quat2} out\n */\nexport function multiply(out, a, b) {\n  var ax0 = a[0],\n    ay0 = a[1],\n    az0 = a[2],\n    aw0 = a[3],\n    bx1 = b[4],\n    by1 = b[5],\n    bz1 = b[6],\n    bw1 = b[7],\n    ax1 = a[4],\n    ay1 = a[5],\n    az1 = a[6],\n    aw1 = a[7],\n    bx0 = b[0],\n    by0 = b[1],\n    bz0 = b[2],\n    bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n\n/**\n * Alias for {@link quat2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Scales a dual quat by a scalar number\n *\n * @param {quat2} out the receiving dual quat\n * @param {ReadonlyQuat2} a the dual quat to scale\n * @param {Number} b amount to scale the dual quat by\n * @returns {quat2} out\n * @function\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n\n/**\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\n *\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\nexport var dot = quat.dot;\n\n/**\n * Performs a linear interpolation between two dual quats's\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\n *\n * @param {quat2} out the receiving dual quat\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat2} out\n */\nexport function lerp(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n\n/**\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a dual quat to calculate inverse of\n * @returns {quat2} out\n */\nexport function invert(out, a) {\n  var sqlen = squaredLength(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n\n/**\n * Calculates the conjugate of a dual quat\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat2} a quat to calculate conjugate of\n * @returns {quat2} out\n */\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n\n/**\n * Calculates the length of a dual quat\n *\n * @param {ReadonlyQuat2} a dual quat to calculate length of\n * @returns {Number} length of a\n * @function\n */\nexport var length = quat.length;\n\n/**\n * Alias for {@link quat2.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Calculates the squared length of a dual quat\n *\n * @param {ReadonlyQuat2} a dual quat to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\nexport var squaredLength = quat.squaredLength;\n\n/**\n * Alias for {@link quat2.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Normalize a dual quat\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a dual quaternion to normalize\n * @returns {quat2} out\n * @function\n */\nexport function normalize(out, a) {\n  var magnitude = squaredLength(a);\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n  return out;\n}\n\n/**\n * Returns a string representation of a dual quaternion\n *\n * @param {ReadonlyQuat2} a dual quaternion to represent as a string\n * @returns {String} string representation of the dual quat\n */\nexport function str(a) {\n  return \"quat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \")\";\n}\n\n/**\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat2} a the first dual quaternion.\n * @param {ReadonlyQuat2} b the second dual quaternion.\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n\n/**\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\n *\n * @param {ReadonlyQuat2} a the first dual quat.\n * @param {ReadonlyQuat2} b the second dual quat.\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}","import BMFontReader from \"./FntFontReader\";\r\nimport BitmapConfigParser from \"./BitmapConfigParser\";\r\nimport EngineHelper, { RetrieveResource } from \"../Core/EngineHelper\";\r\nimport VertexParser from \"./VertexParser\";\r\n\r\nclass ResourceResolver {\r\n  static bmFontResolver(_: EngineHelper) {\r\n    return (result: RetrieveResource) => {\r\n      result.registerFont(new BMFontReader(result.data));\r\n      return result;\r\n    };\r\n  }\r\n\r\n  static bitmapResolver(\r\n    engineHelper: EngineHelper,\r\n    bitmapWidth: number,\r\n    bitmapHeight: number,\r\n    precision: number\r\n  ) {\r\n    return (result: RetrieveResource) => {\r\n      const bitmapLoader = new BitmapConfigParser(\r\n        result.data,\r\n        bitmapWidth,\r\n        bitmapHeight,\r\n        precision\r\n      );\r\n      const textureSource = bitmapLoader.getTextureSource();\r\n      for (const key in bitmapLoader.getMap()) {\r\n        if (bitmapLoader.map.hasOwnProperty(key)) {\r\n          const uv = bitmapLoader.map[key];\r\n          engineHelper.addUVCache(textureSource, key, uv);\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n  }\r\n\r\n  static objResolverMultiple(\r\n    engineHelper: EngineHelper,\r\n    sources: { textureSource: string; name: string }[]\r\n  ) {\r\n    return (result: RetrieveResource) => {\r\n      sources.map(({ textureSource, name }) =>\r\n        engineHelper.addVertexUvCache(\r\n          textureSource,\r\n          name,\r\n          new VertexParser(result.data).vertices\r\n        )\r\n      );\r\n    };\r\n  }\r\n\r\n  static objResolver(\r\n    engineHelper: EngineHelper,\r\n    textureSource: string,\r\n    name: string\r\n  ) {\r\n    return (result: RetrieveResource) => {\r\n      engineHelper.addVertexUvCache(\r\n        textureSource,\r\n        name,\r\n        new VertexParser(result.data).vertices\r\n      );\r\n    };\r\n  }\r\n}\r\nexport default ResourceResolver;\r\n","import BaseProgram from \"../Base/BaseProgram\";\r\nimport RGBFragmentShader from \"../Shaders/RGBFragmentShader.glsl\";\r\nimport RGBVertexShader from \"../Shaders/RGBVertexShader.glsl\";\r\nimport ArrayBuffer from \"../../Buffer/ArrayBuffer\";\r\nimport ProgramReference from \"../Base/ProgramReference\";\r\n\r\nexport default class ShaderProgramColour extends BaseProgram {\r\n  static DRAW_VERTEX_SIZE = 7;\r\n  positionRef: ProgramReference;\r\n  colorRef: ProgramReference;\r\n  modelViewMatrixRef: ProgramReference;\r\n  viewMtrx: ProgramReference;\r\n  projMtrx: ProgramReference;\r\n  arrayBuffer: ArrayBuffer;\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    super(ctx);\r\n    this.arrayBuffer = new ArrayBuffer(ctx);\r\n    this.program = this.compileShaders(RGBVertexShader, RGBFragmentShader);\r\n    this.bindProgram();\r\n\r\n    this.positionRef = new ProgramReference(\r\n      \"a_position\",\r\n      ctx,\r\n      true,\r\n      this.program\r\n    );\r\n    this.colorRef = new ProgramReference(\"a_color\", ctx, true, this.program);\r\n    this.modelViewMatrixRef = new ProgramReference(\r\n      \"u_model\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.viewMtrx = new ProgramReference(\"u_view\", ctx, false, this.program);\r\n    this.projMtrx = new ProgramReference(\r\n      \"u_projection\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n  }\r\n\r\n  bindProgram() {\r\n    this._bindProgram(this.program);\r\n  }\r\n\r\n  unbindProgram() {\r\n    this._unbindProgram();\r\n  }\r\n\r\n  enableAttribPointers() {\r\n    const ctx = this.ctx;\r\n    ctx.enableVertexAttribArray(this.positionRef.ref);\r\n    ctx.enableVertexAttribArray(this.colorRef.ref);\r\n  }\r\n\r\n  bindAttributePointers() {\r\n    this.enableAttribPointers();\r\n    const ctx = this.ctx;\r\n    ctx.vertexAttribPointer(\r\n      this.positionRef.ref,\r\n      2,\r\n      ctx.FLOAT,\r\n      false,\r\n      4 * 7,\r\n      0\r\n    );\r\n    ctx.vertexAttribPointer(\r\n      this.colorRef.ref,\r\n      4,\r\n      ctx.FLOAT,\r\n      false,\r\n      4 * 7,\r\n      3 * 4\r\n    );\r\n  }\r\n\r\n  unbindAttributePointers() {\r\n    const ctx = this.ctx;\r\n    ctx.disableVertexAttribArray(this.positionRef.ref);\r\n    ctx.disableVertexAttribArray(this.colorRef.ref);\r\n  }\r\n\r\n  glSetProjectMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.projMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetModelViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.modelViewMatrixRef.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.viewMtrx.ref, false, matrixArray);\r\n  }\r\n}\r\n","import { ShaderType } from \"../../Data/RenderOption\";\r\nimport ShaderProgramColour from \"../ShaderProgram/ShaderColourProgram\";\r\nimport { ShaderEntity } from \"../../EngineEntity/ShaderEntity\";\r\nimport { mat4 } from \"gl-matrix\";\r\nimport { BaseCamera } from \"../../Camera\";\r\n\r\nclass EntityColourProgram {\r\n  program: ShaderProgramColour;\r\n  ctx: WebGLRenderingContext;\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n    this.program = new ShaderProgramColour(ctx);\r\n  }\r\n\r\n  delete() {\r\n    this.program.arrayBuffer.delete();\r\n    this.program.delete();\r\n  }\r\n\r\n  updateBuffer(entity: ShaderEntity, buffer: number[]) {\r\n    const opt = entity.getOpt();\r\n    if (ShaderType.COLOUR !== opt.shaderType) {\r\n      console.error(\r\n        \"Updating buffer for registered Colour Entity but with different shader type as RenderOptions\",\r\n        opt\r\n      );\r\n      return;\r\n    }\r\n\r\n    const buffReg =\r\n      this.program.arrayBuffer.bufferReg[entity.rendererBufferId!];\r\n    if (!buffer || buffer.length !== buffReg.verticesSize) {\r\n      console.error(\r\n        \"New Buffer data does not match initial buffer data!\",\r\n        entity,\r\n        buffer,\r\n        buffReg.verticesSize\r\n      );\r\n    }\r\n\r\n    this.program.arrayBuffer.bufferSub(\r\n      buffReg.offset,\r\n      buffer,\r\n      ShaderProgramColour.DRAW_VERTEX_SIZE\r\n    );\r\n  }\r\n\r\n  bindBuffer() {\r\n    this.program.arrayBuffer.bufferBind();\r\n  }\r\n\r\n  render(entities: [ShaderEntity, Float32List][], camera: BaseCamera) {\r\n    this.program.arrayBuffer.bind();\r\n    this.program.bindAttributePointers();\r\n    this.program.bindProgram();\r\n    this.program.glSetViewMatrix(camera.viewMatrix as Float32List);\r\n    if (this.ctx.isEnabled(this.ctx.CULL_FACE)) {\r\n      this.ctx.disable(this.ctx.CULL_FACE);\r\n    }\r\n    if (this.ctx.isEnabled(this.ctx.DEPTH_TEST)) {\r\n      this.ctx.disable(this.ctx.DEPTH_TEST);\r\n    }\r\n\r\n    for (let index = 0; index < entities.length; index++) {\r\n      const data = entities[index];\r\n      const entity = data[0];\r\n      const model = data[1];\r\n      if (!entity.rendererBufferId) {\r\n        throw new Error(\"Unregistered entity buffer\" + entity);\r\n      }\r\n      const buffReg =\r\n        this.program.arrayBuffer.bufferReg[entity.rendererBufferId];\r\n      this.program.glSetModelViewMatrix(model);\r\n      this.ctx.drawArrays(\r\n        this.ctx.TRIANGLE_STRIP,\r\n        buffReg.offset,\r\n        buffReg.size\r\n      );\r\n    }\r\n\r\n    this.program.arrayBuffer.unbind();\r\n    this.program.unbindAttributePointers();\r\n    this.program.unbindProgram();\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity, objBuffer: number[]) {\r\n    const size = objBuffer.length / ShaderProgramColour.DRAW_VERTEX_SIZE;\r\n    this.program.arrayBuffer.bufferReg[this.program.arrayBuffer.bufferRegId] = {\r\n      offset: this.program.arrayBuffer.length(),\r\n      size: size,\r\n      verticesSize: objBuffer.length,\r\n    };\r\n    this.program.arrayBuffer.push(objBuffer, size);\r\n    object.rendererBufferId = this.program.arrayBuffer.bufferRegId;\r\n    this.program.arrayBuffer.bufferRegId++;\r\n  }\r\n\r\n  updatePerspective(projectionMatrix: mat4) {\r\n    this.program.bindProgram();\r\n    this.program.glSetProjectMatrix(projectionMatrix as Float32List);\r\n  }\r\n}\r\n\r\nexport default EntityColourProgram;\r\n","import SpriteModel from \"./SpriteModel\";\r\nimport Moveable from \"./Moveable\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\n\r\nexport class SpriteMoveableModel extends SpriteModel {}\r\n\r\nclass SpriteMoveable extends Moveable {\r\n  spriteModel: SpriteModel;\r\n  constructor(rect: Rect2d, spriteModel: SpriteMoveableModel) {\r\n    super();\r\n    this.spriteModel = spriteModel;\r\n    this.spriteModel.setRect(rect);\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    this.spriteModel.render(engineHelper);\r\n  }\r\n  update(engineHelper: EngineHelper) {\r\n    this.spriteModel.update(engineHelper);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.entities.push(this.spriteModel);\r\n    super.init(engineHelper);\r\n    this.setRect(this.spriteModel.getRect());\r\n    this.updatePhysicsPosition();\r\n  }\r\n}\r\n\r\nexport default SpriteMoveable;\r\n","export class ShaderType {\r\n  static THREE_DIMENSION = 2;\r\n  static TWO_DIMENSION = 1;\r\n  static COLOUR = 3;\r\n}\r\n\r\nexport class RenderType {\r\n  static PLAIN = 4;\r\n  static TRIANGLE = 5;\r\n  static RECTANGLE = 6;\r\n}\r\n\r\nexport default class RenderOption {\r\n  shaderType: ShaderType;\r\n  renderType: RenderType;\r\n}\r\n","export default class ProgramReference {\r\n  ref: any | number | WebGLUniformLocation;\r\n\r\n  constructor(\r\n    key: string,\r\n    ctx: WebGLRenderingContext,\r\n    isAttribute: boolean,\r\n    program: WebGLProgram\r\n  ) {\r\n    if (isAttribute) {\r\n      this.ref = ctx.getAttribLocation(program, key);\r\n      if (this.ref === -1) {\r\n        throw new Error(\"Unable to find attribute shader key = \" + key);\r\n      }\r\n    } else {\r\n      this.ref = ctx.getUniformLocation(program, key);\r\n      if (this.ref === null) {\r\n        throw new Error(\"Unable to find uniform shader key = \" + key);\r\n      }\r\n    }\r\n  }\r\n}\r\n","class Colour {\r\n  r: number;\r\n  g: number;\r\n  b: number;\r\n  a: number;\r\n  constructor(r: number, g: number, b: number, a: number) {\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n    this.a = a;\r\n  }\r\n}\r\n\r\nexport default Colour;\r\n","export default \"\\r\\nprecision mediump float;\\r\\nprecision mediump int;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\nvarying vec4 v_shadow_pos;\\r\\n\\r\\nuniform sampler2D texture;\\r\\nuniform sampler2D shadowMap;\\r\\nuniform float numLights;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nfloat decodeFloat(vec4 color) {\\r\\n  const vec4 bitShift = vec4(\\r\\n    1.0 / (256.0 * 256.0 * 256.0),\\r\\n    1.0 / (256.0 * 256.0),\\r\\n    1.0 / 256.0,\\r\\n    1\\r\\n  );\\r\\n  return dot(color, bitShift);\\r\\n}\\r\\n\\r\\nfloat random(vec3 seed, int i) {\\r\\n  vec4 seed4 = vec4(seed, i);\\r\\n  float dot_product = dot(seed4, vec4(12.9898, 78.233, 45.164, 94.673));\\r\\n  return fract(sin(dot_product) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec2 poisson(int index) {\\r\\n  if (index == 0)\\r\\n    return vec2(-0.94201624, -0.39906216);\\r\\n  if (index == 1)\\r\\n    return vec2(0.94558609, -0.76890725);\\r\\n  if (index == 2)\\r\\n    return vec2(-0.094184101, -0.92938870);\\r\\n  if (index == 3)\\r\\n    return vec2(0.34495938, 0.29387760);\\r\\n  if (index == 4)\\r\\n    return vec2(-0.91588581, 0.45771432);\\r\\n  if (index == 5)\\r\\n    return vec2(-0.81544232, -0.87912464);\\r\\n  if (index == 6)\\r\\n    return vec2(-0.38277543, 0.27676845);\\r\\n  if (index == 7)\\r\\n    return vec2(0.97484398, 0.75648379);\\r\\n  if (index == 8)\\r\\n    return vec2(0.44323325, -0.97511554);\\r\\n  if (index == 9)\\r\\n    return vec2(0.53742981, -0.47373420);\\r\\n  if (index == 10)\\r\\n    return vec2(-0.26496911, -0.41893023);\\r\\n  if (index == 11)\\r\\n    return vec2(0.79197514, 0.19090188);\\r\\n  if (index == 12)\\r\\n    return vec2(-0.24188840, 0.99706507);\\r\\n  if (index == 13)\\r\\n    return vec2(-0.81409955, 0.91437590);\\r\\n  if (index == 14)\\r\\n    return vec2(0.19984126, 0.78641367);\\r\\n  if (index == 15)\\r\\n    return vec2(0.14383161, -0.14100790);\\r\\n  return vec2(0, 0);\\r\\n}\\r\\n\\r\\nfloat unpackRGBAToDepth(const vec4 v) {\\r\\n  const float UnpackDownscale = 255. / 256.;\\r\\n  const vec3 PackFactors = vec3(256. * 256. * 256., 256. * 256., 256.);\\r\\n  const vec4 UnpackFactors = UnpackDownscale / vec4(PackFactors, 1.);\\r\\n  return dot(v, UnpackFactors);\\r\\n}\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n    gl_FragColor = surfaceColor;\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n  vec3 diffuse = v_diffuseCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n  vec3 ambient = light1.ambientCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n  vec3 n = normalize(v_normal);\\r\\n  vec3 l = normalize(v_light1_pos);\\r\\n  float cosTheta = clamp(dot(n, l), 0.0, 1.0);\\r\\n\\r\\n  const float texelSize = 1.0 / 1024.0;\\r\\n\\r\\n  float amountInLight = 0.0;\\r\\n\\r\\n  vec3 fragmentDepth = v_shadow_pos.xyz / v_shadow_pos.w;\\r\\n  const float shadowAcneRemover = 0.001;\\r\\n  fragmentDepth.z -= shadowAcneRemover;\\r\\n\\r\\n  float soften = 0.0;\\r\\n  for (int x = -1; x <= 1; x++) {\\r\\n    for (int y = -1; y <= 1; y++) {\\r\\n      float texelDepth = unpackRGBAToDepth(texture2D(shadowMap, fragmentDepth.xy + vec2(x, y) * texelSize));\\r\\n      soften += 1.0;\\r\\n      if (fragmentDepth.z < texelDepth) {\\r\\n        amountInLight += 1.0;\\r\\n      }\\r\\n    }\\r\\n  }\\r\\n\\r\\n  amountInLight /= soften;\\r\\n\\r\\n  vec3 linearColor = ambient + amountInLight * v_attenuation * diffuse * cosTheta;\\r\\n  vec3 gamma = vec3(1.0 / 2.2);\\r\\n  gl_FragColor = vec4(pow(linearColor, gamma), surfaceColor.a);\\r\\n}\\r\\n\";","import RenderOption, { ShaderType, RenderType } from \"./Data/RenderOption\";\r\nimport Entity3DProgram from \"./WebGL/EntityProgram/Entity3DProgram\";\r\nimport EntityColourProgram from \"./WebGL/EntityProgram/EntityColorProgram\";\r\nimport WebGLContext from \"./WebGL/Base/WebGLContext\";\r\nimport Texture from \"./Buffer/Texture\";\r\nimport NotificationQueue, {\r\n  Notification,\r\n  NotificationPayload,\r\n} from \"./Common/NotificationQueue\";\r\nimport WorldDelegate from \"./WorldDelegate\";\r\nimport Camera from \"./Camera\";\r\nimport { ShaderEntity } from \"./EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"./EngineHelper\";\r\nimport Light from \"./Data/Light\";\r\nimport { WebGLContainer } from \"./App\";\r\nimport SubscriberPool, { Subscription } from \"./Common/SubscriberPool\";\r\nimport ModelData from \"./Data/ModelData\";\r\n\r\nexport class RendererSubscription {\r\n  static CREATE_TEXTURE: Subscription = new Subscription(\r\n    \"Renderer#CreateTexture\"\r\n  );\r\n  static REGISTER_ENTITY: Subscription = new Subscription(\r\n    \"Renderer#RegisterEntity\"\r\n  );\r\n  static createTexturePayload = (\r\n    object: ShaderEntity,\r\n    resourcesLoading: Promise<any>[]\r\n  ) => [object, resourcesLoading];\r\n  static registerEntityPayload = (entity: ShaderEntity, buffer: ModelData) => [\r\n    entity,\r\n    buffer,\r\n  ];\r\n}\r\n\r\nexport class RendererNotification {\r\n  static NOTIFICATION_PRE_RENDER_KEY = \"Renderer#Prerender\";\r\n  static NOTIFICATION_RENDER_KEY = \"Renderer#Render\";\r\n  static NOTIFICATION_INIT_KEY = \"Renderer#Init\";\r\n  static UPDATE_PROJECTION_MATRIX: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"UPDATE_PROJECTION_MATRIX\"\r\n  );\r\n  static RESIZE_SCREEN: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"RESIZE_SCREEN\"\r\n  );\r\n  static CREATE_TEXTURE: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_INIT_KEY,\r\n    \"CREATE_TEXTURE\"\r\n  );\r\n  static REGISTER_ENTITY: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_INIT_KEY,\r\n    \"REGISTER_ENTITY\"\r\n  );\r\n  static registerEntity = (entity: ShaderEntity, modelData: ModelData) =>\r\n    NotificationPayload.from(RendererNotification.REGISTER_ENTITY, [\r\n      entity,\r\n      modelData,\r\n    ]);\r\n  static UPDATE_BUFFER: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"UPDATE_BUFFER\"\r\n  );\r\n  static updateBuffer = (entity: ShaderEntity, buffer: number[]) =>\r\n    NotificationPayload.from(RendererNotification.UPDATE_BUFFER, [\r\n      entity,\r\n      buffer,\r\n    ]);\r\n  static createTexture = (\r\n    object: ShaderEntity,\r\n    resourcesLoading: Promise<any>[]\r\n  ) =>\r\n    NotificationPayload.from(RendererNotification.CREATE_TEXTURE, [\r\n      object,\r\n      resourcesLoading,\r\n    ]);\r\n\r\n  static SET_LIGHTING: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"SET_LIGHTING\"\r\n  );\r\n  static setLighting = (light: Light) =>\r\n    NotificationPayload.from(RendererNotification.SET_LIGHTING, [light]);\r\n\r\n  static RENDER_ENTITY: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_RENDER_KEY,\r\n    \"RENDER_ENTITY\"\r\n  );\r\n  static renderEntity = (entity: ShaderEntity, model: Float32List) =>\r\n    NotificationPayload.from(RendererNotification.RENDER_ENTITY, [\r\n      entity,\r\n      model,\r\n    ]);\r\n}\r\n\r\nclass Renderer {\r\n  webGLContainer: WebGLContainer;\r\n  ctx: WebGLRenderingContext;\r\n  shader3DProgram: Entity3DProgram;\r\n  shaderColourProgram: EntityColourProgram;\r\n  textureReg: { [key: string]: any } = {};\r\n  world: WorldDelegate;\r\n  camera: Camera;\r\n  _renderEntities: { [key: number]: [ShaderEntity, Float32List][] } = {};\r\n  notificationQueue: NotificationQueue;\r\n  subscriberPool: SubscriberPool;\r\n  glContext: WebGLContext;\r\n  cachedModelData: { [key: number]: number } = {};\r\n  private enableLighting: boolean;\r\n\r\n  constructor(\r\n    args: { [key: string]: any },\r\n    webGLContainer: WebGLContainer,\r\n    camera: Camera,\r\n    notificationQueue: NotificationQueue,\r\n    subscriberPool: SubscriberPool\r\n  ) {\r\n    if (!args.world) {\r\n      throw new Error(\"world not defined\");\r\n    }\r\n    this.notificationQueue = notificationQueue;\r\n    this.subscriberPool = subscriberPool;\r\n    this.camera = camera;\r\n    this.world = args.world;\r\n    this.webGLContainer = webGLContainer;\r\n    this.ctx = this.webGLContainer.getCtx();\r\n    this.glContext = new WebGLContext(this.ctx);\r\n    this.glContext.setupDefault();\r\n    this.enableLighting = args.enableLighting !== undefined ? args.enableLighting : true;\r\n\r\n    this.subscriberPool.listen(RendererSubscription.CREATE_TEXTURE, (data) => {\r\n      const [object, resourcesLoading] = data;\r\n      this.createTexture(object, resourcesLoading);\r\n    });\r\n    this.subscriberPool.listen(RendererSubscription.REGISTER_ENTITY, (data) => {\r\n      const [entity, buffer] = data;\r\n      this.registerEntity(entity, buffer);\r\n    });\r\n  }\r\n\r\n  resizeViewPort = () => {\r\n    this.glContext.resizeViewPort(this.webGLContainer.canvas);\r\n  };\r\n\r\n  updatePerspective = () => {\r\n    if (this.camera.renderMode === '3d') {\r\n      if (this.shader3DProgram) {\r\n        this.shader3DProgram.updatePerspective(this.camera.camera3d.frustum);\r\n      }\r\n      if (this.shaderColourProgram) {\r\n        this.shaderColourProgram.updatePerspective(this.camera.camera3d.frustum);\r\n      }\r\n    } else {\r\n      if (this.shader3DProgram) {\r\n        this.shader3DProgram.updatePerspective(this.camera.camera2d.frustum);\r\n      }\r\n      if (this.shaderColourProgram) {\r\n        this.shaderColourProgram.updatePerspective(this.camera.camera2d.frustum);\r\n      }\r\n    }\r\n  };\r\n\r\n  delete = () => {\r\n    Object.values(this.textureReg).forEach((texReg: any) => {\r\n      const texture = texReg.texture;\r\n      if (texture.texture) {\r\n        this.glContext.deleteTexture(texture.texture);\r\n      }\r\n      texture.texture = undefined;\r\n      texture.texUnit = undefined;\r\n    });\r\n    Texture.textureCount = 0;\r\n\r\n    if (this.shader3DProgram) {\r\n      this.shader3DProgram.delete();\r\n    }\r\n    if (this.shaderColourProgram) {\r\n      this.shaderColourProgram.delete();\r\n    }\r\n    this.glContext.destroyWebGL();\r\n  };\r\n\r\n  setLighting = (light: Light) => {\r\n    if (this.shader3DProgram) {\r\n      const activeCamera = this.camera.renderMode === '3d' ? this.camera.camera3d : this.camera.camera2d;\r\n      this.shader3DProgram.setLight(light, activeCamera);\r\n    } else {\r\n      throw new Error(\"Lighting is set without any 3D entities\");\r\n    }\r\n  };\r\n\r\n  updateBuffer = (entity: ShaderEntity, buffer: number[]) => {\r\n    const opt = entity.getOpt();\r\n    const program = this._getProgramOpt(opt);\r\n    program.updateBuffer(entity, buffer);\r\n  };\r\n\r\n  _isPlain(opt: RenderOption) {\r\n    return opt.renderType === RenderType.PLAIN;\r\n  }\r\n\r\n  _getProgram3D = (opt: RenderOption) => {\r\n    let program;\r\n    if (this._isPlain(opt)) {\r\n      throw new Error(\"Plain no longer supported\");\r\n    } else {\r\n      program = this.shader3DProgram;\r\n    }\r\n    return program;\r\n  };\r\n\r\n  _getProgramOpt = (opt: RenderOption) => {\r\n    let program;\r\n    if (ShaderType.COLOUR === opt.shaderType) {\r\n      program = this.shaderColourProgram;\r\n    } else if (\r\n      ShaderType.THREE_DIMENSION === opt.shaderType ||\r\n      ShaderType.TWO_DIMENSION === opt.shaderType\r\n    ) {\r\n      program = this._getProgram3D(opt);\r\n    } else {\r\n      throw new Error(\"unsupported opt shader type\");\r\n    }\r\n    return program;\r\n  };\r\n\r\n  _defRenderTop(isTop: boolean) {\r\n    // render colour\r\n    const colourModel = this._renderEntities[ShaderType.COLOUR].filter(\r\n      (e) => !!e[0].isTop === isTop\r\n    );\r\n    if (colourModel.length > 0) {\r\n      this.shaderColourProgram.render(colourModel, this.camera.camera2d);\r\n    }\r\n\r\n    const model3d = this._renderEntities[ShaderType.THREE_DIMENSION].filter(\r\n      (e) => !!e[0].isTop === isTop\r\n    );\r\n    if (model3d.length > 0) {\r\n      this.shader3DProgram.render3DShadowMap(model3d, this.resizeViewPort);\r\n      this.shader3DProgram.render(\r\n        model3d,\r\n        this.camera.camera3d,\r\n        this.textureReg,\r\n        false\r\n      );\r\n    }\r\n\r\n    const model2d = this._renderEntities[ShaderType.TWO_DIMENSION].filter(\r\n      (e) => !!e[0].isTop === isTop\r\n    );\r\n    if (model2d.length > 0) {\r\n      this.shader3DProgram.render(\r\n        model2d,\r\n        this.camera.camera2d,\r\n        this.textureReg,\r\n        true\r\n      );\r\n    }\r\n  }\r\n\r\n  _defRender = () => {\r\n    this._defRenderTop(false);\r\n    this._defRenderTop(true);\r\n  };\r\n\r\n  init() {\r\n    this.readMessages(RendererNotification.NOTIFICATION_INIT_KEY);\r\n    this.shader3DProgram?.toggleLighting(this.enableLighting);\r\n  }\r\n\r\n  readMessages(key: string, isUniqueAction = false) {\r\n    let message: NotificationPayload | undefined;\r\n    const unique: { [key: string]: boolean | undefined } = {};\r\n    while ((message = this.notificationQueue.take(key))) {\r\n      if (!isUniqueAction || unique[message.action] === undefined) {\r\n        this.handleNotification(message);\r\n        if (isUniqueAction) {\r\n          unique[message.action] = true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _render = (entity: ShaderEntity, model: Float32List) => {\r\n    if (entity.hidden) {\r\n      return;\r\n    }\r\n\r\n    const opt = entity.getOpt();\r\n    const payload: [ShaderEntity, Float32List] = [entity, model];\r\n    if (ShaderType.COLOUR === opt.shaderType) {\r\n      this._renderEntities[ShaderType.COLOUR].push(payload);\r\n    } else if (ShaderType.THREE_DIMENSION === opt.shaderType) {\r\n      this._renderEntities[ShaderType.THREE_DIMENSION].push(payload);\r\n    } else if (ShaderType.TWO_DIMENSION === opt.shaderType) {\r\n      this._renderEntities[ShaderType.TWO_DIMENSION].push(payload);\r\n    }\r\n  };\r\n\r\n  bindBuffer = () => {\r\n    if (this.shader3DProgram) {\r\n      this.shader3DProgram.bindBuffer();\r\n    }\r\n    if (this.shaderColourProgram) {\r\n      this.shaderColourProgram.bindBuffer();\r\n    }\r\n  };\r\n\r\n  _lazyLoadProgram(opt: RenderOption) {\r\n    if (ShaderType.COLOUR === opt.shaderType) {\r\n      if (!this.shaderColourProgram) {\r\n        this.shaderColourProgram = new EntityColourProgram(this.ctx);\r\n      }\r\n    } else if (\r\n      ShaderType.THREE_DIMENSION === opt.shaderType ||\r\n      ShaderType.TWO_DIMENSION === opt.shaderType\r\n    ) {\r\n      if (!this.shader3DProgram) {\r\n        this.shader3DProgram = new Entity3DProgram(this.ctx);\r\n      }\r\n    } else {\r\n      console.error(this, opt);\r\n      throw new Error(\"unsupported opt shader type\");\r\n    }\r\n\r\n    this.updatePerspective();\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity, modelData: ModelData) {\r\n    const opt = object.getOpt();\r\n    this._lazyLoadProgram(opt);\r\n    const program = this._getProgramOpt(opt);\r\n    if (!this.cachedModelData[modelData.$id]) {\r\n      program.registerEntity(object, modelData.vertices);\r\n      this.cachedModelData[modelData.$id] = object.rendererBufferId!;\r\n    } else {\r\n      object.rendererBufferId = this.cachedModelData[modelData.$id];\r\n    }\r\n  }\r\n\r\n  _resetDefferred = () => {\r\n    this._renderEntities = {\r\n      [ShaderType.COLOUR]: [],\r\n      [ShaderType.THREE_DIMENSION]: [],\r\n      [ShaderType.TWO_DIMENSION]: [],\r\n    };\r\n  };\r\n\r\n  handleNotification = (notification: NotificationPayload) => {\r\n    let updatePerspective = false;\r\n    switch (notification.action) {\r\n      case RendererNotification.RENDER_ENTITY.action:\r\n        this._render(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.UPDATE_PROJECTION_MATRIX.action:\r\n        updatePerspective = true;\r\n        break;\r\n      case RendererNotification.RESIZE_SCREEN.action:\r\n        this.resizeViewPort();\r\n        updatePerspective = true;\r\n        break;\r\n      case RendererNotification.CREATE_TEXTURE.action:\r\n        this.createTexture(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.UPDATE_BUFFER.action:\r\n        this.updateBuffer(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.REGISTER_ENTITY.action:\r\n        this.registerEntity(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.SET_LIGHTING.action:\r\n        this.setLighting(notification.data[0]);\r\n        break;\r\n      default:\r\n        console.error(\"unhandled notification: \", notification);\r\n        break;\r\n    }\r\n    if (updatePerspective) {\r\n      this.updatePerspective();\r\n    }\r\n  };\r\n\r\n  render(time: number, engineHelper: EngineHelper) {\r\n    this.glContext.clear();\r\n\r\n    this.readMessages(RendererNotification.NOTIFICATION_PRE_RENDER_KEY, true);\r\n\r\n    this.camera.commitProjectionView();\r\n\r\n    engineHelper.setTime(time);\r\n\r\n    // reinitialse next cycle\r\n    this._resetDefferred();\r\n\r\n    this.world.render();\r\n    engineHelper.renderFont();\r\n\r\n    this.readMessages(RendererNotification.NOTIFICATION_RENDER_KEY);\r\n\r\n    this._defRender();\r\n  }\r\n\r\n  createTexture(object: ShaderEntity, resourcesLoading: Promise<any>[]) {\r\n    const src = object.getTextureSource();\r\n    if (src === undefined) {\r\n      console.error(\"src is undefined when trying to create texture\", object);\r\n      throw new Error(\"src is undefined when trying to create texture\");\r\n    }\r\n    object.rendererTextureRef = src;\r\n    const textureReg = this.textureReg[src];\r\n    if (!textureReg) {\r\n      const texture = new Texture(src, this.ctx);\r\n      this.textureReg[src] = {\r\n        texture: texture,\r\n      };\r\n      resourcesLoading.push(texture.load);\r\n    } else if (textureReg.texture && textureReg.texture.error) {\r\n      console.error(\r\n        \"there was an error while trying to load texture\",\r\n        textureReg\r\n      );\r\n      throw new Error(\"there was an error while trying to load texture\");\r\n    }\r\n  }\r\n}\r\nexport default Renderer;\r\n","import EngineHelper from \"../EngineHelper\";\r\nimport Camera from \"../Camera\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport Feature from \"./Feature\";\r\nimport EngineObject from \"./EngineObject\";\r\n\r\nexport default class CameraFollower implements Feature {\r\n  private camera: Camera;\r\n  private offset: Coordinate;\r\n\r\n  constructor(camera: Camera, offset?: Coordinate) {\r\n    this.camera = camera;\r\n    this.offset = new Coordinate(\r\n      offset?.x ?? 0,\r\n      offset?.y ?? 0,\r\n      offset?.z ?? 0\r\n    );\r\n  }\r\n\r\n  init(entity: EngineObject): void {\r\n    entity.isLowPriority = true;\r\n  }\r\n\r\n  update(entity: EngineObject, engineHelper: EngineHelper): void {\r\n    const cam = this.camera.camera3d || this.camera;\r\n    const { x, y, z } = cam.position;\r\n    \r\n    entity.center(\r\n      x + this.offset.x,\r\n      y + this.offset.y,\r\n      z + this.offset.z\r\n    );\r\n  }\r\n}\r\n","import {\r\n  App,\r\n  EngineEvent,\r\n  EngineObject,\r\n  Events,\r\n  Object3d,\r\n  ObjectManager,\r\n  Plane3d,\r\n  PlaneType,\r\n  Rect3d,\r\n  ResourceResolver,\r\n  FontReference,\r\n  Coordinate,\r\n  Light,\r\n  Moveable\r\n} from \"synaren-engine\";\r\nimport CameraFollower from \"../src/Core/EngineEntity/CameraFollower\";\r\nimport Cube from \"./Cube\";\r\nimport Sphere from \"./Sphere\";\r\n\r\ninterface RacingBot {\r\n  car: Moveable;  // Use Moveable for physics-based movement\r\n  position: { x: number, y: number, z: number };\r\n  speed: number;\r\n  currentWaypoint: number;\r\n  name: string;\r\n  rotation: number;\r\n  nameText: FontReference | any; // Allow any type for font fallback\r\n}\r\n\r\ninterface Waypoint {\r\n  x: number;\r\n  z: number;\r\n}\r\n\r\nexport default class RacingGame extends ObjectManager {\r\n  // Game state\r\n  gameStarted: boolean = false;\r\n  gameEnded: boolean = false;\r\n  raceTime: number = 0;\r\n  currentLap: number = 1;\r\n  totalLaps: number = 3;\r\n  raceFinished: boolean = false;\r\n\r\n  // Racing objects\r\n  playerCar: Object3d;\r\n  bots: RacingBot[] = [];\r\n  ground: Plane3d;\r\n  sky: Sphere;\r\n  trackBarriers: Cube[] = [];\r\n  waypointTiles: Cube[] = [];\r\n\r\n  // Movement speeds\r\n  crowd: Object3d[] = []; // Low poly girls as crowd\r\n  trees: Object3d[] = []; // Low poly trees for nature scenery\r\n\r\n  // Race track waypoints (defines the racing line) - Simplified track within 1000x1000 ground\r\n  waypoints: Waypoint[] = [\r\n    // Start/Finish line\r\n    { x: 0, z: 0 },\r\n    \r\n    // First sector - right turn\r\n    { x: 150, z: 0 },\r\n    { x: 250, z: 100 },\r\n    { x: 250, z: 200 },\r\n    \r\n    // Second sector - top straight and left turn\r\n    { x: 200, z: 300 },\r\n    { x: 50, z: 350 },\r\n    { x: -100, z: 300 },\r\n    \r\n    // Third sector - left side and hairpin\r\n    { x: -200, z: 200 },\r\n    { x: -250, z: 50 },\r\n    { x: -200, z: -100 },\r\n    \r\n    // Fourth sector - bottom straight and return\r\n    { x: -50, z: -150 },\r\n    { x: 100, z: -100 },\r\n    { x: 0, z: -50 },\r\n    \r\n    // Complete the loop back to start\r\n    { x: 0, z: 0 }\r\n  ];\r\n\r\n  // Player controls - Slower for better visibility\r\n  playerSpeed: number = 0;\r\n  maxSpeed: number = 0.4;  // Reduced from 0.8 to 0.4\r\n  acceleration: number = 0.015;  // Reduced acceleration\r\n  deceleration: number = 0.02;   // Reduced deceleration\r\n  turnSpeed: number = 0.025;     // Reduced turn speed\r\n  playerRotation: number = 0;\r\n  playerPosition: Coordinate = { x: 0, y: 0, z: 0 }; // Better starting position on ground\r\n  keys: { [key: string]: boolean } = {};\r\n\r\n  // Game timer\r\n  lastWaypoint: number = 0;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  createGameObjects() {\r\n    try {\r\n      console.log('Creating game objects...');\r\n\r\n      // Create simple ground plane\r\n      this.ground = new Plane3d(\r\n        new Rect3d(0.0, 0.0, 0.0, 1000, 0, 1000),\r\n        this.engineHelper.newVertexModel(\"grass\", PlaneType.XZ)\r\n      );\r\n      this.addEntity(this.ground);\r\n\r\n      // Create sky sphere with camera follower\r\n      this.sky = new Sphere(\r\n        new Rect3d(0.0, 10.0, 0.0, 200.0, 200.0, 200.0),\r\n        \"background\"\r\n      );\r\n      this.sky.addFeature(new CameraFollower(this.engineHelper.camera));\r\n      this.addEntity(this.sky);\r\n\r\n      // Create player car\r\n      this.createPlayerCar();\r\n\r\n      // Create bot cars\r\n      this.createBotCars();\r\n\r\n      // Create fewer crowd members to reduce complexity\r\n      this.createSimpleCrowd();\r\n\r\n      // Create trees for atmosphere\r\n      this.createTrees();\r\n\r\n      console.log('Game objects created successfully!');\r\n    } catch (error) {\r\n      console.error('Error creating game objects:', error);\r\n    }\r\n  }\r\n\r\n  createSimpleCrowd() {\r\n    // Create minimal crowd dynamically based on waypoints for performance\r\n    const crowdPositions: {x: number, z: number}[] = [];\r\n    \r\n    // Calculate the center point of the track\r\n    const centerX = this.waypoints.reduce((sum, wp) => sum + wp.x, 0) / this.waypoints.length;\r\n    const centerZ = this.waypoints.reduce((sum, wp) => sum + wp.z, 0) / this.waypoints.length;\r\n    \r\n    // Place crowd members around key waypoints (every 5th waypoint to reduce crowd)\r\n    for (let i = 0; i < this.waypoints.length; i += 5) {\r\n      const waypoint = this.waypoints[i];\r\n      \r\n      // Calculate direction from waypoint to track center\r\n      const dx = centerX - waypoint.x;\r\n      const dz = centerZ - waypoint.z;\r\n      const distance = Math.sqrt(dx * dx + dz * dz);\r\n      \r\n      if (distance > 0) {\r\n        // Normalize direction\r\n        const normalizedDx = dx / distance;\r\n        const normalizedDz = dz / distance;\r\n        \r\n        // Place crowd members on the inside of the track (toward center)\r\n        const crowdDistance = 15; // Distance from waypoint toward center\r\n        const crowdX = waypoint.x + normalizedDx * crowdDistance;\r\n        const crowdZ = waypoint.z + normalizedDz * crowdDistance;\r\n        \r\n        crowdPositions.push({ x: crowdX, z: crowdZ });\r\n        \r\n        // Add only one variation around each main position (was 2)\r\n        crowdPositions.push(\r\n          { x: crowdX + (Math.random() - 0.5) * 12, z: crowdZ + (Math.random() - 0.5) * 12 }\r\n        );\r\n      }\r\n    }\r\n    \r\n    // Add minimal crowd in the calculated center area (reduced from 8 to 4)\r\n    for (let i = 0; i < 4; i++) {\r\n      crowdPositions.push({\r\n        x: centerX + (Math.random() - 0.5) * 30,\r\n        z: centerZ + (Math.random() - 0.5) * 30\r\n      });\r\n    }\r\n\r\n    crowdPositions.forEach((pos, index) => {\r\n      try {\r\n        const crowdMember = new Object3d(\r\n          new Rect3d(pos.x, 1.5, pos.z, 2, 2, 2),\r\n          \"low_poly_girl\"\r\n        );\r\n        \r\n        crowdMember.scale(1, 1, 1);\r\n        crowdMember.angleY(Math.random() * 360);\r\n        \r\n        this.crowd.push(crowdMember);\r\n        this.addEntity(crowdMember);\r\n      } catch (error) {\r\n        console.warn('Failed to create crowd member:', error);\r\n      }\r\n    });\r\n\r\n    console.log(`Created ${this.crowd.length} crowd members dynamically based on waypoints`);\r\n    console.log(`Track center calculated at: (${centerX.toFixed(1)}, ${centerZ.toFixed(1)})`);\r\n  }\r\n\r\n  createTrees() {\r\n    // Create minimal trees dynamically based on waypoints for performance\r\n    const treePositions: {x: number, z: number}[] = [];\r\n    \r\n    // Calculate track bounds from waypoints\r\n    const minX = Math.min(...this.waypoints.map(wp => wp.x));\r\n    const maxX = Math.max(...this.waypoints.map(wp => wp.x));\r\n    const minZ = Math.min(...this.waypoints.map(wp => wp.z));\r\n    const maxZ = Math.max(...this.waypoints.map(wp => wp.z));\r\n    \r\n    // Calculate track center\r\n    const centerX = (minX + maxX) / 2;\r\n    const centerZ = (minZ + maxZ) / 2;\r\n    \r\n    // Create fewer perimeter trees around the track bounds (increased spacing)\r\n    const perimeterPadding = 60;\r\n    const treeSpacing = 50; // Increased from 25 to 50 for fewer trees\r\n    \r\n    // North and South perimeter (fewer trees)\r\n    for (let x = minX - perimeterPadding; x <= maxX + perimeterPadding; x += treeSpacing) {\r\n      treePositions.push(\r\n        { x: x, z: minZ - perimeterPadding },  // North\r\n        { x: x, z: maxZ + perimeterPadding }   // South\r\n      );\r\n    }\r\n    \r\n    // East and West perimeter (fewer trees)\r\n    for (let z = minZ - perimeterPadding; z <= maxZ + perimeterPadding; z += treeSpacing) {\r\n      treePositions.push(\r\n        { x: minX - perimeterPadding, z: z },  // West\r\n        { x: maxX + perimeterPadding, z: z }   // East\r\n      );\r\n    }\r\n    \r\n    // Create minimal trees around waypoints (every 4th waypoint instead of every 2nd)\r\n    for (let i = 0; i < this.waypoints.length - 1; i += 4) { // Reduced frequency\r\n      const current = this.waypoints[i];\r\n      const next = this.waypoints[i + 1];\r\n      \r\n      // Calculate perpendicular direction for placing trees beside the track\r\n      const dx = next.x - current.x;\r\n      const dz = next.z - current.z;\r\n      const length = Math.sqrt(dx * dx + dz * dz);\r\n      \r\n      if (length > 0) {\r\n        // Normalize direction vector\r\n        const normalizedDx = dx / length;\r\n        const normalizedDz = dz / length;\r\n        \r\n        // Perpendicular vectors for track sides\r\n        const perpX = -normalizedDz;\r\n        const perpZ = normalizedDx;\r\n        \r\n        const treeDistance = 25 + Math.random() * 10; // 25-35 units from track\r\n        \r\n        // Only one tree per side (not both sides)\r\n        treePositions.push({\r\n          x: current.x + perpX * treeDistance,\r\n          z: current.z + perpZ * treeDistance\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Create fewer forest clusters (reduced from 8 to 4 clusters)\r\n    const clusterCenters = [\r\n      { x: centerX + 120, z: centerZ + 120 },\r\n      { x: centerX - 120, z: centerZ + 120 },\r\n      { x: centerX + 120, z: centerZ - 120 },\r\n      { x: centerX - 120, z: centerZ - 120 }\r\n    ];\r\n    \r\n    clusterCenters.forEach(cluster => {\r\n      // Create fewer trees per cluster (3-5 instead of 8-12)\r\n      const treesPerCluster = 3 + Math.floor(Math.random() * 3);\r\n      for (let i = 0; i < treesPerCluster; i++) {\r\n        treePositions.push({\r\n          x: cluster.x + (Math.random() - 0.5) * 30,\r\n          z: cluster.z + (Math.random() - 0.5) * 30\r\n        });\r\n      }\r\n    });\r\n    \r\n    // Filter out trees that are too close to the racing line\r\n    const filteredTreePositions = treePositions.filter(treePos => {\r\n      // Check distance to all waypoints\r\n      return this.waypoints.every(waypoint => {\r\n        const distance = Math.sqrt(\r\n          Math.pow(treePos.x - waypoint.x, 2) + \r\n          Math.pow(treePos.z - waypoint.z, 2)\r\n        );\r\n        return distance > 12; // Minimum 12 units from racing line\r\n      });\r\n    });\r\n\r\n    filteredTreePositions.forEach((pos, index) => {\r\n      try {\r\n        const tree = new Object3d(\r\n          new Rect3d(pos.x, 0.5, pos.z, 6, 6, 6), // Trees at ground level\r\n          \"low_poly_tree\"\r\n        );\r\n        \r\n        // Make trees bigger and more varied\r\n        const scale = 2.5 + Math.random() * 2.0; // Scale between 2.5 and 4.5 (bigger trees)\r\n        tree.scale(scale, scale, scale);\r\n        tree.angleY(Math.random() * 360);\r\n        \r\n        this.trees.push(tree);\r\n        this.addEntity(tree);\r\n      } catch (error) {\r\n        console.warn('Failed to create tree:', error);\r\n      }\r\n    });\r\n\r\n    console.log(`Created ${this.trees.length} trees dynamically around the track`);\r\n    console.log(`Track bounds: X(${minX.toFixed(1)} to ${maxX.toFixed(1)}), Z(${minZ.toFixed(1)} to ${maxZ.toFixed(1)})`);\r\n    console.log(`Filtered ${treePositions.length - filteredTreePositions.length} trees too close to racing line`);\r\n  }\r\n\r\n \r\n  createPlayerCar() {\r\n    this.playerCar = new Object3d(\r\n      new Rect3d(this.playerPosition.x, this.playerPosition.y, this.playerPosition.z, 1.5, 1.5, 1.5),\r\n      \"racing_car\"\r\n    );\r\n    this.playerCar.scale(1.5, 1.5, 1.5); // Bigger player car - was 0.5, now 0.8\r\n    this.playerCar.angleY(90); // Start facing forward (0 degrees)\r\n    this.addEntity(this.playerCar);\r\n  }\r\n\r\n  createBotCars() {\r\n    const botNames = ['Speed Demon', 'Thunder Bolt', 'Turbo Racer', 'Lightning Fast'];\r\n\r\n    for (let i = 0; i < 4; i++) {\r\n      // Create simple bot name text (may not render if font system has issues)\r\n      let nameText: any = { center: () => {}, render: () => {} }; // Default fallback\r\n      \r\n      try {\r\n        nameText = FontReference.newFont(\r\n          new Coordinate(0.1 + (i * 0.2), 0.9, 0),\r\n          `bot-${i}-name`\r\n        );\r\n        nameText.setText(botNames[i])\r\n          .setFontSize(18)\r\n          .setTop(true);\r\n      } catch (error) {\r\n        console.warn('Font creation failed, using fallback:', error);\r\n      }\r\n\r\n      // Position bots in a line behind the start, spread out more\r\n      const startX = -12 + (i * 6); // Increased spread: was (i * 4), now (i * 6) for more separation\r\n      const startZ = -10 - (i * 2); // Stagger Z positions more: each bot further back\r\n\r\n      // Create the car as an Object3d\r\n      const carObject = new Object3d(\r\n        new Rect3d(startX, 0, startZ, 1.5, 1.5, 1.5),\r\n        \"racing_car\"\r\n      );\r\n      carObject.scale(0.6, 0.6, 0.6); // Slightly larger for visibility\r\n\r\n      // Create a Moveable wrapper for physics-based movement\r\n      const moveableCar = new Moveable();\r\n      moveableCar.entities.push(carObject);\r\n      moveableCar.center(startX, 0.5, startZ);\r\n      moveableCar.setRect(new Rect3d(startX, 0.5, startZ, 1.5, 1.5, 1.5)); // Set 3D collision bounds\r\n      moveableCar.updatePhysicsPosition();\r\n\r\n      const bot: RacingBot = {\r\n        car: moveableCar,\r\n        position: { x: startX, y: 0, z: startZ },\r\n        speed: 0.08 + (Math.random() * 0.08), // Increased variance: 0.08 to 0.16 (wider spread)\r\n        currentWaypoint: 0, // Start with waypoint 0 (origin)\r\n        name: botNames[i],\r\n        rotation: 0, // Start facing forward\r\n        nameText: nameText\r\n      };\r\n\r\n      this.bots.push(bot);\r\n      this.addEntity(bot.car);\r\n\r\n      console.log(`Created bot ${bot.name} at position (${startX}, ${startZ})`);\r\n    }\r\n  }\r\n\r\n  createCrowd() {\r\n    // Create crowd of low poly girls around the center of the track\r\n    const centerX = 0;\r\n    const centerZ = 27.5; // Center of the track loop\r\n    const crowdPositions = [\r\n      // Inner crowd circle\r\n      { x: centerX - 8, z: centerZ - 8 },\r\n      { x: centerX + 8, z: centerZ - 8 },\r\n      { x: centerX - 8, z: centerZ + 8 },\r\n      { x: centerX + 8, z: centerZ + 8 },\r\n      { x: centerX, z: centerZ - 10 },\r\n      { x: centerX, z: centerZ + 10 },\r\n      { x: centerX - 10, z: centerZ },\r\n      { x: centerX + 10, z: centerZ },\r\n      // Additional crowd around the track\r\n      { x: -15, z: 10 },\r\n      { x: 15, z: 10 },\r\n      { x: -15, z: 45 },\r\n      { x: 15, z: 45 },\r\n    ];\r\n\r\n    crowdPositions.forEach((pos, index) => {\r\n      const crowdMember = new Object3d(\r\n        new Rect3d(pos.x, 1.7, pos.z, 2, 2, 2),\r\n        \"low_poly_girl\"\r\n      );\r\n      \r\n      // Vary the scale and rotation for diversity\r\n      const scale = 0.8 + Math.random() * 0.4; // Scale between 0.8 and 1.2\r\n      crowdMember.scale(scale, scale, scale);\r\n      crowdMember.angleY(Math.random() * 360); // Random rotation\r\n      \r\n      this.crowd.push(crowdMember);\r\n      this.addEntity(crowdMember);\r\n    });\r\n\r\n    console.log(`Created ${this.crowd.length} crowd members`);\r\n  }\r\n\r\n  createWaypointTiles() {\r\n    try {\r\n      // Create bigger tiles to visualize the waypoint path\r\n      for (let i = 0; i < this.waypoints.length - 1; i++) { // -1 to avoid duplicate at start/end\r\n        const waypoint = this.waypoints[i];\r\n        \r\n        // Create a bigger cube tile at each waypoint\r\n        const tile = new Cube(\r\n          new Rect3d(waypoint.x, 0.2, waypoint.z, 5, 0.2, 5), // Bigger tiles: 5x5 instead of 3x3\r\n          \"sky\",\r\n          [\"sky\", \"sky\", \"sky\", \"sky\", \"sky\", \"sky\"]\r\n        );\r\n        \r\n        this.waypointTiles.push(tile);\r\n        this.addEntity(tile);\r\n        tile.init(this.engineHelper);\r\n      }\r\n      \r\n      // Create path connection tiles between waypoints\r\n      for (let i = 0; i < this.waypoints.length - 1; i++) {\r\n        const current = this.waypoints[i];\r\n        const next = this.waypoints[i + 1];\r\n        \r\n        // Calculate distance and direction between waypoints\r\n        const dx = next.x - current.x;\r\n        const dz = next.z - current.z;\r\n        const distance = Math.sqrt(dx * dx + dz * dz);\r\n        \r\n        // Create bigger tiles along the path between waypoints\r\n        const tilesPerSegment = Math.floor(distance / 4); // One tile every 4 units (was 3)\r\n        for (let j = 1; j < tilesPerSegment; j++) {\r\n          const progress = j / tilesPerSegment;\r\n          const x = current.x + dx * progress;\r\n          const z = current.z + dz * progress;\r\n          \r\n          const pathTile = new Cube(\r\n            new Rect3d(x, 0.1, z, 4, 0.1, 4), // Bigger path tiles: 4x4 instead of 3x3\r\n            \"ground\",\r\n            [\"ground\", \"ground\", \"ground\", \"ground\", \"ground\", \"ground\"]\r\n          );\r\n          \r\n          this.waypointTiles.push(pathTile);\r\n          this.addEntity(pathTile);\r\n          pathTile.init(this.engineHelper);\r\n        }\r\n      }\r\n      \r\n      // Create course walls around the track edges\r\n      this.createCourseWalls();\r\n      \r\n      console.log(`Created ${this.waypointTiles.length} bigger waypoint path tiles and course walls`);\r\n    } catch (error) {\r\n      console.error('Error creating waypoint tiles:', error);\r\n    }\r\n  }\r\n\r\n  createCourseWalls() {\r\n    // Create walls derived from waypoints\r\n    const wallHeight = 2;\r\n    const wallThickness = 1;\r\n    const trackWidth = 8; // Distance from track center to wall\r\n    \r\n    // Calculate bounding box from waypoints\r\n    let minX = Math.min(...this.waypoints.map(wp => wp.x));\r\n    let maxX = Math.max(...this.waypoints.map(wp => wp.x));\r\n    let minZ = Math.min(...this.waypoints.map(wp => wp.z));\r\n    let maxZ = Math.max(...this.waypoints.map(wp => wp.z));\r\n    \r\n    // Add padding around the track\r\n    const padding = 15;\r\n    minX -= padding;\r\n    maxX += padding;\r\n    minZ -= padding;\r\n    maxZ += padding;\r\n    \r\n    // Create outer boundary walls based on waypoint extents\r\n    const outerWalls = [\r\n      // North wall (top)\r\n      { x: (minX + maxX) / 2, z: minZ, width: maxX - minX, height: wallHeight, depth: wallThickness },\r\n      // South wall (bottom)\r\n      { x: (minX + maxX) / 2, z: maxZ, width: maxX - minX, height: wallHeight, depth: wallThickness },\r\n      // West wall (left)\r\n      { x: minX, z: (minZ + maxZ) / 2, width: wallThickness, height: wallHeight, depth: maxZ - minZ },\r\n      // East wall (right)\r\n      { x: maxX, z: (minZ + maxZ) / 2, width: wallThickness, height: wallHeight, depth: maxZ - minZ }\r\n    ];\r\n\r\n    outerWalls.forEach((wall, index) => {\r\n      try {\r\n        const wallCube = new Cube(\r\n          new Rect3d(wall.x, wall.height / 2, wall.z, wall.width, wall.height, wall.depth),\r\n          \"rock\", // Use a distinct texture for walls\r\n          [\"rock\", \"rock\", \"rock\", \"rock\", \"rock\", \"rock\"]\r\n        );\r\n        \r\n        this.trackBarriers.push(wallCube);\r\n        this.addEntity(wallCube);\r\n        wallCube.init(this.engineHelper);\r\n      } catch (error) {\r\n        console.warn('Failed to create course wall:', error);\r\n      }\r\n    });\r\n\r\n    // Create inner barriers along the track path\r\n    for (let i = 0; i < this.waypoints.length - 1; i++) {\r\n      const current = this.waypoints[i];\r\n      const next = this.waypoints[i + 1];\r\n      \r\n      // Calculate perpendicular direction for track width\r\n      const dx = next.x - current.x;\r\n      const dz = next.z - current.z;\r\n      const length = Math.sqrt(dx * dx + dz * dz);\r\n      \r\n      if (length > 0) {\r\n        // Normalize direction vector\r\n        const normalizedDx = dx / length;\r\n        const normalizedDz = dz / length;\r\n        \r\n        // Perpendicular vectors for track sides\r\n        const perpX = -normalizedDz;\r\n        const perpZ = normalizedDx;\r\n        \r\n        // Create barriers on both sides of track segments at turns\r\n        if (i % 3 === 0) { // Only at some waypoints to avoid cluttering\r\n          // Left side barrier\r\n          const leftBarrierX = current.x + perpX * trackWidth;\r\n          const leftBarrierZ = current.z + perpZ * trackWidth;\r\n          \r\n          // Right side barrier  \r\n          const rightBarrierX = current.x - perpX * trackWidth;\r\n          const rightBarrierZ = current.z - perpZ * trackWidth;\r\n          \r\n          [\r\n            { x: leftBarrierX, z: leftBarrierZ },\r\n            { x: rightBarrierX, z: rightBarrierZ }\r\n          ].forEach((barrierPos) => {\r\n            try {\r\n              const barrierCube = new Cube(\r\n                new Rect3d(barrierPos.x, wallHeight / 2, barrierPos.z, 2, wallHeight, 2),\r\n                \"rock\",\r\n                [\"rock\", \"rock\", \"rock\", \"rock\", \"rock\", \"rock\"]\r\n              );\r\n              \r\n              this.trackBarriers.push(barrierCube);\r\n              this.addEntity(barrierCube);\r\n              barrierCube.init(this.engineHelper);\r\n            } catch (error) {\r\n              console.warn('Failed to create track barrier:', error);\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log(`Created ${this.trackBarriers.length} course walls and barriers derived from ${this.waypoints.length} waypoints`);\r\n    console.log(`Track bounds: X(${minX.toFixed(1)} to ${maxX.toFixed(1)}), Z(${minZ.toFixed(1)} to ${maxZ.toFixed(1)})`);\r\n  }\r\n\r\n  startRace() {\r\n    this.gameStarted = true;\r\n    console.log('Race started! Use WASD to control your car.');\r\n    console.log('Bot initial positions and targets:');\r\n    this.bots.forEach((bot, index) => {\r\n      const target = this.waypoints[bot.currentWaypoint];\r\n      console.log(`Bot ${index} (${bot.name}): pos(${bot.position.x}, ${bot.position.z}) -> waypoint ${bot.currentWaypoint} at (${target.x}, ${target.z})`);\r\n    });\r\n  }\r\n\r\n  updatePlayerMovement() {\r\n    if (!this.gameStarted || this.raceFinished) return;\r\n\r\n    // Handle acceleration/deceleration\r\n    if (this.keys['keyw']) {\r\n      this.playerSpeed = Math.min(this.playerSpeed + this.acceleration, this.maxSpeed);\r\n    } else if (this.keys['keys']) {\r\n      this.playerSpeed = Math.max(this.playerSpeed - this.deceleration, -this.maxSpeed * 0.5);\r\n    } else {\r\n      // Natural deceleration\r\n      if (this.playerSpeed > 0) {\r\n        this.playerSpeed = Math.max(0, this.playerSpeed - this.deceleration * 0.5);\r\n      } else {\r\n        this.playerSpeed = Math.min(0, this.playerSpeed + this.deceleration * 0.5);\r\n      }\r\n    }\r\n\r\n    // Handle turning - this will rotate the camera direction\r\n    if (this.keys['keya']) {\r\n      this.playerRotation += this.turnSpeed; // Turn left\r\n    }\r\n    if (this.keys['keyd']) {\r\n      this.playerRotation -= this.turnSpeed; // Turn right\r\n    }\r\n\r\n    // Move position based on current rotation and speed\r\n    const forwardX = Math.sin(this.playerRotation);\r\n    const forwardZ = Math.cos(this.playerRotation);\r\n    \r\n    this.playerPosition.x += forwardX * this.playerSpeed;\r\n    this.playerPosition.z += forwardZ * this.playerSpeed;\r\n    \r\n    // Update player car position and rotation\r\n    if (this.playerCar) {\r\n      this.playerCar.center(this.playerPosition.x, this.playerPosition.y, this.playerPosition.z);\r\n      this.playerCar.angleY(this.playerRotation * (180 / Math.PI));\r\n    }\r\n\r\n    // Check waypoint progress\r\n    this.checkWaypoints();\r\n  }\r\n\r\n  updateBots() {\r\n    if (!this.gameStarted || this.raceFinished) return;\r\n\r\n    this.bots.forEach((bot, index) => {\r\n      const baseWaypoint = this.waypoints[bot.currentWaypoint];\r\n      \r\n      // Add variance to target waypoint to prevent bots from clustering\r\n      const lateralOffset = (index - 1.5) * 3; // Spread bots across track width (-4.5 to 4.5)\r\n      const randomVariance = (Math.sin(Date.now() * 0.002 + index * 3) * 2); // Small random movement\r\n      \r\n      // Calculate perpendicular direction for lateral positioning\r\n      const nextWaypointIndex = (bot.currentWaypoint + 1) % this.waypoints.length;\r\n      const nextWaypoint = this.waypoints[nextWaypointIndex];\r\n      const trackDx = nextWaypoint.x - baseWaypoint.x;\r\n      const trackDz = nextWaypoint.z - baseWaypoint.z;\r\n      const trackLength = Math.sqrt(trackDx * trackDx + trackDz * trackDz);\r\n      \r\n      let perpX = 0, perpZ = 0;\r\n      if (trackLength > 0) {\r\n        // Perpendicular to track direction for lateral offset\r\n        perpX = -trackDz / trackLength;\r\n        perpZ = trackDx / trackLength;\r\n      }\r\n      \r\n      // Create varied target waypoint\r\n      const targetWaypoint = {\r\n        x: baseWaypoint.x + perpX * (lateralOffset + randomVariance),\r\n        z: baseWaypoint.z + perpZ * (lateralOffset + randomVariance)\r\n      };\r\n\r\n      // Calculate direction to varied target waypoint\r\n      const dx = targetWaypoint.x - bot.position.x;\r\n      const dz = targetWaypoint.z - bot.position.z;\r\n      const distance = Math.sqrt(dx * dx + dz * dz);\r\n\r\n      // Debug logging for first bot (reduced frequency)\r\n      if (index === 0 && Math.random() < 0.01) { // Less frequent logging\r\n        console.log(`Bot ${bot.name}: pos(${bot.position.x.toFixed(1)}, ${bot.position.z.toFixed(1)}) -> varied waypoint ${bot.currentWaypoint} at (${targetWaypoint.x.toFixed(1)}, ${targetWaypoint.z.toFixed(1)}) distance: ${distance.toFixed(1)}`);\r\n      }\r\n\r\n      // Check if reached base waypoint (use original waypoint for progression)\r\n      const baseDistance = Math.sqrt(\r\n        Math.pow(bot.position.x - baseWaypoint.x, 2) + \r\n        Math.pow(bot.position.z - baseWaypoint.z, 2)\r\n      );\r\n      if (baseDistance < 5) { // Larger threshold for more reliable waypoint detection\r\n        bot.currentWaypoint = (bot.currentWaypoint + 1) % this.waypoints.length;\r\n        console.log(`Bot ${bot.name} reached waypoint, moving to waypoint ${bot.currentWaypoint}`);\r\n      }\r\n\r\n      // Direct movement for reliable bot AI with left-right variance\r\n      if (distance > 0.1 && distance < 200) { // Prevent extreme movements\r\n        // Normalize direction vector\r\n        const normalizedDx = dx / distance;\r\n        const normalizedDz = dz / distance;\r\n        \r\n        // Add left-right variance to prevent bots driving on top of each other\r\n        const lateralVariance = (Math.sin(Date.now() * 0.001 + index * 2) * 0.3) + (index - 1.5) * 0.1; // Different pattern per bot\r\n        const perpX = -normalizedDz; // Perpendicular to direction\r\n        const perpZ = normalizedDx;\r\n        \r\n        // Move bot towards target waypoint with lateral variance\r\n        bot.position.x += (normalizedDx * bot.speed) + (perpX * lateralVariance * 0.05);\r\n        bot.position.z += (normalizedDz * bot.speed) + (perpZ * lateralVariance * 0.05);\r\n\r\n        // Calculate rotation to face movement direction\r\n        // Fix the rotation calculation - use correct coordinate system\r\n        bot.rotation = Math.atan2(normalizedDx, normalizedDz) * (180 / Math.PI); // Fixed: removed negative from dz\r\n\r\n        // Update the Moveable car's position to match bot position\r\n        bot.car.center(bot.position.x, bot.position.y, bot.position.z);\r\n        bot.car.angleY(bot.rotation);\r\n        \r\n        // Also update the internal Object3d position for proper rendering\r\n        if (bot.car.entities.length > 0) {\r\n          const carObject = bot.car.entities[0];\r\n          carObject.center(bot.position.x, bot.position.y, bot.position.z);\r\n          carObject.angleY(bot.rotation);\r\n        }\r\n      }\r\n\r\n      // Update name text position (screen overlay)\r\n      if (bot.nameText) {\r\n        try {\r\n          const screenX = 0.1 + (index * 0.2); // Spread names across top\r\n          const screenY = 0.9; // Near top of screen\r\n          bot.nameText.center(screenX, screenY);\r\n        } catch (error) {\r\n          // Font system may not be ready, ignore silently\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  checkWaypoints() {\r\n    const currentWaypoint = this.waypoints[this.lastWaypoint];\r\n    const dx = this.playerPosition.x - currentWaypoint.x;\r\n    const dz = this.playerPosition.z - currentWaypoint.z;\r\n    const distance = Math.sqrt(dx * dx + dz * dz);\r\n\r\n    if (distance < 3) {\r\n      this.lastWaypoint = (this.lastWaypoint + 1) % this.waypoints.length;\r\n\r\n      // Check if completed a lap\r\n      if (this.lastWaypoint === 0) {\r\n        this.currentLap++;\r\n        console.log(`Lap ${this.currentLap - 1} completed!`);\r\n\r\n        if (this.currentLap > this.totalLaps) {\r\n          this.finishRace();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  finishRace() {\r\n    this.raceFinished = true;\r\n    console.log('Race finished!');\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject, index: number) => ent.render(this.engineHelper));\r\n    \r\n    // Temporarily disable font rendering to focus on bot movement\r\n    // TODO: Re-enable when font system is stable\r\n    // if (this.gameStarted) {\r\n    //   this.bots.forEach((bot) => {\r\n    //     try {\r\n    //       bot.nameText.render(this.engineHelper);\r\n    //     } catch (error) {\r\n    //       console.warn('Font rendering error:', error);\r\n    //     }\r\n    //   });\r\n    // }\r\n  }\r\n\r\n  update() {\r\n    if (this.gameStarted && !this.raceFinished) {\r\n      this.raceTime += 1 / 60; // Assuming 60 FPS\r\n    }\r\n\r\n    this.updatePlayerMovement();\r\n    this.updateBots();\r\n    this.checkWaypoints();\r\n\r\n    // Update all entities (sky camera following handled by CameraFollower feature)\r\n    this.entities.forEach((ent: EngineObject) => ent.update(this.engineHelper));\r\n\r\n    // Update camera - fixed position behind player with rotating view\r\n    if (this.playerCar) {\r\n      const cameraOffset = 8;\r\n      const cameraHeight = 3;\r\n      \r\n      // Camera position follows player with fixed offset (no rotation)\r\n      const cameraX = this.playerPosition.x;\r\n      const cameraZ = this.playerPosition.z - cameraOffset;\r\n      const cameraY = this.playerPosition.y + cameraHeight;\r\n\r\n      this.engineHelper.camera.camera3d.center(cameraX, cameraY, cameraZ);\r\n      this.engineHelper.camera.camera3d.position.ay = -this.playerRotation * (180 / Math.PI);\r\n      this.engineHelper.camera.camera3d.updateProjectionView();\r\n    }\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    // Handle keyboard events\r\n    if (event.eventType === Events.KEY_DOWN) {\r\n      const keyEvent = event as any;\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = true;\r\n\r\n        // Start game on spacebar\r\n        if (keyEvent.code === 'Space' && !this.gameStarted && !this.gameEnded) {\r\n          this.startRace();\r\n        }\r\n      }\r\n    }\r\n\r\n    if (event.eventType === Events.KEY_UP) {\r\n      const keyEvent = event as any;\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = false;\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  init() {\r\n    // Simplified initialization\r\n    console.log('Initializing Racing Game...');\r\n\r\n    // Set up basic lighting\r\n    this.engineHelper.setLighting(\r\n      new Light({\r\n        pos: [0.0, 20, 0],\r\n        in: [1.0, 1.0, 1.0],\r\n        attenuation: 0.02,\r\n        ambientCoeff: 0.4,\r\n        at: [0.0, 0.0, 0.0]\r\n      })\r\n    );\r\n\r\n    // Position camera for initial view\r\n    this.engineHelper.camera.camera3d.center(0, 5, 10);\r\n    this.engineHelper.camera.camera3d.lookAt(0, 0, 0);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n    this.engineHelper.camera.camera3d.commitProjectionView();\r\n    \r\n    // Create game objects\r\n    this.createGameObjects();\r\n    super.init();\r\n    \r\n    // Create waypoint tiles for visual debugging\r\n    this.createWaypointTiles();\r\n    \r\n    console.log('Racing Game initialized! Press SPACE to start racing!');\r\n    console.log('Controls: W/S - Accelerate/Brake, A/D - Turn Left/Right');\r\n    \r\n    // Auto-start the race after 2 seconds\r\n    setTimeout(() => {\r\n      if (!this.gameStarted) {\r\n        console.log('Auto-starting race...');\r\n        this.startRace();\r\n      }\r\n    }, 2000);\r\n  }\r\n\r\n  loadResources() {\r\n    console.log('Loading Racing game resources...');\r\n\r\n    // Load font for bot names first\r\n    this.engineHelper\r\n      .getResource(\"assets/paprika.fnt\")\r\n      .then(ResourceResolver.bmFontResolver(this.engineHelper))\r\n      .then(() => {\r\n        console.log('Font resources loaded');\r\n        // Initialize bot fonts after font is loaded\r\n        this.bots.forEach((bot, index) => {\r\n          try {\r\n            bot.nameText.center(0.1 + (index * 0.2), 0.9);\r\n          } catch (error) {\r\n            console.warn('Font initialization warning:', error);\r\n          }\r\n        });\r\n      })\r\n      .catch(err => console.error('Font resource error:', err));\r\n\r\n    // Load missing texture fallback for cubes\r\n    this.engineHelper\r\n      .getResource(\"assets/missing-texture.txt\")\r\n      .then(ResourceResolver.bitmapResolver(this.engineHelper, 1184, 1184, 0))\r\n      .then(() => console.log('Missing texture fallback loaded'))\r\n      .catch(err => console.error('Missing texture resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/racing_car.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/racing_car.png\",\r\n          \"racing_car\"\r\n        )\r\n      ).then(() => {\r\n        console.log('Racing car resources loaded');\r\n      })\r\n      .catch(err => console.error('Racing car resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/atlas.txt\")\r\n      .then(\r\n        ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 20e-3)\r\n      ).then(() => console.log('Atlas resources loaded'))\r\n      .catch(err => console.error('Atlas resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/background.jpg\")\r\n      .then(ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 0))\r\n      .then(() => console.log('Background resources loaded'))\r\n      .catch(err => console.error('Background resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/sphere.txt\")\r\n      .then(\r\n        ResourceResolver.objResolverMultiple(this.engineHelper, [\r\n          { textureSource: \"assets/background.jpg\", name: \"background\" },\r\n          { textureSource: \"assets/sun.png\", name: \"sun\" }\r\n        ])\r\n      ).then(() => console.log('Sphere resources loaded'))\r\n      .catch(err => console.error('Sphere resource error:', err));\r\n\r\n    // Load low poly girl for crowd\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_girl.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_girl.png\",\r\n          \"low_poly_girl\"\r\n        )\r\n      ).then(() => console.log('Low poly girl resources loaded'))\r\n      .catch(err => console.error('Low poly girl resource error:', err));\r\n\r\n    // Load low poly tree for nature scenery\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_tree.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_tree.png\",\r\n          \"low_poly_tree\"\r\n        )\r\n      ).then(() => console.log('Low poly tree resources loaded'))\r\n      .catch(err => console.error('Low poly tree resource error:', err));\r\n\r\n  }\r\n}\r\n\r\n// Export function to create and launch the racing game\r\nexport const createRacingGame = (): void => {\r\n  console.log('Starting Racing Game...');\r\n\r\n  const aspect = window.innerWidth / window.innerHeight;\r\n  const args = {\r\n    world: new RacingGame(),\r\n    elementId: \"app\",\r\n    canvasId: \"app-game\",\r\n    error: undefined,\r\n    subscribe: undefined,\r\n    renderMode: '3d',\r\n    camera: {\r\n      near: 0.01,\r\n      far: 1000.0,\r\n      fov: 60.0,\r\n      maxFov: 60.0,\r\n      isFovMax: false,\r\n      projection: 'perspective',\r\n      aspect\r\n    },\r\n    aspectRatio: aspect,\r\n    eventThrottle: 1000.0 / 60.0,\r\n    fps: 60,\r\n    isStepRender: false,\r\n  };\r\n  const app = new App(args);\r\n\r\n  // Expose game instance globally for UI updates\r\n  (window as any).gameInstance = args.world;\r\n\r\n  app.run().catch(console.error);\r\n  app.unpause();\r\n  window.onresize = () => {\r\n    location.reload();\r\n  };\r\n};\r\n","import {\r\n  App,\r\n  EngineEvent,\r\n  EngineObject,\r\n  Events,\r\n  Light,\r\n  ObjectManager,\r\n  Rect3d,\r\n  ResourceResolver\r\n} from \"synaren-engine\";\r\nimport CameraFollower from \"../src/Core/EngineEntity/CameraFollower\";\r\nimport Cube from \"./Cube\";\r\nimport Ground3d from \"./Ground3d\";\r\nimport Sphere from \"./Sphere\";\r\n\r\ninterface Crystal {\r\n  sphere: Sphere;\r\n  collected: boolean;\r\n  glowIntensity: number;\r\n  glowDirection: number;\r\n}\r\n\r\ninterface Obstacle {\r\n  cube: Cube;\r\n  rotationSpeed: number;\r\n}\r\n\r\nexport default class CrystalCollectorGame extends ObjectManager {\r\n  // Game state\r\n  score: number = 0;\r\n  timeLeft: number = 60; // 60 seconds game time\r\n  gameStarted: boolean = false;\r\n  gameEnded: boolean = false;\r\n  \r\n  // Game objects\r\n  player: Sphere;\r\n  crystals: Crystal[] = [];\r\n  obstacles: Obstacle[] = [];\r\n  ground: Ground3d;\r\n  sky: Sphere;\r\n  \r\n  // Player movement\r\n  playerSpeed: number = 0.1;\r\n  playerPosition: { x: number, y: number, z: number } = { x: 0, y: 1, z: 0 };\r\n  keys: { [key: string]: boolean } = {};\r\n  \r\n  // Game timer\r\n  gameTimer: number | null = null;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  startGame() {\r\n    this.gameStarted = true;\r\n    this.gameEnded = false;\r\n    this.score = 0;\r\n    this.timeLeft = 60;\r\n    \r\n    // Start countdown timer\r\n    this.gameTimer = window.setInterval(() => {\r\n      this.timeLeft--;\r\n      if (this.timeLeft <= 0) {\r\n        this.endGame();\r\n      }\r\n    }, 1000);\r\n    \r\n    // Reset crystals\r\n    this.crystals.forEach(crystal => {\r\n      crystal.collected = false;\r\n      // Reset crystal position to original\r\n      crystal.sphere.center(crystal.sphere.position.x, 1, crystal.sphere.position.z);\r\n    });\r\n    \r\n    // Reset player position\r\n    this.playerPosition = { x: 0, y: 1, z: 0 };\r\n    this.player.center(0, 1, 0);\r\n    \r\n    // Update camera to follow player\r\n    this.engineHelper.camera.camera3d.center(0, 3, 5);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n  }\r\n\r\n  endGame() {\r\n    this.gameEnded = true;\r\n    this.gameStarted = false;\r\n    \r\n    if (this.gameTimer) {\r\n      clearInterval(this.gameTimer);\r\n      this.gameTimer = null;\r\n    }\r\n  }\r\n\r\n  restartGame() {\r\n    this.gameEnded = false;\r\n    this.startGame();\r\n  }\r\n\r\n  checkCollisions() {\r\n    if (!this.gameStarted || this.gameEnded) return;\r\n    \r\n    // Check crystal collection\r\n    this.crystals.forEach((crystal, index) => {\r\n      if (!crystal.collected) {\r\n        const distance = Math.sqrt(\r\n          Math.pow(this.playerPosition.x - crystal.sphere.position.x, 2) +\r\n          Math.pow(this.playerPosition.y - crystal.sphere.position.y, 2) +\r\n          Math.pow(this.playerPosition.z - crystal.sphere.position.z, 2)\r\n        );\r\n        \r\n        if (distance < 1.5) {\r\n          crystal.collected = true;\r\n          // Move crystal far away instead of hiding it\r\n          crystal.sphere.center(1000, 1000, 1000);\r\n          this.score += 10;\r\n          \r\n          // Check if all crystals collected\r\n          if (this.crystals.every(c => c.collected)) {\r\n            this.score += this.timeLeft * 2; // Bonus points for time left\r\n            this.endGame();\r\n          }\r\n        }\r\n      }\r\n    });\r\n    \r\n    // Check obstacle collisions\r\n    this.obstacles.forEach(obstacle => {\r\n      const distance = Math.sqrt(\r\n        Math.pow(this.playerPosition.x - obstacle.cube.position.x, 2) +\r\n        Math.pow(this.playerPosition.y - obstacle.cube.position.y, 2) +\r\n        Math.pow(this.playerPosition.z - obstacle.cube.position.z, 2)\r\n      );\r\n      \r\n      if (distance < 2) {\r\n        // Penalty for hitting obstacle\r\n        this.score = Math.max(0, this.score - 5);\r\n        // Push player away\r\n        const dx = this.playerPosition.x - obstacle.cube.position.x;\r\n        const dz = this.playerPosition.z - obstacle.cube.position.z;\r\n        const length = Math.sqrt(dx * dx + dz * dz);\r\n        if (length > 0) {\r\n          this.playerPosition.x += (dx / length) * 2;\r\n          this.playerPosition.z += (dz / length) * 2;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  updatePlayer() {\r\n    if (!this.gameStarted || this.gameEnded) return;\r\n    \r\n    const newPosition = { ...this.playerPosition };\r\n    \r\n    // WASD movement using keyboard codes\r\n    if (this.keys['keyw']) newPosition.z -= this.playerSpeed;\r\n    if (this.keys['keys']) newPosition.z += this.playerSpeed;\r\n    if (this.keys['keya']) newPosition.x -= this.playerSpeed;\r\n    if (this.keys['keyd']) newPosition.x += this.playerSpeed;\r\n    \r\n    // Boundary checking (keep player in play area)\r\n    const boundary = 15;\r\n    newPosition.x = Math.max(-boundary, Math.min(boundary, newPosition.x));\r\n    newPosition.z = Math.max(-boundary, Math.min(boundary, newPosition.z));\r\n    \r\n    this.playerPosition = newPosition;\r\n    this.player.center(this.playerPosition.x, this.playerPosition.y, this.playerPosition.z);\r\n    \r\n    // Update camera to follow player\r\n    this.engineHelper.camera.camera3d.center(\r\n      this.playerPosition.x,\r\n      this.playerPosition.y + 3,\r\n      this.playerPosition.z + 5\r\n    );\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n  }\r\n\r\n  updateCrystals() {\r\n    this.crystals.forEach(crystal => {\r\n      if (!crystal.collected) {\r\n        // Glow effect\r\n        crystal.glowIntensity += crystal.glowDirection * 0.02;\r\n        if (crystal.glowIntensity >= 1) {\r\n          crystal.glowDirection = -1;\r\n        } else if (crystal.glowIntensity <= 0.3) {\r\n          crystal.glowDirection = 1;\r\n        }\r\n        \r\n        // Floating animation\r\n        const time = Date.now() * 0.001;\r\n        const floatOffset = Math.sin(time * 2) * 0.2;\r\n        crystal.sphere.position.y = 1 + floatOffset;\r\n        \r\n        // Slow rotation\r\n        crystal.sphere.angleY(time * 50);\r\n      }\r\n    });\r\n  }\r\n\r\n  updateObstacles() {\r\n    this.obstacles.forEach(obstacle => {\r\n      obstacle.cube.position.ay += obstacle.rotationSpeed;\r\n      obstacle.cube.planes?.forEach(plane => {\r\n        plane.angleY(obstacle.cube.position.ay);\r\n      });\r\n    });\r\n  }\r\n\r\n  updateUI() {\r\n    if (this.gameEnded) {\r\n      const allCrystalsCollected = this.crystals.every(c => c.collected);\r\n      if (allCrystalsCollected) {\r\n        console.log(` YOU WIN! Final Score: ${this.score} | Press R to restart`);\r\n      } else {\r\n        console.log(` TIME'S UP! Final Score: ${this.score} | Press R to restart`);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject, index: number) => ent.render(this.engineHelper));\r\n  }\r\n\r\n  update() {\r\n    this.updatePlayer();\r\n    this.updateCrystals();\r\n    this.updateObstacles();\r\n    this.checkCollisions();\r\n    this.updateUI();\r\n    \r\n    super.update();\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    console.log(`Event: ${event.eventType}, Time: ${event.timeStamp} ms, keys: ${JSON.stringify(event)}`);\r\n    // Handle keyboard events\r\n    if (event.eventType === Events.KEY_DOWN) {\r\n      const keyEvent = event as any; // Cast to access keyboard properties\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = true;\r\n        \r\n        // Start game on spacebar\r\n        if (keyEvent.code === 'Space' && !this.gameStarted && !this.gameEnded) {\r\n          this.startGame();\r\n        }\r\n        \r\n        // Restart game on R\r\n        if (keyEvent.code === 'KeyR' && this.gameEnded) {\r\n          this.restartGame();\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (event.eventType === Events.KEY_UP) {\r\n      const keyEvent = event as any; // Cast to access keyboard properties\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = false;\r\n      }\r\n    }\r\n    \r\n    // Mouse look controls\r\n    if (event.eventType === Events.DRAG) {\r\n      this.engineHelper.camera.camera3d.angleY(-event.dxRaw * 0.5);\r\n      this.engineHelper.camera.camera3d.angleX(event.dyRaw * 0.5);\r\n      this.engineHelper.camera.camera3d.updateProjectionView();\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n\r\n  loadResources() {\r\n    console.log('Loading Crystal Collector game resources...');\r\n    \r\n    this.engineHelper\r\n      .getResource(\"assets/sphere.txt\")\r\n      .then(\r\n        ResourceResolver.objResolverMultiple(this.engineHelper, [\r\n          { textureSource: \"assets/background.jpg\", name: \"background\" },\r\n          { textureSource: \"assets/sun.png\", name: \"crystal\" }\r\n        ])\r\n      ).then(() => console.log('Sphere resources loaded'))\r\n      .catch(err => console.error('Sphere resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/atlas.txt\")\r\n      .then(\r\n        ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 20e-3)\r\n      ).then(() => console.log('Atlas resources loaded'))\r\n      .catch(err => console.error('Atlas resource error:', err));\r\n  }\r\n\r\n  init() {\r\n    const length = 30;\r\n    const width = 30;\r\n\r\n    // Initialize camera\r\n    this.engineHelper.camera.camera3d.center(0, 3, 5);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n\r\n    // Create sky\r\n    this.sky = new Sphere(\r\n      new Rect3d(0.0, 2.0, 0.0, 100.0, 100.0, 100.0),\r\n      \"background\"\r\n    );\r\n    this.sky.addFeature(new CameraFollower(this.engineHelper.camera));\r\n    this.addEntity(this.sky);\r\n\r\n    // Create ground\r\n    this.ground = new Ground3d(\r\n      new Rect3d(0.0, 0.0, 0.0, width, 0, length),\r\n      \"grass\"\r\n    );\r\n    this.addEntity(this.ground);\r\n\r\n    // Create player (blue sphere)\r\n    this.player = new Sphere(new Rect3d(0, 1, 0, 0.8, 0.8, 0.8), \"crystal\");\r\n    this.player.scale(0.5, 0.5, 0.5);\r\n    this.addEntity(this.player);\r\n\r\n    // Create crystals to collect (8 crystals placed around the map)\r\n    const crystalPositions = [\r\n      { x: 5, z: 5 }, { x: -5, z: 5 }, { x: 5, z: -5 }, { x: -5, z: -5 },\r\n      { x: 8, z: 0 }, { x: -8, z: 0 }, { x: 0, z: 8 }, { x: 0, z: -8 }\r\n    ];\r\n    \r\n    crystalPositions.forEach((pos, index) => {\r\n      const crystal = new Sphere(new Rect3d(pos.x, 1, pos.z, 0.6, 0.6, 0.6), \"crystal\");\r\n      const crystalData: Crystal = {\r\n        sphere: crystal,\r\n        collected: false,\r\n        glowIntensity: 0.5,\r\n        glowDirection: 1\r\n      };\r\n      this.crystals.push(crystalData);\r\n      this.addEntity(crystal);\r\n    });\r\n\r\n    // Create rotating obstacles (spinning cubes)\r\n    const obstaclePositions = [\r\n      { x: 3, z: 3 }, { x: -3, z: 3 }, { x: 3, z: -3 }, { x: -3, z: -3 },\r\n      { x: 6, z: -2 }, { x: -6, z: 2 }\r\n    ];\r\n    \r\n    obstaclePositions.forEach((pos, index) => {\r\n      const obstacle = new Cube(\r\n        new Rect3d(pos.x, 1, pos.z, 1.2, 1.2, 1.2), \r\n        \"assets/atlas.png\", \r\n        [\"rock\", \"rock\", \"rock\", \"rock\", \"rock\", \"rock\"]\r\n      );\r\n      \r\n      const obstacleData: Obstacle = {\r\n        cube: obstacle,\r\n        rotationSpeed: 2 + Math.random() * 3 // Random rotation speed\r\n      };\r\n      \r\n      this.obstacles.push(obstacleData);\r\n      this.addEntity(obstacle);\r\n    });\r\n\r\n    // Initialize all engine objects\r\n    super.init();\r\n\r\n    // Set up lighting\r\n    this.engineHelper.setLighting(\r\n      new Light({\r\n        pos: [0.0, 15, 0],\r\n        in: [1.0, 1.0, 1.0],\r\n        attenuation: 0.01,\r\n        ambientCoeff: 0.4,\r\n        at: [0.0, 0.0, 0.0]\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\nconst createCrystalCollectorApp = () => {\r\n  const aspect = window.innerWidth / window.innerHeight;\r\n  const args = {\r\n    world: new CrystalCollectorGame(),\r\n    elementId: \"app\",\r\n    canvasId: \"app-game\",\r\n    error: undefined,\r\n    subscribe: undefined,\r\n    renderMode: '3d',\r\n    camera: {\r\n      near: 0.01,\r\n      far: 1000.0,\r\n      fov: 75.0,\r\n      maxFov: 75.0,\r\n      isFovMax: false,\r\n      projection: 'perspective',\r\n      aspect\r\n    },\r\n    aspectRatio: aspect,\r\n    eventThrottle: 1000.0 / 60.0,\r\n    fps: 60,\r\n    isStepRender: false,\r\n  };\r\n  const app = new App(args);\r\n  \r\n  // Expose game instance globally for UI updates\r\n  (window as any).gameInstance = args.world;\r\n  \r\n  app.run().catch(console.error);\r\n  app.unpause();\r\n  window.onresize = () => {\r\n    location.reload();\r\n  };\r\n};\r\n\r\n// Export for use in other files\r\nexport { createCrystalCollectorApp, CrystalCollectorGame };\r\n\r\n","import WorldDelegate from \"../Core/WorldDelegate\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport { EngineEvent } from \"../Core/Events\";\r\n\r\nexport default class ObjectManager extends WorldDelegate {\r\n  entities: EngineObject[] = [];\r\n  deferred: Function[] = [];\r\n  isLoaded = false;\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject) => ent.render(this.engineHelper));\r\n  }\r\n\r\n  update() {\r\n    const lowPriorityQueue: EngineObject[] = [];\r\n    \r\n    for (const entity of this.entities) {\r\n      if (entity.isLowPriority) {\r\n        lowPriorityQueue.push(entity);\r\n      } else {\r\n        entity.update(this.engineHelper);\r\n      }\r\n    }\r\n    \r\n    lowPriorityQueue.forEach((ent) => ent.update(this.engineHelper));\r\n  }\r\n\r\n  addEntity(entity: EngineObject) {\r\n    this.entities.push(entity);\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    for (let entityIdx = 0; entityIdx < this.entities.length; entityIdx++) {\r\n      const shouldPropagate = this.entities[entityIdx].event(\r\n        event,\r\n        this.engineHelper\r\n      );\r\n      if (shouldPropagate === false) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  loadTexture(onLoad: Function) {\r\n    if (!this.isLoaded) {\r\n      this.deferred.push(onLoad);\r\n    } else {\r\n      onLoad();\r\n    }\r\n  }\r\n  init() {\r\n    for (let entityIdx = 0; entityIdx < this.entities.length; entityIdx++) {\r\n      this.entities[entityIdx].init(this.engineHelper);\r\n    }\r\n    this.deferred.forEach((def) => def());\r\n    this.isLoaded = true;\r\n  }\r\n}\r\n","import Plane2d from \"./Plane2d\";\r\nimport Timer from \"../Core/Common/Timer\";\r\nimport EntityManager2d from \"../Manager/EntityManager2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\n\r\nexport default class SpriteModel extends EntityManager2d {\r\n  spriteIdx = 0;\r\n  private timer = new Timer();\r\n  private ticks: number;\r\n  private textures: string[];\r\n  constructor(rect: Rect2d, ticks: number, textures: string[]) {\r\n    super();\r\n    this.setRect(rect);\r\n    this.ticks = ticks;\r\n    this.textures = textures;\r\n  }\r\n  update(_: EngineHelper) {}\r\n  render(engineHelper: EngineHelper) {\r\n    this.entities[this.spriteIdx]?.render(engineHelper);\r\n    this.calcSpriteIdx();\r\n  }\r\n  calcSpriteIdx() {\r\n    if (this.timer.peak() > this.ticks) {\r\n      const spriteLength = this.entities.length;\r\n      this.spriteIdx += Math.round(this.timer.peak() / this.ticks);\r\n      if (this.spriteIdx >= spriteLength) {\r\n        const idxFactor = this.spriteIdx / spriteLength;\r\n        this.spriteIdx = Math.round(\r\n          (idxFactor - Math.floor(idxFactor)) * spriteLength\r\n        );\r\n        if (this.spriteIdx >= spriteLength) {\r\n          console.error(\"index out of bound after shaping\", this.spriteIdx);\r\n          this.spriteIdx = 0;\r\n        }\r\n      }\r\n      this.timer.start();\r\n    }\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    if (!this.textures) {\r\n      return;\r\n    }\r\n    for (let index = 0; index < this.textures.length; index++) {\r\n      this.entities.push(new Plane2d(this.getRect(), this.textures[index]));\r\n    }\r\n    this.entities.forEach((e) => {\r\n      e.setTop(this.isTop);\r\n      e.hidden = this.hidden;\r\n    });\r\n    this.center(this.position.x, this.position.y, this.position.z);\r\n    this.rotateOrigin(this.position.x, this.position.y, this.position.z);\r\n    this.rotateZ(180);\r\n    super.init(engineHelper);\r\n    this.timer.start();\r\n  }\r\n}\r\n","import Colour from \"../Data/Colour\";\r\nimport PlaneType from \"../Data/PlaneType\";\r\nimport { ColourRenderUnit, TextureRenderUnit } from \"../Data/RenderUnit\";\r\n\r\nexport class VertexBuilder {\r\n  toArray2D(vertexes: TextureRenderUnit[]): number[] {\r\n    const vertexConstruct: number[] = [];\r\n    for (const key in vertexes) {\r\n      if (vertexes.hasOwnProperty(key)) {\r\n        const _vertex = vertexes[key];\r\n        vertexConstruct.push(_vertex.vertex.x);\r\n        vertexConstruct.push(_vertex.vertex.y);\r\n        vertexConstruct.push(_vertex.vertex.z);\r\n        vertexConstruct.push(_vertex.normal.x);\r\n        vertexConstruct.push(_vertex.normal.y);\r\n        vertexConstruct.push(_vertex.normal.z);\r\n        vertexConstruct.push(_vertex.texture.u);\r\n        vertexConstruct.push(_vertex.texture.v);\r\n      }\r\n    }\r\n    return vertexConstruct;\r\n  }\r\n  toTextureArray(vertexes: TextureRenderUnit[]): number[] {\r\n    const vertexConstruct: number[] = [];\r\n    for (const key in vertexes) {\r\n      if (vertexes.hasOwnProperty(key)) {\r\n        const _vertex = vertexes[key];\r\n        vertexConstruct.push(_vertex.vertex.x);\r\n        vertexConstruct.push(_vertex.vertex.y);\r\n        vertexConstruct.push(_vertex.vertex.z);\r\n        vertexConstruct.push(_vertex.normal.x);\r\n        vertexConstruct.push(_vertex.normal.y);\r\n        vertexConstruct.push(_vertex.normal.z);\r\n        vertexConstruct.push(_vertex.texture.u);\r\n        vertexConstruct.push(_vertex.texture.v);\r\n      }\r\n    }\r\n    return vertexConstruct;\r\n  }\r\n  toColourArray(vertexes: ColourRenderUnit[]): number[] {\r\n    const vertexConstruct: number[] = [];\r\n    for (const key in vertexes) {\r\n      if (vertexes.hasOwnProperty(key)) {\r\n        const _vertex = vertexes[key];\r\n        vertexConstruct.push(_vertex.vertex.x);\r\n        vertexConstruct.push(_vertex.vertex.y);\r\n        vertexConstruct.push(_vertex.vertex.z);\r\n        vertexConstruct.push(_vertex.colour.r);\r\n        vertexConstruct.push(_vertex.colour.g);\r\n        vertexConstruct.push(_vertex.colour.b);\r\n        vertexConstruct.push(_vertex.colour.a);\r\n      }\r\n    }\r\n    return vertexConstruct;\r\n  }\r\n  triangleXYColour(colour: Colour): number[] {\r\n    const r = colour.r / 255.0;\r\n    const g = colour.g / 255.0;\r\n    const b = colour.b / 255.0;\r\n    const a = colour.a / 255.0;\r\n    const _colour = [\r\n      1,\r\n      1,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0,\r\n      1,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0,\r\n      0,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n    ];\r\n    return _colour;\r\n  }\r\n  planeXYColour(colour: Colour): number[] {\r\n    const r = colour.r / 255.0;\r\n    const g = colour.g / 255.0;\r\n    const b = colour.b / 255.0;\r\n    const a = colour.a / 255.0;\r\n    const _colour = [\r\n      -0.5,\r\n      -0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0.5,\r\n      -0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      -0.5,\r\n      0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0.5,\r\n      0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n    ];\r\n    return _colour;\r\n  }\r\n  planeCCW(loc: number[], width: number, height: number) {\r\n    const left = loc[0];\r\n    const top = loc[1];\r\n    const right = loc[2];\r\n    const bottom = loc[3];\r\n    const uv = [\r\n      left / width,\r\n      bottom / height,\r\n      left / width,\r\n      top / height,\r\n      right / width,\r\n      top / height,\r\n      right / width,\r\n      bottom / height,\r\n    ];\r\n    return uv;\r\n  }\r\n  planeCW(loc: number[], width: number, height: number): number[] {\r\n    const left = loc[0];\r\n    const top = loc[1];\r\n    const right = loc[2];\r\n    const bottom = loc[3];\r\n    const uv = [\r\n      right / width,\r\n      bottom / height,\r\n      right / width,\r\n      top / height,\r\n      left / width,\r\n      top / height,\r\n      left / width,\r\n      bottom / height,\r\n    ];\r\n    return uv;\r\n  }\r\n  planeUV(vertices: TextureRenderUnit[], uv: number[]) {\r\n    vertices[0].texture.u = uv[4];\r\n    vertices[0].texture.v = uv[1];\r\n    vertices[2].texture.u = uv[4];\r\n    vertices[2].texture.v = uv[3];\r\n    vertices[1].texture.u = uv[0];\r\n    vertices[1].texture.v = uv[1];\r\n    vertices[3].texture.u = uv[0];\r\n    vertices[3].texture.v = uv[3];\r\n  }\r\n  planeXY(vertices: TextureRenderUnit[]) {\r\n    this.plane(vertices, PlaneType.XY);\r\n  }\r\n  plane(vertices: TextureRenderUnit[], PLANE: PlaneType) {\r\n    switch (PLANE) {\r\n      case PlaneType.XY: {\r\n        vertices[0].vertex.x = -1 / 2;\r\n        vertices[0].vertex.y = -1 / 2;\r\n        vertices[0].normal.z = -1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.y = 1 / 2;\r\n        vertices[1].normal.z = -1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.y = -1 / 2;\r\n        vertices[2].normal.z = -1;\r\n        vertices[3].vertex.x = 1 / 2;\r\n        vertices[3].vertex.y = 1 / 2;\r\n        vertices[3].normal.z = -1;\r\n        break;\r\n      }\r\n      case PlaneType.YX: {\r\n        vertices[0].vertex.x = 1 / 2;\r\n        vertices[0].vertex.y = 1 / 2;\r\n        vertices[0].normal.z = 1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.y = -1 / 2;\r\n        vertices[2].normal.z = 1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.y = 1 / 2;\r\n        vertices[1].normal.z = 1;\r\n        vertices[3].vertex.x = -1 / 2;\r\n        vertices[3].vertex.y = -1 / 2;\r\n        vertices[3].normal.z = 1;\r\n        break;\r\n      }\r\n      case PlaneType.XZ: {\r\n        vertices[0].vertex.x = -1 / 2;\r\n        vertices[0].vertex.z = -1 / 2;\r\n        vertices[0].normal.y = 1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.y = 1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.y = 1;\r\n        vertices[3].vertex.x = 1 / 2;\r\n        vertices[3].vertex.z = 1 / 2;\r\n        vertices[3].normal.y = 1;\r\n        break;\r\n      }\r\n      case PlaneType.ZX: {\r\n        vertices[0].vertex.x = 1 / 2;\r\n        vertices[0].vertex.z = 1 / 2;\r\n        vertices[0].normal.y = -1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.y = -1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.y = -1;\r\n        vertices[3].vertex.x = -1 / 2;\r\n        vertices[3].vertex.z = -1 / 2;\r\n        vertices[3].normal.y = -1;\r\n        break;\r\n      }\r\n      case PlaneType.YZ: {\r\n        vertices[0].vertex.y = -1 / 2;\r\n        vertices[0].vertex.z = -1 / 2;\r\n        vertices[0].normal.x = -1;\r\n        vertices[1].vertex.y = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.x = -1;\r\n        vertices[2].vertex.y = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.x = -1;\r\n        vertices[3].vertex.y = 1 / 2;\r\n        vertices[3].vertex.z = 1 / 2;\r\n        vertices[3].normal.x = -1;\r\n        break;\r\n      }\r\n      case PlaneType.ZY: {\r\n        vertices[0].vertex.y = 1 / 2;\r\n        vertices[0].vertex.z = 1 / 2;\r\n        vertices[0].normal.x = 1;\r\n        vertices[2].vertex.y = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.x = 1;\r\n        vertices[1].vertex.y = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.x = 1;\r\n        vertices[3].vertex.y = -1 / 2;\r\n        vertices[3].vertex.z = -1 / 2;\r\n        vertices[3].normal.x = 1;\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n  circleXYColour(segments: number, colour: Colour): number[] {\r\n    const r = colour.r / 255.0;\r\n    const g = colour.g / 255.0;\r\n    const b = colour.b / 255.0;\r\n    const a = colour.a / 255.0;\r\n    const increment = (2 * Math.PI) / segments;\r\n    const vertices: number[] = [];\r\n    for (let angle = -Math.PI / 2; angle < Math.PI / 2; angle += increment) {\r\n      const x = Math.sin(angle);\r\n      const y = Math.cos(angle);\r\n      vertices.push(x, y, 0);\r\n      vertices.push(r, g, b, a);\r\n      vertices.push(x, -y, 0);\r\n      vertices.push(r, g, b, a);\r\n    }\r\n    return vertices;\r\n  }\r\n}\r\n","import ModelPosition from \"../Core/EngineEntity/ModelPosition\";\r\nimport Physics from \"../Core/Physics/Physics\";\r\nimport EntityManager from \"../Manager/EntityManager\";\r\nimport Coordinate from \"../Core/Data/Coordinate\";\r\nimport Rect3d from \"../Core/Data/Rect3d\";\r\nimport EngineMath from \"../Core/Physics/EngineMath\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\n\r\nclass Moveable extends EntityManager {\r\n  physics: {\r\n    t: Coordinate;\r\n    d: Coordinate;\r\n    v: Coordinate;\r\n    a: Coordinate;\r\n    modelPos: ModelPosition;\r\n    isMoving: boolean;\r\n    collisionSize: Rect3d | undefined;\r\n    bound: Rect3d | undefined;\r\n    simulationId: number | undefined;\r\n    jumpSimulationId: number | undefined;\r\n    gravitySimulationId: number | undefined;\r\n    collisionIteration: number;\r\n    collisionStopItThres: number;\r\n  };\r\n  isBounded: boolean;\r\n  isMoveable: boolean;\r\n  isRotateMove: boolean;\r\n  hasCollision: boolean;\r\n  dampenReduction = 0.0;\r\n  constructor() {\r\n    super();\r\n    this.physics = {\r\n      t: new Coordinate(0, 0, 0),\r\n      d: new Coordinate(0, 0, 0),\r\n      v: new Coordinate(0, 0, 0),\r\n      a: new Coordinate(0, 0, 0),\r\n      modelPos: new ModelPosition(),\r\n      isMoving: false,\r\n      collisionSize: undefined,\r\n      bound: new Rect2d(0, 0, 1.0, 1.0),\r\n      simulationId: undefined,\r\n      jumpSimulationId: undefined,\r\n      gravitySimulationId: undefined,\r\n      collisionIteration: 0,\r\n      collisionStopItThres: 5,\r\n    };\r\n    this.isMoveable = true;\r\n    this.isBounded = true;\r\n    this.hasCollision = true;\r\n  }\r\n  updatePhysicsPosition() {\r\n    this.physics.t.x = this.position.x;\r\n    this.physics.t.y = this.position.y;\r\n    this.physics.t.z = this.position.z;\r\n  }\r\n  updateDeltaDistance(x?: number, y?: number, z?: number) {\r\n    if (x !== undefined) {\r\n      this.physics.d.x = x - this.position.x;\r\n      this.physics.t.x = x;\r\n    } else {\r\n      this.physics.d.x = this.physics.t.x - this.position.x;\r\n    }\r\n    if (y !== undefined) {\r\n      this.physics.d.y = y - this.position.y;\r\n      this.physics.t.y = y;\r\n    } else {\r\n      this.physics.d.y = this.physics.t.y - this.position.y;\r\n    }\r\n    if (z !== undefined) {\r\n      this.physics.d.z = z - this.position.z;\r\n      this.physics.t.z = z;\r\n    } else {\r\n      this.physics.d.z = this.physics.t.z - this.position.z;\r\n    }\r\n  }\r\n\r\n  updateLocBoundToBoundary() {\r\n    const pos = this.physics.collisionSize\r\n      ? this.physics.modelPos.position\r\n      : this.position;\r\n    const boundRect = this.physics.bound ?? new Rect2d(0, 0, 1, 1, 0);\r\n    const coordinate = EngineMath.boundRect(\r\n      boundRect,\r\n      this.physics.collisionSize\r\n        ? this.physics.modelPos.position\r\n        : this.position\r\n    );\r\n    let dx = 0;\r\n    let dy = 0;\r\n    if (pos.x !== coordinate.x) {\r\n      this.physics.v.x = 0;\r\n      dx = coordinate.x - pos.x;\r\n    }\r\n    if (pos.y !== coordinate.y) {\r\n      this.physics.v.y = 0;\r\n      dy = coordinate.y - pos.y;\r\n    }\r\n    this.center(this.position.x + dx, this.position.y + dy, this.position.z);\r\n  }\r\n\r\n  calcTotalDeltaDistance() {\r\n    return Math.sqrt(\r\n      this.physics.d.x * this.physics.d.x +\r\n        this.physics.d.y * this.physics.d.y +\r\n        this.physics.d.z * this.physics.d.z\r\n    );\r\n  }\r\n  translateTo(\r\n    velocity: number,\r\n    dx?: number,\r\n    dy?: number,\r\n    dz?: number,\r\n    complete?: () => void\r\n  ) {\r\n    const directionalModifier =\r\n      dx !== 0 ? 10e-6 * (this.physics.d.x < 0 ? -1 : 1) : 0;\r\n    this.physics.t.x += (dx || 0) + directionalModifier;\r\n    this.physics.t.y += dy || 0;\r\n    this.physics.t.z += dz || 0;\r\n    this.moveTo(\r\n      velocity,\r\n      this.physics.t.x,\r\n      this.physics.t.y,\r\n      this.physics.t.z,\r\n      complete\r\n    );\r\n  }\r\n  shouldTranslate(colliding: ModelPosition[]): boolean {\r\n    return colliding.length === 0;\r\n  }\r\n  moveToTime(\r\n    time: number,\r\n    x?: number,\r\n    y?: number,\r\n    z?: number,\r\n    complete?: () => void\r\n  ) {\r\n    Physics.cancelSimulation(this.physics.simulationId ?? 0, true);\r\n\r\n    if (!this.isMoveable) {\r\n      return;\r\n    }\r\n    const physics = this.physics;\r\n    this.updateDeltaDistance(x, y, z);\r\n\r\n    const totalTime = Math.max(time, 10e-6);\r\n    this.movementRotation(physics.d.x);\r\n\r\n    let completeSim = this.completeSimulation;\r\n    if (complete) {\r\n      completeSim = () => {\r\n        this.completeSimulation();\r\n        complete();\r\n      };\r\n    }\r\n\r\n    physics.simulationId = Physics.runSimulation(\r\n      totalTime,\r\n      this.moveSimulation.bind(this),\r\n      completeSim,\r\n      physics.simulationId\r\n    );\r\n  }\r\n  private movementRotation(dx: number) {\r\n    if (this.isRotateMove) {\r\n      if (dx > 0) {\r\n        this.rotateY(0);\r\n      } else if (dx < 0) {\r\n        this.rotateY(180);\r\n      }\r\n    }\r\n  }\r\n\r\n  moveTo(\r\n    velocity: number,\r\n    x?: number,\r\n    y?: number,\r\n    z?: number,\r\n    complete?: () => void\r\n  ) {\r\n    Physics.cancelSimulation(this.physics.simulationId ?? 0, true);\r\n\r\n    if (!this.isMoveable) {\r\n      return;\r\n    }\r\n    const physics = this.physics;\r\n    this.updateDeltaDistance(x, y, z);\r\n\r\n    const distance = this.calcTotalDeltaDistance();\r\n    const totalTime = distance / velocity;\r\n    this.movementRotation(physics.d.x);\r\n\r\n    let completeSim = this.completeSimulation;\r\n    if (complete) {\r\n      completeSim = () => {\r\n        this.completeSimulation();\r\n        complete();\r\n      };\r\n    }\r\n    physics.simulationId = Physics.runSimulation(\r\n      totalTime,\r\n      this.moveSimulation.bind(this),\r\n      completeSim,\r\n      physics.simulationId\r\n    );\r\n  }\r\n  completeSimulation = () => {\r\n    this.resetPhysics();\r\n  };\r\n  resetPhysics = () => {\r\n    this.physics.t.x = this.position.x;\r\n    this.physics.t.y = this.position.y;\r\n    this.physics.t.z = this.position.z;\r\n    this.physics.d.x = 0;\r\n    this.physics.d.y = 0;\r\n    this.physics.d.z = 0;\r\n    this.physics.isMoving = false;\r\n    this.physics.collisionIteration = 0;\r\n  };\r\n  addDampener(time) {\r\n    const dampeningProp = time / 1000.0;\r\n    const xSign = Math.sign(this.physics.v.x);\r\n    this.physics.v.x -= xSign * this.dampenReduction * dampeningProp;\r\n    if (xSign !== Math.sign(this.physics.v.x)) {\r\n      this.physics.v.x = 0;\r\n    }\r\n    const ySign = Math.sign(this.physics.v.y);\r\n    this.physics.v.y -= ySign * this.dampenReduction * dampeningProp;\r\n    if (ySign !== Math.sign(this.physics.v.y)) {\r\n      this.physics.v.y = 0;\r\n    }\r\n\r\n    if (Math.abs(this.physics.v.x) < 10e-6) {\r\n      this.physics.v.x = 0;\r\n    }\r\n    if (Math.abs(this.physics.v.y) < 10e-6) {\r\n      this.physics.v.y = 0;\r\n    }\r\n  }\r\n  addImpulse(acceleration: Coordinate, contactTime: number) {\r\n    this.physics.v.x += acceleration.x * contactTime;\r\n    this.physics.v.y += acceleration.y * contactTime;\r\n  }\r\n  setVelocity(velocity: Coordinate) {\r\n    this.physics.v.x = velocity.x;\r\n    this.physics.v.y = velocity.y;\r\n  }\r\n  runPhysicsSimulation(\r\n    simulationId: number,\r\n    totalTime: number = Physics.TIME_STEP_MILLIS * 2.0\r\n  ) {\r\n    Physics.runSimulation(\r\n      totalTime,\r\n      this.physicSimulation,\r\n      this.completeSimulation,\r\n      simulationId\r\n    );\r\n  }\r\n  physicSimulation = (simulationId: number, time: number, _: number) => {\r\n    const physics = this.physics;\r\n    physics.isMoving = true;\r\n\r\n    let dx = physics.v.x * time;\r\n    let dy = physics.v.y * time;\r\n\r\n    let model: ModelPosition = this;\r\n    if (physics.collisionSize) {\r\n      physics.modelPos.setRect(physics.collisionSize);\r\n      physics.modelPos.$physicsId = this.$physicsId;\r\n      model = physics.modelPos;\r\n    }\r\n    const [_dx, _dy, collision] = this.resolveCollision(model, dx, dy);\r\n    if (this.shouldTranslate(collision)) {\r\n      physics.collisionIteration = 0;\r\n    } else {\r\n      this.addDampener(time);\r\n      dx = _dx;\r\n      dy = _dy;\r\n      physics.collisionIteration++;\r\n      if (physics.collisionIteration > physics.collisionStopItThres) {\r\n        this.cancelSimulation(simulationId);\r\n      }\r\n    }\r\n\r\n    this.movementRotation(physics.v.x);\r\n\r\n    this.translate(dx, dy, 0);\r\n    if (physics.collisionSize) {\r\n      physics.modelPos.translate(dx, dy, 0);\r\n      physics.collisionSize.x += dx;\r\n      physics.collisionSize.y += dy;\r\n    }\r\n    if (this.isBounded) {\r\n      this.updateLocBoundToBoundary();\r\n    }\r\n\r\n    this.completePhysicsIteration(time);\r\n  };\r\n\r\n  completePhysicsIteration(_: number) {}\r\n\r\n  private resolveCollision(\r\n    model: ModelPosition,\r\n    dx: number,\r\n    dy: number\r\n  ): [number, number, ModelPosition[]] {\r\n    if (this.hasCollision) {\r\n      return Physics.isCollidingResolve(model, dx, dy);\r\n    } else {\r\n      return [dx, dy, []];\r\n    }\r\n  }\r\n\r\n  private cancelSimulation(simulationId: number) {\r\n    const simulation = Physics.simulations[simulationId];\r\n    if (simulation?.completeSimulation) {\r\n      simulation.completeSimulation();\r\n    }\r\n    Physics.cancelSimulation(simulationId);\r\n  }\r\n\r\n  moveSimulation(simulationId: number, time: number, totalRunTime: number) {\r\n    if (Math.abs(totalRunTime) < 10e-6) {\r\n      return;\r\n    }\r\n    const physics = this.physics;\r\n    physics.isMoving = true;\r\n    const propTime = Math.min(1.0, time / totalRunTime);\r\n\r\n    const dx = physics.d.x * propTime;\r\n    const dy = physics.d.y * propTime;\r\n    const dz = physics.d.z * propTime;\r\n\r\n    this.translateCollision(simulationId, dx, dy, dz);\r\n    this.completePhysicsIteration(time);\r\n  }\r\n\r\n  translateCollision(simulationId: number, dx: number, dy: number, dz: number) {\r\n    const physics = this.physics;\r\n    let model: ModelPosition = this;\r\n    if (physics.collisionSize) {\r\n      physics.modelPos.setRect(physics.collisionSize);\r\n      physics.modelPos.$physicsId = this.$physicsId;\r\n      model = physics.modelPos;\r\n    }\r\n    const colliding = Physics.isCollidingOffset2d(model, dx, dy);\r\n    if (this.shouldTranslate(colliding)) {\r\n      this.translate(dx, dy, dz);\r\n      if (physics.collisionSize) {\r\n        physics.modelPos.translate(dx, dy, 0);\r\n        physics.collisionSize.x += dx;\r\n        physics.collisionSize.y += dy;\r\n      }\r\n      if (this.isBounded) {\r\n        this.updateLocBoundToBoundary();\r\n      }\r\n      this.physics.collisionIteration = 0;\r\n    } else {\r\n      this.physics.collisionIteration++;\r\n      if (this.physics.collisionIteration > this.physics.collisionStopItThres) {\r\n        this.cancelSimulation(simulationId);\r\n      }\r\n    }\r\n  }\r\n\r\n  setMoveable(isMoving: boolean) {\r\n    this.isMoveable = isMoving;\r\n  }\r\n\r\n  copyTexture(obj: EngineObject) {\r\n    this.shaderEntity ? super.copyTexture(obj) : undefined;\r\n    this.entities.forEach((entity) => entity.copyTexture(obj));\r\n  }\r\n}\r\n\r\nexport default Moveable;\r\n","import Coordinate from \"./Coordinate\";\r\n\r\nexport class TextureUnit {\r\n  u = 0.0;\r\n  v = 0.0;\r\n}\r\n\r\nexport class Colour {\r\n  r = 0.0;\r\n  g = 0.0;\r\n  b = 0.0;\r\n  a = 0.0;\r\n}\r\n\r\nexport class RenderUnit {\r\n  vertex: Coordinate = new Coordinate(0, 0, 0);\r\n}\r\n\r\nexport class TextureRenderUnit extends RenderUnit {\r\n  texture: TextureUnit = new TextureUnit();\r\n  normal: Coordinate = new Coordinate(0, 0, 0);\r\n}\r\n\r\nexport class ColourRenderUnit extends RenderUnit {\r\n  colour: Colour = new Colour();\r\n}\r\n","export class Subscription {\r\n  key: string;\r\n\r\n  constructor(key: string) {\r\n    this.key = key;\r\n  }\r\n}\r\n\r\nexport class SubscriptionListeners extends Subscription {\r\n  listeners: { [key: number]: (data: any) => void } = {};\r\n  subscriptionId = 0;\r\n\r\n  constructor(key: string) {\r\n    super(key);\r\n  }\r\n\r\n  listen(callback: (data: any) => void): number {\r\n    this.listeners[this.subscriptionId++] = callback;\r\n    return this.subscriptionId - 1;\r\n  }\r\n\r\n  unlisten(subscriptionId: number) {\r\n    delete this.listeners[subscriptionId];\r\n  }\r\n\r\n  publish(data: any) {\r\n    Object.values(this.listeners).forEach((listener) => listener(data));\r\n  }\r\n\r\n  flush() {\r\n    this.listeners = {};\r\n  }\r\n}\r\n\r\nclass SubscriberPool {\r\n  subscribers: { [key: string]: SubscriptionListeners };\r\n\r\n  constructor() {\r\n    this.subscribers = {};\r\n  }\r\n\r\n  listen(subscription: Subscription, callback: (data: any) => void): number {\r\n    return this.getSubscriptionListeners(subscription).listen(callback);\r\n  }\r\n\r\n  getSubscriptionListeners(subscription: Subscription) {\r\n    const key = subscription.key;\r\n    if (!this.subscribers[key]) {\r\n      this.subscribers[key] = new SubscriptionListeners(key);\r\n    }\r\n    return this.subscribers[key];\r\n  }\r\n\r\n  publish(subscription: Subscription, data?: any) {\r\n    this.getSubscriptionListeners(subscription).publish(data);\r\n  }\r\n}\r\n\r\nexport default SubscriberPool;\r\n","import Rect3d from \"../Core/Data/Rect3d\";\r\nimport TextureVertexModel from \"../Core/Data/TextureVertexModel\";\r\nimport ModelObject3d from \"../Core/EngineEntity/ModelObject3d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class Object3d extends ModelObject3d {\r\n  vertexUvCacheId: string;\r\n  constructor(rect: Rect3d, vertexUvCacheId: string) {\r\n    super(rect, new TextureVertexModel());\r\n    this.vertexUvCacheId = vertexUvCacheId;\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = engineHelper.newVertexModelUv3d(this.vertexUvCacheId);\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n","export default class PlaneType {\r\n  static XY = new PlaneType(\"XY\", 0, 0, 0, 0);\r\n  static YX = new PlaneType(\"YX\", 0, 0, 0, 0);\r\n  static XZ = new PlaneType(\"XZ\", 0, 0, 0, 0);\r\n  static ZX = new PlaneType(\"ZX\", 0, 0, 0, 0);\r\n  static YZ = new PlaneType(\"YZ\", 0, 0, 0, 0);\r\n  static ZY = new PlaneType(\"ZY\", 0, 0, 0, 0);\r\n  static BACKWARDS = -1;\r\n  static FORWARD = 1;\r\n\r\n  name: string;\r\n  width: number;\r\n  height: number;\r\n  length: number;\r\n  normalDirection: number;\r\n\r\n  constructor(\r\n    name: string,\r\n    width: number,\r\n    height: number,\r\n    length: number,\r\n    normalDirection: number\r\n  ) {\r\n    this.name = name;\r\n    this.width = width;\r\n    this.height = height;\r\n    this.length = length;\r\n    this.normalDirection = normalDirection;\r\n  }\r\n}\r\n","import Rect2d from \"../Data/Rect2d\";\r\n\r\nclass Position extends Rect2d {\r\n  x = 0;\r\n  y = 0;\r\n  z = 0;\r\n  ax = 0;\r\n  ay = 0;\r\n  az = 0;\r\n  nx = 0;\r\n  ny = 0;\r\n  nz = 0;\r\n  width = 0;\r\n  height = 0;\r\n  length = 0;\r\n  scaleX = 1;\r\n  scaleY = 1;\r\n  scaleZ = 1;\r\n  originX = 0;\r\n  originY = 0;\r\n  originZ = 0;\r\n  maxHeight = 0;\r\n  maxWidth = 0;\r\n  constructor() {\r\n    super(0, 0, 0, 0, 0);\r\n  }\r\n}\r\n\r\nexport default Position;\r\n","import EntityManager from \"../../Manager/EntityManager\";\r\nimport Texture from \"../Buffer/Texture\";\r\nimport Timer from \"../Common/Timer\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport FontMetaData, { FontCharacter } from \"../Data/FontMetaData\";\r\nimport PlaneType from \"../Data/PlaneType\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\nimport { EngineEntity } from \"../EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"../EngineEntity/EngineObjectHelper\";\r\nimport ModelObject2d from \"../EngineEntity/ModelObject2d\";\r\nimport ModelPosition from \"../EngineEntity/ModelPosition\";\r\nimport { ShaderEntity } from \"../EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { RendererNotification } from \"../Renderer\";\r\n\r\nclass FontChar extends ModelObject2d {\r\n  fontChar: FontCharacter;\r\n  constructor(\r\n    fontChar: FontCharacter,\r\n    rect: Rect2d,\r\n    vertexModel: TextureVertexModel\r\n  ) {\r\n    super(rect, vertexModel);\r\n    this.fontChar = fontChar;\r\n  }\r\n}\r\n\r\nclass RenderFont {\r\n  shaderEntity?: ShaderEntity;\r\n  font?: FontChar;\r\n  displayTime?: number;\r\n  timer: Timer;\r\n  id: number;\r\n  modelPos: ModelPosition;\r\n  repeat = false;\r\n  static $id = 0;\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    if (this.isRepeat() && !this.repeat) {\r\n      return;\r\n    } else {\r\n      this.repeat = false;\r\n    }\r\n    if (this.shaderEntity) {\r\n      engineHelper.render(this.shaderEntity);\r\n    }\r\n  }\r\n\r\n  expire() {\r\n    this.displayTime = -1;\r\n    this.shaderEntity = undefined;\r\n    this.font = undefined;\r\n  }\r\n\r\n  isExpired() {\r\n    return (\r\n      this.displayTime !== undefined &&\r\n      !this.isRepeat() &&\r\n      this.displayTime < this.timer.peak()\r\n    );\r\n  }\r\n\r\n  refresh() {\r\n    this.repeat = true;\r\n  }\r\n\r\n  isRepeat() {\r\n    return this.displayTime === 0;\r\n  }\r\n\r\n  constructor(font: FontChar, fontPos: Rect2d, time?: number) {\r\n    this.newFont(font, fontPos, time);\r\n  }\r\n\r\n  newFont(font: FontChar, fontPos: Rect2d, time?: number) {\r\n    this.font = font;\r\n    this.displayTime = time;\r\n    this.timer = this.timer ? this.timer : new Timer();\r\n    this.timer.start();\r\n    this.id = this.id ? this.id : RenderFont.$id++;\r\n\r\n    this.shaderEntity = font.shaderEntity.shallowCopy();\r\n    const pos = new ModelPosition();\r\n    pos.centerRect(fontPos);\r\n    pos.rotateOriginRect(fontPos);\r\n    pos.rotateZ(180);\r\n    pos.scaleRect(fontPos);\r\n    this.shaderEntity.model = pos.getModel;\r\n    this.shaderEntity.modelPosition = () => pos.position;\r\n    this.modelPos = pos;\r\n  }\r\n}\r\n\r\nclass FontManager extends EntityManager {\r\n  metaData: FontMetaData;\r\n  fontBitmap: Texture;\r\n  fonts: { [key: number]: FontChar };\r\n  renderFontPool: RenderFont[];\r\n  renderFontState: { [key: number]: RenderFont };\r\n  avgWidth: number;\r\n  avgHeight: number;\r\n  count: number;\r\n\r\n  constructor(metaData: FontMetaData) {\r\n    super();\r\n    this.metaData = metaData;\r\n    this.fonts = {};\r\n    this.renderFontState = {};\r\n    this.renderFontPool = [];\r\n    this.avgWidth = 0;\r\n    this.avgHeight = 0;\r\n    this.count = 0;\r\n  }\r\n\r\n  getFont(charCode: number): FontChar {\r\n    return this.fonts[charCode];\r\n  }\r\n\r\n  createRender(font: FontChar, fontPos: Rect2d, time?: number): RenderFont {\r\n    let renderFont: RenderFont;\r\n    if (this.renderFontPool.length > 0) {\r\n      renderFont = this.renderFontPool.pop()!;\r\n      renderFont.newFont(font, fontPos, time);\r\n    } else {\r\n      renderFont = new RenderFont(font, fontPos, time);\r\n    }\r\n    this.renderFontState[renderFont.id] = renderFont;\r\n    return renderFont;\r\n  }\r\n\r\n  refreshExpired() {\r\n    Object.values(this.renderFontState).forEach((font) => {\r\n      if (font.isExpired()) {\r\n        delete this.renderFontState[font.id];\r\n        this.renderFontPool.push(font);\r\n      }\r\n    });\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    this.refreshExpired();\r\n    super.update(engineHelper);\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    const fonts = Object.values(this.renderFontState);\r\n    fonts.forEach((r) => r.render(engineHelper));\r\n    this.count = fonts.length;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const context = this.metaData.context;\r\n    const fonts = context.fonts;\r\n    const defaultRect = new Rect2d(0.5, 0.5, 1.0, 1.0, 1.0);\r\n    let totalWidth = 0.0;\r\n    let totalHeight = 0.0;\r\n    let totalNo = 0;\r\n    for (const fontIdx in fonts) {\r\n      const fontChar = fonts[fontIdx];\r\n      const pos = [\r\n        fontChar.x,\r\n        fontChar.y,\r\n        fontChar.x + fontChar.width,\r\n        fontChar.y + fontChar.height,\r\n      ];\r\n      const uvs = EngineObjectHelper.vertex.planeCW(\r\n        pos,\r\n        context.width,\r\n        context.height\r\n      );\r\n      const vertexModel = engineHelper.createPlaneVertexModel(\r\n        context.filename,\r\n        uvs,\r\n        PlaneType.YX\r\n      );\r\n      const font = new FontChar(fontChar, defaultRect, vertexModel);\r\n      this.fonts[fontChar.charCode] = font;\r\n      this.entities.push(font);\r\n\r\n      totalWidth += fontChar.width;\r\n      totalHeight += fontChar.height;\r\n      totalNo += 1;\r\n    }\r\n\r\n    this.avgHeight = totalHeight / totalNo;\r\n    this.avgWidth = totalWidth / totalNo;\r\n\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n\r\nexport class FontReference {\r\n  $id: number;\r\n  id?: string;\r\n  _hidden: boolean;\r\n  prevText?: string;\r\n  prevPos: Coordinate;\r\n  pos: Coordinate;\r\n  text: string;\r\n  fontSize: number;\r\n  width: number;\r\n  time?: number;\r\n  $cacheId?: number | string;\r\n  isDirtyPos: boolean;\r\n  isDirtyText: boolean;\r\n  isTop: boolean;\r\n  displayRect: Rect2d;\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.writeFont(this);\r\n  }\r\n  static newFont(\r\n    pos: Coordinate,\r\n    cacheId?: number | string,\r\n    time?: number\r\n  ): FontReference {\r\n    const ref = new FontReference();\r\n    ref.displayRect = new Rect2d(0, 0, 0, 0);\r\n    ref.pos = pos;\r\n    ref.time = time;\r\n    ref.$cacheId = cacheId;\r\n    ref.isDirtyPos = false;\r\n    ref.isDirtyText = false;\r\n    return ref;\r\n  }\r\n  setTop(isTop: boolean): FontReference {\r\n    this.isTop = isTop;\r\n    return this;\r\n  }\r\n  translate(dx: number, dy: number): FontReference {\r\n    this.pos.x += dx;\r\n    this.pos.y += dy;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  center(x: number, y: number): FontReference {\r\n    this.pos.x = x;\r\n    this.pos.y = y;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  setPosition(position: Coordinate): FontReference {\r\n    this.pos = new Coordinate(position.x, position.y);\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  setWidth(width: number): FontReference {\r\n    this.width = width;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  setText(text: string): FontReference {\r\n    if (this._hidden) {\r\n      this.prevText = text;\r\n      this.text = \"\";\r\n    } else {\r\n      this.text = text;\r\n      this.prevText = \"\";\r\n    }\r\n    this.isDirtyText = true;\r\n    return this;\r\n  }\r\n  setFontSize(fontSize: number): FontReference {\r\n    this.fontSize = fontSize;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  set hidden(hidden: boolean) {\r\n    if (!this._hidden && hidden) {\r\n      this.prevText = this.text;\r\n      this.text = \"\";\r\n      this.isDirtyText = true;\r\n    } else if (this._hidden && !hidden) {\r\n      this.text = this.prevText ?? \"\";\r\n      this.prevText = \"\";\r\n      this.isDirtyText = true;\r\n    }\r\n    this._hidden = hidden;\r\n  }\r\n}\r\n\r\nclass Font implements EngineEntity {\r\n  $id: string;\r\n  fontManager: FontManager;\r\n  static MAX_FONT = 1000;\r\n  static DefaultFont: Font;\r\n  warningShown = false;\r\n  fontCache: { [key: string]: RenderFont[] };\r\n  fontCacheId = 1;\r\n  engineHelper: EngineHelper;\r\n  fontRefCache: { [key: string]: FontReference };\r\n\r\n  private static readonly pixelDensity = 400.0;\r\n\r\n  constructor(metaData: FontMetaData) {\r\n    this.fontManager = new FontManager(metaData);\r\n    this.fontCache = {};\r\n    this.fontRefCache = {};\r\n    if (!Font.DefaultFont) {\r\n      Font.DefaultFont = this;\r\n    }\r\n  }\r\n\r\n  event(): boolean | undefined {\r\n    return;\r\n  }\r\n  update(engineHelper: EngineHelper) {\r\n    if (\r\n      engineHelper.notificationQueue.peak(\r\n        RendererNotification.RESIZE_SCREEN.key\r\n      )\r\n    ) {\r\n      Object.values(this.fontRefCache).forEach(this.expireRenderFont);\r\n      Object.values(this.fontRefCache).forEach(\r\n        (font) => (font.isDirtyText = true)\r\n      );\r\n      this.fontManager.refreshExpired();\r\n      Object.values(this.fontRefCache).forEach(this.writeRef);\r\n    }\r\n    this.fontManager.update(engineHelper);\r\n  }\r\n\r\n  expireRenderFont = (fontRef: FontReference) => {\r\n    this.fontCache[fontRef.$id].forEach((f) => f.expire());\r\n    this.fontCache[fontRef.$id] = [];\r\n  };\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.fontManager.render(engineHelper);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    this.fontManager.init(engineHelper);\r\n  }\r\n\r\n  writeRef = (fontRef: FontReference): FontReference => {\r\n    if (this.fontManager.count > Font.MAX_FONT) {\r\n      if (!this.warningShown) {\r\n        this.warningShown = true;\r\n        console.warn(\"Maximum font is being rendered\", this.fontManager.count);\r\n      }\r\n    }\r\n    if (!fontRef.fontSize) {\r\n      if (!fontRef.width) {\r\n        if (!this.warningShown) {\r\n          this.warningShown = true;\r\n          console.warn(\r\n            \"Either font size or width needs to be set in FontReference\"\r\n          );\r\n        }\r\n        return fontRef;\r\n      }\r\n      if (!fontRef.text) {\r\n        if (!this.warningShown) {\r\n          this.warningShown = true;\r\n          console.warn(\r\n            \"Font text must be set to calculate font size to fit width\"\r\n          );\r\n        }\r\n        return fontRef;\r\n      }\r\n      fontRef.fontSize = this.calculateFontSize(\r\n        fontRef.width,\r\n        fontRef.text.length\r\n      );\r\n    } else if (!fontRef.width) {\r\n      fontRef.width = this.calcTotalTextWidth(fontRef);\r\n    }\r\n\r\n    if (fontRef.isDirtyText && fontRef.$id) {\r\n      this.expireRenderFont(fontRef);\r\n    }\r\n\r\n    if (!fontRef.$id || fontRef.isDirtyText) {\r\n      if (!fontRef.$id) {\r\n        fontRef.$id = this.fontCacheId++;\r\n      }\r\n      fontRef.isDirtyText = false;\r\n      fontRef.isDirtyPos = false;\r\n      fontRef.prevPos = new Coordinate(fontRef.pos.x, fontRef.pos.y);\r\n\r\n      const fonts = this.createFonts(fontRef);\r\n      this.fontCache[fontRef.$id] = fonts;\r\n      this.fontRefCache[fontRef.$id] = fontRef;\r\n    } else if (fontRef.isDirtyPos) {\r\n      const fonts = this.fontCache[fontRef.$id];\r\n      const fontPos = fontRef.pos;\r\n      if (!fontRef.prevPos) {\r\n        fontRef.prevPos = new Coordinate(fontRef.pos.x, fontRef.pos.y);\r\n      }\r\n      const dx = fontRef.prevPos.x - fontPos.x;\r\n      const dy = fontRef.prevPos.y - fontPos.y;\r\n      fonts.forEach((font) => {\r\n        const modelPos = font.modelPos;\r\n        modelPos.translate(-dx, -dy, 0);\r\n        modelPos.rotateOrigin(\r\n          modelPos.position.x,\r\n          modelPos.position.y,\r\n          modelPos.position.z\r\n        );\r\n      });\r\n\r\n      fontRef.isDirtyPos = false;\r\n      fontRef.prevPos.x = fontRef.pos.x;\r\n      fontRef.prevPos.y = fontRef.pos.y;\r\n    }\r\n    this.fontCache[fontRef.$id].forEach((font) => {\r\n      font.refresh();\r\n      font.shaderEntity!.isTop = fontRef.isTop;\r\n    });\r\n    return fontRef;\r\n  };\r\n\r\n  calcTotalTextWidth(fontRef: FontReference) {\r\n    const text = fontRef.text;\r\n    const fontSize = fontRef.fontSize / Font.pixelDensity;\r\n    let carryWidth = 0;\r\n    for (let charIdx = 0; charIdx < text.length; charIdx++) {\r\n      const charCode = text.charCodeAt(charIdx);\r\n      const font = this.fontManager.getFont(charCode);\r\n      const height = fontSize;\r\n      const fontRatio =\r\n        Math.abs(font.fontChar.height) < 10e-6\r\n          ? 0.0\r\n          : font.fontChar.width / font.fontChar.height;\r\n      const width = height * fontRatio;\r\n      carryWidth += width;\r\n    }\r\n    return carryWidth;\r\n  }\r\n\r\n  calculateFontSize(width: number, length: number): number {\r\n    const fontRatio =\r\n      Math.abs(this.fontManager.avgHeight) < 10e-6\r\n        ? 0.0\r\n        : this.fontManager.avgWidth / this.fontManager.avgHeight;\r\n    const widthFactor = 3;\r\n    return ((width / fontRatio) * Font.pixelDensity) / length / widthFactor;\r\n  }\r\n\r\n  createFonts(fontRef: FontReference): RenderFont[] {\r\n    const pos = fontRef.pos;\r\n    const time = fontRef.time;\r\n    const text = fontRef.text;\r\n    const fontSize = Font.fontHeight(fontRef.fontSize);\r\n    const totalWidth = this.calcTotalTextWidth(fontRef);\r\n    let maxHeight = 0;\r\n    let carryWidth = -totalWidth / 2.0;\r\n    const fonts: RenderFont[] = [];\r\n    for (let charIdx = 0; charIdx < text.length; charIdx++) {\r\n      const charCode = text.charCodeAt(charIdx);\r\n      const font = this.fontManager.getFont(charCode);\r\n      const fontChar = font.fontChar;\r\n      const height = fontSize;\r\n      maxHeight = Math.max(maxHeight, height);\r\n      const fontRatio =\r\n        Math.abs(fontChar.height) < 10e-6\r\n          ? 0.0\r\n          : fontChar.width / fontChar.height;\r\n      const width = height * fontRatio;\r\n      carryWidth += width;\r\n      const fontPos = new Rect2d(\r\n        pos.x + carryWidth - width / 2.0 - fontChar.xOffset / 2.0,\r\n        pos.y + height / 2.0 - fontChar.yOffset / 2.0,\r\n        width,\r\n        height,\r\n        -1 * pos.z\r\n      );\r\n      const renderFont = this.fontManager.createRender(font, fontPos, time);\r\n      fonts.push(renderFont);\r\n    }\r\n\r\n    fontRef.displayRect.x = pos.x;\r\n    fontRef.displayRect.y = pos.y;\r\n    fontRef.displayRect.width = carryWidth;\r\n    fontRef.displayRect.height = maxHeight;\r\n\r\n    return fonts;\r\n  }\r\n\r\n  static fontHeight(fontSize: number) {\r\n    return fontSize / Font.pixelDensity;\r\n  }\r\n}\r\n\r\nexport default Font;\r\n","import { TextureRenderUnit } from \"./RenderUnit\";\r\nimport VertexModel from \"./VertexModel\";\r\nimport ModelData from \"./ModelData\";\r\nimport EngineObjectHelper from \"../EngineEntity/EngineObjectHelper\";\r\n\r\nclass TextureVertexModel extends VertexModel {\r\n  vertexBufferId: number;\r\n  renderUnits: TextureRenderUnit[];\r\n  textureSource: string;\r\n  createRenderUnits(count: number): TextureVertexModel {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < count; index++) {\r\n      this.renderUnits.push(new TextureRenderUnit());\r\n    }\r\n    return this;\r\n  }\r\n  fillRenderUnits(values: number[]) {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < values.length; index += 8) {\r\n      const renderUnit = new TextureRenderUnit();\r\n      renderUnit.vertex.x = values[index];\r\n      renderUnit.vertex.y = values[index + 1];\r\n      renderUnit.vertex.z = values[index + 2];\r\n      renderUnit.normal.x = values[index + 3];\r\n      renderUnit.normal.y = values[index + 4];\r\n      renderUnit.normal.z = values[index + 5];\r\n      renderUnit.texture.u = values[index + 6];\r\n      renderUnit.texture.v = values[index + 7];\r\n      this.renderUnits.push(renderUnit);\r\n    }\r\n    return this;\r\n  }\r\n  createModel(): ModelData {\r\n    const model = new ModelData();\r\n    model.vertices = EngineObjectHelper.vertex.toTextureArray(this.renderUnits);\r\n    return model;\r\n  }\r\n}\r\nexport default TextureVertexModel;\r\n","import ModelPosition from \"./ModelPosition\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { EngineEvent } from \"../Events\";\r\nimport { ShaderEntity } from \"./ShaderEntity\";\r\nimport { generateId } from \"../Common/IdGenerator\";\r\nimport Feature from \"./Feature\";\r\n\r\nabstract class EngineObject extends ModelPosition implements EngineEntity {\r\n  private $hidden = false;\r\n  data: object;\r\n  $id: string = generateId();\r\n  isLowPriority: boolean = false;\r\n  features: Feature[] = [];\r\n  copyTexture(obj: EngineObject) {\r\n    this.shaderEntity.rendererTextureRef = obj.shaderEntity.rendererTextureRef;\r\n    this.shaderEntity.vertexModel = obj.shaderEntity.vertexModel;\r\n    this.shaderEntity.rendererBufferId = obj.shaderEntity.rendererBufferId;\r\n  }\r\n  set shaderEntity(shaderEntity: ShaderEntity) {\r\n    this._shaderEntity = shaderEntity;\r\n    this._shaderEntity.isTop = this.isTop;\r\n    this._shaderEntity.clone = this.clone;\r\n  }\r\n  get shaderEntity(): ShaderEntity {\r\n    if (\r\n      this._shaderEntity !== undefined &&\r\n      this._shaderEntity.hidden !== this.$hidden\r\n    ) {\r\n      this._shaderEntity.hidden = this.$hidden;\r\n    }\r\n    return this._shaderEntity;\r\n  }\r\n  private _shaderEntity: ShaderEntity;\r\n  type?: string | number;\r\n  clone = false;\r\n  isTop = false;\r\n  isLastEvent = false;\r\n  get hidden(): boolean {\r\n    return this.$hidden;\r\n  }\r\n  set hidden(value: boolean) {\r\n    this.setHidden(value);\r\n  }\r\n  addFeature(feature: Feature): void {\r\n    feature.init(this);\r\n    this.features.push(feature);\r\n  }\r\n  setHidden(value: boolean) {\r\n    this.$hidden = value;\r\n    if (this.shaderEntity) {\r\n      this.shaderEntity.hidden = value;\r\n    }\r\n  }\r\n  setTop(isTop: boolean) {\r\n    this.isTop = isTop;\r\n    if (!this.shaderEntity) return;\r\n    this.shaderEntity.isTop = isTop;\r\n  }\r\n  setClone(clone: boolean) {\r\n    this.clone = clone;\r\n    if (!this.shaderEntity) return;\r\n    this.shaderEntity.clone = clone;\r\n  }\r\n  update(engineHelper: EngineHelper) {\r\n    this.features.forEach(feature => feature.update(this, engineHelper));\r\n  }\r\n  render(engineHelper: EngineHelper) {}\r\n  event(event: EngineEvent, engineHelper: EngineHelper): boolean | undefined {\r\n    return;\r\n  }\r\n  init(engineHelper: EngineHelper) {}\r\n}\r\n\r\nexport interface EngineEntity {\r\n  $id: string;\r\n  update(engineHelper: EngineHelper): void;\r\n  render(engineHelper: EngineHelper): void;\r\n  event(event: EngineEvent, engineHelper: EngineHelper): boolean | undefined;\r\n  init(engineHelper: EngineHelper): void;\r\n}\r\n\r\nexport default EngineObject;\r\n","import { mat4, vec3 } from \"gl-matrix\";\r\n\r\nexport interface LightOptions {\r\n  pos: number[];\r\n  in: number[];\r\n  ambientCoeff: number;\r\n  attenuation: number;\r\n  at: number[];\r\n  up?: vec3;\r\n}\r\n\r\nexport default class Light {\r\n  pos: number[];\r\n  in: number[];\r\n  ambientCoeff: number;\r\n  attenuation: number;\r\n  at: number[];\r\n  up: vec3;\r\n\r\n  constructor(options: LightOptions) {\r\n    this.pos = options.pos;\r\n    this.in = options.in;\r\n    this.attenuation = options.attenuation;\r\n    this.ambientCoeff = options.ambientCoeff;\r\n    this.at = options.at;\r\n  }\r\n\r\n  vecZero(vec: vec3) {\r\n    return vec3.equals(vec, vec3.fromValues(0, 0, 0));\r\n  }\r\n\r\n  parellelVec(vec1: vec3, vec2: vec3) {\r\n    return (\r\n      this.vecZero(vec1) !== true &&\r\n      this.vecZero(vec2) !== true &&\r\n      vec3.equals(\r\n        vec3.normalize(vec3.create(), vec1),\r\n        vec3.normalize(vec3.create(), vec2)\r\n      ) === true\r\n    );\r\n  }\r\n\r\n  perpVec(vec: vec3) {\r\n    let perp = vec3.fromValues(1.0, 0.0, 0.0);\r\n    if (this.parellelVec(vec, perp) === true) {\r\n      perp = vec3.fromValues(0.0, 0.0, 1.0);\r\n    }\r\n    return perp;\r\n  }\r\n\r\n  posVec() {\r\n    return vec3.fromValues(this.pos[0], this.pos[1], this.pos[2]);\r\n  }\r\n\r\n  atVec() {\r\n    return vec3.fromValues(this.at[0], this.at[1], this.at[2]);\r\n  }\r\n\r\n  lookAt() {\r\n    const pos = this.posVec();\r\n    const at = this.atVec();\r\n    let atCross = at;\r\n    let posCross = pos;\r\n\r\n    if (this.parellelVec(pos, at) === true) {\r\n      atCross = this.perpVec(pos);\r\n    } else {\r\n      if (this.vecZero(pos) === true) {\r\n        posCross = this.perpVec(at);\r\n      }\r\n      if (this.vecZero(at) === true) {\r\n        atCross = this.perpVec(pos);\r\n      }\r\n    }\r\n    this.up = vec3.cross(vec3.create(), posCross, atCross);\r\n    return mat4.lookAt(mat4.create(), pos, at, this.up);\r\n  }\r\n}\r\n","export default class BaseProgram {\r\n  program: WebGLProgram;\r\n  ctx: WebGLRenderingContext;\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n  }\r\n\r\n  compileShaders(\r\n    vertexShaderContent: string,\r\n    fragmentShaderContent: string\r\n  ): WebGLProgram {\r\n    const ctx = this.ctx;\r\n    const vertexShader = ctx.createShader(ctx.VERTEX_SHADER);\r\n    const fragmentShader = ctx.createShader(ctx.FRAGMENT_SHADER);\r\n\r\n    if (!vertexShader || !fragmentShader) {\r\n      throw new Error(\"Unable to create vertex or fragment shader\");\r\n    }\r\n\r\n    const fragmentChar = fragmentShaderContent;\r\n    const vertexChar = vertexShaderContent;\r\n\r\n    ctx.shaderSource(vertexShader, vertexChar);\r\n    ctx.compileShader(vertexShader);\r\n\r\n    ctx.shaderSource(fragmentShader, fragmentChar);\r\n    ctx.compileShader(fragmentShader);\r\n\r\n    if (!ctx.getShaderParameter(vertexShader, ctx.COMPILE_STATUS)) {\r\n      const error = \"could not compile vertex shader:\" + ctx.getShaderInfoLog(vertexShader);\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n\r\n    if (!ctx.getShaderParameter(fragmentShader, ctx.COMPILE_STATUS)) {\r\n      const error = \"could not compile fragment shader:\" + ctx.getShaderInfoLog(fragmentShader);\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n\r\n    const program: WebGLProgram = ctx.createProgram()!;\r\n    ctx.attachShader(program, vertexShader);\r\n    ctx.attachShader(program, fragmentShader);\r\n    ctx.linkProgram(program);\r\n\r\n    ctx.validateProgram(program);\r\n\r\n    if (!ctx.getProgramParameter(program, ctx.LINK_STATUS)) {\r\n      const error = \"Link failed: \" + ctx.getProgramInfoLog(program);\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n\r\n    console.log('Shader program compiled successfully');\r\n    return program;\r\n  }\r\n\r\n  delete() {\r\n    this.ctx.deleteProgram(this.program);\r\n  }\r\n\r\n  _bindProgram(program: WebGLProgram) {\r\n    this.ctx.useProgram(program);\r\n  }\r\n  _unbindProgram() {}\r\n}\r\n","import Coordinate from \"./Data/Coordinate\";\r\nimport { WebGLContainer } from \"./App\";\r\n\r\nexport type EngineEventCallback = (EngineEvent) => boolean;\r\n\r\nexport interface EngineEvent {\r\n  x: number;\r\n  y: number;\r\n  dx: number;\r\n  dy: number;\r\n  dxRaw: number;\r\n  dyRaw: number;\r\n  eventType: number;\r\n  prevEventType: number;\r\n  timeStamp: number;\r\n  prevTimeStamp: number;\r\n  orientationQuaternion: number[];\r\n  code?: string;\r\n  keyDown?: { [key: string]: boolean };\r\n  rawEvent?: Event;\r\n  isDown: boolean;\r\n  isUp: boolean;\r\n}\r\n\r\nexport default class Events {\r\n  private eventDown = false;\r\n  private touchDown = false;\r\n  private eventDownX = 0.0;\r\n  private eventDownY = 0.0;\r\n  private eventDownDx = 0.0;\r\n  private eventDownDy = 0.0;\r\n  private keyDownMap: { [key: string]: boolean } = {};\r\n  private prevEvent = 0.0;\r\n  private timeStamp = 0.0;\r\n  private prevTimeStamp = 0.0;\r\n  private motionTimeStamp = 0.0;\r\n  private orientationQuaternion = [0.0, 0.0, 0.0, 0.0];\r\n  private orientation: string | number;\r\n  private NULL_EVENT = {\r\n    x: 0,\r\n    y: 0,\r\n    dx: 0,\r\n    dy: 0,\r\n    dxRaw: 0,\r\n    dyRaw: 0,\r\n    eventType: -1,\r\n    prevEventType: -1,\r\n    timeStamp: 0,\r\n    prevTimeStamp: 0,\r\n    orientationQuaternion: [0, 0, 0, 0],\r\n    rawEvent: undefined,\r\n    isDown: false,\r\n    isUp: false,\r\n  };\r\n\r\n  static DOWN = 1;\r\n  static DRAG = 2;\r\n  static UP = 3;\r\n  static RESIZE = 4;\r\n  static ORIENTATION = 5;\r\n  static KEY_DOWN = 6;\r\n  static KEY_UP = 7;\r\n  static SYSTEM_EVENTS = 8;\r\n  boundedWindow = false;\r\n\r\n  callback: EngineEventCallback[] = [];\r\n  private webGLContainer: WebGLContainer;\r\n  private throttle = 1000.0 / 25.0;\r\n\r\n  setThrottle = (throttle: number) => {\r\n    if (throttle) {\r\n      this.throttle = throttle;\r\n    }\r\n  };\r\n\r\n  delete(cb: Function) {\r\n    this.callback = this.callback.filter((c) => c !== cb);\r\n  }\r\n\r\n  bindWindow() {\r\n    if (this.boundedWindow) {\r\n      return;\r\n    }\r\n\r\n    window.addEventListener(\r\n      \"mouseup\",\r\n      this.isBodyFocus(this.handleMouseUp),\r\n      true\r\n    );\r\n    window.addEventListener(\r\n      \"touchend\",\r\n      this.isBodyFocus(this.handleTouchEnd),\r\n      true\r\n    );\r\n    window.addEventListener(\"resize\", this.resize, true);\r\n    window.addEventListener(\"keydown\", this.isBodyFocus(this.keyDown), true);\r\n    window.addEventListener(\"keyup\", this.isBodyFocus(this.keyUp), true);\r\n\r\n    if (window.hasOwnProperty(\"DeviceMotionEvent\")) {\r\n      window.addEventListener(\"devicemotion\", this.handleMotion, true);\r\n    }\r\n\r\n    if (window.hasOwnProperty(\"DeviceOrientationEvent\")) {\r\n      window.addEventListener(\r\n        \"orientationchange\",\r\n        this.handleOrientationChange,\r\n        true\r\n      );\r\n    }\r\n    this.boundedWindow = true;\r\n  }\r\n\r\n  bindCanvas() {\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"mousedown\",\r\n      this.handleEventDown,\r\n      true\r\n    );\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"mousemove\",\r\n      this.handleEventMove,\r\n      true\r\n    );\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"touchstart\",\r\n      this.handleTouchStart,\r\n      true\r\n    );\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"touchmove\",\r\n      this.handleTouchMove,\r\n      true\r\n    );\r\n  }\r\n\r\n  isBodyFocus(callback: (event: any) => void): (event: any) => void {\r\n    return (_event: any[]) => {\r\n      // if (window.document.activeElement === window.document.body) {\r\n        callback(_event);\r\n      // } else {\r\n      //   console.trace('body is not focused when event triggered', event);\r\n      // }\r\n    };\r\n  }\r\n\r\n  bind = (callback: EngineEventCallback, webGLContainer: WebGLContainer) => {\r\n    this.callback.push(callback);\r\n    this.webGLContainer = webGLContainer;\r\n    this.bindCanvas();\r\n    this.bindWindow();\r\n  };\r\n\r\n  handleOrientationChange = () => {\r\n    this.orientation = window.orientation || 0;\r\n  };\r\n\r\n  getQuaternion(alpha: number, beta: number, gamma: number) {\r\n    const degtorad = Math.PI / 180.0;\r\n    const radtodeg = 180.0 / Math.PI;\r\n\r\n    const _x = beta ? beta * degtorad : 0;\r\n    const _y = gamma ? gamma * degtorad : 0;\r\n    const _z = alpha ? alpha * degtorad : 0;\r\n\r\n    const cX = Math.cos(_x / 2);\r\n    const cY = Math.cos(_y / 2);\r\n    const cZ = Math.cos(_z / 2);\r\n    const sX = Math.sin(_x / 2);\r\n    const sY = Math.sin(_y / 2);\r\n    const sZ = Math.sin(_z / 2);\r\n\r\n    const w = cX * cY * cZ - sX * sY * sZ;\r\n    const x = sX * cY * cZ - cX * sY * sZ;\r\n    const y = cX * sY * cZ + sX * cY * sZ;\r\n    const z = cX * cY * sZ + sX * sY * cZ;\r\n\r\n    const screenAccData = new Coordinate(0, 0, 0);\r\n\r\n    switch (this.orientation) {\r\n      case 90:\r\n        screenAccData.x = -x;\r\n        screenAccData.y = z;\r\n        break;\r\n      case 180:\r\n        screenAccData.x = -z;\r\n        screenAccData.y = -x;\r\n        break;\r\n      case 270:\r\n      case -90:\r\n        screenAccData.x = x;\r\n        screenAccData.y = -z;\r\n        break;\r\n      default:\r\n        screenAccData.x = z;\r\n        screenAccData.y = x;\r\n        break;\r\n    }\r\n    // convert to engine coords\r\n    return [\r\n      (screenAccData.x * radtodeg) / w,\r\n      (-1 * screenAccData.y * radtodeg) / w,\r\n      (y * radtodeg) / w,\r\n      1.0,\r\n    ];\r\n  }\r\n\r\n  handleMotion = (event: DeviceMotionEvent) => {\r\n    if (!this.motionTimeStamp) {\r\n      this.motionTimeStamp = event.timeStamp;\r\n    }\r\n    this.incrementQuaternion(event);\r\n    if (event && event.timeStamp - this.motionTimeStamp > this.throttle) {\r\n      const tempEventDownX = this.eventDownX;\r\n      const tempEventDownY = this.eventDownY;\r\n      this.eventDownX = this.orientationQuaternion[0];\r\n      this.eventDownY = this.orientationQuaternion[1];\r\n      this.handleEvent(event, Events.ORIENTATION);\r\n      this.eventDownX = tempEventDownX;\r\n      this.eventDownY = tempEventDownY;\r\n\r\n      this.prevEvent = Events.ORIENTATION;\r\n      this.motionTimeStamp = event.timeStamp;\r\n      this.orientationQuaternion = [0.0, 0.0, 0.0, 1.0];\r\n    }\r\n  };\r\n\r\n  incrementQuaternion = (event: DeviceMotionEvent) => {\r\n    const accData: any = event.rotationRate\r\n      ? event.rotationRate\r\n      : { beta: 0, gamma: 0, alpha: 0 };\r\n    const eventQuaternion = this.getQuaternion(\r\n      accData.alpha,\r\n      accData.beta,\r\n      accData.gamma\r\n    );\r\n    this.orientationQuaternion[0] += eventQuaternion[0];\r\n    this.orientationQuaternion[1] += eventQuaternion[1];\r\n    this.orientationQuaternion[2] += eventQuaternion[2];\r\n  };\r\n\r\n  buildEvent = (evt: Event, type: number): EngineEvent => {\r\n    if (!this.webGLContainer.canvas) return this.NULL_EVENT;\r\n    return {\r\n      x: this.eventDownX / this.webGLContainer.canvas.offsetWidth,\r\n      y: 1 - this.eventDownY / this.webGLContainer.canvas.offsetHeight,\r\n      dx: (2.0 * this.eventDownDx) / this.webGLContainer.canvas.offsetWidth,\r\n      dy: (2.0 * this.eventDownDy) / this.webGLContainer.canvas.offsetHeight,\r\n      dxRaw: this.eventDownDx,\r\n      dyRaw: this.eventDownDy,\r\n      eventType: type,\r\n      prevEventType: this.prevEvent,\r\n      timeStamp: this.timeStamp,\r\n      prevTimeStamp: this.prevTimeStamp,\r\n      orientationQuaternion: this.orientationQuaternion,\r\n      rawEvent: evt,\r\n      isDown: type === Events.DOWN || type === Events.KEY_DOWN,\r\n      isUp: type === Events.UP || type === Events.KEY_UP,\r\n      code: evt instanceof KeyboardEvent ? evt.code : undefined,\r\n    };\r\n  };\r\n\r\n  resize = (evt: Event) => {\r\n    this.handleEvent(evt, Events.RESIZE);\r\n  };\r\n\r\n  buildEventKey = (evt: KeyboardEvent, type: number) => {\r\n    return {\r\n      eventType: type,\r\n      keyCode: evt.key,\r\n      code: evt.code,\r\n      event: evt,\r\n      keyDown: this.keyDownMap,\r\n      isDown: type === Events.DOWN,\r\n      isUp: type === Events.UP,\r\n    };\r\n  };\r\n\r\n  keyDown = (evt: KeyboardEvent) => {\r\n    this.keyDownMap[evt.code] = true;\r\n    this.handleEvent(evt, Events.KEY_DOWN);\r\n    switch (evt.keyCode) {\r\n      // prevent arrow keys from scrolling window\r\n      case 37:\r\n      case 39:\r\n      case 38:\r\n      case 40:\r\n        evt.preventDefault();\r\n        break;\r\n    }\r\n  };\r\n\r\n  keyUp = (evt: KeyboardEvent) => {\r\n    this.keyDownMap[evt.code] = false;\r\n    this.handleEvent(evt, Events.KEY_UP);\r\n  };\r\n\r\n  handleMouseUp = (evt: MouseEvent) => {\r\n    this.eventDown = false;\r\n    this.timeStamp = evt.timeStamp;\r\n    this.eventDownX = evt.offsetX;\r\n    this.eventDownY = evt.offsetY;\r\n    this.handleEvent(evt, Events.UP);\r\n    this.prevEvent = Events.UP;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n  };\r\n\r\n  handleEventDown = (evt: MouseEvent) => {\r\n    this.eventDown = true;\r\n    this.eventDownX = evt.offsetX;\r\n    this.eventDownY = evt.offsetY;\r\n    this.timeStamp = evt.timeStamp;\r\n    this.handleEvent(evt, Events.DOWN);\r\n    this.prevEvent = Events.DOWN;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n  };\r\n\r\n  handleEventMove = (evt: MouseEvent) => {\r\n    if (this.eventDown && evt.timeStamp - this.timeStamp > this.throttle) {\r\n      const xUp = evt.offsetX;\r\n      const yUp = evt.offsetY;\r\n\r\n      this.eventDownDx = this.eventDownX - xUp;\r\n      this.eventDownDy = this.eventDownY - yUp;\r\n      this.eventDownX = xUp;\r\n      this.eventDownY = yUp;\r\n      this.timeStamp = evt.timeStamp;\r\n      this.handleEvent(evt, Events.DRAG);\r\n      this.prevEvent = Events.DRAG;\r\n      this.prevTimeStamp = evt.timeStamp;\r\n    }\r\n  };\r\n\r\n  handleTouchEnd = (evt: TouchEvent) => {\r\n    this.touchDown = false;\r\n    this.timeStamp = evt.timeStamp;\r\n    this.handleEvent(evt, Events.UP);\r\n    this.prevEvent = Events.UP;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n  };\r\n\r\n  handleTouchStart = (evt: TouchEvent) => {\r\n    this.touchDown = true;\r\n    this.timeStamp = evt.timeStamp;\r\n    if (evt.target instanceof HTMLElement) {\r\n      const rect = evt.target.getBoundingClientRect();\r\n      this.eventDownX = evt.touches[0].clientX - rect.left;\r\n      this.eventDownY = evt.touches[0].clientY - rect.top;\r\n    }\r\n    this.handleEvent(evt, Events.DOWN);\r\n    this.prevEvent = Events.DOWN;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n    if (evt.cancelable) {\r\n      evt.preventDefault();\r\n    }\r\n  };\r\n\r\n  handleTouchMove = (evt: TouchEvent) => {\r\n    if (\r\n      this.touchDown &&\r\n      evt.timeStamp - this.timeStamp > this.throttle &&\r\n      evt.target instanceof HTMLElement\r\n    ) {\r\n      const rect = evt.target.getBoundingClientRect();\r\n      const xUp = evt.touches[0].clientX - rect.left;\r\n      const yUp = evt.touches[0].clientY - rect.top;\r\n\r\n      this.eventDownDx = (this.eventDownX - xUp) / 2.0;\r\n      this.eventDownDy = (this.eventDownY - yUp) / 2.0;\r\n      this.eventDownX = xUp;\r\n      this.eventDownY = yUp;\r\n      this.timeStamp = evt.timeStamp;\r\n      this.handleEvent(evt, Events.DRAG);\r\n      this.prevEvent = Events.DRAG;\r\n      this.prevTimeStamp = evt.timeStamp;\r\n    }\r\n    // prevent device scrolling\r\n    if (evt.cancelable) {\r\n      evt.preventDefault();\r\n    }\r\n  };\r\n\r\n  handleEvent = (evt: Event, event: Events[keyof Events]) => {\r\n    const targetEvent = this.buildEvent(evt, event);\r\n    for (let i = 0; i < this.callback.length; i++) {\r\n      const callbackPropagate = this.callback[i](targetEvent);\r\n      if (callbackPropagate === false) {\r\n        break;\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport const event = new Events();\r\n","import ShaderEntityBuilder from \"../Builder/ShaderEntityBuilder\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport RenderOption, { RenderType, ShaderType } from \"../Data/RenderOption\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport EngineObject from \"./EngineObject\";\r\n\r\nexport default class ModelObject3d extends EngineObject {\r\n  public vertexModel: TextureVertexModel;\r\n  protected renderType: RenderType;\r\n\r\n  constructor(rect: Rect3d, vertexModel: TextureVertexModel) {\r\n    super();\r\n    this.renderType = RenderType.TRIANGLE;\r\n    this.vertexModel = vertexModel;\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n  setRenderType(renderType: RenderType) {\r\n    this.renderType = renderType;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = this.renderType;\r\n    renderOpt.shaderType = ShaderType.THREE_DIMENSION;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .createTexture(this.vertexModel.textureSource)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import FontMetaData, {\r\n  FontCharacter,\r\n  FontMeta,\r\n} from \"../Core/Data/FontMetaData\";\r\n\r\nclass FntFontReader extends FontMetaData {\r\n  static FILENAME = /file=\"([\\w\\d\\W\\D]+)\"/;\r\n  static WIDTH = /scaleW=([\\d]+)/;\r\n  static HEIGHT = /scaleH=([\\d]+)/;\r\n  static LINE_HEIGHT = /lineHeight=([\\d]+)/;\r\n  static FONT_CHAR = new RegExp(\r\n    \"char[\\\\s]+\" +\r\n      [\"id\", \"x\", \"y\", \"width\", \"height\", \"xoffset\", \"yoffset\"]\r\n        .map((column) => `${column}=([-\\\\d]+)[\\\\s]+`)\r\n        .reduce((sum: string, str: string) => sum + str)\r\n  );\r\n\r\n  context: FontMeta;\r\n\r\n  constructor(raw: string) {\r\n    super();\r\n    const lines = raw.split(\"\\n\");\r\n    this.context = new FontMeta();\r\n    for (const lineIdx in lines) {\r\n      if (!lines.hasOwnProperty(lineIdx)) {\r\n        continue;\r\n      }\r\n      const line = lines[lineIdx];\r\n      this.parseWidth(this.context, line);\r\n      this.parseHeight(this.context, line);\r\n      this.parseFilename(this.context, line);\r\n      this.parseLineHeight(this.context, line);\r\n      this.parseChar(this.context, line);\r\n    }\r\n  }\r\n\r\n  parseChar(context: FontMeta, line: string) {\r\n    const match = line.match(FntFontReader.FONT_CHAR);\r\n    if (match) {\r\n      const font = new FontCharacter();\r\n      font.charCode = parseFloat(match[1]);\r\n      font.x = parseFloat(match[2]);\r\n      font.y = parseFloat(match[3]);\r\n      font.width = parseFloat(match[4]);\r\n      font.height = parseFloat(match[5]);\r\n      font.xOffset = parseFloat(match[6]) / context.width;\r\n      font.yOffset = parseFloat(match[7]) / context.height;\r\n      font.char = String.fromCharCode(font.charCode);\r\n      context.fonts[font.char] = font;\r\n    }\r\n  }\r\n\r\n  parseHeight(context: FontMeta, line: string) {\r\n    if (!context.height) {\r\n      const match = line.match(FntFontReader.HEIGHT);\r\n      if (match) {\r\n        context.height = parseFloat(match[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseLineHeight(context: FontMeta, line: string) {\r\n    if (!context.lineHeight) {\r\n      const match = line.match(FntFontReader.LINE_HEIGHT);\r\n      if (match) {\r\n        context.lineHeight = parseFloat(match[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseWidth(context: FontMeta, line: string) {\r\n    if (!context.width) {\r\n      const match = line.match(FntFontReader.WIDTH);\r\n      if (match) {\r\n        context.width = parseFloat(match[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseFilename(context: FontMeta, line: string) {\r\n    if (!context.filename) {\r\n      const match = line.match(FntFontReader.FILENAME);\r\n      if (match) {\r\n        context.filename = match[1];\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default FntFontReader;\r\n","import ModelData from \"./ModelData\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { RenderUnit } from \"./RenderUnit\";\r\n\r\nabstract class VertexModel {\r\n  public vertexBufferId: number;\r\n  public renderUnits: RenderUnit[];\r\n\r\n  public abstract createRenderUnits(count: number): VertexModel;\r\n  public abstract fillRenderUnits(vertexUV: number[]): void;\r\n  public abstract createModel(): ModelData;\r\n\r\n  public registerModel(engineHelper: EngineHelper) {\r\n    if (!this.vertexBufferId) {\r\n      this.vertexBufferId = engineHelper.addBufferCache(this.createModel());\r\n    }\r\n  }\r\n}\r\n\r\nexport default VertexModel;\r\n","export default class Resource {\r\n  location: string;\r\n  type: string;\r\n  width: number;\r\n  height: number;\r\n  precision: number;\r\n}\r\n","export default \"\\r\\nattribute vec3 a_position;\\r\\nattribute vec4 a_color;\\r\\nvarying vec4 v_color;\\r\\nuniform mat4 u_model;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_projection;\\r\\n\\r\\nvoid main(void) {\\r\\n  v_color = a_color;\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1);\\r\\n}\\r\\n\\r\\n\";","import { quat, mat4, glMatrix, ReadonlyVec3 } from \"gl-matrix\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport Position from \"./Position\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\n\r\nexport default class ModelPosition {\r\n  $physicsId: number;\r\n  position: Position = new Position();\r\n  cachedModel: mat4;\r\n  dirtyModel = true;\r\n  quatRotationxyz: mat4;\r\n  dirtyQuat = true;\r\n  dirtyPos = true;\r\n  dirtyScale = true;\r\n  dirtyOrigin = true;\r\n  intermediateModels: mat4[] = [\r\n    mat4.create(),\r\n    mat4.create(),\r\n    mat4.create(),\r\n    mat4.create(),\r\n  ];\r\n  // prevent memory reallocation of objects\r\n  initialMat4Temp = mat4.create();\r\n  rotateQuatTemp = quat.create();\r\n  rotateMat4Temp = mat4.create();\r\n\r\n  setPosition(position: Position) {\r\n    this.position = position;\r\n    this.dirtyOrigin = true;\r\n    this.dirtyQuat = true;\r\n    this.dirtyPos = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  pos() {\r\n    return [this.position.x, this.position.y, this.position.z];\r\n  }\r\n\r\n  centerRect(rect: Rect3d) {\r\n    this.center(rect.x, rect.y, rect.z);\r\n  }\r\n\r\n  rotateOriginRect(rect: Rect3d) {\r\n    this.rotateOrigin(rect.x, rect.y, rect.z);\r\n  }\r\n\r\n  centerCoord(coord: Coordinate) {\r\n    this.center(coord.x, coord.y, coord.z);\r\n  }\r\n\r\n  center(x: number, y: number, z: number) {\r\n    if (\r\n      this.position.x === x &&\r\n      this.position.y === y &&\r\n      this.position.z === z\r\n    ) {\r\n      return;\r\n    }\r\n    this.position.x = x;\r\n    this.position.y = y;\r\n    this.position.z = z;\r\n    this.dirtyPos = true;\r\n    this.dirtyModel = true;\r\n    this.rotateOrigin(x, y, z);\r\n  }\r\n\r\n  translate(dx: number, dy: number, dz: number) {\r\n    this.position.x += dx;\r\n    this.position.y += dy;\r\n    this.position.z += dz;\r\n    this.dirtyPos = true;\r\n    this.dirtyModel = true;\r\n    this.rotateOrigin(this.position.x, this.position.y, this.position.z);\r\n  }\r\n\r\n  rotateOrigin(x: number, y: number, z: number) {\r\n    if (\r\n      this.position.originX !== x ||\r\n      this.position.originY !== y ||\r\n      this.position.originZ !== z\r\n    ) {\r\n      this.position.originX = x;\r\n      this.position.originY = y;\r\n      this.position.originZ = z;\r\n      this.dirtyOrigin = true;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  angleX(x: number) {\r\n    if (this.position.ax !== x) {\r\n      this.position.ax = x;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  angleY(y: number) {\r\n    if (this.position.ay !== y) {\r\n      this.position.ay = y;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  angleZ(z: number) {\r\n    if (this.position.az !== z) {\r\n      this.position.az = z;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  rotateX(x: number) {\r\n    this.angleX(x);\r\n  }\r\n\r\n  rotateY(y: number) {\r\n    this.angleY(y);\r\n  }\r\n\r\n  rotateZ(z: number) {\r\n    this.angleZ(z);\r\n  }\r\n\r\n  scaleX(x: number) {\r\n    this.position.scaleX = x;\r\n    this.position.width = this.position.scaleX;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scaleY(y: number) {\r\n    this.position.scaleY = y;\r\n    this.position.height = this.position.scaleY;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scaleZ(z: number) {\r\n    this.position.scaleZ = z;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scale(x: number, y: number, z: number) {\r\n    if (\r\n      this.position.scaleX === x &&\r\n      this.position.scaleY === y &&\r\n      this.position.scaleZ === z\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.position.scaleX = x;\r\n    this.position.scaleY = y;\r\n    this.position.scaleZ = z;\r\n    this.position.width = x;\r\n    this.position.height = y;\r\n    this.position.length = z;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scaleRect(rect: Rect3d) {\r\n    this.scale(rect.width, rect.height, rect.length);\r\n  }\r\n\r\n  _buildQuat() {\r\n    const quatMat = this.createMat4NoAlloc(this.rotateMat4Temp);\r\n    let quatRotationxyz = this.createQuatNoAlloc(this.rotateQuatTemp);\r\n    quatRotationxyz = quat.rotateX(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ax)\r\n    );\r\n    quatRotationxyz = quat.rotateY(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ay)\r\n    );\r\n    quatRotationxyz = quat.rotateZ(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.az)\r\n    );\r\n    quatRotationxyz = quat.normalize(quatRotationxyz, quatRotationxyz);\r\n    return mat4.fromQuat(quatMat, quatRotationxyz);\r\n  }\r\n\r\n  getIntermediateModel(point: number, dest: mat4) {\r\n    const org = this.intermediateModels[point];\r\n    for (const index in dest) {\r\n      if (dest.hasOwnProperty(index)) {\r\n        dest[index] = org[index];\r\n      }\r\n    }\r\n    return dest;\r\n  }\r\n\r\n  _buildModelIntermediate(point: number, dest: mat4) {\r\n    // faster copy - preserve existing reference to prevent GC\r\n    const org = this.intermediateModels[point];\r\n    for (const index in dest) {\r\n      if (dest.hasOwnProperty(index)) {\r\n        org[index] = dest[index];\r\n      }\r\n    }\r\n    return dest;\r\n  }\r\n\r\n  createQuatNoAlloc(out: quat) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    return out;\r\n  }\r\n\r\n  createMat4NoAlloc(out: mat4) {\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = 1;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[10] = 1;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n    out[15] = 1;\r\n    return out;\r\n  }\r\n\r\n  _buildModel() {\r\n    let _dirty = false;\r\n    let dest = this.createMat4NoAlloc(this.initialMat4Temp);\r\n    if (this.dirtyOrigin) {\r\n      _dirty = true;\r\n      const origin: ReadonlyVec3 = [\r\n        this.position.originX,\r\n        this.position.originY,\r\n        this.position.originZ,\r\n      ];\r\n      mat4.translate(dest, dest, origin);\r\n\r\n      this._buildModelIntermediate(0, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(0, dest);\r\n    }\r\n\r\n    // cache this one as its heavy\r\n    if (this.dirtyQuat || _dirty) {\r\n      _dirty = true;\r\n      this.quatRotationxyz = this._buildQuat();\r\n      mat4.multiply(dest, dest, this.quatRotationxyz);\r\n      this._buildModelIntermediate(1, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(1, dest);\r\n    }\r\n\r\n    if (this.dirtyPos || _dirty) {\r\n      _dirty = true;\r\n      const negOrigin: ReadonlyVec3 = [\r\n        -1 * this.position.originX,\r\n        -1 * this.position.originY,\r\n        -1 * this.position.originZ,\r\n      ];\r\n      mat4.translate(dest, dest, negOrigin);\r\n\r\n      const pos: ReadonlyVec3 = [\r\n        this.position.x,\r\n        this.position.y,\r\n        this.position.z,\r\n      ];\r\n      mat4.translate(dest, dest, pos);\r\n\r\n      this._buildModelIntermediate(2, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(2, dest);\r\n    }\r\n\r\n    if (this.dirtyScale || _dirty) {\r\n      _dirty = true;\r\n      const scale: ReadonlyVec3 = [\r\n        this.position.scaleX,\r\n        this.position.scaleY,\r\n        this.position.scaleZ,\r\n      ];\r\n      mat4.scale(dest, dest, scale);\r\n\r\n      this._buildModelIntermediate(3, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(3, dest);\r\n    }\r\n\r\n    this.dirtyPos = false;\r\n    this.dirtyQuat = false;\r\n    this.dirtyScale = false;\r\n    this.dirtyOrigin = false;\r\n    this.cachedModel = dest;\r\n  }\r\n\r\n  getModel = () => {\r\n    if (this.dirtyModel) {\r\n      this.dirtyModel = false;\r\n      this._buildModel();\r\n    }\r\n    return this.cachedModel;\r\n  };\r\n\r\n  degreesToRadians(degrees: number) {\r\n    return Math.round(glMatrix.toRadian(degrees) * 100) / 100;\r\n  }\r\n  setRect(rect: Rect3d) {\r\n    this.scaleRect(rect);\r\n    this.centerRect(rect);\r\n  }\r\n\r\n  // memory optimised\r\n  setRect2(\r\n    x: number,\r\n    y: number,\r\n    z: number,\r\n    width: number,\r\n    height: number,\r\n    length: number\r\n  ) {\r\n    this.scale(width, height, length);\r\n    this.center(x, y, z);\r\n  }\r\n\r\n  // memory optimised\r\n  getRect2(): Rect3d {\r\n    return this.position;\r\n  }\r\n\r\n  getRect(): Rect3d {\r\n    return new Rect3d(\r\n      this.position.x,\r\n      this.position.y,\r\n      this.position.z,\r\n      this.position.width,\r\n      this.position.height,\r\n      this.position.length\r\n    );\r\n  }\r\n\r\n  getPosition = () => {\r\n    return this.position;\r\n  };\r\n}\r\n","import EngineObject, { EngineEntity } from \"./EngineObject\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { EngineEvent } from \"../Events\";\r\nimport Physics from \"../Physics/Physics\";\r\nimport Position from \"./Position\";\r\nimport ConfigMapBuilder from \"../Builder/ConfigMapBuilder\";\r\nimport { FontReference } from \"../Font/Font\";\r\nimport EntityManager2d from \"../../Manager/EntityManager2d\";\r\n\r\nclass EngineMap extends EntityManager2d {\r\n  $ref: { [key: string]: { entity: EngineObject; position: Position } } = {};\r\n  show = false;\r\n  configBuilder?: ConfigMapBuilder;\r\n  engineHelper: EngineHelper;\r\n\r\n  reset() {\r\n    this.entities = [];\r\n    this.$ref = {};\r\n  }\r\n\r\n  beforeShow() {}\r\n\r\n  updatePosition(entity: EngineObject, position: Position) {\r\n    if (this.$ref[entity.$id]) {\r\n      this.$ref[entity.$id].position = position;\r\n    } else {\r\n      console.error(\"Trying to update position when entity not set\", this);\r\n    }\r\n  }\r\n\r\n  setShow(show: boolean) {\r\n    this.show = show;\r\n    if (this.show) {\r\n      this.beforeShow();\r\n    }\r\n    this.entities.forEach((ent: EngineObject) => {\r\n      Physics.setEnabledPhysics(ent, show);\r\n      ent.hidden = !show;\r\n    });\r\n    if (this.show) {\r\n      this.restore();\r\n    }\r\n  }\r\n\r\n  restore() {\r\n    for (const prop in this.$ref) {\r\n      if (this.$ref.hasOwnProperty(prop)) {\r\n        const entityData = this.$ref[prop];\r\n        entityData.entity.setPosition(entityData.position);\r\n      }\r\n    }\r\n  }\r\n\r\n  addEntity(entity: EngineObject): EngineMap {\r\n    if (!this.$ref[entity.$id]) {\r\n      this.entities.push(entity);\r\n      this.$ref[entity.$id] = {\r\n        entity: entity,\r\n        position: entity.position,\r\n      };\r\n    }\r\n    return this;\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    if (!this.show) {\r\n      return;\r\n    }\r\n    this.entities.forEach((ent: EngineObject) => ent.update(engineHelper));\r\n    if (this.configBuilder) {\r\n      this.configBuilder.texts.forEach((fontRef: FontReference) =>\r\n        engineHelper.writeFont(fontRef)\r\n      );\r\n    }\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    if (!this.show) {\r\n      return;\r\n    }\r\n    this.entities.forEach((ent: EngineObject) => ent.render(engineHelper));\r\n  }\r\n\r\n  event(event: EngineEvent, engineHelper: EngineHelper): boolean | undefined {\r\n    if (!this.show) {\r\n      return;\r\n    }\r\n\r\n    for (const entities of this.entities) {\r\n      if (entities.isLastEvent) {\r\n        continue;\r\n      }\r\n\r\n      const shouldPropagate = entities.event(event, engineHelper);\r\n      if (shouldPropagate === false) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    for (const entities of this.entities) {\r\n      if (!entities.isLastEvent) {\r\n        continue;\r\n      }\r\n\r\n      const shouldPropagate = entities.event(event, engineHelper);\r\n      if (shouldPropagate === false) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n    this.entities.forEach((ent: EngineEntity) => ent.init(engineHelper));\r\n  }\r\n  parseMap(engineHelper: EngineHelper, map: any) {\r\n    this.configBuilder = new ConfigMapBuilder(engineHelper);\r\n    this.configBuilder.build(map);\r\n    this.addEntities();\r\n  }\r\n  addEntities() {\r\n    if (!this.configBuilder || !this.configBuilder.objects) return;\r\n    this.configBuilder.objects.forEach((ent: EngineObject) =>\r\n      this.addEntity(ent)\r\n    );\r\n  }\r\n}\r\n\r\nexport default EngineMap;\r\n","export function generateId() {\r\n  return \"xxxxxxxxx\".replace(/[x]/g, function (c) {\r\n    const r = (Math.random() * 16) | 0;\r\n    const v = c == \"x\" ? r : (r & 0x3) | 0x8;\r\n    return v.toString(16);\r\n  });\r\n}\r\n","import { ShaderEntity } from \"../EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport VertexModel from \"../Data/VertexModel\";\r\nimport EngineObject from \"../EngineEntity/EngineObject\";\r\nimport RenderOption from \"../Data/RenderOption\";\r\n\r\nclass ShaderEntityBuilder {\r\n  engineHelper: EngineHelper;\r\n  textureSource?: string;\r\n\r\n  vertexModel: VertexModel;\r\n  hasTexture: boolean;\r\n\r\n  constructor(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n  }\r\n\r\n  createTexture(textureSource: string): ShaderEntityBuilder {\r\n    this.textureSource = textureSource;\r\n    this.hasTexture = true;\r\n    return this;\r\n  }\r\n\r\n  addBuffer(vertexModel: VertexModel): ShaderEntityBuilder {\r\n    this.vertexModel = vertexModel;\r\n    return this;\r\n  }\r\n\r\n  build(engineObject: EngineObject, opt: RenderOption): ShaderEntity {\r\n    if (!this.vertexModel) {\r\n      console.error(\"VertexModel is undefined\", this);\r\n    }\r\n    const entity = new ShaderEntity();\r\n    const entityOption = entity.getOpt();\r\n    entityOption.renderType = opt.renderType;\r\n    entityOption.shaderType = opt.shaderType;\r\n    entity.model = engineObject.getModel;\r\n    entity.modelPosition = () => engineObject.position;\r\n    entity.vertexModel = this.vertexModel;\r\n    entity.vertexModel.registerModel(this.engineHelper);\r\n    this.engineHelper.registerEntity(entity);\r\n    if (this.hasTexture) {\r\n      entity.src = this.textureSource;\r\n      this.engineHelper.createTexture(entity);\r\n    }\r\n    return entity;\r\n  }\r\n\r\n  static clone(shaderEntity: ShaderEntity): ShaderEntity {\r\n    return Object.assign(new ShaderEntity(), shaderEntity);\r\n  }\r\n}\r\n\r\nexport default ShaderEntityBuilder;\r\n","class TextureLoader {\r\n  image: HTMLImageElement;\r\n\r\n  loadImage(src: string): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      this.image = document.createElement(\"img\");\r\n      if (window.location.origin !== \"file://\") {\r\n        this.image.crossOrigin = \"anonymous\";\r\n      }\r\n      this.image.onload = () => resolve();\r\n      this.image.onerror = (error) => reject(error);\r\n      this.image.src = src;\r\n    });\r\n  }\r\n}\r\n\r\nclass Texture extends TextureLoader {\r\n  texUnit: number;\r\n  width: number;\r\n  height: number;\r\n  texture: WebGLTexture;\r\n  isLoaded: boolean;\r\n  isError: boolean;\r\n  load: Promise<boolean>;\r\n\r\n  static textureCount = 0;\r\n  static maxTextureUnits: number | null = null;\r\n  static readonly DEFAULT_MAX_TEXTURE_UNITS = 10;\r\n  constructor(src: string, ctx: WebGLRenderingContext) {\r\n    super();\r\n    this.isLoaded = false;\r\n    this.isError = false;\r\n    \r\n    if (Texture.maxTextureUnits === null) {\r\n      Texture.maxTextureUnits =\r\n        ctx.getParameter(ctx.MAX_TEXTURE_IMAGE_UNITS) || Texture.DEFAULT_MAX_TEXTURE_UNITS;\r\n    }\r\n    \r\n    this.load = this.loadImage(src)\r\n      .then(() => this.onLoad(ctx))\r\n      .catch((error) => this.onError(error));\r\n  }\r\n\r\n  onError(error: Error): boolean {\r\n    this.isError = true;\r\n    this.isLoaded = false;\r\n    throw error;\r\n  }\r\n\r\n  onLoad(ctx: WebGLRenderingContext): boolean {\r\n    this.handleTextureLoaded(this.image, ctx);\r\n    this.isLoaded = true;\r\n    this.width = this.image.width;\r\n    this.height = this.image.height;\r\n    return true;\r\n  }\r\n\r\n  newTextureUnit(): number {\r\n    const maxUnits = Texture.maxTextureUnits || Texture.DEFAULT_MAX_TEXTURE_UNITS;\r\n    if (Texture.textureCount >= maxUnits) {\r\n      console.error(\r\n        `Texture units exceeded: requested index ${Texture.textureCount} >= max ${maxUnits}. Reusing texture units.`\r\n      );\r\n      return Texture.textureCount % maxUnits;\r\n    }\r\n    return Texture.textureCount++;\r\n  }\r\n\r\n  bindTexture(ctx: WebGLRenderingContext, sampler: WebGLUniformLocation) {\r\n    if (this.isLoaded) {\r\n      ctx.uniform1i(sampler, this.texUnit);\r\n    }\r\n  }\r\n\r\n  handleTextureLoaded(image: HTMLImageElement, ctx: WebGLRenderingContext) {\r\n    this.texUnit = this.newTextureUnit();\r\n    ctx.activeTexture(ctx.TEXTURE0 + this.texUnit);\r\n    this.texture = this.createTextureFromImage(image, ctx);\r\n  }\r\n\r\n  createTextureFromImage(\r\n    image: HTMLImageElement,\r\n    ctx: WebGLRenderingContext\r\n  ): WebGLTexture {\r\n    const texture = ctx.createTexture()!;\r\n    ctx.bindTexture(ctx.TEXTURE_2D, texture);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MIN_FILTER, ctx.NEAREST);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MAG_FILTER, ctx.NEAREST);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_WRAP_S, ctx.CLAMP_TO_EDGE);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_WRAP_T, ctx.CLAMP_TO_EDGE);\r\n    ctx.texImage2D(\r\n      ctx.TEXTURE_2D,\r\n      0,\r\n      ctx.RGBA,\r\n      ctx.RGBA,\r\n      ctx.UNSIGNED_BYTE,\r\n      image\r\n    );\r\n    return texture;\r\n  }\r\n}\r\n\r\nexport default Texture;\r\n","import Shader3DProgram from \"../ShaderProgram/Shader3DProgram\";\r\nimport { ShaderType, RenderType } from \"../../Data/RenderOption\";\r\nimport { mat4 } from \"gl-matrix\";\r\nimport Light from \"../../Data/Light\";\r\nimport { BaseCamera } from \"../../Camera\";\r\nimport { ShaderEntity } from \"../../EngineEntity/ShaderEntity\";\r\n\r\nclass Entity3DProgram {\r\n  program: Shader3DProgram;\r\n  ctx: WebGLRenderingContext;\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n    this.program = new Shader3DProgram(ctx);\r\n  }\r\n\r\n  updatePerspective(projectionMatrix: mat4) {\r\n    this.program.bindProgram();\r\n    this.program.glSetProjectMatrix(projectionMatrix as Float32List);\r\n  }\r\n\r\n  delete() {\r\n    this.program.arrayBuffer.delete();\r\n    this.program.delete();\r\n  }\r\n\r\n  setLight(light: Light, camera: BaseCamera) {\r\n    this.program.setLight(light, camera);\r\n  }\r\n\r\n  updateBuffer(entity: ShaderEntity, buffer: number[]) {\r\n    const opt = entity.getOpt();\r\n    if (ShaderType.THREE_DIMENSION !== opt.shaderType) {\r\n      console.error(\r\n        \"Updating buffer for registered 3D Entity but with different shader type as RenderOptions\",\r\n        opt\r\n      );\r\n      return;\r\n    }\r\n\r\n    const buffReg =\r\n      this.program.arrayBuffer.bufferReg[entity.rendererBufferId!];\r\n    if (!buffer || buffer.length !== buffReg.verticesSize) {\r\n      console.error(\r\n        \"New Buffer data does not match initial buffer data!\",\r\n        entity,\r\n        buffer,\r\n        buffReg.verticesSize\r\n      );\r\n    }\r\n\r\n    this.program.arrayBuffer.bufferSub(\r\n      buffReg.offset,\r\n      buffer,\r\n      Shader3DProgram.DRAW_VERTEX_SIZE\r\n    );\r\n  }\r\n\r\n  _render3DShadowEntities(entities: [ShaderEntity, Float32List][]) {\r\n    for (let index = 0; index < entities.length; index++) {\r\n      const data = entities[index];\r\n      const entity = data[0];\r\n      const model = data[1];\r\n      const opt = entity.getOpt();\r\n\r\n      this.program.glSetShadowModelMatrix(model);\r\n\r\n      if (!entity.rendererBufferId) {\r\n        throw new Error(\"Unregistered entity buffer\" + entity);\r\n      }\r\n\r\n      const buffReg =\r\n        this.program.arrayBuffer.bufferReg[entity.rendererBufferId];\r\n\r\n      if (opt.renderType === RenderType.TRIANGLE) {\r\n        this.ctx.drawArrays(this.ctx.TRIANGLES, buffReg.offset, buffReg.size);\r\n      } else {\r\n        this.ctx.drawArrays(\r\n          this.ctx.TRIANGLE_STRIP,\r\n          buffReg.offset,\r\n          buffReg.size\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  _setupShadow() {\r\n    this.program.bindShadowTexture();\r\n  }\r\n\r\n  render3DShadowMap(\r\n    entities: [ShaderEntity, Float32List][],\r\n    setOriginalViewport: Function\r\n  ) {\r\n    if (!this.program.isShadowEnabled) {\r\n      return;\r\n    }\r\n    this.ctx.disable(this.ctx.CULL_FACE);\r\n    this.program.prepareShadowTexture();\r\n    this._render3DShadowEntities(entities);\r\n    this.program.revertShadowTexture();\r\n    setOriginalViewport();\r\n    this.ctx.enable(this.ctx.CULL_FACE);\r\n    this.ctx.cullFace(this.ctx.BACK);\r\n    this._setupShadow();\r\n  }\r\n  render(\r\n    entities: [ShaderEntity, Float32List][],\r\n    camera: BaseCamera,\r\n    textureReg: { [key: string]: any },\r\n    is2d: boolean\r\n  ) {\r\n    this.program.arrayBuffer.bind();\r\n    this.program.bindAttributePointers();\r\n    this.program.bindProgram();\r\n    this.program.glSetViewMatrix(camera.viewMatrix as Float32List);\r\n\r\n    if (is2d) {\r\n      if (this.ctx.isEnabled(this.ctx.CULL_FACE)) {\r\n        this.ctx.disable(this.ctx.CULL_FACE);\r\n      }\r\n      if (this.ctx.isEnabled(this.ctx.DEPTH_TEST)) {\r\n        this.ctx.disable(this.ctx.DEPTH_TEST);\r\n      }\r\n    } else {\r\n      if (!this.ctx.isEnabled(this.ctx.CULL_FACE)) {\r\n        this.ctx.enable(this.ctx.CULL_FACE);\r\n      }\r\n      if (!this.ctx.isEnabled(this.ctx.DEPTH_TEST)) {\r\n        this.ctx.enable(this.ctx.DEPTH_TEST);\r\n      }\r\n    }\r\n\r\n    for (let index = 0; index < entities.length; index++) {\r\n      const data = entities[index];\r\n      const entity = data[0];\r\n      const model = data[1];\r\n      const opt = entity.getOpt();\r\n      if (!entity.rendererTextureRef) {\r\n        throw new Error(\"Unregistered entity texture\" + entity);\r\n      }\r\n\r\n      const texReg = textureReg[entity.rendererTextureRef];\r\n      this.program.bindTexture(texReg.texture);\r\n      this.program.glSetModelViewMatrix(model);\r\n\r\n      if (!entity.rendererBufferId) {\r\n        throw new Error(\"Unregistered entity buffer\" + entity);\r\n      }\r\n      const buffReg =\r\n        this.program.arrayBuffer.bufferReg[entity.rendererBufferId];\r\n      if (opt.renderType === RenderType.TRIANGLE) {\r\n        this.ctx.drawArrays(this.ctx.TRIANGLES, buffReg.offset, buffReg.size);\r\n      } else {\r\n        this.ctx.drawArrays(\r\n          this.ctx.TRIANGLE_STRIP,\r\n          buffReg.offset,\r\n          buffReg.size\r\n        );\r\n      }\r\n    }\r\n    this.program.arrayBuffer.unbind();\r\n    this.program.unbindAttributePointers();\r\n    this.program.unbindProgram();\r\n  }\r\n\r\n  bindBuffer() {\r\n    this.program.arrayBuffer.bufferBind();\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity, objBuffer: number[]) {\r\n    const size = objBuffer.length / Shader3DProgram.DRAW_VERTEX_SIZE;\r\n    this.program.arrayBuffer.bufferReg[this.program.arrayBuffer.bufferRegId] = {\r\n      offset: this.program.arrayBuffer.length(),\r\n      size: size,\r\n      verticesSize: objBuffer.length,\r\n    };\r\n    this.program.arrayBuffer.push(objBuffer, size);\r\n    object.rendererBufferId = this.program.arrayBuffer.bufferRegId;\r\n    this.program.arrayBuffer.bufferRegId++;\r\n  }\r\n\r\n  toggleLighting(enable: boolean) {\r\n    this.program.toggleLighting(enable);\r\n  }\r\n}\r\n\r\nexport default Entity3DProgram;\r\n","export default \"\\r\\nprecision mediump int;\\r\\nprecision mediump float;\\r\\n\\r\\nattribute vec3 a_position;\\r\\n\\r\\nuniform mat4 u_projection;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_model;\\r\\nvoid main(void) {\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n}\\r\\n\\r\\n\";","import EntityManager from \"../Manager/EntityManager\";\r\nimport ObjectManager from \"../Manager/ObjectManager\";\r\nimport Coordinate from \"./Data/Coordinate\";\r\nimport EngineObject from \"./EngineEntity/EngineObject\";\r\nimport EngineHelper from \"./EngineHelper\";\r\nimport Renderer from \"./Renderer\";\r\nimport WorldDelegate from \"./WorldDelegate\";\r\n\r\nexport interface DebugCameraInfo {\r\n  position: Coordinate;\r\n  rotation: { ax: number; ay: number; az: number };\r\n  origin: Coordinate;\r\n}\r\n\r\nexport interface DebugEntityInfo {\r\n  type: string;\r\n  position: Coordinate;\r\n  hidden: boolean;\r\n  hasShaderEntity: boolean;\r\n  textureRef?: string;\r\n  bufferId?: number;\r\n  features: string[];\r\n  isLowPriority: boolean;\r\n}\r\n\r\nexport interface DebugInfo {\r\n  fps: number;\r\n  frameTime: number;\r\n  entityCount: number;\r\n  camera: DebugCameraInfo;\r\n  entities: DebugEntityInfo[];\r\n  webglInfo: {\r\n    faceCullingEnabled: boolean;\r\n    depthTestEnabled: boolean;\r\n    blendEnabled: boolean;\r\n    clearColor: string;\r\n  };\r\n  renderCalls: number;\r\n  lastError?: string;\r\n}\r\n\r\nexport default class EngineDebugger {\r\n  private debugElement: HTMLDivElement;\r\n  private isVisible: boolean = true;\r\n  private updateInterval: number | null = null;\r\n  private fpsCounter: number = 0;\r\n  private lastFrameTime: number = performance.now();\r\n  private frameTimeHistory: number[] = [];\r\n  private renderCallCount: number = 0;\r\n  private lastError: string | undefined;\r\n  private world: WorldDelegate | null = null;\r\n  private engineHelper: EngineHelper | null = null;\r\n  private renderer: Renderer | null = null;\r\n\r\n  constructor(private canvas: HTMLCanvasElement) {\r\n    this.createDebugUI();\r\n    this.startUpdating();\r\n    this.enableDebugOnRightClick();\r\n    this.hide();\r\n  }\r\n\r\n  /**\r\n   * Cleans up debugger UI and keyboard controls.\r\n   */\r\n  public destroy(): void {\r\n    if (this.updateInterval) {\r\n      clearInterval(this.updateInterval);\r\n      this.updateInterval = null;\r\n    }\r\n\r\n    if (this.debugElement && this.debugElement.parentElement) {\r\n      this.debugElement.parentElement.removeChild(this.debugElement);\r\n    }\r\n  }\r\n\r\n  private createDebugUI(): void {\r\n    // Create debug overlay container\r\n    this.debugElement = document.createElement('div');\r\n    this.debugElement.id = 'engine-debugger';\r\n    this.debugElement.style.cssText = `\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 10px;\r\n      background: rgba(0, 0, 0, 0.9);\r\n      color: #ffffff;\r\n      font-family: 'Courier New', monospace;\r\n      font-size: 12px;\r\n      padding: 15px;\r\n      border-radius: 8px;\r\n      min-width: 400px;\r\n      max-width: 500px;\r\n      max-height: 80vh;\r\n      overflow-y: auto;\r\n      z-index: 10000;\r\n      border: 1px solid #333;\r\n      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\r\n      line-height: 1.4;\r\n    `;\r\n\r\n    // Create the static structure that won't be replaced\r\n    this.createStaticStructure();\r\n\r\n    // Add to canvas parent or body\r\n    const parent = this.canvas.parentElement || document.body;\r\n    parent.style.position = 'relative'; // Ensure parent can contain absolute positioned children\r\n    parent.appendChild(this.debugElement);\r\n  }\r\n\r\n  private createStaticStructure(): void {\r\n    this.debugElement.innerHTML = `\r\n      <div style=\"margin-top: 25px;\">\r\n        <h3 style=\"margin: 0 0 10px 0; color: #4CAF50; font-size: 14px;\">Engine Debugger</h3>\r\n        \r\n        <div id=\"debug-performance\" style=\"margin-bottom: 10px;\">\r\n          <strong style=\"color: #FFD700;\">Performance:</strong><br>\r\n          <span id=\"perf-content\"></span>\r\n        </div>\r\n\r\n        <div id=\"debug-camera-controls\" style=\"margin-bottom: 15px; border: 1px solid #444; padding: 8px; border-radius: 4px;\">\r\n          <strong style=\"color: #FFD700;\">Camera Controls:</strong><br>\r\n          <div style=\"margin: 8px 0;\">\r\n            <strong>Position:</strong><br>\r\n            <div style=\"display: flex; gap: 5px; margin: 5px 0;\">\r\n              <div style=\"flex: 1;\">\r\n                X: <input id=\"cam-pos-x\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Y: <input id=\"cam-pos-y\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Z: <input id=\"cam-pos-z\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style=\"margin: 8px 0;\">\r\n            <strong>Rotation:</strong><br>\r\n            <div style=\"display: flex; gap: 5px; margin: 5px 0;\">\r\n              <div style=\"flex: 1;\">\r\n                X: <input id=\"cam-rot-x\" type=\"number\" step=\"1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Y: <input id=\"cam-rot-y\" type=\"number\" step=\"1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Z: <input id=\"cam-rot-z\" type=\"number\" step=\"1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style=\"margin: 8px 0;\">\r\n            <strong>Origin:</strong><br>\r\n            <div style=\"display: flex; gap: 5px; margin: 5px 0;\">\r\n              <div style=\"flex: 1;\">\r\n                X: <input id=\"cam-origin-x\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Y: <input id=\"cam-origin-y\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Z: <input id=\"cam-origin-z\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style=\"margin: 8px 0;\">\r\n            <button id=\"reset-camera-btn\" \r\n                    style=\"background: #4CAF50; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 11px;\">\r\n              Reset Camera\r\n            </button>\r\n            <button id=\"look-at-origin-btn\" \r\n                    style=\"background: #2196F3; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 11px; margin-left: 5px;\">\r\n              Look at Origin\r\n            </button>\r\n            <button id=\"reset-origin-btn\" \r\n                    style=\"background: #FF9800; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 11px; margin-left: 5px;\">\r\n              Fix Origin\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"debug-webgl\" style=\"margin-bottom: 10px;\">\r\n          <strong style=\"color: #FFD700;\">WebGL State:</strong><br>\r\n          <span id=\"webgl-content\"></span>\r\n        </div>\r\n\r\n        <div id=\"debug-entities\" style=\"margin-bottom: 10px;\">\r\n          <strong style=\"color: #FFD700;\">Entities (<span id=\"entity-count\">0</span>):</strong><br>\r\n          <div id=\"entities-container\" style=\"max-height: 180px; overflow-y: auto; overflow-x: hidden; border: 1px solid #444; padding: 5px; margin-top: 5px; background: rgba(0,0,0,0.3);\">\r\n            <!-- Entities will be populated here -->\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"debug-error\" style=\"margin-bottom: 10px; display: none;\">\r\n          <strong style=\"color: #FF4444;\">Last Error:</strong><br>\r\n          <span id=\"error-content\" style=\"color: #FF4444; font-size: 11px; word-break: break-word;\"></span>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    // Add toggle button\r\n    const toggleButton = document.createElement('button');\r\n    toggleButton.textContent = '';\r\n    toggleButton.style.cssText = `\r\n      position: absolute;\r\n      top: 5px;\r\n      right: 5px;\r\n      background: #ff4444;\r\n      color: white;\r\n      border: none;\r\n      border-radius: 3px;\r\n      width: 20px;\r\n      height: 20px;\r\n      cursor: pointer;\r\n      font-size: 14px;\r\n      line-height: 1;\r\n    `;\r\n    toggleButton.onclick = () => this.toggle();\r\n    this.debugElement.appendChild(toggleButton);\r\n\r\n    // Set up event listeners for camera controls\r\n    this.setupCameraControlEventListeners();\r\n  }\r\n\r\n  private startUpdating(): void {\r\n    this.updateInterval = window.setInterval(() => {\r\n      if (this.isVisible) {\r\n        this.updateDisplay();\r\n      }\r\n    }, 100); // Update 10 times per second\r\n  }\r\n\r\n  private calculateFPS(): number {\r\n    const now = performance.now();\r\n    const frameTime = now - this.lastFrameTime;\r\n    this.lastFrameTime = now;\r\n    \r\n    this.frameTimeHistory.push(frameTime);\r\n    if (this.frameTimeHistory.length > 60) {\r\n      this.frameTimeHistory.shift();\r\n    }\r\n    \r\n    const avgFrameTime = this.frameTimeHistory.reduce((a, b) => a + b, 0) / this.frameTimeHistory.length;\r\n    return Math.round(1000 / avgFrameTime);\r\n  }\r\n\r\n  public updateDebugInfo(engineHelper: EngineHelper | null): void {\r\n    this.fpsCounter = this.calculateFPS();\r\n    \r\n    if (!engineHelper || !this.isVisible) return;\r\n\r\n    const debugInfo = this.gatherDebugInfo(engineHelper);\r\n    this.renderDebugInfo(debugInfo);\r\n  }\r\n\r\n  public setReferences(world: WorldDelegate, renderer: Renderer): void {\r\n    this.world = world;\r\n    this.renderer = renderer;\r\n  }\r\n\r\n  public setEngineHelper(engineHelper: EngineHelper): void {\r\n    this.engineHelper = engineHelper;\r\n  }\r\n\r\n  private buildEntityInfo(entity: EngineObject): DebugEntityInfo {\r\n    return {\r\n      type: entity ? entity.constructor.name : 'null',\r\n      position: entity ? {\r\n        x: Math.round(entity.position.x * 100) / 100,\r\n        y: Math.round(entity.position.y * 100) / 100,\r\n        z: Math.round(entity.position.z * 100) / 100\r\n      } : { x: 0, y: 0, z: 0 },\r\n      hidden: entity ? entity.hidden : true,\r\n      hasShaderEntity: entity ? !!entity.shaderEntity : false,\r\n      textureRef: entity?.shaderEntity?.rendererTextureRef,\r\n      bufferId: entity?.shaderEntity?.rendererBufferId,\r\n      features: entity?.features?.map(f => f.constructor.name) || [],\r\n      isLowPriority: entity?.isLowPriority || false\r\n    };\r\n  }\r\n\r\n  private gatherDebugInfo(engineHelper: EngineHelper): DebugInfo {\r\n    const camera = engineHelper.camera;\r\n    \r\n    // Get WebGL context info from the canvas\r\n    const canvas = this.canvas;\r\n    const glContext = canvas.getContext('webgl') || canvas.getContext('experimental-webgl') as WebGLRenderingContext;\r\n    const webglInfo = glContext ? {\r\n      faceCullingEnabled: glContext.isEnabled(glContext.CULL_FACE),\r\n      depthTestEnabled: glContext.isEnabled(glContext.DEPTH_TEST),\r\n      blendEnabled: glContext.isEnabled(glContext.BLEND),\r\n      clearColor: this.getClearColorString(glContext)\r\n    } : {\r\n      faceCullingEnabled: false,\r\n      depthTestEnabled: false,\r\n      blendEnabled: false,\r\n      clearColor: 'unknown'\r\n    };\r\n\r\n    // Get camera info\r\n    const cameraInfo = {\r\n      position: { \r\n        x: Math.round(camera.getActiveCamera().position.x * 100) / 100, \r\n        y: Math.round(camera.getActiveCamera().position.y * 100) / 100, \r\n        z: Math.round(camera.getActiveCamera().position.z * 100) / 100 \r\n      },\r\n      rotation: { \r\n        ax: Math.round(camera.getActiveCamera().position.ax * 100) / 100, \r\n        ay: Math.round(camera.getActiveCamera().position.ay * 100) / 100, \r\n        az: Math.round(camera.getActiveCamera().position.az * 100) / 100 \r\n      },\r\n      origin: {\r\n        x: Math.round(camera.getActiveCamera().position.originX * 100) / 100,\r\n        y: Math.round(camera.getActiveCamera().position.originY * 100) / 100,\r\n        z: Math.round(camera.getActiveCamera().position.originZ * 100) / 100\r\n      }\r\n    };\r\n\r\n    const entities = this.world instanceof ObjectManager && this.world?.entities?.flatMap((entity: EngineObject, index) => {\r\n      if (entity instanceof EntityManager) {\r\n        return entity.entities.map(obj => this.buildEntityInfo(obj));\r\n      }\r\n      return this.buildEntityInfo(entity)\r\n    }) || [];\r\n\r\n    return {\r\n      fps: this.fpsCounter,\r\n      frameTime: this.frameTimeHistory.length > 0 ? \r\n        Math.round(this.frameTimeHistory[this.frameTimeHistory.length - 1] * 100) / 100 : 0,\r\n      entityCount: entities.length,\r\n      camera: cameraInfo,\r\n      entities: entities,\r\n      webglInfo: webglInfo,\r\n      renderCalls: this.renderCallCount,\r\n      lastError: this.lastError\r\n    };\r\n  }\r\n\r\n  private getClearColorString(ctx: WebGLRenderingContext): string {\r\n    const color = ctx.getParameter(ctx.COLOR_CLEAR_VALUE) as Float32Array;\r\n    return `rgba(${Math.round(color[0] * 255)}, ${Math.round(color[1] * 255)}, ${Math.round(color[2] * 255)}, ${color[3]})`;\r\n  }\r\n\r\n  private renderDebugInfo(info: DebugInfo): void {\r\n    const perfContent = this.debugElement.querySelector('#perf-content');\r\n    if (perfContent) {\r\n      perfContent.innerHTML = `\r\n        FPS: <span style=\"color: ${info.fps > 50 ? '#4CAF50' : info.fps > 30 ? '#FFA500' : '#FF4444'}\">${info.fps}</span><br>\r\n        Frame Time: ${info.frameTime}ms<br>\r\n        Render Calls: ${info.renderCalls}\r\n      `;\r\n    }\r\n\r\n    // Update camera controls with current values\r\n    this.updateCameraControls(info.camera);\r\n\r\n    // Update WebGL state\r\n    const webglContent = this.debugElement.querySelector('#webgl-content');\r\n    if (webglContent) {\r\n      webglContent.innerHTML = `\r\n        Face Culling: <span style=\"color: ${info.webglInfo.faceCullingEnabled ? '#4CAF50' : '#FF4444'}\">${info.webglInfo.faceCullingEnabled ? 'ON' : 'OFF'}</span><br>\r\n        Depth Test: <span style=\"color: ${info.webglInfo.depthTestEnabled ? '#4CAF50' : '#FF4444'}\">${info.webglInfo.depthTestEnabled ? 'ON' : 'OFF'}</span><br>\r\n        Blend: <span style=\"color: ${info.webglInfo.blendEnabled ? '#4CAF50' : '#FF4444'}\">${info.webglInfo.blendEnabled ? 'ON' : 'OFF'}</span><br>\r\n        Clear Color: ${info.webglInfo.clearColor}\r\n      `;\r\n    }\r\n\r\n    // Update entity count\r\n    const entityCountEl = this.debugElement.querySelector('#entity-count');\r\n    if (entityCountEl) {\r\n      entityCountEl.textContent = info.entityCount.toString();\r\n    }\r\n\r\n    // Update entities list efficiently - preserve scroll position\r\n    this.updateEntitiesList(info.entities);\r\n\r\n    // Update error display\r\n    this.updateErrorDisplay(info.lastError);\r\n  }\r\n\r\n  private updateCameraControls(camera: DebugInfo['camera']): void {\r\n    const posX = this.debugElement.querySelector('#cam-pos-x') as HTMLInputElement;\r\n    const posY = this.debugElement.querySelector('#cam-pos-y') as HTMLInputElement;\r\n    const posZ = this.debugElement.querySelector('#cam-pos-z') as HTMLInputElement;\r\n    const rotX = this.debugElement.querySelector('#cam-rot-x') as HTMLInputElement;\r\n    const rotY = this.debugElement.querySelector('#cam-rot-y') as HTMLInputElement;\r\n    const rotZ = this.debugElement.querySelector('#cam-rot-z') as HTMLInputElement;\r\n    \r\n    // Origin input elements\r\n    const originX = this.debugElement.querySelector('#cam-origin-x') as HTMLInputElement;\r\n    const originY = this.debugElement.querySelector('#cam-origin-y') as HTMLInputElement;\r\n    const originZ = this.debugElement.querySelector('#cam-origin-z') as HTMLInputElement;\r\n\r\n    if (posX && posX !== document.activeElement) {\r\n      posX.value = camera.position.x.toString();\r\n    }\r\n    if (posY && posY !== document.activeElement) {\r\n      posY.value = camera.position.y.toString();\r\n    }\r\n    if (posZ && posZ !== document.activeElement) {\r\n      posZ.value = camera.position.z.toString();\r\n    }\r\n    if (rotX && rotX !== document.activeElement) {\r\n      rotX.value = camera.rotation.ax.toString();\r\n    }\r\n    if (rotY && rotY !== document.activeElement) {\r\n      rotY.value = camera.rotation.ay.toString();\r\n    }\r\n    if (rotZ && rotZ !== document.activeElement) {\r\n      rotZ.value = camera.rotation.az.toString();\r\n    }\r\n\r\n    // Update origin input fields with proper styling based on values\r\n    if (originX && originX !== document.activeElement) {\r\n      originX.value = camera.origin.x.toString();\r\n      originX.style.borderColor = camera.origin.x === 0 ? '#4CAF50' : '#FF4444';\r\n    }\r\n    if (originY && originY !== document.activeElement) {\r\n      originY.value = camera.origin.y.toString();\r\n      originY.style.borderColor = camera.origin.y === 0 ? '#4CAF50' : '#FF4444';\r\n    }\r\n    if (originZ && originZ !== document.activeElement) {\r\n      originZ.value = camera.origin.z.toString();\r\n      originZ.style.borderColor = camera.origin.z === 0 ? '#4CAF50' : '#FF4444';\r\n    }\r\n  }\r\n\r\n  private updateEntitiesList(entities: DebugInfo['entities']): void {\r\n    const container = this.debugElement.querySelector('#entities-container');\r\n    if (!container) return;\r\n\r\n    // Save current scroll position\r\n    const scrollTop = container.scrollTop;\r\n\r\n    // Generate new content\r\n    const entitiesHtml = entities.map((entity, index) => `\r\n      <div style=\"margin-bottom: 5px; padding: 4px; border-left: 3px solid ${entity.hidden ? '#FF4444' : entity.isLowPriority ? '#FFA500' : '#4CAF50'}; background: rgba(255,255,255,0.05); border-radius: 2px;\">\r\n        <strong style=\"color: #87CEEB;\">${index}: ${entity.type}</strong>${entity.isLowPriority ? ' <span style=\"color: #FFA500; font-size: 10px;\">[LOW PRIORITY]</span>' : ''}<br>\r\n        <span style=\"font-size: 11px;\">\r\n          Pos: (${entity.position.x}, ${entity.position.y}, ${entity.position.z})<br>\r\n          Hidden: ${entity.hidden ? 'YES' : 'NO'} | \r\n          Shader: ${entity.hasShaderEntity ? 'YES' : 'NO'}<br>\r\n          ${entity.textureRef ? `Texture: <span style=\"color: #90EE90;\">${entity.textureRef}</span><br>` : ''}\r\n          ${entity.bufferId !== undefined ? `Buffer ID: <span style=\"color: #FFB6C1;\">${entity.bufferId}</span><br>` : '<span style=\"color: #FF6B6B;\">No Buffer</span><br>'}\r\n          ${entity.features.length > 0 ? `Features: <span style=\"color: #FFD700;\">${entity.features.join(', ')}</span>` : '<span style=\"color: #888;\">No Features</span>'}\r\n        </span>\r\n      </div>\r\n    `).join('');\r\n\r\n    // Only update if content has changed\r\n    if (container.innerHTML !== entitiesHtml) {\r\n      container.innerHTML = entitiesHtml;\r\n      // Restore scroll position\r\n      container.scrollTop = scrollTop;\r\n    }\r\n  }\r\n\r\n  private updateErrorDisplay(lastError?: string): void {\r\n    const errorDiv = this.debugElement.querySelector('#debug-error') as HTMLElement;\r\n    const errorContent = this.debugElement.querySelector('#error-content') as HTMLElement;\r\n    \r\n    if (lastError && errorDiv && errorContent) {\r\n      errorDiv.style.display = 'block';\r\n      errorContent.textContent = lastError;\r\n    } else if (errorDiv) {\r\n      errorDiv.style.display = 'none';\r\n    }\r\n  }\r\n\r\n  private updateDisplay(): void {\r\n\r\n  }\r\n\r\n  public toggle(): void {\r\n    this.isVisible = !this.isVisible;\r\n    this.debugElement.style.display = this.isVisible ? 'block' : 'none';\r\n  }\r\n\r\n  public show(): void {\r\n    this.isVisible = true;\r\n    this.debugElement.style.display = 'block';\r\n  }\r\n\r\n  public hide(): void {\r\n    this.isVisible = false;\r\n    this.debugElement.style.display = 'none';\r\n  }\r\n\r\n  public incrementRenderCalls(): void {\r\n    this.renderCallCount++;\r\n  }\r\n\r\n  public resetRenderCalls(): void {\r\n    this.renderCallCount = 0;\r\n  }\r\n\r\n  public logError(error: string): void {\r\n    this.lastError = error;\r\n    console.error('Engine Error:', error);\r\n  }\r\n\r\n\r\n\r\n  private setupCameraControlEventListeners(): void {\r\n    // Position controls\r\n    const posX = this.debugElement.querySelector('#cam-pos-x') as HTMLInputElement;\r\n    const posY = this.debugElement.querySelector('#cam-pos-y') as HTMLInputElement;\r\n    const posZ = this.debugElement.querySelector('#cam-pos-z') as HTMLInputElement;\r\n    \r\n    posX?.addEventListener('change', (e) => this.setCameraPosition('x', (e.target as HTMLInputElement).value));\r\n    posY?.addEventListener('change', (e) => this.setCameraPosition('y', (e.target as HTMLInputElement).value));\r\n    posZ?.addEventListener('change', (e) => this.setCameraPosition('z', (e.target as HTMLInputElement).value));\r\n\r\n    // Rotation controls\r\n    const rotX = this.debugElement.querySelector('#cam-rot-x') as HTMLInputElement;\r\n    const rotY = this.debugElement.querySelector('#cam-rot-y') as HTMLInputElement;\r\n    const rotZ = this.debugElement.querySelector('#cam-rot-z') as HTMLInputElement;\r\n    \r\n    rotX?.addEventListener('change', (e) => this.setCameraRotation('ax', (e.target as HTMLInputElement).value));\r\n    rotY?.addEventListener('change', (e) => this.setCameraRotation('ay', (e.target as HTMLInputElement).value));\r\n    rotZ?.addEventListener('change', (e) => this.setCameraRotation('az', (e.target as HTMLInputElement).value));\r\n\r\n    // Origin controls\r\n    const originX = this.debugElement.querySelector('#cam-origin-x') as HTMLInputElement;\r\n    const originY = this.debugElement.querySelector('#cam-origin-y') as HTMLInputElement;\r\n    const originZ = this.debugElement.querySelector('#cam-origin-z') as HTMLInputElement;\r\n    \r\n    originX?.addEventListener('change', (e) => this.setCameraOrigin('x', (e.target as HTMLInputElement).value));\r\n    originY?.addEventListener('change', (e) => this.setCameraOrigin('y', (e.target as HTMLInputElement).value));\r\n    originZ?.addEventListener('change', (e) => this.setCameraOrigin('z', (e.target as HTMLInputElement).value));\r\n\r\n    // Buttons\r\n    const resetBtn = this.debugElement.querySelector('#reset-camera-btn') as HTMLButtonElement;\r\n    const lookAtBtn = this.debugElement.querySelector('#look-at-origin-btn') as HTMLButtonElement;\r\n    const resetOriginBtn = this.debugElement.querySelector('#reset-origin-btn') as HTMLButtonElement;\r\n    \r\n    resetBtn?.addEventListener('click', () => this.resetCamera());\r\n    lookAtBtn?.addEventListener('click', () => this.lookAtOrigin());\r\n    resetOriginBtn?.addEventListener('click', () => this.resetCameraOrigin());\r\n  }\r\n\r\n  public enableDebugOnRightClick(): void {\r\n    this.canvas.addEventListener('contextmenu', (event) => {\r\n      event.preventDefault();\r\n\r\n      const debugMenu = document.createElement('div');\r\n      debugMenu.style.cssText = `\r\n        position: absolute;\r\n        top: ${event.clientY}px;\r\n        left: ${event.clientX}px;\r\n        background: #333;\r\n        color: white;\r\n        border: 1px solid #555;\r\n        padding: 10px;\r\n        border-radius: 5px;\r\n        z-index: 10001;\r\n      `;\r\n      debugMenu.innerHTML = '<button id=\"debug-toggle\">Toggle Debug</button>';\r\n\r\n      document.body.appendChild(debugMenu);\r\n\r\n      const toggleButton = debugMenu.querySelector('#debug-toggle') as HTMLButtonElement;\r\n      toggleButton.addEventListener('click', () => {\r\n        this.toggle();\r\n        document.body.removeChild(debugMenu);\r\n      });\r\n\r\n      document.addEventListener('click', () => {\r\n        if (document.body.contains(debugMenu)) {\r\n          document.body.removeChild(debugMenu);\r\n        }\r\n      }, { once: true });\r\n    });\r\n  }\r\n\r\n  private setCameraPosition(axis: string, value: string): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    switch (axis) {\r\n      case 'x':\r\n        camera.position.x = numValue;\r\n        break;\r\n      case 'y':\r\n        camera.position.y = numValue;\r\n        break;\r\n      case 'z':\r\n        camera.position.z = numValue;\r\n        break;\r\n    }\r\n    camera.updateProjectionView();\r\n  }\r\n\r\n  private setCameraRotation(axis: string, value: string): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    switch (axis) {\r\n      case 'ax':\r\n        camera.position.ax = numValue;\r\n        break;\r\n      case 'ay':\r\n        camera.position.ay = numValue;\r\n        break;\r\n      case 'az':\r\n        camera.position.az = numValue;\r\n        break;\r\n    }\r\n    camera.updateProjectionView();\r\n  }\r\n\r\n  private setCameraOrigin(axis: string, value: string): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    switch (axis) {\r\n      case 'x':\r\n        camera.position.originX = numValue;\r\n        break;\r\n      case 'y':\r\n        camera.position.originY = numValue;\r\n        break;\r\n      case 'z':\r\n        camera.position.originZ = numValue;\r\n        break;\r\n    }\r\n    camera.dirtyOrigin = true;\r\n    camera.dirtyQuat = true;\r\n    camera.dirtyModel = true;\r\n    camera.updateProjectionView();\r\n  }\r\n\r\n  private resetCamera(): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    camera.center(0, 2, 5);\r\n    camera.position.ax = 0;\r\n    camera.position.ay = 0;\r\n    camera.position.az = 0;\r\n    camera.updateProjectionView();\r\n    console.log('Camera reset to default position');\r\n  }\r\n\r\n  private lookAtOrigin(): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    camera.lookAt(0, 0, 0);\r\n    camera.updateProjectionView();\r\n    console.log('Camera looking at origin');\r\n  }\r\n\r\n  private resetCameraOrigin(): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    camera.position.originX = 0;\r\n    camera.position.originY = 0;\r\n    camera.position.originZ = 0;\r\n    camera.dirtyOrigin = true;\r\n    camera.dirtyQuat = true;\r\n    camera.dirtyModel = true;\r\n    camera.updateProjectionView();\r\n    console.log('Camera rotation origin reset to (0,0,0)');\r\n  }\r\n}\r\n","export class Notification {\r\n  key: string;\r\n  action: string;\r\n\r\n  constructor(key: string, action: string) {\r\n    this.key = key;\r\n    this.action = action;\r\n  }\r\n}\r\n\r\nexport class NotificationPayload extends Notification {\r\n  data?: any;\r\n\r\n  constructor(key: string, action: string, data?: any) {\r\n    super(key, action);\r\n    this.data = data;\r\n  }\r\n\r\n  static from(notification: Notification, data?: any): NotificationPayload {\r\n    return new NotificationPayload(notification.key, notification.action, data);\r\n  }\r\n}\r\n\r\nclass LinkedList {\r\n  next?: LinkedList;\r\n  data: NotificationPayload;\r\n\r\n  constructor(data: NotificationPayload) {\r\n    this.data = data;\r\n  }\r\n}\r\n\r\nclass NotificationQueue {\r\n  queueMap: { [key: string]: { bottom?: LinkedList; top?: LinkedList } };\r\n\r\n  constructor() {\r\n    this.queueMap = {};\r\n  }\r\n\r\n  clearQueue() {\r\n    this.queueMap = {};\r\n  }\r\n\r\n  pushPayload(notification: NotificationPayload) {\r\n    const key = notification.key;\r\n    let nodes = this.queueMap[key];\r\n    if (!nodes) {\r\n      this.queueMap[key] = { bottom: undefined, top: undefined };\r\n      nodes = this.queueMap[key];\r\n    }\r\n    if (!nodes.bottom) {\r\n      nodes.bottom = new LinkedList(notification);\r\n      nodes.top = nodes.bottom;\r\n    } else if (nodes.top) {\r\n      nodes.top.next = new LinkedList(notification);\r\n      nodes.top = nodes.top.next;\r\n    } else {\r\n      throw new Error(\"Unexpected state for notification push payload\");\r\n    }\r\n  }\r\n\r\n  push(notification: Notification, data?: any) {\r\n    if (notification instanceof NotificationPayload) {\r\n      console.error(\"Please use pushPayload\");\r\n    }\r\n    this.pushPayload(\r\n      new NotificationPayload(notification.key, notification.action, data)\r\n    );\r\n  }\r\n\r\n  pushNotification(key: string, action: string) {\r\n    this.push(new Notification(key, action));\r\n  }\r\n\r\n  take(key: string): NotificationPayload | undefined {\r\n    const bottom = this.getBottom(key);\r\n    if (!bottom) {\r\n      return undefined;\r\n    }\r\n    const data = this.peak(key);\r\n    if (!data) {\r\n      throw new Error(\r\n        \"Expected data to appear when reading data from notification\"\r\n      );\r\n    }\r\n    this.shiftQueue(key);\r\n    return data;\r\n  }\r\n\r\n  shiftQueue(key: string) {\r\n    const nodes = this.queueMap[key];\r\n    const bottom = nodes.bottom;\r\n    if (bottom) {\r\n      nodes.bottom = bottom.next;\r\n      if (!nodes.bottom) {\r\n        nodes.top = undefined;\r\n      }\r\n    } else {\r\n      throw new Error(\"Trying to shift queue with bottom undefined\");\r\n    }\r\n  }\r\n\r\n  getBottom(key: string): LinkedList | undefined {\r\n    return this.queueMap[key] ? this.queueMap[key].bottom : undefined;\r\n  }\r\n\r\n  peak(key: string): NotificationPayload | undefined {\r\n    const bottom = this.getBottom(key);\r\n    return (bottom && bottom.data) || undefined;\r\n  }\r\n}\r\n\r\nexport default NotificationQueue;\r\n","export default \"\\r\\nprecision mediump int;\\r\\nprecision mediump float;\\r\\n\\r\\nattribute vec3 a_position;\\r\\nattribute vec2 a_texture_coords;\\r\\nattribute vec3 a_normal;\\r\\n\\r\\nuniform mat4 u_projection;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_model;\\r\\n\\r\\nuniform vec3 u_light1_pos;\\r\\nuniform vec3 u_light1_intensities;\\r\\nuniform float u_light1_attenuation;\\r\\nuniform float u_light1_ambient_coefficient;\\r\\nuniform mat4 u_light1_view;\\r\\nuniform mat4 u_light1_projection;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\n\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\nvarying vec4 v_shadow_pos;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nfloat transpose(float m) {\\r\\n  return m;\\r\\n}\\r\\n\\r\\nmat2 transpose(mat2 m) {\\r\\n  return mat2(m[0][0], m[1][0],\\r\\n    m[0][1], m[1][1]);\\r\\n}\\r\\n\\r\\nmat3 transpose(mat3 m) {\\r\\n  return mat3(m[0][0], m[1][0], m[2][0],\\r\\n    m[0][1], m[1][1], m[2][1],\\r\\n    m[0][2], m[1][2], m[2][2]);\\r\\n}\\r\\n\\r\\nmat4 transpose(mat4 m) {\\r\\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\\r\\n    m[0][1], m[1][1], m[2][1], m[3][1],\\r\\n    m[0][2], m[1][2], m[2][2], m[3][2],\\r\\n    m[0][3], m[1][3], m[2][3], m[3][3]);\\r\\n}\\r\\n\\r\\nfloat inverse(float m) {\\r\\n  return 1.0 / m;\\r\\n}\\r\\n\\r\\nmat2 inverse(mat2 m) {\\r\\n  return mat2(m[1][1], -m[0][1],\\r\\n    -m[1][0], m[0][0]) / (m[0][0] * m[1][1] - m[0][1] * m[1][0]);\\r\\n}\\r\\n\\r\\nmat3 inverse(mat3 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\\r\\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\\r\\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\\r\\n\\r\\n  float b01 = a22 * a11 - a12 * a21;\\r\\n  float b11 = -a22 * a10 + a12 * a20;\\r\\n  float b21 = a21 * a10 - a11 * a20;\\r\\n\\r\\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\\r\\n\\r\\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\\r\\n    b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\\r\\n    b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\\r\\n}\\r\\n\\r\\nmat4 inverse(mat4 m) {\\r\\n  float\\r\\n  a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n    a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n    a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n    a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\\r\\n\\r\\n    b00 = a00 * a11 - a01 * a10,\\r\\n    b01 = a00 * a12 - a02 * a10,\\r\\n    b02 = a00 * a13 - a03 * a10,\\r\\n    b03 = a01 * a12 - a02 * a11,\\r\\n    b04 = a01 * a13 - a03 * a11,\\r\\n    b05 = a02 * a13 - a03 * a12,\\r\\n    b06 = a20 * a31 - a21 * a30,\\r\\n    b07 = a20 * a32 - a22 * a30,\\r\\n    b08 = a20 * a33 - a23 * a30,\\r\\n    b09 = a21 * a32 - a22 * a31,\\r\\n    b10 = a21 * a33 - a23 * a31,\\r\\n    b11 = a22 * a33 - a23 * a32,\\r\\n\\r\\n    det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat4(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03,\\r\\n    a22 * b04 - a21 * b05 - a23 * b03,\\r\\n    a12 * b08 - a10 * b11 - a13 * b07,\\r\\n    a00 * b11 - a02 * b08 + a03 * b07,\\r\\n    a32 * b02 - a30 * b05 - a33 * b01,\\r\\n    a20 * b05 - a22 * b02 + a23 * b01,\\r\\n    a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a30 * b04 - a31 * b02 + a33 * b00,\\r\\n    a21 * b02 - a20 * b04 - a23 * b00,\\r\\n    a11 * b07 - a10 * b09 - a12 * b06,\\r\\n    a00 * b09 - a01 * b07 + a02 * b06,\\r\\n    a31 * b01 - a30 * b03 - a32 * b00,\\r\\n    a20 * b03 - a21 * b01 + a22 * b00) / det;\\r\\n}\\r\\n\\r\\nconst mat4 norm_shadow_coords = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n    v_texture_coords = a_texture_coords;\\r\\n    return;\\r\\n  }\\r\\n  \\r\\n  v_texture_coords = a_texture_coords;\\r\\n  v_position = a_position;\\r\\n  v_normal = a_normal;\\r\\n  v_model = u_model;\\r\\n\\r\\n  v_light1_pos = u_light1_pos;\\r\\n  v_light1_intensities = u_light1_intensities;\\r\\n  v_light1_attenuation = u_light1_attenuation;\\r\\n  v_light1_ambient_coefficient = u_light1_ambient_coefficient;\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec3 surfacePos = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  mat3 normalMatrix = transpose(inverse(mat3(v_model)));\\r\\n  vec3 normal = normalize(normalMatrix * v_normal);\\r\\n\\r\\n  vec3 fragPosition = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  vec3 surfaceToLight = light1.position - fragPosition;\\r\\n\\r\\n  float brightness = dot(normal, surfaceToLight) / (length(surfaceToLight) * length(normal));\\r\\n  if (brightness > 1.0) {\\r\\n    brightness = 1.0;\\r\\n  } else if (brightness < 0.0) {\\r\\n    brightness = 0.0;\\r\\n  }\\r\\n\\r\\n  float distanceToLight = length(light1.position - surfacePos);\\r\\n\\r\\n  v_diffuseCoefficient = max(0.0, dot(normal, surfaceToLight));\\r\\n  v_attenuation = 1.0 / (1.0 + light1.attenuation * pow(distanceToLight, 2.0));\\r\\n  v_shadow_pos = norm_shadow_coords * u_light1_projection * u_light1_view * u_model * vec4(a_position, 1.0);\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n}\\r\\n\\r\\n\";","import RenderOption, {\r\n  ShaderType,\r\n  RenderType,\r\n} from \"../Core/Data/RenderOption\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport ShaderEntityBuilder from \"../Core/Builder/ShaderEntityBuilder\";\r\nimport VertexModel from \"../Core/Data/VertexModel\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport Colour from \"../Core/Data/Colour\";\r\nimport ColourVertexModel from \"../Core/Data/ColourVertexModel\";\r\nimport EngineObjectHelper from \"../Core/EngineEntity/EngineObjectHelper\";\r\n\r\nexport default class PlaneColour extends EngineObject {\r\n  vertexModel: VertexModel;\r\n  constructor(rect: Rect2d, private rgba: Colour) {\r\n    super();\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = new ColourVertexModel().fillRenderUnits(\r\n      EngineObjectHelper.vertex.planeXYColour(\r\n        this.rgba || new Colour(0, 0, 0, 0)\r\n      )\r\n    );\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.TRIANGLE;\r\n    renderOpt.shaderType = ShaderType.COLOUR;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import EntityManager from \"./EntityManager\";\r\nimport Plane2d from \"../Entity/Plane2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class EntityManager2d extends EntityManager {\r\n  setLayer(priority: number): any {\r\n    this.entities.forEach((entity) => {\r\n      if (entity instanceof Plane2d) {\r\n        entity.setLayer(priority);\r\n      }\r\n    });\r\n    this.position.z = -1 * priority;\r\n    return this;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    super.init(engineHelper);\r\n    this.setLayer(-this.position.z);\r\n  }\r\n}\r\n","import ShaderEntityBuilder from \"../Core/Builder/ShaderEntityBuilder\";\r\nimport ColourVertexModel from \"../Core/Data/ColourVertexModel\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport RenderOption, {\r\n  RenderType,\r\n  ShaderType,\r\n} from \"../Core/Data/RenderOption\";\r\nimport { Colour } from \"../Core/Data/RenderUnit\";\r\nimport VertexModel from \"../Core/Data/VertexModel\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"../Core/EngineEntity/EngineObjectHelper\";\r\nimport { ShaderEntity } from \"../Core/EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class TriangleColour2d extends EngineObject {\r\n  vertexModel: VertexModel;\r\n  constructor(rect: Rect2d, rgba: Colour) {\r\n    super();\r\n    this.vertexModel = new ColourVertexModel().fillRenderUnits(\r\n      EngineObjectHelper.vertex.triangleXYColour(rgba)\r\n    );\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.TRIANGLE;\r\n    renderOpt.shaderType = ShaderType.COLOUR;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","export class FontMeta {\r\n  filename: string;\r\n  height: number;\r\n  width: number;\r\n  fonts: { [key: string]: FontCharacter } = {};\r\n  lineHeight: number;\r\n}\r\n\r\nexport class FontCharacter {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  charCode: number;\r\n  char: string;\r\n  xOffset: number;\r\n  yOffset: number;\r\n}\r\n\r\nclass FontMetaData {\r\n  context: FontMeta;\r\n}\r\n\r\nexport default FontMetaData;\r\n","import ShaderEntityBuilder from \"../Builder/ShaderEntityBuilder\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport RenderOption, { RenderType, ShaderType } from \"../Data/RenderOption\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport EngineObject from \"./EngineObject\";\r\nimport { ShaderEntity } from \"./ShaderEntity\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\n\r\nexport default class ModelObjectRect3d extends EngineObject {\r\n  public vertexModel: TextureVertexModel;\r\n\r\n  constructor(rect: Rect3d, vertexModel: TextureVertexModel) {\r\n    super();\r\n    this.vertexModel = vertexModel;\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.RECTANGLE;\r\n    renderOpt.shaderType = ShaderType.THREE_DIMENSION;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .createTexture(this.vertexModel.textureSource)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import WorldDelegate from \"./WorldDelegate\";\r\nimport EngineHelper from \"./EngineHelper\";\r\n\r\nexport default class Updater {\r\n  world: WorldDelegate;\r\n\r\n  constructor(args: { [key: string]: any }) {\r\n    if (!args.world) {\r\n      throw new Error(\"world not defined\");\r\n    }\r\n    this.world = args.world;\r\n  }\r\n\r\n  update(time: number, engineHelper: EngineHelper) {\r\n    engineHelper.setTime(time);\r\n    this.world.update();\r\n    engineHelper.updateFont();\r\n  }\r\n}\r\n","import { vec3 } from \"gl-matrix\";\r\nimport { ModelPosition } from \"..\";\r\nimport { AppSubscription } from \"./App\";\r\nimport Camera from \"./Camera\";\r\nimport NotificationQueue from \"./Common/NotificationQueue\";\r\nimport SubscriberPool from \"./Common/SubscriberPool\";\r\nimport FontMetaData from \"./Data/FontMetaData\";\r\nimport Light from \"./Data/Light\";\r\nimport ModelData from \"./Data/ModelData\";\r\nimport PlaneType from \"./Data/PlaneType\";\r\nimport Rect3d from \"./Data/Rect3d\";\r\nimport { ShaderType } from \"./Data/RenderOption\";\r\nimport TextureVertexModel from \"./Data/TextureVertexModel\";\r\nimport EngineObject from \"./EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"./EngineEntity/EngineObjectHelper\";\r\nimport Position from \"./EngineEntity/Position\";\r\nimport { ShaderEntity } from \"./EngineEntity/ShaderEntity\";\r\nimport { EngineEvent } from \"./Events\";\r\nimport Font, { FontReference } from \"./Font/Font\";\r\nimport { CollisionDetection } from \"./Physics/CollisionDetection\";\r\nimport { RendererNotification, RendererSubscription } from \"./Renderer\";\r\n\r\nexport default class EngineHelper {\r\n  notificationQueue: NotificationQueue;\r\n  subscriberPool: SubscriberPool;\r\n  resourcesLoading: Promise<RetrieveResource>[] = [];\r\n  bufferCache: { [key: number]: ModelData } = {};\r\n  fontCache: { [key: number]: { meta: FontMetaData; font: Font } } = {};\r\n  fontNameKeyReverse: { [key: string]: number } = {};\r\n  uvCache: { [key: string]: { source: string; uv: number[] } } = {};\r\n  vertexUVCache: { [key: string]: { source: string; uv: number[] } } = {};\r\n  camera: Camera;\r\n  time: number;\r\n  cacheId = 0;\r\n  fps: number;\r\n  \r\n  constructor(\r\n    notificationQueue: NotificationQueue,\r\n    subscriberPool: SubscriberPool,\r\n    camera: Camera\r\n  ) {\r\n    this.camera = camera;\r\n    this.notificationQueue = notificationQueue;\r\n    this.subscriberPool = subscriberPool;\r\n    subscriberPool.listen(AppSubscription.GET_FPS, (fps) => (this.fps = fps));\r\n  }\r\n\r\n  startIteration() {\r\n    this.subscriberPool.publish(AppSubscription.START_ITERATION);\r\n  }\r\n\r\n  render(entity: ShaderEntity) {\r\n    const shaderProgram = entity.opt.shaderType;\r\n    if (\r\n      this.camera.renderMode === '2d' &&\r\n      (shaderProgram === ShaderType.TWO_DIMENSION ||\r\n        shaderProgram === ShaderType.COLOUR) &&\r\n      this.camera.camera2d.isOutOfBound(entity.modelPosition())\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    let model = entity.getModel();\r\n    if (entity.clone) {\r\n      model = model.slice(0);\r\n    }\r\n\r\n    if (this.camera.renderMode === '3d') {\r\n      this.renderWithCulling(entity, model);\r\n      return;\r\n    }\r\n\r\n    this.notificationQueue.pushPayload(\r\n      RendererNotification.renderEntity(entity, model)\r\n    );\r\n  }\r\n\r\n  renderCopy(entity: EngineObject, pos: ModelPosition) {\r\n    this.render(entity.shaderEntity.renderCopy(pos));\r\n  }\r\n\r\n    /**\r\n   * Distance-based culling - objects beyond a certain distance are not rendered\r\n   * @param entity The engine object to test\r\n   * @param cameraPosition Camera position\r\n   * @param maxDistance Maximum rendering distance\r\n   * @returns true if the object should be rendered\r\n   */\r\n  isEntityWithinDistance(entity: EngineObject, cameraPosition: vec3, maxDistance: number): boolean {\r\n    if (!entity || !entity.position) {\r\n      return true;\r\n    }\r\n\r\n    const entityPos = vec3.fromValues(\r\n      entity.position.x || 0,\r\n      entity.position.y || 0,\r\n      entity.position.z || 0\r\n    );\r\n\r\n    const distance = vec3.distance(cameraPosition, entityPos);\r\n    return distance <= maxDistance;\r\n  }\r\n\r\n\r\n  /**\r\n   * Render an EngineObject with frustum and distance culling\r\n   * @param entity The EngineObject to render\r\n   * @returns true if the entity was rendered, false if culled\r\n   */\r\n  renderWithCulling(entity: ShaderEntity, model: Float32List): boolean {\r\n    if (!entity) {\r\n      return false;\r\n    }\r\n\r\n    const entityPosition = entity.modelPosition();\r\n    \r\n    const entitySize = Math.max(\r\n      entityPosition.width || 1,\r\n      entityPosition.height || 1,\r\n      entityPosition.length || 1\r\n    );\r\n    \r\n    // If entity is very large (> 100 units), likely a sky/background object - always render\r\n    if (entitySize > 100) {\r\n      this.notificationQueue.pushPayload(\r\n        RendererNotification.renderEntity(entity, model)\r\n      );\r\n      return true;\r\n    }\r\n\r\n    const camera3d = this.camera.camera3d;\r\n    \r\n    const cameraPos = vec3.fromValues(\r\n      camera3d.position.x || 0,\r\n      camera3d.position.y || 0,\r\n      camera3d.position.z || 0\r\n    );\r\n    \r\n    const entityPos3d = vec3.fromValues(\r\n      entityPosition.x || 0,\r\n      entityPosition.y || 0,\r\n      entityPosition.z || 0\r\n    );\r\n    \r\n    const yawRad = camera3d.degreesToRadians(camera3d.position.ay);\r\n    const pitchRad = camera3d.degreesToRadians(camera3d.position.ax);\r\n    \r\n    const cameraForward = vec3.fromValues(\r\n      Math.sin(yawRad) * Math.cos(pitchRad),\r\n      -Math.sin(pitchRad),\r\n      -Math.cos(yawRad) * Math.cos(pitchRad)\r\n    );\r\n    vec3.normalize(cameraForward, cameraForward);\r\n    \r\n    const toEntity = vec3.create();\r\n    vec3.subtract(toEntity, entityPos3d, cameraPos);\r\n    const distance = vec3.length(toEntity);\r\n    \r\n    if (distance < camera3d.near) {\r\n      this.notificationQueue.pushPayload(\r\n        RendererNotification.renderEntity(entity, model)\r\n      );\r\n      return true;\r\n    }\r\n    \r\n    if (distance > camera3d.far) {\r\n      return false;\r\n    }\r\n    \r\n    vec3.normalize(toEntity, toEntity);\r\n    \r\n    const dot = vec3.dot(cameraForward, toEntity);\r\n    \r\n    if (dot <= 0) {\r\n      return false;\r\n    }\r\n    \r\n    const angle = Math.acos(Math.max(0, Math.min(1, dot)));\r\n    \r\n    const fov = camera3d.fov;\r\n    const fovRadians = (fov * Math.PI) / 180;\r\n    const halfFov = fovRadians / 2;\r\n    \r\n    const angularSize = Math.atan(entitySize / Math.max(distance, 1));\r\n    const padding = angularSize + 0.3;\r\n    \r\n    const effectiveHalfFov = halfFov + padding;\r\n    \r\n    if (angle > effectiveHalfFov) {\r\n      return false;\r\n    }\r\n\r\n    this.notificationQueue.pushPayload(\r\n      RendererNotification.renderEntity(entity, model)\r\n    );\r\n    return true;\r\n  }\r\n\r\n  setLighting(light: Light) {\r\n    this.notificationQueue.pushPayload(RendererNotification.setLighting(light));\r\n  }\r\n\r\n  createTexture(object: ShaderEntity) {\r\n    this.subscriberPool.publish(\r\n      RendererSubscription.CREATE_TEXTURE,\r\n      RendererSubscription.createTexturePayload(object, this.resourcesLoading)\r\n    );\r\n  }\r\n\r\n  getFPS(): number {\r\n    return this.fps;\r\n  }\r\n\r\n  getTotalPixelHeight(): number {\r\n    return window.screen.height;\r\n  }\r\n\r\n  getTotalPixelWidth(): number {\r\n    return window.screen.width;\r\n  }\r\n\r\n  getScreenHeight(): number {\r\n    return this.camera.height;\r\n  }\r\n\r\n  getScreenWidth(): number {\r\n    return this.camera.width;\r\n  }\r\n\r\n  setTime(time: number) {\r\n    if (time) {\r\n      this.time = time;\r\n    }\r\n  }\r\n\r\n  getTime() {\r\n    return this.time;\r\n  }\r\n\r\n  getVerticesById(id: number): number[] {\r\n    if (this.bufferCache[id]) {\r\n      return this.bufferCache[id].vertices;\r\n    } else {\r\n      console.error(\"Unable to find src in cache\", id, this);\r\n      throw new Error(\"unable to find src in cache\");\r\n    }\r\n  }\r\n\r\n  updateBufferCache(buffer: ModelData, verticesCacheId: number): number {\r\n    buffer.cacheId = verticesCacheId;\r\n    this.bufferCache[verticesCacheId] = buffer;\r\n    return verticesCacheId;\r\n  }\r\n\r\n  addBufferCache(buffer: ModelData): number {\r\n    const cacheId = this.cacheId++;\r\n    this.bufferCache[cacheId] = buffer;\r\n    buffer.cacheId = cacheId;\r\n    return cacheId;\r\n  }\r\n\r\n  getResource(src: string): Promise<RetrieveResource> {\r\n    const promise = new Promise<RetrieveResource>((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      console.log(`Loading resource ${src}`);\r\n      xhr.open(\"GET\", src);\r\n      xhr.onreadystatechange = () => {\r\n        if (xhr.readyState === XMLHttpRequest.DONE) {\r\n          // handle file:// loading with status 0\r\n          if (xhr.status === 200 || xhr.status === 0) {\r\n            const cacheId = this.cacheId++;\r\n            resolve({\r\n              data: xhr.responseText,\r\n              engineHelper: this,\r\n              cacheId: cacheId,\r\n\r\n              registerBuffer: (obj: ModelData) => {\r\n                this.bufferCache[cacheId] = obj;\r\n              },\r\n\r\n              registerFont: (meta: FontMetaData) => {\r\n                const font = new Font(meta);\r\n                this.fontCache[cacheId] = {\r\n                  meta: meta,\r\n                  font: font,\r\n                };\r\n                this.fontNameKeyReverse[src] = cacheId;\r\n              },\r\n            });\r\n          } else {\r\n            reject(xhr.responseText);\r\n          }\r\n        }\r\n      };\r\n      xhr.send();\r\n    });\r\n    this.resourcesLoading.push(promise);\r\n    return promise;\r\n  }\r\n\r\n  getAllResourcesLoading(): Promise<RetrieveResource[]> {\r\n    return Promise.all(this.resourcesLoading);\r\n  }\r\n\r\n  updateBuffer(object: ShaderEntity) {\r\n    this.updateBufferCache(\r\n      object.vertexModel.createModel(),\r\n      object.vertexModel.vertexBufferId\r\n    );\r\n    const notification = RendererNotification.updateBuffer(\r\n      object,\r\n      this.getBuffer(object)\r\n    );\r\n    this.notificationQueue.pushPayload(notification);\r\n  }\r\n\r\n  getBufferModelData(object: ShaderEntity): ModelData {\r\n    return this.bufferCache[object.getVertexBufferId()];\r\n  }\r\n\r\n  getBuffer(object: ShaderEntity): number[] {\r\n    const buffer: number[] = this.getBufferModelData(object).vertices;\r\n    if (!buffer) {\r\n      throw new Error(\"No buffer was found for this entity\");\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity) {\r\n    this.subscriberPool.publish(\r\n      RendererSubscription.REGISTER_ENTITY,\r\n      RendererSubscription.registerEntityPayload(\r\n        object,\r\n        this.getBufferModelData(object)\r\n      )\r\n    );\r\n  }\r\n\r\n  initFont() {\r\n    for (const fontType in this.fontCache) {\r\n      if (!this.fontCache.hasOwnProperty(fontType)) {\r\n        continue;\r\n      }\r\n      const font = this.fontCache[fontType].font;\r\n      font.init(this);\r\n    }\r\n  }\r\n\r\n  renderFont() {\r\n    for (const fontType in this.fontCache) {\r\n      if (!this.fontCache.hasOwnProperty(fontType)) {\r\n        continue;\r\n      }\r\n      const font = this.fontCache[fontType].font;\r\n      font.render(this);\r\n    }\r\n  }\r\n\r\n  updateFont() {\r\n    for (const fontType in this.fontCache) {\r\n      if (!this.fontCache.hasOwnProperty(fontType)) {\r\n        continue;\r\n      }\r\n      const font = this.fontCache[fontType].font;\r\n      font.update(this);\r\n    }\r\n  }\r\n\r\n  newVertexModel2d(cacheId: string): TextureVertexModel {\r\n    return this.newVertexModel(cacheId, PlaneType.YX);\r\n  }\r\n\r\n  newVertexModelUv3d(cacheId: string): TextureVertexModel {\r\n    const cache = this.vertexUVCache[cacheId];\r\n    const vertexModel = new TextureVertexModel().fillRenderUnits(cache.uv);\r\n    vertexModel.textureSource = cache.source;\r\n    return vertexModel;\r\n  }\r\n\r\n  createPlaneVertexModel(\r\n    src: string,\r\n    uv: number[],\r\n    plane: PlaneType\r\n  ): TextureVertexModel {\r\n    const vertexModel = new TextureVertexModel().createRenderUnits(4);\r\n    vertexModel.textureSource = src;\r\n    EngineObjectHelper.vertex.plane(vertexModel.renderUnits, plane);\r\n    EngineObjectHelper.vertex.planeUV(vertexModel.renderUnits, uv);\r\n    return vertexModel;\r\n  }\r\n\r\n  getUVCache(name: string): number[] {\r\n    return this.uvCache[name].uv;\r\n  }\r\n\r\n  addUVCache(source: string, name: string, uv: number[]) {\r\n    this.uvCache[name] = { source: source, uv: uv };\r\n  }\r\n\r\n  getVertexUvCache(name: string): number[] {\r\n    return this.vertexUVCache[name].uv;\r\n  }\r\n\r\n  newVertexModel(cacheId: string, plane: PlaneType): TextureVertexModel {\r\n    const cache = this.uvCache[cacheId];\r\n    if (!cache) {\r\n      const cache = this.uvCache[\"missing\"];\r\n      console.warn(\r\n        `texture ${cacheId} has not been loaded - loading default texture`\r\n      );\r\n      return this.createPlaneVertexModel(cache.source, cache.uv, plane);\r\n    }\r\n    return this.createPlaneVertexModel(cache.source, cache.uv, plane);\r\n  }\r\n\r\n  addVertexUvCache(textureSource: string, name: string, vertexUv: number[]) {\r\n    this.vertexUVCache[name] = { source: textureSource, uv: vertexUv };\r\n  }\r\n\r\n  writeFont(fontRef: FontReference): FontReference {\r\n    let fontCacheId: number | undefined = undefined;\r\n    if (typeof fontRef.$cacheId === \"string\") {\r\n      fontCacheId = this.fontNameKeyReverse[fontRef.$cacheId];\r\n    } else if (typeof fontRef.$cacheId === \"number\") {\r\n      fontCacheId = fontRef.$cacheId;\r\n    } else if (fontRef.$cacheId !== undefined) {\r\n      throw new Error(\"fontId is not a number or string\");\r\n    }\r\n    let font: Font;\r\n    if (fontCacheId === undefined) {\r\n      font = Font.DefaultFont;\r\n    } else {\r\n      font = this.fontCache[fontCacheId].font;\r\n    }\r\n    return font.writeRef(fontRef);\r\n  }\r\n\r\n  isClickedObject(event: EngineEvent, object: EngineObject) {\r\n    return this.isClicked(event, object.getRect2());\r\n  }\r\n\r\n  isClicked(event: EngineEvent, rect: Rect3d) {\r\n    const distance = this.camera.camera2d.distanceEvent(event);\r\n    return CollisionDetection.isPointInRect(rect, distance);\r\n  }\r\n\r\n  rotate(event: EngineEvent, rect: Position) {\r\n    const { x, y } = this.camera.camera2d.position;\r\n    return CollisionDetection.rotate(x + event.x, y + event.y, rect);\r\n  }\r\n\r\n  updateProjectionMatrix() {\r\n    this.notificationQueue.pushPayload(\r\n      RendererNotification.UPDATE_PROJECTION_MATRIX\r\n    );\r\n  }\r\n}\r\n\r\nexport declare interface RetrieveResource {\r\n  data: string;\r\n  engineHelper: EngineHelper;\r\n  cacheId: number;\r\n  registerBuffer: (obj: ModelData) => void;\r\n  registerFont: (font: FontMetaData) => void;\r\n}\r\n","export default \"precision mediump int;\\r\\nprecision mediump float;\\r\\n\\r\\nattribute vec3 a_position;\\r\\nattribute vec2 a_texture_coords;\\r\\nattribute vec3 a_normal;\\r\\n\\r\\nuniform mat4 u_projection;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_model;\\r\\n\\r\\nuniform vec3 u_light1_pos;\\r\\nuniform vec3 u_light1_intensities;\\r\\nuniform float u_light1_attenuation;\\r\\nuniform float u_light1_ambient_coefficient;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nfloat transpose(float m) {\\r\\n  return m;\\r\\n}\\r\\n\\r\\nmat2 transpose(mat2 m) {\\r\\n  return mat2(m[0][0], m[1][0],\\r\\n    m[0][1], m[1][1]);\\r\\n}\\r\\n\\r\\nmat3 transpose(mat3 m) {\\r\\n  return mat3(m[0][0], m[1][0], m[2][0],\\r\\n    m[0][1], m[1][1], m[2][1],\\r\\n    m[0][2], m[1][2], m[2][2]);\\r\\n}\\r\\n\\r\\nmat4 transpose(mat4 m) {\\r\\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\\r\\n    m[0][1], m[1][1], m[2][1], m[3][1],\\r\\n    m[0][2], m[1][2], m[2][2], m[3][2],\\r\\n    m[0][3], m[1][3], m[2][3], m[3][3]);\\r\\n}\\r\\n\\r\\nfloat inverse(float m) {\\r\\n  return 1.0 / m;\\r\\n}\\r\\n\\r\\nmat2 inverse(mat2 m) {\\r\\n  return mat2(m[1][1], -m[0][1],\\r\\n    -m[1][0], m[0][0]) / (m[0][0] * m[1][1] - m[0][1] * m[1][0]);\\r\\n}\\r\\n\\r\\nmat3 inverse(mat3 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\\r\\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\\r\\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\\r\\n\\r\\n  float b01 = a22 * a11 - a12 * a21;\\r\\n  float b11 = -a22 * a10 + a12 * a20;\\r\\n  float b21 = a21 * a10 - a11 * a20;\\r\\n\\r\\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\\r\\n\\r\\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\\r\\n    b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\\r\\n    b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\\r\\n}\\r\\n\\r\\nmat4 inverse(mat4 m) {\\r\\n  float\\r\\n  a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n    a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n    a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n    a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\\r\\n\\r\\n    b00 = a00 * a11 - a01 * a10,\\r\\n    b01 = a00 * a12 - a02 * a10,\\r\\n    b02 = a00 * a13 - a03 * a10,\\r\\n    b03 = a01 * a12 - a02 * a11,\\r\\n    b04 = a01 * a13 - a03 * a11,\\r\\n    b05 = a02 * a13 - a03 * a12,\\r\\n    b06 = a20 * a31 - a21 * a30,\\r\\n    b07 = a20 * a32 - a22 * a30,\\r\\n    b08 = a20 * a33 - a23 * a30,\\r\\n    b09 = a21 * a32 - a22 * a31,\\r\\n    b10 = a21 * a33 - a23 * a31,\\r\\n    b11 = a22 * a33 - a23 * a32,\\r\\n\\r\\n    det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat4(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03,\\r\\n    a22 * b04 - a21 * b05 - a23 * b03,\\r\\n    a12 * b08 - a10 * b11 - a13 * b07,\\r\\n    a00 * b11 - a02 * b08 + a03 * b07,\\r\\n    a32 * b02 - a30 * b05 - a33 * b01,\\r\\n    a20 * b05 - a22 * b02 + a23 * b01,\\r\\n    a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a30 * b04 - a31 * b02 + a33 * b00,\\r\\n    a21 * b02 - a20 * b04 - a23 * b00,\\r\\n    a11 * b07 - a10 * b09 - a12 * b06,\\r\\n    a00 * b09 - a01 * b07 + a02 * b06,\\r\\n    a31 * b01 - a30 * b03 - a32 * b00,\\r\\n    a20 * b03 - a21 * b01 + a22 * b00) / det;\\r\\n}\\r\\n\\r\\nfloat pow3(float x, float y) {\\r\\n  return exp2(y * log2(x));\\r\\n}\\r\\n\\r\\nvec3 pow2(vec3 x, vec3 y) {\\r\\n  return vec3(pow3(x.x, y.x), pow3(x.y, y.y), pow3(x.z, y.z));\\r\\n}\\r\\n\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n    v_texture_coords = a_texture_coords;\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  v_texture_coords = a_texture_coords;\\r\\n  v_position = a_position;\\r\\n  v_normal = a_normal;\\r\\n  v_model = u_model;\\r\\n\\r\\n  v_light1_pos = u_light1_pos;\\r\\n  v_light1_intensities = u_light1_intensities;\\r\\n  v_light1_attenuation = u_light1_attenuation;\\r\\n  v_light1_ambient_coefficient = u_light1_ambient_coefficient;\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec3 surfacePos = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  mat3 normalMatrix = transpose(inverse(mat3(v_model)));\\r\\n  vec3 normal = normalize(normalMatrix * v_normal);\\r\\n\\r\\n  vec3 fragPosition = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  vec3 surfaceToLight = light1.position - fragPosition;\\r\\n\\r\\n  float brightness = dot(normal, surfaceToLight) / (length(surfaceToLight) * length(normal));\\r\\n  if (brightness > 1.0) {\\r\\n    brightness = 1.0;\\r\\n  } else if (brightness < 0.0) {\\r\\n    brightness = 0.0;\\r\\n  }\\r\\n\\r\\n  float distanceToLight = length(light1.position - surfacePos);\\r\\n\\r\\n  v_diffuseCoefficient = max(0.0, dot(normal, surfaceToLight));\\r\\n  v_attenuation = 1.0 / (1.0 + light1.attenuation * pow3(distanceToLight, 2.0));\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n}\";","export default \"\\r\\nprecision mediump float;\\r\\nvarying vec4 v_color;\\r\\nvoid main(void) {\\r\\n  gl_FragColor = v_color;\\r\\n}\\r\\n\\r\\n\";","import ModelObjectRect3d from \"../Core/EngineEntity/ModelObjectRect3d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect3d from \"../Core/Data/Rect3d\";\r\nimport TextureVertexModel from \"../Core/Data/TextureVertexModel\";\r\n\r\nexport default class Plane3d extends ModelObjectRect3d {\r\n  constructor(rect: Rect3d, vertexModel: TextureVertexModel) {\r\n    super(rect, vertexModel);\r\n    if (!(vertexModel instanceof TextureVertexModel)) {\r\n      const error = \"Vertex model must of be type TextureVertexModel\";\r\n      console.error(error, vertexModel);\r\n      throw new Error(error);\r\n    }\r\n    if (!vertexModel.renderUnits || vertexModel.renderUnits.length !== 4) {\r\n      const error = \"Plane3d requires 4 vertexes\";\r\n      console.error(error, vertexModel);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n}\r\n","import {\r\n  ModelObject3d,\r\n  Rect3d,\r\n  TextureVertexModel,\r\n  EngineHelper\r\n} from \"synaren-engine\";\r\n\r\nexport default class Sphere extends ModelObject3d {\r\n  vertexUvCacheId: string;\r\n  constructor(rect: Rect3d, vertexUvCacheId: string) {\r\n    super(rect, new TextureVertexModel());\r\n    this.vertexUvCacheId = vertexUvCacheId;\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = engineHelper.newVertexModelUv3d(this.vertexUvCacheId);\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n","import Rect3d from \"./Rect3d\";\r\n\r\nexport default class Rect2d extends Rect3d {\r\n  constructor(\r\n    x: number,\r\n    y: number,\r\n    width: number,\r\n    height: number,\r\n    layer?: number\r\n  ) {\r\n    super(x, y, layer || 0, width, height, 1);\r\n  }\r\n\r\n  static create() {\r\n    return new Rect2d(0, 0, 0, 0, 0);\r\n  }\r\n\r\n  newCenter(): Rect2d {\r\n    return new Rect2d(\r\n      this.x + this.width / 2.0,\r\n      this.y + this.height / 2.0,\r\n      this.width,\r\n      this.height,\r\n      this.z\r\n    );\r\n  }\r\n}\r\n","import Colour from \"../../Data/Colour\";\r\n\r\nclass WebGLContext {\r\n  ctx: WebGLRenderingContext;\r\n  clearColour: Colour = new Colour(1.0, 1.0, 1.0, 1.0);\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n  }\r\n\r\n  setClearColor(colour: Colour) {\r\n    this.clearColour = colour;\r\n    this.ctx.clearColor(colour.r, colour.g, colour.b, colour.a);\r\n  }\r\n\r\n  setupDefault() {\r\n    this.setClearColor(this.clearColour);\r\n    this.ctx.enable(this.ctx.BLEND);\r\n    this.ctx.blendFunc(this.ctx.SRC_ALPHA, this.ctx.ONE_MINUS_SRC_ALPHA);\r\n    this.ctx.enable(this.ctx.CULL_FACE);\r\n    this.ctx.frontFace(this.ctx.CCW);\r\n    this.ctx.cullFace(this.ctx.BACK);\r\n    this.ctx.clearDepth(1);\r\n    this.ctx.enable(this.ctx.DEPTH_TEST);\r\n    this.ctx.depthFunc(this.ctx.LEQUAL);\r\n  }\r\n\r\n  clear() {\r\n    this.ctx.clear(this.ctx.COLOR_BUFFER_BIT | this.ctx.DEPTH_BUFFER_BIT);\r\n  }\r\n\r\n  deleteTexture(texture: WebGLTexture) {\r\n    this.ctx.deleteTexture(texture);\r\n  }\r\n\r\n  resizeViewPort(canvas: HTMLCanvasElement) {\r\n    this.ctx.viewport(0, 0, canvas.width, canvas.height);\r\n  }\r\n\r\n  getWebGL2RenderingContext(): WebGL2RenderingContext {\r\n    return this.ctx as WebGL2RenderingContext;\r\n  }\r\n\r\n  destroyWebGL() {\r\n    const ctx = this.ctx;\r\n    const ctx2 = this.getWebGL2RenderingContext();\r\n    const isWebGL2RenderingContext = !!ctx2.createTransformFeedback;\r\n\r\n    if (isWebGL2RenderingContext) {\r\n      ctx2.bindVertexArray(null);\r\n    }\r\n\r\n    const numAttribs = ctx.getParameter(ctx.MAX_VERTEX_ATTRIBS);\r\n    const tmp = ctx.createBuffer();\r\n    ctx.bindBuffer(ctx.ARRAY_BUFFER, tmp);\r\n    for (let ii = 0; ii < numAttribs; ++ii) {\r\n      ctx.disableVertexAttribArray(ii);\r\n      ctx.vertexAttribPointer(ii, 4, ctx.FLOAT, false, 0, 0);\r\n      ctx.vertexAttrib1f(ii, 0);\r\n      if (isWebGL2RenderingContext) {\r\n        ctx2.vertexAttribDivisor(ii, 0);\r\n      }\r\n    }\r\n    ctx.deleteBuffer(tmp);\r\n\r\n    const numTextureUnits = ctx.getParameter(ctx.MAX_TEXTURE_IMAGE_UNITS);\r\n    for (let ii = 0; ii < numTextureUnits; ++ii) {\r\n      ctx.activeTexture(ctx.TEXTURE0 + ii);\r\n      ctx.bindTexture(ctx.TEXTURE_CUBE_MAP, null);\r\n      ctx.bindTexture(ctx.TEXTURE_2D, null);\r\n      if (isWebGL2RenderingContext) {\r\n        ctx2.bindTexture(ctx2.TEXTURE_2D_ARRAY, null);\r\n        ctx2.bindTexture(ctx2.TEXTURE_3D, null);\r\n        ctx2.bindSampler(ii, null);\r\n      }\r\n    }\r\n\r\n    ctx.activeTexture(ctx.TEXTURE0);\r\n    ctx.useProgram(null);\r\n    ctx.bindBuffer(ctx.ARRAY_BUFFER, null);\r\n    ctx.bindBuffer(ctx.ELEMENT_ARRAY_BUFFER, null);\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\r\n    ctx.disable(ctx.BLEND);\r\n    ctx.disable(ctx.CULL_FACE);\r\n    ctx.disable(ctx.DEPTH_TEST);\r\n    ctx.disable(ctx.DITHER);\r\n    ctx.disable(ctx.SCISSOR_TEST);\r\n    ctx.blendColor(0, 0, 0, 0);\r\n    ctx.blendEquation(ctx.FUNC_ADD);\r\n    ctx.blendFunc(ctx.ONE, ctx.ZERO);\r\n    ctx.clearColor(0, 0, 0, 0);\r\n    ctx.clearDepth(1);\r\n    ctx.clearStencil(-1);\r\n    ctx.colorMask(true, true, true, true);\r\n    ctx.cullFace(ctx.BACK);\r\n    ctx.depthFunc(ctx.LESS);\r\n    ctx.depthMask(true);\r\n    ctx.depthRange(0, 1);\r\n    ctx.frontFace(ctx.CCW);\r\n    ctx.hint(ctx.GENERATE_MIPMAP_HINT, ctx.DONT_CARE);\r\n    ctx.lineWidth(1);\r\n    ctx.pixelStorei(ctx.PACK_ALIGNMENT, 4);\r\n    ctx.pixelStorei(ctx.UNPACK_ALIGNMENT, 4);\r\n    ctx.pixelStorei(ctx.UNPACK_FLIP_Y_WEBGL, 0);\r\n    ctx.pixelStorei(ctx.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\r\n\r\n    if (ctx.UNPACK_COLORSPACE_CONVERSION_WEBGL) {\r\n      ctx.pixelStorei(\r\n        ctx.UNPACK_COLORSPACE_CONVERSION_WEBGL,\r\n        ctx.BROWSER_DEFAULT_WEBGL\r\n      );\r\n    }\r\n    ctx.polygonOffset(0, 0);\r\n    ctx.sampleCoverage(1, false);\r\n    ctx.scissor(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n    ctx.stencilFunc(ctx.ALWAYS, 0, 0xffffffff);\r\n    ctx.stencilMask(0xffffffff);\r\n    ctx.stencilOp(ctx.KEEP, ctx.KEEP, ctx.KEEP);\r\n    ctx.viewport(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n    ctx.clear(\r\n      ctx.COLOR_BUFFER_BIT | ctx.DEPTH_BUFFER_BIT | ctx.STENCIL_BUFFER_BIT\r\n    );\r\n\r\n    if (isWebGL2RenderingContext) {\r\n      ctx2.drawBuffers([ctx2.BACK]);\r\n\r\n      ctx2.readBuffer(ctx2.BACK);\r\n\r\n      ctx2.bindBuffer(ctx2.COPY_READ_BUFFER, null);\r\n\r\n      ctx2.bindBuffer(ctx2.COPY_WRITE_BUFFER, null);\r\n\r\n      ctx2.bindBuffer(ctx2.PIXEL_PACK_BUFFER, null);\r\n\r\n      ctx2.bindBuffer(ctx2.PIXEL_UNPACK_BUFFER, null);\r\n      const numTransformFeedbacks = ctx.getParameter(\r\n        ctx2.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS\r\n      );\r\n      for (let ii = 0; ii < numTransformFeedbacks; ++ii) {\r\n        ctx2.bindBufferBase(ctx2.TRANSFORM_FEEDBACK_BUFFER, ii, null);\r\n      }\r\n\r\n      const numUBOs = ctx.getParameter(ctx2.MAX_UNIFORM_BUFFER_BINDINGS);\r\n      for (let ii = 0; ii < numUBOs; ++ii) {\r\n        ctx2.bindBufferBase(ctx2.UNIFORM_BUFFER, ii, null);\r\n      }\r\n\r\n      ctx2.disable(ctx2.RASTERIZER_DISCARD);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_IMAGE_HEIGHT, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_SKIP_IMAGES, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_ROW_LENGTH, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_SKIP_ROWS, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_SKIP_PIXELS, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.PACK_ROW_LENGTH, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.PACK_SKIP_ROWS, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.PACK_SKIP_PIXELS, 0);\r\n\r\n      ctx2.hint(ctx2.FRAGMENT_SHADER_DERIVATIVE_HINT, ctx2.DONT_CARE);\r\n    }\r\n  }\r\n\r\n  programInfo(program: WebGLProgram) {\r\n    const numAttribs = this.ctx.getProgramParameter(\r\n      program,\r\n      this.ctx.ACTIVE_ATTRIBUTES\r\n    );\r\n    for (let ii = 0; ii < numAttribs; ++ii) {\r\n      const attribInfo = this.ctx.getActiveAttrib(program, ii);\r\n      if (!attribInfo) {\r\n        break;\r\n      }\r\n      console.log(\r\n        this.ctx.getAttribLocation(program, attribInfo.name),\r\n        attribInfo.name\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default WebGLContext;\r\n","import EngineHelper from \"./EngineHelper\";\r\nimport { EngineEvent } from \"../Core/Events\";\r\nimport Resource from \"./Data/Resource\";\r\n\r\nexport default class WorldDelegate {\r\n  engineHelper: EngineHelper;\r\n  setEngineHelper(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n  }\r\n  loadResources(resources: Resource[]) {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  update() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  render() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  event(event: EngineEvent) {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  pause() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  resume() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  destroy() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  reset() {}\r\n}\r\n","class ModelData {\r\n  vertices: number[];\r\n  cacheId?: number;\r\n  $id: number = ModelData._$ID++;\r\n\r\n  static _$ID = 1;\r\n}\r\n\r\nexport default ModelData;\r\n","import App from \"./Core/App\";\r\nexport { App };\r\nexport { default as EngineObject } from \"./Core/EngineEntity/EngineObject\";\r\nexport { default as EngineHelper } from \"./Core/EngineHelper\";\r\nexport { default as EngineMap } from \"./Core/EngineEntity/EngineMap\";\r\nexport { default as ObjectManager } from \"./Manager/ObjectManager\";\r\nexport { default as EntityManager } from \"./Manager/EntityManager\";\r\nexport { default as EntityManager2d } from \"./Manager/EntityManager2d\";\r\nexport { default as Font } from \"./Core/Font/Font\";\r\nexport { FontReference } from \"./Core/Font/Font\";\r\nexport { default as LineColour } from \"./Entity/LineColour\";\r\nexport { default as ResourceResolver } from \"./AssetLoader/ResourceResolver\";\r\nexport { default as Resource } from \"./Core/Data/Resource\";\r\nexport { default as Light, LightOptions } from \"./Core/Data/Light\";\r\nexport { default as PlaneType } from \"./Core/Data/PlaneType\";\r\nexport { default as Colour } from \"./Core/Data/Colour\";\r\nexport { default as Moveable } from \"./Entity/Moveable\";\r\nexport { default as Rect3d } from \"./Core/Data/Rect3d\";\r\nexport { default as Rect2d } from \"./Core/Data/Rect2d\";\r\nexport { default as ModelPosition } from \"./Core/EngineEntity/ModelPosition\";\r\nexport { default as Physics } from \"./Core/Physics/Physics\";\r\nexport { default as Position } from \"./Core/EngineEntity/Position\";\r\nexport { default as Timer } from \"./Core/Common/Timer\";\r\nexport { generateId } from \"./Core/Common/IdGenerator\";\r\nexport {\r\n  ConfigBuilder,\r\n  ConfigEntity,\r\n  ConfigEntityConcreteType,\r\n} from \"./Core/Builder/ConfigMapBuilder\";\r\nexport { default as Events, EngineEvent } from \"./Core/Events\";\r\nexport {\r\n  Collision,\r\n  CollisionDetection,\r\n  Polygon,\r\n} from \"./Core/Physics/CollisionDetection\";\r\nexport { default as Camera } from \"./Core/Camera\";\r\nexport { default as Coordinate } from \"./Core/Data/Coordinate\";\r\nexport { default as Plane3d } from \"./Entity/Plane3d\";\r\nexport { default as Plane2d } from \"./Entity/Plane2d\";\r\nexport { default as PlaneColour } from \"./Entity/PlaneColour\";\r\nexport { default as BitmapConfigParser } from \"./AssetLoader/BitmapConfigParser\";\r\nexport { default as ModelObject3d } from \"./Core/EngineEntity/ModelObject3d\";\r\nexport { default as Object3d } from \"./Entity/Object3d\";\r\nexport { RenderType } from \"./Core/Data/RenderOption\";\r\nexport { default as TextureVertexModel } from \"./Core/Data/TextureVertexModel\";\r\n","import Camera from \"./Camera\";\r\nimport Updater from \"./Updater\";\r\nimport Renderer, { RendererNotification } from \"./Renderer\";\r\nimport EngineHelper, { RetrieveResource } from \"./EngineHelper\";\r\nimport Events, { event } from \"./Events\";\r\nimport Timer from \"./Common/Timer\";\r\nimport NotificationQueue from \"./Common/NotificationQueue\";\r\nimport WorldDelegate from \"./WorldDelegate\";\r\nimport { EngineEvent } from \"../Core/Events\";\r\nimport SubscriberPool, { Subscription } from \"./Common/SubscriberPool\";\r\nimport Resource from \"./Data/Resource\";\r\nimport EngineDebugger from \"./EngineDebugger\";\r\n\r\nexport class WebGLContainer {\r\n  canvas: HTMLCanvasElement;\r\n  aspectRatio: number;\r\n  isFullScreen: boolean;\r\n  constructor(\r\n    elementId: string,\r\n    parentElement: HTMLElement,\r\n    aspectRatio: number,\r\n    isFullScreen: boolean,\r\n    restoreContentFn: () => any\r\n  ) {\r\n    this.isFullScreen = isFullScreen;\r\n    this.aspectRatio = aspectRatio;\r\n    this.canvas = document.createElement(\"canvas\");\r\n    if (elementId) {\r\n      this.canvas.id = elementId;\r\n    } else {\r\n      this.canvas.id = \"app\";\r\n    }\r\n    this.canvas.addEventListener(\r\n      \"webglcontextlost\",\r\n      (event) => event.preventDefault(),\r\n      false\r\n    );\r\n    this.canvas.addEventListener(\r\n      \"webglcontextrestored\",\r\n      restoreContentFn,\r\n      false\r\n    );\r\n    parentElement.appendChild(this.canvas);\r\n  }\r\n\r\n  delete() {\r\n    this.canvas.style.display = \"none\";\r\n    if (this.canvas.parentElement) {\r\n      this.canvas.parentElement.removeChild(this.canvas);\r\n    }\r\n  }\r\n\r\n  resize(measureElement: HTMLElement) {\r\n    let width = measureElement.offsetWidth;\r\n    let height = width / this.getAspectRatio();\r\n\r\n    if (this.isFullScreen) {\r\n      width = window.innerWidth;\r\n      height = window.innerHeight;\r\n    }\r\n\r\n    this.canvas.width = width * window.devicePixelRatio;\r\n    this.canvas.height = height * window.devicePixelRatio;\r\n\r\n    this.canvas.style.height = `${height}px`;\r\n    this.canvas.style.width = `${width}px`;\r\n  }\r\n\r\n  getAspectRatio() {\r\n    let aspectRatio = this.aspectRatio;\r\n    if (!aspectRatio) {\r\n      const width =\r\n        window.innerWidth ||\r\n        document.documentElement.clientWidth ||\r\n        document.body.clientWidth;\r\n      const height =\r\n        window.innerHeight ||\r\n        document.documentElement.clientHeight ||\r\n        document.body.clientHeight;\r\n      aspectRatio = width / height;\r\n    }\r\n    return aspectRatio;\r\n  }\r\n\r\n  getCtx(): WebGLRenderingContext {\r\n    const ctx =\r\n      this.canvas.getContext(\"webgl\") ||\r\n      this.canvas.getContext(\"experimental-webgl\");\r\n    if (!ctx) {\r\n      throw new Error(\"WebGL not avaliable\");\r\n    }\r\n    return ctx as WebGLRenderingContext;\r\n  }\r\n}\r\n\r\nexport class AppSubscription {\r\n  static START_ITERATION = new Subscription(\"App#StartIteration\");\r\n  static GET_FPS = new Subscription(\"App#GetFPS\");\r\n}\r\n\r\nexport default class App {\r\n  renderer: Renderer;\r\n  updater: Updater;\r\n  timer: Timer;\r\n  interval: any;\r\n  camera: Camera;\r\n  errorCallback: Function;\r\n  args: { [key: string]: any };\r\n  fps: number;\r\n  isStepRender: boolean;\r\n  ready = false;\r\n  engineHelper: EngineHelper;\r\n  isPaused = true;\r\n  frameTime = 0.0;\r\n  framesElapsed = 0;\r\n  webGLContainer: WebGLContainer;\r\n  world: WorldDelegate;\r\n  isVisible: boolean;\r\n  notificationQueue: NotificationQueue;\r\n  subscriberPool: SubscriberPool;\r\n  debugger?: EngineDebugger;\r\n\r\n  constructor(args: { [key: string]: any }) {\r\n    if (!args) {\r\n      throw new Error(\"no args passed into App\");\r\n    }\r\n    this.notificationQueue = new NotificationQueue();\r\n    this.subscriberPool = new SubscriberPool();\r\n    this.subscriberPool.listen(\r\n      AppSubscription.START_ITERATION,\r\n      this.startIteration\r\n    );\r\n\r\n    this.args = args;\r\n    this.buildCanvas(args);\r\n\r\n    this.isStepRender = args.isStepRender || false;\r\n    event.bind(this.onEvent, this.webGLContainer);\r\n    event.setThrottle(args.eventThrottle || 1000.0 / 25.0);\r\n\r\n    this.errorCallback = args.error;\r\n    this.setup();\r\n\r\n    if (args.clearColour) {\r\n      this.renderer.glContext.setClearColor(args.clearColour);\r\n    }\r\n\r\n    this.setFPS(args.fps);\r\n  }\r\n\r\n  setFPS(fps: number) {\r\n    this.fps = 1000.0 / fps || 1000.0 / 30.0;\r\n    this.subscriberPool.publish(AppSubscription.GET_FPS, this.fps);\r\n  }\r\n\r\n  setup = () => {\r\n    const args = this.args;\r\n    this.timer = new Timer();\r\n    this.camera = new Camera();\r\n    this.updater = new Updater(args);\r\n    this.renderer = new Renderer(\r\n      args,\r\n      this.webGLContainer,\r\n      this.camera,\r\n      this.notificationQueue,\r\n      this.subscriberPool\r\n    );\r\n\r\n    this.camera.setupCamera(\r\n      args.camera,\r\n      args.aspectRatio,\r\n      this.webGLContainer.canvas,\r\n      args.renderMode || args.camera?.renderMode || '2d' // Default to 2D mode\r\n    );\r\n    this.engineHelper = new EngineHelper(\r\n      this.notificationQueue,\r\n      this.subscriberPool,\r\n      this.camera\r\n    );\r\n\r\n    this.debugger = new EngineDebugger(this.webGLContainer.canvas);\r\n\r\n    this.world = this.args.world;\r\n    this.world.setEngineHelper(this.engineHelper);\r\n    \r\n    if (this.debugger) {\r\n      this.debugger.setReferences(this.world, this.renderer);\r\n      this.debugger.setEngineHelper(this.engineHelper);\r\n    }\r\n  };\r\n\r\n  onEvent = (event: EngineEvent): boolean => {\r\n    if (event.eventType === Events.RESIZE) {\r\n      this.resizeScreen();\r\n    }\r\n    if (this.world) {\r\n      this.world.event(event);\r\n    }\r\n    return true;\r\n  };\r\n\r\n  destroy = () => {\r\n    clearInterval(this.interval);\r\n    this.renderer.delete();\r\n    event.delete(this.onEvent);\r\n    \r\n\r\n    \r\n    if (this.debugger) {\r\n      this.debugger.destroy();\r\n      this.debugger = undefined;\r\n    }\r\n    \r\n    this.webGLContainer.delete();\r\n\r\n    console.log(\"destroying\", this);\r\n  };\r\n\r\n  animationFrame = () => {\r\n    if (!this.ready) {\r\n      return;\r\n    }\r\n    try {\r\n      this.updater.update(this.timer.peak(), this.engineHelper);\r\n      this.renderer.render(this.timer.peak(), this.engineHelper);\r\n      \r\n      if (this.debugger) {\r\n        this.debugger.resetRenderCalls();\r\n        this.debugger.updateDebugInfo(this.engineHelper);\r\n      }\r\n      \r\n      this.notifyFrames();\r\n      this.timer.start();\r\n    } catch (error) {\r\n      console.error(error);\r\n      if (this.debugger) {\r\n        this.debugger.logError(error.toString());\r\n      }\r\n      clearInterval(this.interval);\r\n      if (this.errorCallback) {\r\n        this.errorCallback(error);\r\n      }\r\n    }\r\n  };\r\n\r\n  startIteration = () => requestAnimationFrame(this.animationFrame);\r\n\r\n  notifyFrames = () => {\r\n    this.frameTime += this.timer.peak();\r\n    this.framesElapsed++;\r\n    if (this.framesElapsed === 60) {\r\n      if (this.args.subscribe) {\r\n        this.args.subscribe({\r\n          fps: (1000.0 / this.frameTime) * this.framesElapsed,\r\n        });\r\n      }\r\n      this.framesElapsed = 0;\r\n      this.frameTime = 0;\r\n    }\r\n  };\r\n\r\n  toggleStepRender(run = !this.isStepRender) {\r\n    this.isStepRender = run;\r\n    if (!this.isStepRender && !this.interval) {\r\n      this.startRunLoop();\r\n    }\r\n  }\r\n\r\n  startRunLoop = () => {\r\n    this.timer.start();\r\n    const fps = this.fps;\r\n    this.interval = setInterval(() => {\r\n      if (!this.isPaused) {\r\n        this.animationFrame();\r\n      }\r\n      if (this.isStepRender) {\r\n        clearInterval(this.interval);\r\n        this.interval = undefined;\r\n      }\r\n      if (this.fps !== fps) {\r\n        clearInterval(this.interval);\r\n        this.interval = undefined;\r\n        this.startRunLoop();\r\n      }\r\n    }, fps);\r\n  };\r\n\r\n  initSystem = (): Promise<RetrieveResource[]> => {\r\n    this.initFont();\r\n    this.world.init(this.engineHelper);\r\n    this.renderer.init();\r\n    return this.engineHelper.getAllResourcesLoading();\r\n  };\r\n\r\n  initFont() {\r\n    this.engineHelper.initFont();\r\n  }\r\n\r\n  loadResources = (resources: Resource[]): Promise<RetrieveResource[]> => {\r\n    this.world.loadResources(resources);\r\n    return this.engineHelper.getAllResourcesLoading();\r\n  };\r\n\r\n  runApp = () => {\r\n    this.ready = true;\r\n    if (!this.isStepRender) {\r\n      this.startRunLoop();\r\n    } else {\r\n      this.animationFrame();\r\n    }\r\n  };\r\n\r\n  onRunError = (error: Error) => {\r\n    clearInterval(this.interval);\r\n    console.error(error);\r\n    throw error;\r\n  };\r\n\r\n  run = () => {\r\n    console.log(\"Running\", this);\r\n    const startTime = new Date();\r\n    return this.loadResources(this.args.resources)\r\n      .then(this.initSystem)\r\n      .then(this.renderer.bindBuffer)\r\n      .then(this.runApp)\r\n      .then(() =>\r\n        console.log(\r\n          `startup time: ${new Date().getTime() - startTime.getTime()}`\r\n        )\r\n      )\r\n      .then(\r\n        () =>\r\n          new Promise(function (resolve) {\r\n            setTimeout(resolve, 1);\r\n          })\r\n      )\r\n      .catch(this.onRunError);\r\n  };\r\n\r\n  resizeCanvas = (measureElement: HTMLElement) => {\r\n    this.webGLContainer.resize(measureElement);\r\n  };\r\n\r\n  resizeScreen = () => {\r\n    const measureElement = document.getElementById(this.args.elementId)!;\r\n    this.resizeCanvas(measureElement);\r\n    this.camera.setupCamera(\r\n      this.args.camera,\r\n      this.args.aspectRatio,\r\n      this.webGLContainer.canvas,\r\n      this.args.renderMode || this.args.camera?.renderMode || '2d'\r\n    );\r\n    this.notificationQueue.push(RendererNotification.RESIZE_SCREEN);\r\n    if (this.isStepRender && this.ready) {\r\n      this.animationFrame();\r\n    }\r\n  };\r\n\r\n  buildCanvas = (args: { [key: string]: any }) => {\r\n    if (this.webGLContainer) {\r\n      return;\r\n    }\r\n    let appElement: HTMLElement = document.body;\r\n    if (args.elementId) {\r\n      appElement = document.getElementById(args.elementId)!;\r\n    }\r\n    this.webGLContainer = new WebGLContainer(\r\n      args.canvasId,\r\n      appElement,\r\n      args.aspectRatio,\r\n      args.isFullScreen,\r\n      this.setup\r\n    );\r\n    this.resizeCanvas(appElement);\r\n  };\r\n\r\n  reset = () => {\r\n    if (this.world) {\r\n      this.world.reset();\r\n    } else {\r\n      console.error(\"Game Delegate not ready to call reset\");\r\n    }\r\n  };\r\n\r\n  toggleShow = () => {\r\n    if (this.isVisible) {\r\n      this.hide();\r\n    } else {\r\n      this.show();\r\n    }\r\n  };\r\n\r\n  show = () => {\r\n    this.webGLContainer.canvas.style.display = \"initial\";\r\n    this.resizeScreen();\r\n    this.isVisible = true;\r\n  };\r\n\r\n  hide = () => {\r\n    this.webGLContainer.canvas.style.display = \"none\";\r\n    this.isVisible = false;\r\n  };\r\n\r\n  togglePause = () => {\r\n    this.isPaused = !this.isPaused;\r\n  };\r\n\r\n  pause = () => {\r\n    this.isPaused = true;\r\n  };\r\n\r\n  unpause = () => {\r\n    this.isPaused = false;\r\n  };\r\n}\r\n","/**\n * Common utilities\n * @module glMatrix\n */\n\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== \"undefined\" ? Float32Array : Array;\nexport var RANDOM = Math.random;\nexport var ANGLE_ORDER = \"zyx\";\n\n/**\n * Symmetric round\n * see https://www.npmjs.com/package/round-half-up-symmetric#user-content-detailed-background\n *\n * @param {Number} a value to round\n */\nexport function round(a) {\n  if (a >= 0) return Math.round(a);\n  return a % 0.5 === 0 ? Math.floor(a) : Math.round(a);\n}\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\nvar radian = 180 / Math.PI;\n\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\nexport function toRadian(a) {\n  return a * degree;\n}\n\n/**\n * Convert Radian To Degree\n *\n * @param {Number} a Angle in Radians\n */\nexport function toDegree(a) {\n  return a * radian;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a          The first number to test.\n * @param {Number} b          The second number to test.\n * @param {Number} tolerance  Absolute or relative tolerance (default glMatrix.EPSILON)\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  var tolerance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : EPSILON;\n  return Math.abs(a - b) <= tolerance * Math.max(1, Math.abs(a), Math.abs(b));\n}","class Coordinate {\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n\r\n  constructor(x: number, y: number, z?: number) {\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n    this.z = z || 0;\r\n  }\r\n}\r\n\r\nexport default Coordinate;\r\n","import { CollisionDetection } from \"../Physics/CollisionDetection\";\r\nimport { VertexBuilder } from \"../Builder/VertexBuilder\";\r\n\r\nexport default class EngineObjectHelper {\r\n  static vertex: VertexBuilder = new VertexBuilder();\r\n  static collision: CollisionDetection = new CollisionDetection();\r\n}\r\n","import Rect2d from \"../Data/Rect2d\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\n\r\nexport default class EngineMath {\r\n  public static boundRect(bound: Rect2d, pos: Rect2d): Coordinate {\r\n    const boundedX = Math.max(\r\n      bound.x + pos.width / 2.0,\r\n      Math.min(bound.x + bound.width - pos.width / 2.0, pos.x)\r\n    );\r\n    const boundedY = Math.max(\r\n      bound.y + pos.height / 2.0,\r\n      Math.min(bound.y + bound.height - pos.height / 2.0, pos.y)\r\n    );\r\n    return new Coordinate(boundedX, boundedY, pos.z);\r\n  }\r\n  public static getLength(x1: number, y1: number, x2: number, y2: number) {\r\n    return Math.sqrt(\r\n      Math.abs((x1 - x2) * (x1 - x2)) + Math.abs((y1 - y2) * (y1 - y2))\r\n    );\r\n  }\r\n}\r\n","import {\r\n  Camera,\r\n  EntityManager,\r\n  Rect3d,\r\n  EngineHelper,\r\n  Coordinate,\r\n  Plane3d,\r\n  CollisionDetection,\r\n  PlaneType\r\n} from \"synaren-engine\";\r\n\r\nexport default class Ground3d extends EntityManager {\r\n  cacheId: string;\r\n  textureSource: string;\r\n  camera: Camera;\r\n\r\n  constructor(rect: Rect3d, cacheId: string) {\r\n    super();\r\n    this.cacheId = cacheId;\r\n    this.setRect(rect);\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.entities.forEach(element => element.render(engineHelper));\r\n  }\r\n\r\n  isPointInGround(coordinate: Coordinate): Plane3d | null {\r\n    let insideElement: Plane3d | null = null;\r\n    for (const key in this.entities) {\r\n      if (this.entities.hasOwnProperty(key)) {\r\n        const element = this.entities[key];\r\n        const isInside = CollisionDetection.isPointInPlane3d(\r\n          this.camera.camera3d,\r\n          element as Plane3d,\r\n          coordinate.x,\r\n          coordinate.y\r\n        );\r\n        if (isInside) {\r\n          insideElement = element as Plane3d;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return insideElement;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    this.camera = engineHelper.camera;\r\n    this.createEntities(engineHelper);\r\n    this.rotateOriginRect(this.getRect());\r\n    this.angleX(this.position.ax);\r\n    this.angleY(this.position.ay);\r\n    this.angleZ(this.position.az);\r\n    super.init(engineHelper);\r\n  }\r\n\r\n  createEntities(engineHelper: EngineHelper) {\r\n    const width = this.position.width;\r\n    const length = this.position.length;\r\n    const x = this.position.x;\r\n    const y = this.position.y;\r\n    const z = this.position.z;\r\n    const vertexModel = engineHelper.newVertexModel(this.cacheId, PlaneType.XZ);\r\n    for (let index = 0; index < width; index++) {\r\n      for (let index2 = 0; index2 < length; index2++) {\r\n        const rect = new Rect3d(\r\n          x + index - width / 2.0,\r\n          y,\r\n          z + index2 - length / 2.0,\r\n          1,\r\n          1,\r\n          1\r\n        );\r\n        const plane = new Plane3d(rect, vertexModel);\r\n        this.entities.push(plane);\r\n      }\r\n    }\r\n  }\r\n\r\n  center(x: number, y: number, z: number) {\r\n    const originX = this.position.x;\r\n    const originZ = this.position.z;\r\n    if (Math.abs(originX - x) > 10e-6 || Math.abs(originZ - z) > 10e-6) {\r\n      for (let index = 0; index < this.entities.length; index++) {\r\n        const element = this.entities[index];\r\n        element.translate(x - originX, 0, z - originZ);\r\n      }\r\n      this.position.x = x;\r\n      this.position.z = z;\r\n    }\r\n  }\r\n}\r\n","import Coordinate from \"../Data/Coordinate\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport Timer from \"../Common/Timer\";\r\nimport ModelPosition from \"../EngineEntity/ModelPosition\";\r\nimport { CollisionDetection } from \"./CollisionDetection\";\r\n\r\nexport default class Physics {\r\n  static TIME_STEP_MILLIS = 10;\r\n  static simulations: {\r\n    [key: number]:\r\n      | {\r\n          pause: boolean;\r\n          timer: Timer;\r\n          totalRunTime: number;\r\n          runTime: number;\r\n          totalIterations: number;\r\n          simulation: (\r\n            simulationId: number,\r\n            timeStep: number,\r\n            totalRunTime: number,\r\n            totalIterations?: number\r\n          ) => void;\r\n          completeSimulation?: () => void;\r\n          cancelled: boolean;\r\n        }\r\n      | undefined;\r\n  } = {};\r\n  static simulationIdCurrent = 1;\r\n  static simulationLoop: ReturnType<typeof setInterval> | undefined;\r\n  static physicsEntities: {\r\n    [key: number]: {\r\n      entity: ModelPosition;\r\n      enabled: boolean;\r\n      physics: PhysicsData | undefined;\r\n    };\r\n  } = {};\r\n  static physicsEntityIdCount = 1;\r\n\r\n  static registerPhysics(\r\n    entity: ModelPosition,\r\n    physics: PhysicsData | undefined = undefined\r\n  ) {\r\n    if (!entity.$physicsId) {\r\n      entity.$physicsId = Physics.physicsEntityIdCount++;\r\n\r\n      this.physicsEntities[entity.$physicsId] = {\r\n        entity: entity,\r\n        enabled: true,\r\n        physics: physics,\r\n      };\r\n    }\r\n  }\r\n  static deregisterPhysics(entity: ModelPosition) {\r\n    if (\r\n      entity.$physicsId !== undefined &&\r\n      this.physicsEntities[entity.$physicsId]\r\n    ) {\r\n      delete this.physicsEntities[entity.$physicsId];\r\n    }\r\n  }\r\n  static setEnabledPhysics(entity: ModelPosition, enabled: boolean) {\r\n    if (this.physicsEntities[entity.$physicsId]) {\r\n      this.physicsEntities[entity.$physicsId].enabled = enabled;\r\n    }\r\n  }\r\n  static isCollidingOffset2d(\r\n    entity: ModelPosition,\r\n    dx: number,\r\n    dy: number\r\n  ): ModelPosition[] {\r\n    const px = entity.position.x + dx;\r\n    const py = entity.position.y + dy;\r\n    return Physics.isCollidingPos2d(entity, px, py);\r\n  }\r\n\r\n  static isCollidingPoint2d(entity: ModelPosition): ModelPosition[] {\r\n    const px = entity.position.x;\r\n    const py = entity.position.y;\r\n    return Physics.isCollidingPos2d(entity, px, py);\r\n  }\r\n\r\n  static isCollidingResolve(\r\n    entity: ModelPosition,\r\n    dx: number,\r\n    dy: number\r\n  ): [number, number, ModelPosition[]] {\r\n    const collision: ModelPosition[] = [];\r\n    const _dx: number[] = [];\r\n    const _dy: number[] = [];\r\n    for (const key in this.physicsEntities) {\r\n      if (this.physicsEntities.hasOwnProperty(key)) {\r\n        const physicsEntity = this.physicsEntities[key];\r\n        const node = physicsEntity.entity;\r\n        if (physicsEntity.enabled && node.$physicsId !== entity.$physicsId) {\r\n          const { x, y, width, height } =\r\n            physicsEntity.physics?.collisionSize || node.position;\r\n          const colliding = CollisionDetection.isCollidingRect(\r\n            x,\r\n            y,\r\n            width,\r\n            height,\r\n            entity.position.x + dx,\r\n            entity.position.y + dy,\r\n            entity.position.width,\r\n            entity.position.height\r\n          );\r\n          if (colliding) {\r\n            collision.push(physicsEntity.entity);\r\n            const collidingX = CollisionDetection.isCollidingRect(\r\n              x,\r\n              y,\r\n              width,\r\n              height,\r\n              entity.position.x + dx,\r\n              entity.position.y,\r\n              entity.position.width,\r\n              entity.position.height\r\n            );\r\n            const collidingY = CollisionDetection.isCollidingRect(\r\n              x,\r\n              y,\r\n              width,\r\n              height,\r\n              entity.position.x,\r\n              entity.position.y + dy,\r\n              entity.position.width,\r\n              entity.position.height\r\n            );\r\n            if (collidingX && collidingY) {\r\n              _dx.push(-Physics.dxBoundary(entity, x, width));\r\n              _dy.push(-Physics.dyBoundary(entity, y, height));\r\n            } else if (collidingX) {\r\n              _dx.push(Physics.dxBoundary(entity, x, width));\r\n            } else if (collidingY) {\r\n              _dy.push(Physics.dyBoundary(entity, y, height));\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (_dx.length > 0) {\r\n      dx = Math.min.apply(Math, _dx);\r\n    }\r\n    if (_dy.length > 0) {\r\n      dy = Math.min.apply(Math, _dy);\r\n    }\r\n    if (Math.abs(dx) < 10e-6) {\r\n      dx = 0;\r\n    }\r\n    if (Math.abs(dy) < 10e-6) {\r\n      dy = 0;\r\n    }\r\n    return [dx, dy, collision];\r\n  }\r\n\r\n  private static dyBoundary(entity: ModelPosition, y: number, height: number) {\r\n    let _dy = Math.abs(\r\n      CollisionDetection.getLength(entity.position.y, 0, y, 0) -\r\n        entity.position.height / 2 -\r\n        height / 2\r\n    );\r\n    _dy *= Math.sign(y - entity.position.y) * 0.9999999;\r\n    return _dy;\r\n  }\r\n\r\n  private static dxBoundary(entity: ModelPosition, x: number, width: number) {\r\n    let _dx = Math.abs(\r\n      CollisionDetection.getLength(entity.position.x, 0, x, 0) -\r\n        entity.position.width / 2 -\r\n        width / 2\r\n    );\r\n    _dx *= Math.sign(x - entity.position.x) * 0.9999999;\r\n    return _dx;\r\n  }\r\n\r\n  private static isCollidingPos2d(\r\n    entity: ModelPosition,\r\n    px: number,\r\n    py: number\r\n  ): ModelPosition[] {\r\n    const collision: ModelPosition[] = [];\r\n    for (const key in this.physicsEntities) {\r\n      if (this.physicsEntities.hasOwnProperty(key)) {\r\n        const physicsEntity = this.physicsEntities[key];\r\n        const pEntityRoot = physicsEntity.entity;\r\n        if (\r\n          physicsEntity.enabled &&\r\n          pEntityRoot.$physicsId !== entity.$physicsId\r\n        ) {\r\n          const colliding = CollisionDetection.isCollidingRect(\r\n            pEntityRoot.position.x,\r\n            pEntityRoot.position.y,\r\n            pEntityRoot.position.width,\r\n            pEntityRoot.position.height,\r\n            px,\r\n            py,\r\n            entity.position.width,\r\n            entity.position.height\r\n          );\r\n          if (colliding) {\r\n            collision.push(physicsEntity.entity);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return collision;\r\n  }\r\n\r\n  static generateSimulationId() {\r\n    const simulationId = this.simulationIdCurrent;\r\n    this.simulationIdCurrent += 1;\r\n    return simulationId;\r\n  }\r\n  static pauseSimulation(simulationId: number) {\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      return;\r\n    }\r\n    data.pause = true;\r\n  }\r\n  static resumeSimulation(simulationId: number) {\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      return;\r\n    }\r\n    data.pause = false;\r\n  }\r\n  static cancelSimulation(simulationId: number, force: boolean = false) {\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      return;\r\n    }\r\n    data.cancelled = true;\r\n    data.totalIterations = 0;\r\n    if (!force && data.completeSimulation) {\r\n      data.completeSimulation();\r\n    }\r\n  }\r\n  static physicsLoop() {\r\n    let simulationCount = 0;\r\n    for (const simulationId in this.simulations) {\r\n      if (this.simulations.hasOwnProperty(simulationId)) {\r\n        const data = this.simulations[simulationId];\r\n        if (!data) continue;\r\n        if (data.cancelled) {\r\n          continue;\r\n        }\r\n        if (data) {\r\n          if (data.pause) {\r\n            data.timer.start();\r\n            continue;\r\n          }\r\n          const time = data.timer.peak();\r\n          if (data.totalIterations === 0 || data.runTime < data.totalRunTime) {\r\n            data.simulation(\r\n              +simulationId,\r\n              time,\r\n              data.totalRunTime,\r\n              data.totalIterations\r\n            );\r\n            data.runTime += time;\r\n            data.timer.start();\r\n            data.totalIterations += 1;\r\n            simulationCount++;\r\n          } else {\r\n            this.cancelSimulation(simulationId as unknown as number);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (simulationCount === 0 && this.simulationLoop !== undefined) {\r\n      clearInterval(this.simulationLoop);\r\n      this.simulationLoop = undefined;\r\n    }\r\n  }\r\n\r\n  static runSimulation(\r\n    totalRunTime: number,\r\n    simulation: (\r\n      simulationId: number,\r\n      timeStep: number,\r\n      totalRunTime: number,\r\n      totalIterations?: number\r\n    ) => void,\r\n    completeSimulation?: () => void,\r\n    existingSimulationId?: number\r\n  ): number {\r\n    const simulationId = existingSimulationId || this.generateSimulationId();\r\n\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      this.simulations[simulationId] = {\r\n        pause: false,\r\n        timer: new Timer().start(),\r\n        simulation: simulation,\r\n        totalRunTime: totalRunTime,\r\n        completeSimulation: completeSimulation,\r\n        totalIterations: 0,\r\n        runTime: 0.0,\r\n        cancelled: false,\r\n      };\r\n    } else {\r\n      if (data.cancelled) {\r\n        data.pause = false;\r\n        data.timer.start();\r\n        data.simulation = simulation;\r\n        data.totalRunTime = totalRunTime;\r\n        data.completeSimulation = completeSimulation;\r\n        data.cancelled = false;\r\n      }\r\n      data.totalIterations = 0;\r\n      data.runTime = 0;\r\n    }\r\n\r\n    if (this.simulationLoop === undefined) {\r\n      this.simulationLoop = setInterval(\r\n        this.physicsLoop.bind(this),\r\n        this.TIME_STEP_MILLIS\r\n      );\r\n    }\r\n\r\n    return simulationId;\r\n  }\r\n  static parabolicSimulation(\r\n    parabolic: ParabolicSimulation,\r\n    simulation: (\r\n      simulationId: number,\r\n      timeStep: number,\r\n      dx: number,\r\n      dy: number\r\n    ) => void,\r\n    completeSimulation?: () => void\r\n  ): number {\r\n    return this.runSimulation(\r\n      parabolic.totalRunTime,\r\n      (simulationId: number, timeStep: number) => {\r\n        const data = this.simulations[simulationId];\r\n        if (data) {\r\n          const runTime = data.runTime;\r\n          const height = parabolic.height;\r\n          const width = parabolic.width;\r\n          const totalRunTime = parabolic.totalRunTime;\r\n          const a = ((1.0 / 3.0 + 1.0) * height) / width / width;\r\n          const b = a * width;\r\n          const vy = height / 2.0 / (totalRunTime / 2.0);\r\n          const x = (Math.sqrt(4 * a * vy * runTime + b * b) - b) / (2 * a);\r\n          const vx = -width / totalRunTime;\r\n          const y = -(a * vx * runTime * vx * runTime + b * vx * runTime);\r\n          const dx = x - parabolic.px;\r\n          const dy = y - parabolic.py;\r\n          parabolic.px = x;\r\n          parabolic.py = y;\r\n          simulation(simulationId, timeStep, dx, dy);\r\n        }\r\n      },\r\n      completeSimulation\r\n    );\r\n  }\r\n}\r\n\r\nexport class ParabolicSimulation {\r\n  totalRunTime: number;\r\n  height: number;\r\n  width: number;\r\n  px: number;\r\n  py: number;\r\n}\r\n\r\nexport class PhysicsData {\r\n  t: Coordinate;\r\n  d: Coordinate;\r\n  v: Coordinate;\r\n  a: Coordinate;\r\n  modelPos: ModelPosition;\r\n  isMoving: boolean;\r\n  collisionSize: Rect3d | undefined;\r\n  bound: Rect3d | undefined;\r\n  simulationId: number | undefined;\r\n  jumpSimulationId: number | undefined;\r\n  gravitySimulationId: number | undefined;\r\n  collisionIteration: number;\r\n  collisionStopItThres: number;\r\n}\r\n","import Coordinate from \"./Coordinate\";\r\n\r\nexport default class Rect3d extends Coordinate {\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n  width: number;\r\n  height: number;\r\n  length: number;\r\n  centre: Rect3d;\r\n  constructor(\r\n    x: number,\r\n    y: number,\r\n    z: number,\r\n    width: number,\r\n    height: number,\r\n    length: number\r\n  ) {\r\n    super(x, y, z);\r\n    this.width = width || 0;\r\n    this.height = height || 0;\r\n    this.length = length || 0;\r\n  }\r\n\r\n  center(): Rect3d {\r\n    if (!this.centre || !this.equalCenter(this.centre)) {\r\n      this.centre = this.newCenter();\r\n    }\r\n    return this.centre;\r\n  }\r\n\r\n  equal(r: Rect3d) {\r\n    return (\r\n      r.x === this.x &&\r\n      r.y === this.y &&\r\n      r.z === this.z &&\r\n      r.width === this.width &&\r\n      r.height === this.height &&\r\n      r.length === this.length\r\n    );\r\n  }\r\n\r\n  private equalCenter(c: Rect3d) {\r\n    return (\r\n      c.x === this.x + this.width / 2.0 &&\r\n      c.y === this.y + this.height / 2.0 &&\r\n      c.z === this.z + this.length / 2.0 &&\r\n      c.width === this.width &&\r\n      c.height === this.height &&\r\n      c.length === this.length\r\n    );\r\n  }\r\n\r\n  newCenter(): Rect3d {\r\n    return new Rect3d(\r\n      this.x + this.width / 2.0,\r\n      this.y + this.height / 2.0,\r\n      this.z + this.length / 2.0,\r\n      this.width,\r\n      this.height,\r\n      this.length\r\n    );\r\n  }\r\n}\r\n","import Rect2d from \"../Core/Data/Rect2d\";\r\nimport ModelObject2d from \"../Core/EngineEntity/ModelObject2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport TextureVertexModel from \"../Core/Data/TextureVertexModel\";\r\n\r\nexport default class Plane2d extends ModelObject2d {\r\n  private textureReference: string;\r\n  constructor(rect: Rect2d, textureReference: string) {\r\n    super(rect, new TextureVertexModel());\r\n    this.textureReference = textureReference;\r\n  }\r\n  setLayer(layer: number) {\r\n    this.position.z = -layer;\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = engineHelper.newVertexModel2d(this.textureReference);\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n","import ShaderEntityBuilder from \"../Core/Builder/ShaderEntityBuilder\";\r\nimport Colour from \"../Core/Data/Colour\";\r\nimport ColourVertexModel from \"../Core/Data/ColourVertexModel\";\r\nimport Coordinate from \"../Core/Data/Coordinate\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport RenderOption, {\r\n  RenderType,\r\n  ShaderType,\r\n} from \"../Core/Data/RenderOption\";\r\nimport VertexModel from \"../Core/Data/VertexModel\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"../Core/EngineEntity/EngineObjectHelper\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class LineColour extends EngineObject {\r\n  vertexModel: VertexModel;\r\n  constructor(\r\n    private point1: Coordinate,\r\n    private point2: Coordinate,\r\n    private thickness: number,\r\n    private rgba: Colour\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n\r\n  updatePosition(point1: Coordinate, point2: Coordinate) {\r\n    this.point1 = point1;\r\n    this.point2 = point2;\r\n\r\n    const lX = point2.x - point1.x;\r\n    const lY = point2.y - point1.y;\r\n    const length = Math.sqrt(lX * lX + lY * lY);\r\n    const angle = Math.atan2(lY, lX) * (180 / Math.PI);\r\n\r\n    const mX = (point1.x + point2.x) / 2;\r\n    const mY = (point1.y + point2.y) / 2;\r\n\r\n    this.center(mX, mY, 0);\r\n    this.rotateOrigin(mX, mY, 0);\r\n    this.angleZ(angle);\r\n    this.scale(length, this.thickness, 1.0);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = new ColourVertexModel().fillRenderUnits(\r\n      EngineObjectHelper.vertex.planeXYColour(\r\n        this.rgba || new Colour(0, 0, 0, 0)\r\n      )\r\n    );\r\n    this.updatePosition(this.point1, this.point2);\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.TRIANGLE;\r\n    renderOpt.shaderType = ShaderType.COLOUR;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import vec2 from \"gl-matrix/vec2\";\r\n\r\nclass Vector2d extends Float32Array {\r\n  set x(x: number) {\r\n    this[0] = x;\r\n  }\r\n  get x(): number {\r\n    return this[0];\r\n  }\r\n  set y(y: number) {\r\n    this[1] = y;\r\n  }\r\n  get y(): number {\r\n    return this[1];\r\n  }\r\n  normalise(): Vector2d {\r\n    return vec2.normalize(Vector2d.newVector(0.0, 0.0), this) as Vector2d;\r\n  }\r\n  dot(v: Vector2d): number {\r\n    return vec2.dot(this, v);\r\n  }\r\n  negate(): Vector2d {\r\n    return vec2.negate(Vector2d.newVector(0.0, 0.0), this) as Vector2d;\r\n  }\r\n  scale(s: number): vec2 {\r\n    return vec2.scale(Vector2d.newVector(0.0, 0.0), this, s);\r\n  }\r\n  subtract(v: Vector2d): Vector2d {\r\n    return vec2.subtract(Vector2d.newVector(0, 0), this, v) as Vector2d;\r\n  }\r\n  add(v: Vector2d): Vector2d {\r\n    return vec2.add(Vector2d.newVector(0, 0), this, v) as Vector2d;\r\n  }\r\n  static newVector(x: number, y: number): Vector2d {\r\n    const vector = new Vector2d();\r\n    vector.x = x;\r\n    vector.y = y;\r\n    return vector;\r\n  }\r\n}\r\n\r\nexport default Vector2d;\r\n","import RenderOption from \"../Data/RenderOption\";\r\nimport VertexModel from \"../Data/VertexModel\";\r\nimport { mat4 } from \"gl-matrix\";\r\nimport Position from \"./Position\";\r\nimport ModelPosition from \"./ModelPosition\";\r\n\r\nexport class ShaderEntity {\r\n  opt: RenderOption = new RenderOption();\r\n  vertexModel: VertexModel;\r\n  rendererBufferId?: number;\r\n  rendererTextureRef?: string;\r\n  src?: string;\r\n  hidden: boolean;\r\n  isTop: boolean;\r\n  clone = false;\r\n  modelPosition: () => Position;\r\n  model: () => mat4;\r\n\r\n  getVertexModel(): VertexModel {\r\n    return this.vertexModel;\r\n  }\r\n  getVertexBufferId(): number {\r\n    return this.vertexModel.vertexBufferId;\r\n  }\r\n  getOpt(): RenderOption {\r\n    return this.opt;\r\n  }\r\n  getModel(): Float32List {\r\n    return this.model() as Float32List;\r\n  }\r\n  getTextureSource(): string | undefined {\r\n    return this.src;\r\n  }\r\n  setTextureSource(src: string) {\r\n    this.src = src;\r\n  }\r\n  renderCopy(model: ModelPosition): ShaderEntity {\r\n    const newInstance = this.shallowCopy();\r\n    newInstance.model = model.getModel;\r\n    newInstance.modelPosition = model.getPosition;\r\n    return newInstance;\r\n  }\r\n  shallowCopy(): ShaderEntity {\r\n    const newInstance = new ShaderEntity();\r\n    newInstance.opt = this.opt;\r\n    newInstance.vertexModel = this.vertexModel;\r\n    newInstance.rendererBufferId = this.rendererBufferId;\r\n    newInstance.rendererTextureRef = this.rendererTextureRef;\r\n    newInstance.src = this.src;\r\n    newInstance.isTop = this.isTop;\r\n    newInstance.hidden = this.hidden;\r\n    return newInstance;\r\n  }\r\n}\r\n","import BaseProgram from \"../Base/BaseProgram\";\r\nimport ShadowDepthFragmentShader from \"../Shaders/ShadowDepthFragmentShader.glsl\";\r\nimport PassthroughVertexShader from \"../Shaders/PassthroughVertexShader.glsl\";\r\nimport ShadowLightVertexShader from \"../Shaders/ShadowLightVertexShader.glsl\";\r\nimport ShadowLightFragmentShader from \"../Shaders/ShadowLightFragmentShader.glsl\";\r\nimport LightFragmentShader from \"../Shaders/LightFragmentShader.glsl\";\r\nimport LightVertexShader from \"../Shaders/LightVertexShader.glsl\";\r\nimport ArrayBuffer from \"../../Buffer/ArrayBuffer\";\r\nimport { mat4, vec3 } from \"gl-matrix\";\r\nimport Texture from \"../../Buffer/Texture\";\r\nimport ProgramReference from \"../Base/ProgramReference\";\r\nimport Light from \"../../Data/Light\";\r\nimport { BaseCamera } from \"../../Camera\";\r\n\r\nexport default class Shader3DProgram extends BaseProgram {\r\n  static DRAW_VERTEX_SIZE = 8;\r\n  position: ProgramReference;\r\n  textureCoords: ProgramReference;\r\n  normal: ProgramReference;\r\n\r\n  projMtrx: ProgramReference;\r\n  modelMtrx: ProgramReference;\r\n  viewMtrx: ProgramReference;\r\n\r\n  light1Pos: ProgramReference;\r\n  light1Intensities: ProgramReference;\r\n  light1Attenu: ProgramReference;\r\n  light1AmbCoeff: ProgramReference;\r\n  light1View: ProgramReference;\r\n  light1Projection: ProgramReference;\r\n\r\n  shadowMap: ProgramReference;\r\n  tex2DSampler: ProgramReference;\r\n\r\n  arrayBuffer: ArrayBuffer;\r\n\r\n  // shadow program\r\n  shadowProgram: WebGLProgram;\r\n  shadowFramebuffer: WebGLFramebuffer;\r\n  shadowDepthTexture: WebGLTexture;\r\n  shadowRenderBuffer: WebGLRenderbuffer;\r\n\r\n  isLightingEnabledUniform: ProgramReference;\r\n  shadowPos: ProgramReference;\r\n  shadowProjection: ProgramReference;\r\n  shadowView: ProgramReference;\r\n  shadowModel: ProgramReference;\r\n\r\n  shadowTextureUnit: number;\r\n\r\n  isShadowEnabled: boolean = true;\r\n\r\n  light: Light;\r\n\r\n  // this must be changed in shader as well.\r\n  shadowDepthTextureSize = 1024.0;\r\n\r\n  isLightingEnabled: boolean = true;\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    super(ctx);\r\n    this.arrayBuffer = new ArrayBuffer(ctx);\r\n\r\n    if (this.isShadowEnabled) {\r\n      this.program = this.compileShaders(\r\n        ShadowLightVertexShader,\r\n        ShadowLightFragmentShader\r\n      );\r\n      this.bindProgram();\r\n      this.shadowMap = new ProgramReference(\r\n        \"shadowMap\",\r\n        ctx,\r\n        false,\r\n        this.program\r\n      );\r\n      this.light1View = new ProgramReference(\r\n        \"u_light1_view\",\r\n        ctx,\r\n        false,\r\n        this.program\r\n      );\r\n      this.light1Projection = new ProgramReference(\r\n        \"u_light1_projection\",\r\n        ctx,\r\n        false,\r\n        this.program\r\n      );\r\n    } else {\r\n      this.program = this.compileShaders(\r\n        LightVertexShader,\r\n        LightFragmentShader\r\n      );\r\n      this.bindProgram();\r\n    }\r\n    this.normal = new ProgramReference(\"a_normal\", ctx, true, this.program);\r\n    this.position = new ProgramReference(\"a_position\", ctx, true, this.program);\r\n    this.textureCoords = new ProgramReference(\r\n      \"a_texture_coords\",\r\n      ctx,\r\n      true,\r\n      this.program\r\n    );\r\n\r\n    this.projMtrx = new ProgramReference(\r\n      \"u_projection\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.viewMtrx = new ProgramReference(\"u_view\", ctx, false, this.program);\r\n    this.modelMtrx = new ProgramReference(\"u_model\", ctx, false, this.program);\r\n\r\n    this.tex2DSampler = new ProgramReference(\r\n      \"texture\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n\r\n    this.light1Pos = new ProgramReference(\r\n      \"u_light1_pos\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.light1Intensities = new ProgramReference(\r\n      \"u_light1_intensities\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.light1Attenu = new ProgramReference(\r\n      \"u_light1_attenuation\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.light1AmbCoeff = new ProgramReference(\r\n      \"u_light1_ambient_coefficient\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n\r\n    this.isLightingEnabledUniform = new ProgramReference(\r\n      \"u_isLightingEnabled\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n\r\n    if (this.isShadowEnabled) {\r\n      this.initShadowProgram();\r\n    }\r\n  }\r\n\r\n  initShadowProgram() {\r\n    const ctx = this.ctx;\r\n    this.shadowProgram = this.compileShaders(\r\n      PassthroughVertexShader,\r\n      ShadowDepthFragmentShader\r\n    );\r\n    this.bindShadowProgram();\r\n\r\n    this.shadowPos = new ProgramReference(\r\n      \"a_position\",\r\n      ctx,\r\n      true,\r\n      this.shadowProgram\r\n    );\r\n    this.shadowProjection = new ProgramReference(\r\n      \"u_projection\",\r\n      ctx,\r\n      false,\r\n      this.shadowProgram\r\n    );\r\n    this.shadowView = new ProgramReference(\r\n      \"u_view\",\r\n      ctx,\r\n      false,\r\n      this.shadowProgram\r\n    );\r\n    this.shadowModel = new ProgramReference(\r\n      \"u_model\",\r\n      ctx,\r\n      false,\r\n      this.shadowProgram\r\n    );\r\n\r\n    this.shadowFramebuffer = ctx.createFramebuffer()!;\r\n    this.createDepthTexture();\r\n\r\n    this.shadowRenderBuffer = ctx.createRenderbuffer()!;\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, this.shadowRenderBuffer);\r\n    ctx.renderbufferStorage(\r\n      ctx.RENDERBUFFER,\r\n      ctx.DEPTH_COMPONENT16,\r\n      this.shadowDepthTextureSize,\r\n      this.shadowDepthTextureSize\r\n    );\r\n\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, this.shadowFramebuffer);\r\n    ctx.framebufferTexture2D(\r\n      ctx.FRAMEBUFFER,\r\n      ctx.COLOR_ATTACHMENT0,\r\n      ctx.TEXTURE_2D,\r\n      this.shadowDepthTexture,\r\n      0\r\n    );\r\n    ctx.framebufferRenderbuffer(\r\n      ctx.FRAMEBUFFER,\r\n      ctx.DEPTH_ATTACHMENT,\r\n      ctx.RENDERBUFFER,\r\n      this.shadowRenderBuffer\r\n    );\r\n\r\n    ctx.bindTexture(ctx.TEXTURE_2D, null);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\r\n  }\r\n\r\n  createDepthTexture() {\r\n    const ctx = this.ctx;\r\n    this.shadowTextureUnit = Texture.textureCount;\r\n    ctx.activeTexture(ctx.TEXTURE0 + this.shadowTextureUnit);\r\n    Texture.textureCount += 1;\r\n\r\n    this.shadowDepthTexture = ctx.createTexture()!;\r\n    ctx.bindTexture(ctx.TEXTURE_2D, this.shadowDepthTexture);\r\n\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MIN_FILTER, ctx.LINEAR);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MAG_FILTER, ctx.LINEAR);\r\n    ctx.texImage2D(\r\n      ctx.TEXTURE_2D,\r\n      0,\r\n      ctx.RGBA,\r\n      this.shadowDepthTextureSize,\r\n      this.shadowDepthTextureSize,\r\n      0,\r\n      ctx.RGBA,\r\n      ctx.UNSIGNED_BYTE,\r\n      null\r\n    );\r\n  }\r\n\r\n  bindShadowProgram() {\r\n    this._bindProgram(this.shadowProgram);\r\n  }\r\n\r\n  bindProgram() {\r\n    this._bindProgram(this.program);\r\n  }\r\n\r\n  unbindProgram() {\r\n    this._unbindProgram();\r\n  }\r\n\r\n  unbindShadowProgram() {}\r\n\r\n  enableAttribPointers() {\r\n    const ctx = this.ctx;\r\n    ctx.enableVertexAttribArray(this.position.ref);\r\n    ctx.enableVertexAttribArray(this.textureCoords.ref);\r\n    ctx.enableVertexAttribArray(this.normal.ref);\r\n  }\r\n\r\n  bindAttributePointers() {\r\n    this.enableAttribPointers();\r\n    const ctx = this.ctx;\r\n    ctx.vertexAttribPointer(this.position.ref, 3, ctx.FLOAT, false, 4 * 8, 0);\r\n    ctx.vertexAttribPointer(this.normal.ref, 3, ctx.FLOAT, true, 4 * 8, 3 * 4);\r\n    ctx.vertexAttribPointer(\r\n      this.textureCoords.ref,\r\n      2,\r\n      ctx.FLOAT,\r\n      true,\r\n      4 * 8,\r\n      6 * 4\r\n    );\r\n  }\r\n\r\n  enableShadowAttribPointers() {\r\n    this.ctx.enableVertexAttribArray(this.shadowPos.ref);\r\n  }\r\n\r\n  bindShadowAttributePointers() {\r\n    this.enableShadowAttribPointers();\r\n    const ctx = this.ctx;\r\n    ctx.vertexAttribPointer(this.shadowPos.ref, 3, ctx.FLOAT, false, 4 * 8, 0);\r\n  }\r\n\r\n  glSetShadowModelMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.shadowModel.ref, false, matrixArray);\r\n  }\r\n\r\n  unbindShadowAttributePointers() {\r\n    this.ctx.disableVertexAttribArray(this.shadowPos.ref);\r\n  }\r\n\r\n  setLight(light: Light, camera: BaseCamera) {\r\n    this.light = light;\r\n    const lookAt = light.lookAt();\r\n\r\n    this.bindProgram();\r\n    const ctx = this.ctx;\r\n    ctx.uniform1i(this.isLightingEnabledUniform.ref, this.isLightingEnabled ? 1 : 0);\r\n\r\n    ctx.uniform3fv(this.light1Pos.ref, light.pos);\r\n    ctx.uniform3fv(this.light1Intensities.ref, light.in);\r\n    ctx.uniform1f(this.light1AmbCoeff.ref, light.ambientCoeff);\r\n    ctx.uniform1f(this.light1Attenu.ref, light.attenuation);\r\n\r\n    if (this.isShadowEnabled) {\r\n      const cameraFrustum = mat4.frustum(\r\n        mat4.create(),\r\n        -1 * camera.aspect,\r\n        1 * camera.aspect,\r\n        -1 * camera.aspect,\r\n        1 * camera.aspect,\r\n        1,\r\n        vec3.squaredDistance(light.posVec(), light.atVec())\r\n      );\r\n\r\n      ctx.uniformMatrix4fv(this.light1View.ref, false, lookAt as Float32List);\r\n      ctx.uniformMatrix4fv(this.light1Projection.ref, false, cameraFrustum as Float32List);\r\n\r\n      this.bindShadowProgram();\r\n      ctx.uniformMatrix4fv(this.shadowView.ref, false, lookAt as Float32List);\r\n      ctx.uniformMatrix4fv(this.shadowProjection.ref, false, cameraFrustum as Float32List);\r\n    }\r\n  }\r\n\r\n  toggleLighting(enable: boolean) {\r\n    this.isLightingEnabled = enable;\r\n  }\r\n\r\n  prepareShadowTexture() {\r\n    const ctx = this.ctx;\r\n    ctx.activeTexture(ctx.TEXTURE0 + this.shadowTextureUnit);\r\n    ctx.bindTexture(ctx.TEXTURE_2D, this.shadowDepthTexture);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, this.shadowRenderBuffer);\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, this.shadowFramebuffer);\r\n    ctx.viewport(\r\n      0,\r\n      0,\r\n      this.shadowDepthTextureSize,\r\n      this.shadowDepthTextureSize\r\n    );\r\n    ctx.clear(ctx.COLOR_BUFFER_BIT | ctx.DEPTH_BUFFER_BIT);\r\n\r\n    this.arrayBuffer.bind();\r\n    this.bindShadowAttributePointers();\r\n    this.bindShadowProgram();\r\n  }\r\n\r\n  revertShadowTexture() {\r\n    const ctx = this.ctx;\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\r\n    this.arrayBuffer.unbind();\r\n    this.unbindShadowAttributePointers();\r\n    this.unbindShadowProgram();\r\n  }\r\n\r\n  bindShadowTexture() {\r\n    this.bindProgram();\r\n    this.ctx.uniform1i(this.shadowMap.ref, this.shadowTextureUnit);\r\n  }\r\n\r\n  unbindAttributePointers() {\r\n    const ctx = this.ctx;\r\n    ctx.disableVertexAttribArray(this.position.ref);\r\n    ctx.disableVertexAttribArray(this.textureCoords.ref);\r\n    ctx.disableVertexAttribArray(this.normal.ref);\r\n  }\r\n\r\n  glSetViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.viewMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetProjectMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.projMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetModelViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.modelMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  bindTexture(texture: Texture) {\r\n    texture.bindTexture(this.ctx, this.tex2DSampler.ref);\r\n  }\r\n}\r\n","export default \"\\r\\nprecision mediump float;\\r\\n\\r\\nvec4 packDepthToRGBA(const float v) {\\r\\n  const float PackUpscale = 256. / 255.;\\r\\n  const vec3 PackFactors = vec3(256. * 256. * 256., 256. * 256., 256.);\\r\\n  const float ShiftRight8 = 1. / 256.;\\r\\n\\r\\n  vec4 r = vec4(fract(v * PackFactors), v);\\r\\n  r.yzw -= r.xyz * ShiftRight8; // tidy overflow\\r\\n  return r * PackUpscale;\\r\\n}\\r\\n\\r\\nvoid main(void) {\\r\\n  gl_FragColor = packDepthToRGBA(gl_FragCoord.z);\\r\\n}\\r\\n\\r\\n\";","export interface ArrayBufferMetaData {\r\n  offset: number;\r\n  size: number;\r\n  verticesSize: number;\r\n}\r\n\r\nclass ArrayBuffer {\r\n  bufferid: WebGLBuffer;\r\n  bufferArray: number[] = [];\r\n  verticeSize = 0;\r\n  bufferReg: {\r\n    [key: string]: ArrayBufferMetaData;\r\n  } = {};\r\n  bufferRegId = 1;\r\n  deleted = false;\r\n  maxSize: number;\r\n  private isBuffered = false;\r\n  private ctx: WebGLRenderingContext;\r\n  private static readonly MAX_BUFFER_SIZE = 10000000; // 10M floats (~40MB)\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.bufferid = ctx.createBuffer()!;\r\n    this.ctx = ctx;\r\n    ctx.bindBuffer(ctx.ARRAY_BUFFER, this.bufferid);\r\n  }\r\n\r\n  delete() {\r\n    this.ctx.deleteBuffer(this.bufferid);\r\n    this.deleted = true;\r\n  }\r\n\r\n  bufferBind() {\r\n    if (this.deleted) {\r\n      return;\r\n    }\r\n    this.bind();\r\n\r\n    if (!this.isBuffered) {\r\n      const doubled = this.bufferArray.length * 2;\r\n      const capped = Math.min(doubled, ArrayBuffer.MAX_BUFFER_SIZE);\r\n      this.maxSize = Math.max(capped, this.bufferArray.length);\r\n    }\r\n\r\n    const buffer = new Float32Array(this.maxSize);\r\n    buffer.fill(0, this.bufferArray.length);\r\n    buffer.set(this.bufferArray);\r\n\r\n    this.ctx.bufferData(this.ctx.ARRAY_BUFFER, buffer, this.ctx.STATIC_DRAW);\r\n\r\n    this.isBuffered = true;\r\n  }\r\n\r\n  length() {\r\n    return this.verticeSize;\r\n  }\r\n\r\n  bufferSub(offset: number, data: number[], vertexSize: number) {\r\n    if (this.deleted) {\r\n      return;\r\n    }\r\n    this.bind();\r\n    this.ctx.bufferSubData(\r\n      this.ctx.ARRAY_BUFFER,\r\n      offset * Float32Array.BYTES_PER_ELEMENT * vertexSize,\r\n      new Float32Array(data)\r\n    );\r\n  }\r\n\r\n  reset() {\r\n    this.bufferArray = [];\r\n  }\r\n\r\n  push(vertices: number[], size: number) {\r\n    this.bufferArray = this.bufferArray.concat(vertices);\r\n    this.verticeSize += size;\r\n\r\n    if (this.isBuffered) {\r\n      if (this.bufferArray.length < this.maxSize) {\r\n        this.bufferSub(\r\n          this.verticeSize - size,\r\n          vertices,\r\n          vertices.length / size\r\n        );\r\n      } else {\r\n        this.bufferBind();\r\n        console.log(\"buffer resizing as limit has been reached\");\r\n      }\r\n    }\r\n  }\r\n\r\n  bind() {\r\n    if (this.deleted === true) {\r\n      return;\r\n    }\r\n    this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.bufferid);\r\n  }\r\n\r\n  unbind() {\r\n    // do nothing for now\r\n  }\r\n}\r\n\r\nexport default ArrayBuffer;\r\n","import {\r\n  App,\r\n  BitmapConfigParser,\r\n  Coordinate,\r\n  EngineEvent,\r\n  EngineHelper,\r\n  EngineObject,\r\n  Events,\r\n  Light,\r\n  ModelObject3d,\r\n  Object3d,\r\n  ObjectManager,\r\n  Plane3d,\r\n  PlaneType,\r\n  Rect3d,\r\n  ResourceResolver\r\n} from \"synaren-engine\";\r\nimport Cube from \"./Cube\";\r\nimport Ground3d from \"./Ground3d\";\r\nimport Sphere from \"./Sphere\";\r\n\r\nexport default class ExampleWorld extends ObjectManager {\r\n  fontCacheId: number;\r\n  bitmapLoader: BitmapConfigParser;\r\n  ground: Ground3d;\r\n  racingCar: ModelObject3d;\r\n  lowPolyGirl: ModelObject3d;\r\n  cube: Cube;\r\n  cube2: Cube;\r\n  sun: Sphere;\r\n  road: Plane3d;\r\n  lowPolyTree: ModelObject3d[];\r\n  sky: Sphere;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject, index: number) => ent.render(this.engineHelper));\r\n  }\r\n\r\n  update() {\r\n    this.entities.forEach((ent: EngineObject) => ent.update(this.engineHelper));\r\n    const { x, y, z } = this.engineHelper.camera.camera3d.position;\r\n    if (this.sky) {\r\n      this.sky.center(x, y, z);\r\n    }\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    super.event(event);\r\n    if (event.eventType === Events.DRAG) {\r\n      this.engineHelper.camera.camera3d.angleY(-event.dxRaw);\r\n      this.engineHelper.camera.camera3d.angleX(event.dyRaw);\r\n      this.engineHelper.camera.camera3d.updateProjectionView();\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  loadResources() {\r\n    console.log('Loading ExampleApp resources...');\r\n    \r\n    this.engineHelper\r\n      .getResource(\"assets/sphere.txt\")\r\n      .then(\r\n        ResourceResolver.objResolverMultiple(this.engineHelper, [\r\n          { textureSource: \"assets/background.jpg\", name: \"background\" },\r\n          { textureSource: \"assets/sun.png\", name: \"sun\" }\r\n        ])\r\n      ).then(() => console.log('Sphere resources loaded'))\r\n      .catch(err => console.error('Sphere resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_tree.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_tree.png\",\r\n          \"low_poly_tree\"\r\n        )\r\n      ).then(() => console.log('Tree resources loaded'))\r\n      .catch(err => console.error('Tree resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_girl.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_girl.png\",\r\n          \"low_poly_girl\"\r\n        )\r\n      ).then(() => console.log('Girl resources loaded'))\r\n      .catch(err => console.error('Girl resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/racing_car.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/racing_car.png\",\r\n          \"racing_car\"\r\n        )\r\n      ).then(() => console.log('Car resources loaded'))\r\n      .catch(err => console.error('Car resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/paprika.fnt\")\r\n      .then(ResourceResolver.bmFontResolver(this.engineHelper))\r\n      .then(() => console.log('Font resources loaded'))\r\n      .catch(err => console.error('Font resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/atlas.txt\")\r\n      .then(\r\n        ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 20e-3)\r\n      ).then(() => console.log('Atlas resources loaded'))\r\n      .catch(err => console.error('Atlas resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(`/assets/missing-texture.txt`)\r\n      .then(ResourceResolver.bitmapResolver(this.engineHelper, 1184, 1184, 0))\r\n      .then(() => console.log('Missing texture resources loaded'))\r\n      .catch(err => console.error('Missing texture resource error:', err));\r\n  }\r\n\r\n  init() {\r\n   const length = 30;\r\n    const width = 20;\r\n\r\n    this.engineHelper.camera.camera3d.center(0, 2, length / 2 - 4);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n\r\n    this.sky = new Sphere(\r\n      new Rect3d(0.0, 2.0, 0.0, 100.0, 100.0, 100.0),\r\n      \"background\"\r\n    );\r\n    this.addEntity(this.sky);\r\n\r\n    this.lowPolyGirl = new Object3d(\r\n      new Rect3d(-4, 0.95, 5, 1.0, 1.0, 1.0),\r\n      \"low_poly_girl\"\r\n    );\r\n    this.lowPolyGirl.angleY(240);\r\n    this.lowPolyGirl.scale(0.7, 0.7, 0.7);\r\n    this.addEntity(this.lowPolyGirl);\r\n\r\n    this.racingCar = new Object3d(\r\n      new Rect3d(0, -0.25, 0, 1.5, 1.5, 1.5),\r\n      \"racing_car\"\r\n    );\r\n    this.racingCar.angleY(135);\r\n    this.addEntity(this.racingCar);\r\n\r\n    this.ground = new Ground3d(\r\n      new Rect3d(0.0, 0.0, 0.0, width, 0, length),\r\n      \"grass\"\r\n    );\r\n    this.ground.event = (\r\n      event: EngineEvent,\r\n      engineHelper: EngineHelper\r\n    ) => {\r\n      if (\r\n        event.eventType === Events.UP &&\r\n        event.prevEventType === Events.DOWN\r\n      ) {\r\n        const clickedElement = this.ground.isPointInGround(\r\n          new Coordinate(event.x, event.y, 0)\r\n        );\r\n        if (clickedElement) {\r\n          const cameraX = engineHelper.camera.camera3d.position.x;\r\n          const cameraZ = engineHelper.camera.camera3d.position.z;\r\n          const dx = Math.abs(cameraX - clickedElement.position.x);\r\n          const dz = Math.abs(cameraZ - clickedElement.position.z);\r\n          const totalDist = Math.sqrt(dx * dx + dz * dz);\r\n          const speed = 1 / 200;\r\n          const time = totalDist / speed;\r\n          engineHelper.camera.camera3d.pan3d(\r\n            time,\r\n            clickedElement.position.x,\r\n            undefined,\r\n            clickedElement.position.z\r\n          );\r\n        }\r\n      }\r\n      return true;\r\n    };\r\n    this.addEntity(this.ground);\r\n\r\n    this.cube = new Cube(new Rect3d(-4, 2, -12, 0.9, 0.9, 0.9), \"assets/atlas.png\", [\r\n      \"wood\",\r\n      \"cloth\",\r\n      \"sky\",\r\n      \"grass\",\r\n      \"paper\",\r\n      \"rock\"\r\n    ]);\r\n    this.cube.update = function() {\r\n      this.position.ay++;\r\n      this.position.ax++;\r\n      this.position.az++;\r\n      this.planes.forEach(element => {\r\n        element.angleY(this.position.ay);\r\n        element.angleX(this.position.ax);\r\n        element.angleZ(this.position.az);\r\n      });\r\n    };\r\n    this.addEntity(this.cube);\r\n\r\n    this.cube2 = new Cube(new Rect3d(-2.2, 2, 9, .9, .9, .9), \"assets/atlas.png\", [\r\n      \"wood\",\r\n      \"cloth\",\r\n      \"sky\",\r\n      \"grass\",\r\n      \"paper\",\r\n      \"rock\"\r\n    ]);\r\n    this.cube2.update = function() {\r\n      this.position.ay++;\r\n      this.position.ax++;\r\n      this.position.az++;\r\n      this.planes.forEach(element => {\r\n        element.angleY(this.position.ay);\r\n        element.angleX(this.position.ax);\r\n        element.angleZ(this.position.az);\r\n      });\r\n    };\r\n    this.addEntity(this.cube2);\r\n\r\n    this.sun = new Sphere(new Rect3d(0.0, 10, -15, 1.0, 1.0, 1.0), \"sun\");\r\n    this.sun.update = function() {\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.angleY(this.position.ay);\r\n      this.angleX(this.position.ax);\r\n      this.angleZ(this.position.az);\r\n    };\r\n    this.addEntity(this.sun);\r\n\r\n    this.lowPolyTree = [];\r\n    const treeCreator = (l: number, w: number) => {\r\n      const tree = new Object3d(\r\n        new Rect3d(l, 0, w, 1.0, 1.0, 1.0),\r\n        \"low_poly_tree\"\r\n      );\r\n      const heightRand = Math.random() * 0.8 - 0.8;\r\n      const scale = 3.5 + heightRand;\r\n      tree.scale(scale, scale, scale);\r\n      this.lowPolyTree.push(tree);\r\n      this.addEntity(tree);\r\n    };\r\n    for (let l = 0; l < length; l += 4) {\r\n      treeCreator(-width / 2, l - length / 2);\r\n      treeCreator(width / 2 - 1, l - length / 2);\r\n    }\r\n    for (let w = 1; w < width - 1; w += 4) {\r\n      treeCreator(w - width / 2, -length / 2);\r\n      treeCreator(w - width / 2, length / 2 - 1);\r\n    }\r\n\r\n    const vertexModel = this.engineHelper.newVertexModel(\r\n      \"ground\",\r\n      PlaneType.XZ\r\n    );\r\n    this.road = new Plane3d(new Rect3d(0, 0.01, 0.0, 1, 1, 1), vertexModel);\r\n    this.road.scale(3, 1, (2 * width) / Math.sqrt(2));\r\n    this.road.angleY(-45);\r\n    this.road.center(-2, 0.01, -15);\r\n\r\n    this.addEntity(this.road);\r\n\r\n    // initialise all the engine objects\r\n    super.init();\r\n\r\n    this.engineHelper.setLighting(\r\n      new Light({\r\n        pos: [0.0, 10, -15],\r\n        // intensity and color in rgb\r\n        in: [1.0, 1.0, 1.0],\r\n        // rate of loss in light intensity from source pos\r\n        attenuation: 0.015,\r\n        // ambient lighting 0 - 1 where 0 is complete darkness\r\n        ambientCoeff: 0.3,\r\n        // the direction of light from pos to at to direct the shadowing\r\n        // note that it is only in one direction.\r\n        at: [0.0, 0.0, 0.0]\r\n      })\r\n    );\r\n    \r\n    console.log(\" Example App Loaded!\");\r\n    console.log(\" Features:\");\r\n    console.log(\"    3D scene with various objects\");\r\n    console.log(\"    Mouse drag to look around\");\r\n    console.log(\"    Click on ground to move camera\");\r\n    console.log(\"    Animated cubes and sun\");\r\n  }\r\n}\r\n\r\nconst createExampleApp = () => {\r\n  const aspect = window.innerWidth / window.innerHeight;\r\n  const args = {\r\n    world: new ExampleWorld(),\r\n    elementId: \"app\",\r\n    canvasId: \"app-game\",\r\n    error: undefined,\r\n    subscribe: undefined,\r\n    renderMode: '3d',\r\n    camera: {\r\n      near: 0.01,\r\n      far: 1000.0,\r\n      fov: 60.0,\r\n      maxFov: 60.0,\r\n      isFovMax: false,\r\n      projection: 'perspective',\r\n      aspect\r\n    },\r\n    aspectRatio: aspect,\r\n    eventThrottle: 1000.0 / 60.0,\r\n    fps: 30,\r\n    isStepRender: false,\r\n  };\r\n  const app = new App(args);\r\n  \r\n  // Expose app instance globally\r\n  (window as any).gameInstance = args.world;\r\n  \r\n  app.run().catch(console.error);\r\n  app.unpause();\r\n  window.onresize = () => {\r\n    location.reload();\r\n  };\r\n};\r\n\r\nexport { createExampleApp, ExampleWorld };\r\n","import { ColourRenderUnit } from \"./RenderUnit\";\r\nimport VertexModel from \"./VertexModel\";\r\nimport ModelData from \"./ModelData\";\r\nimport EngineObjectHelper from \"../EngineEntity/EngineObjectHelper\";\r\n\r\nclass ColourVertexModel extends VertexModel {\r\n  vertexBufferId: number;\r\n  renderUnits: ColourRenderUnit[];\r\n  createRenderUnits(count: number) {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < count; index++) {\r\n      this.renderUnits.push(new ColourRenderUnit());\r\n    }\r\n    return this;\r\n  }\r\n  fillRenderUnits(values: number[]) {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < values.length; index += 7) {\r\n      const renderUnit = new ColourRenderUnit();\r\n      renderUnit.vertex.x = values[index];\r\n      renderUnit.vertex.y = values[index + 1];\r\n      renderUnit.vertex.z = values[index + 2];\r\n      renderUnit.colour.r = values[index + 3];\r\n      renderUnit.colour.g = values[index + 4];\r\n      renderUnit.colour.b = values[index + 5];\r\n      renderUnit.colour.a = values[index + 6];\r\n      this.renderUnits.push(renderUnit);\r\n    }\r\n    return this;\r\n  }\r\n  createModel(): ModelData {\r\n    const model = new ModelData();\r\n    model.vertices = EngineObjectHelper.vertex.toColourArray(this.renderUnits);\r\n    return model;\r\n  }\r\n}\r\nexport default ColourVertexModel;\r\n","import { EntityManager, Plane3d, Rect3d, EngineHelper, EngineEvent, CollisionDetection, PlaneType } from \"synaren-engine\";\r\n\r\nexport default class Cube extends EntityManager {\r\n  planes: Plane3d[];\r\n  textureSource: string;\r\n  uvs: string[];\r\n\r\n  constructor(rect: Rect3d, textureSource: string, uvs: string[]) {\r\n    super();\r\n    this.setRect(rect);\r\n    this.textureSource = textureSource;\r\n    this.uvs = uvs;\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.planes.forEach(element => element.render(engineHelper));\r\n  }\r\n\r\n  isPointInCube(evnt: EngineEvent, engineHelper: EngineHelper) {\r\n    return (\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[0],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[1],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[2],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[3],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[4],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[5],\r\n        evnt.x,\r\n        evnt.y\r\n      )\r\n    );\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const width = this.position.width;\r\n    const length = this.position.length;\r\n    const height = this.position.height;\r\n    const x = this.position.x;\r\n    const y = this.position.y;\r\n    const z = this.position.z;\r\n    const rect = new Rect3d(x, y, z, width, height, length);\r\n\r\n    this.planes = [\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[0], PlaneType.YX)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[1], PlaneType.XY)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[2], PlaneType.ZX)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[3], PlaneType.XZ)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[4], PlaneType.ZY)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[5], PlaneType.YZ))\r\n    ];\r\n\r\n    this.planes.forEach(plane => this.entities.push(plane));\r\n\r\n    this.scaleRect(rect);\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n\r\n    this.planes[0].center(x, y, z + length / 2);\r\n    this.planes[1].center(x, y, z - length / 2);\r\n    this.planes[2].center(x, y - height / 2, z);\r\n    this.planes[3].center(x, y + height / 2, z);\r\n    this.planes[4].center(x + width / 2, y, z);\r\n    this.planes[5].center(x - width / 2, y, z);\r\n\r\n    this.rotateOriginRect(this.getRect());\r\n\r\n    super.init(engineHelper);\r\n  }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { CrystalCollectorGame, createCrystalCollectorApp } from \"./CrystalCollectorGame\";\r\nimport { ExampleWorld, createExampleApp } from \"./ExampleApp\";\r\nimport { createRacingGame } from \"./RacingGame\";\r\n\r\n// Game registry\r\nconst games = {\r\n  'example': {\r\n    name: 'Example App',\r\n    description: '3D scene with various objects and interactions',\r\n    createFunction: createExampleApp\r\n  },\r\n  'crystal-collector': {\r\n    name: 'Crystal Collector 3D',\r\n    description: 'Collect crystals in a 3D world before time runs out!',\r\n    createFunction: createCrystalCollectorApp\r\n  },\r\n  'racing': {\r\n    name: '3D Racing Game',\r\n    description: 'Race against AI bots on a 3D track with realistic physics!',\r\n    createFunction: createRacingGame\r\n  }\r\n};\r\n\r\n// Main game launcher\r\nconst launchGame = (gameKey: string) => {\r\n  const game = games[gameKey];\r\n  if (game) {\r\n    console.log(` Launching ${game.name}...`);\r\n    \r\n    // Clear any existing game content\r\n    const appElement = document.getElementById('app');\r\n    if (appElement) {\r\n      appElement.innerHTML = '';\r\n    }\r\n    \r\n    // Launch the selected game\r\n    game.createFunction();\r\n    \r\n    // Hide game menu\r\n    const gameMenu = document.getElementById('game-menu');\r\n    if (gameMenu) {\r\n      gameMenu.style.display = 'none';\r\n    }\r\n    \r\n    // Show back button\r\n    const backButton = document.getElementById('back-button');\r\n    if (backButton) {\r\n      backButton.style.display = 'block';\r\n    }\r\n  } else {\r\n    console.error(`Game '${gameKey}' not found!`);\r\n  }\r\n};\r\n\r\n// Show game menu\r\nconst showGameMenu = () => {\r\n  const gameMenu = document.getElementById('game-menu');\r\n  const backButton = document.getElementById('back-button');\r\n  const appElement = document.getElementById('app');\r\n  \r\n  if (gameMenu) gameMenu.style.display = 'block';\r\n  if (backButton) backButton.style.display = 'none';\r\n  if (appElement) appElement.innerHTML = '';\r\n  \r\n  // Clear any running game instances\r\n  (window as any).gameInstance = null;\r\n};\r\n\r\n// Initialize the application\r\nwindow.onload = function () {\r\n  try {\r\n    // Check URL parameter to decide which game to load\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const gameMode = urlParams.get('game');\r\n    \r\n    if (gameMode && games[gameMode]) {\r\n      // Load specific game directly\r\n      launchGame(gameMode);\r\n    } else {\r\n      // Show game selection menu\r\n      showGameMenu();\r\n    }\r\n    \r\n    // Expose functions globally for HTML access\r\n    (window as any).launchGame = launchGame;\r\n    (window as any).showGameMenu = showGameMenu;\r\n    \r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n};\r\n"],"names":["root","factory","exports","module","define","amd","self","_start","Date","now","start","this","peak","stop","_end","elapsed","raw","vertices","split","map","parseFloat","Array","console","error","entities","setPosition","position","forEach","e","center","x","y","z","rotateOrigin","rotateOriginRect","rect","rotateX","angleX","rotateY","angleY","rotateZ","angleZ","scaleX","scaleY","scaleZ","scale","translate","dx","dy","dz","init","engineHelper","a","render","hidden","entity","update","setTop","isTop","value","setHidden","EntityManager","create","out","Float32Array","clone","fromValues","copy","set","add","b","subtract","multiply","divide","ceil","Math","floor","min","max","round","scaleAndAdd","distance","sqrt","squaredDistance","length","squaredLength","negate","inverse","normalize","len","dot","cross","lerp","t","ax","ay","random","undefined","r","PI","cos","sin","transformMat2","m","transformMat2d","transformMat3","transformMat4","rotate","rad","p0","p1","sinC","cosC","angle","bx","by","abs","atan2","signedAngle","zero","str","exactEquals","equals","a0","a1","b0","b1","vec","sub","mul","div","dist","sqrDist","sqrLen","stride","offset","count","fn","arg","i","l","vertexModel","centerRect","scaleRect","renderOpt","renderType","RenderType","RECTANGLE","shaderType","ShaderType","TWO_DIMENSION","shaderEntity","addBuffer","createTexture","textureSource","build","Collision","vec2","originX","originY","az","getLength","x1","y1","x2","y2","isCollidingRect","width1","height1","width2","height2","CollisionDetection","isRectInRect","rect1","rect2","width","height","isPointInRect","coord","isPointInPlane3d","camera","obj","mvp","mat4","frustum","viewMatrix","getModel","r1","toClipSpace","renderUnits","vertex","r2","r3","r4","rectPolygon","pointInPolygon","pos","vec4Trans","vec4","vec4Norm","point","polygon","inside","j","xi","yi","xj","yj","subtractCenter","p","v","points","area","v1","v2","calculateCentre","centroid","newVector","totalSignedArea","vertexCount","nextVertex","polygonProjection","axis","dotProduct","boundaryDistance","minA","maxA","minB","maxB","isCollision","polygonB","velocity","result","isIntersect","willIntersect","edge","edgeCountA","edges","edgeCountB","minIntervalDistance","Infinity","translationAxis","edgeIndex","normalise","velocityProjection","intervalDistance","minDeintersectDistance","Polygon","zoomScale","baseTranslate","_isUpdateView","timer","updateProjectionView","commitProjectionView","quatRotationxyz","quat","degreesToRadians","dest","quatMat","fromQuat","vec3","frustumMatrix","left","cameraOptions","aspect","right","bottom","top","near","far","updateProjectionMatrix","projection","perspective","clearPan","interval","clearInterval","pan","time","speed","steps","_moveTime","tx","ty","tz","setInterval","isOutOfBound","bound","isUpdateView","fov","diff","experimental","inverseAngleY","zoomIn","delta","zoomOut","maxFovAspect","atan","maxFov","setupCamera","aspectRatio","canvas","enabled","offsetWidth","offsetHeight","zoom","setZoom","setBaseTranslate","isFovMax","lookAt","targetX","targetY","targetZ","horizontalDistance","followBehind","targetRotation","cameraX","cameraZ","cameraY","BaseCamera","INTERVAL_TIME","translateSpace","distanceEvent","event","pan2d","pan2dDif","pan3d","camera3d","Camera3d","camera2d","Camera2d","renderMode","getActiveCamera","getActiveFrustum","Camera","objects","ref","anchor","texts","prop","hasOwnProperty","startsWith","object","initObjectPosition","$ref","$anchor","type","buildModel","config","createPlane2D","model","createRect2d","isCentre","hasPhysics","hookCustomHandler","createPlane3D","createRect3d","planeType","createTriangle","rgba","createSpriteMoveable","spriteModel","ticks","createMoveable","createSprite","createText","texture","createCoordinate","fontSize","text","id","createColour","createLineColour","point1","point2","thickness","warn","$id","data","isLastEvent","FontReference","setClone","window","bind","onClickedDefined","onClick","shouldPropagate","isClicked","eventType","UP","getRect2","Number","textRef","newFont","setText","setFontSize","push","colour","location","registerPhysics","physics","setLayer","moveable","setRect","updatePhysicsPosition","plane","newVertexModel","ConfigEntity","ConfigMapBuilder","getRect","BasicSprite","bitmapWidth","bitmapHeight","precision","SOURCE_KEY","line","processLine","filter","reduce","sum","next","processRawLine","source","substr","indexOf","trim","replace","origin","info","processTextureLine","seperator","nameindex","key","temp","leftindex","topindex","widthIndex","getMap","getTextureSource","BitmapConfigParser","identity","m00","m01","m10","m11","transpose","invert","a2","a3","det","adjoint","determinant","b2","b3","s","c","v0","fromRotation","fromScaling","frob","LDU","L","D","U","multiplyScalar","multiplyScalarAndAdd","d","aa","ab","ac","ad","atx","aty","a4","a5","b4","b5","fromTranslation","fromMat4","m02","m12","m20","m21","m22","a01","a02","a12","a00","a10","a11","a20","a21","a22","b01","b11","b21","b00","b02","b10","b12","b20","b22","fromMat2d","q","w","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","a6","a7","a8","b6","b7","b8","m03","m13","m23","m30","m31","m32","m33","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bz","bw","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","decompose","out_r","out_t","out_s","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","rl","tb","nf","perspectiveNO","fovy","f","tan","perspectiveZO","perspectiveFromFieldOfView","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","orthoNO","lr","bt","ortho","orthoZO","eye","up","x0","y0","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","target","a9","a14","a15","b9","b13","b14","b15","slerp","acos","sinTotal","ratioA","ratioB","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformQuat","qx","qy","qz","qw","vx","vy","vz","mag","cosine","u","A","B","C","E","F","G","H","I","J","v3","v4","s1","s2","rand","setAxisAngle","getAxisAngle","out_axis","getAngle","dotproduct","calculateW","exp","et","ln","log","pow","omega","cosom","sinom","scale0","scale1","u1","u2","u3","sqrt1MinusU1","sqrtU1","invDot","conjugate","fromMat3","fRoot","fTrace","k","fromEuler","order","arguments","halfToRad","cx","cy","cz","Error","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","rotationTo","sqlerp","setAxes","view","dq","w1","w2","fromRotationTranslationValues","outer","getReal","getDual","setReal","setDual","ax1","ay1","az1","aw1","bx1","by1","bz1","ax2","ay2","az2","aw2","rotateByQuatAppend","rotateByQuatPrepend","rotateAroundAxis","axisLength","ax0","ay0","az0","aw0","bw1","bx0","by0","bz0","bw0","mt","sqlen","a_dot_b","bmFontResolver","_","registerFont","bitmapResolver","bitmapLoader","uv","addUVCache","objResolverMultiple","sources","name","addVertexUvCache","objResolver","ResourceResolver","ctx","arrayBuffer","program","compileShaders","bindProgram","positionRef","colorRef","modelViewMatrixRef","viewMtrx","projMtrx","_bindProgram","unbindProgram","_unbindProgram","enableAttribPointers","enableVertexAttribArray","bindAttributePointers","vertexAttribPointer","FLOAT","unbindAttributePointers","disableVertexAttribArray","glSetProjectMatrix","matrixArray","uniformMatrix4fv","glSetModelViewMatrix","glSetViewMatrix","DRAW_VERTEX_SIZE","ShaderProgramColour","delete","updateBuffer","buffer","opt","getOpt","COLOUR","buffReg","bufferReg","rendererBufferId","verticesSize","bufferSub","bindBuffer","bufferBind","isEnabled","CULL_FACE","disable","DEPTH_TEST","index","drawArrays","TRIANGLE_STRIP","size","unbind","registerEntity","objBuffer","bufferRegId","updatePerspective","projectionMatrix","EntityColourProgram","SpriteMoveableModel","SpriteMoveable","THREE_DIMENSION","PLAIN","TRIANGLE","isAttribute","getAttribLocation","getUniformLocation","g","CREATE_TEXTURE","Subscription","REGISTER_ENTITY","createTexturePayload","resourcesLoading","registerEntityPayload","RendererSubscription","NOTIFICATION_PRE_RENDER_KEY","NOTIFICATION_RENDER_KEY","NOTIFICATION_INIT_KEY","UPDATE_PROJECTION_MATRIX","Notification","RendererNotification","RESIZE_SCREEN","modelData","NotificationPayload","from","UPDATE_BUFFER","SET_LIGHTING","setLighting","light","RENDER_ENTITY","renderEntity","args","webGLContainer","notificationQueue","subscriberPool","textureReg","_renderEntities","cachedModelData","resizeViewPort","glContext","shader3DProgram","shaderColourProgram","Object","values","texReg","deleteTexture","texUnit","textureCount","destroyWebGL","activeCamera","setLight","_getProgramOpt","_getProgram3D","_isPlain","_defRender","_defRenderTop","_render","payload","_resetDefferred","handleNotification","notification","action","world","getCtx","setupDefault","enableLighting","listen","colourModel","model3d","render3DShadowMap","model2d","readMessages","toggleLighting","isUniqueAction","message","unique","take","_lazyLoadProgram","clear","setTime","renderFont","src","rendererTextureRef","load","Renderer","isLowPriority","gameStarted","gameEnded","raceTime","currentLap","totalLaps","raceFinished","bots","trackBarriers","waypointTiles","crowd","trees","waypoints","playerSpeed","maxSpeed","acceleration","deceleration","turnSpeed","playerRotation","playerPosition","keys","lastWaypoint","createGameObjects","ground","Plane3d","Rect3d","PlaneType","XZ","addEntity","sky","addFeature","createPlayerCar","createBotCars","createSimpleCrowd","createTrees","crowdPositions","centerX","wp","centerZ","waypoint","normalizedDx","normalizedDz","crowdX","crowdZ","crowdMember","Object3d","toFixed","treePositions","minX","maxX","minZ","maxZ","perimeterPadding","current","perpX","perpZ","treeDistance","cluster","treesPerCluster","filteredTreePositions","treePos","every","tree","playerCar","botNames","nameText","Coordinate","startX","startZ","carObject","moveableCar","Moveable","bot","car","currentWaypoint","rotation","createCrowd","createWaypointTiles","tile","tilesPerSegment","progress","pathTile","createCourseWalls","depth","wall","wallCube","barrierPos","barrierCube","wallHeight","startRace","updatePlayerMovement","forwardX","forwardZ","checkWaypoints","updateBots","baseWaypoint","lateralOffset","randomVariance","nextWaypointIndex","nextWaypoint","trackDx","trackDz","trackLength","targetWaypoint","lateralVariance","finishRace","ent","keyEvent","Events","KEY_DOWN","code","toLowerCase","KEY_UP","Light","in","attenuation","ambientCoeff","at","setTimeout","loadResources","getResource","then","catch","err","ObjectManager","createRacingGame","innerWidth","innerHeight","RacingGame","elementId","canvasId","subscribe","eventThrottle","fps","isStepRender","app","App","gameInstance","run","unpause","onresize","reload","score","timeLeft","crystals","obstacles","gameTimer","startGame","endGame","crystal","collected","sphere","player","restartGame","checkCollisions","obstacle","cube","updatePlayer","newPosition","updateCrystals","glowIntensity","glowDirection","floatOffset","updateObstacles","rotationSpeed","planes","updateUI","timeStamp","JSON","stringify","DRAG","dxRaw","dyRaw","crystalData","obstacleData","CrystalCollectorGame","createCrystalCollectorApp","deferred","isLoaded","lowPriorityQueue","entityIdx","loadTexture","onLoad","def","textures","spriteIdx","calcSpriteIdx","spriteLength","idxFactor","toArray2D","vertexes","vertexConstruct","_vertex","normal","toTextureArray","toColourArray","triangleXYColour","planeXYColour","planeCCW","loc","planeCW","planeUV","planeXY","XY","PLANE","YX","ZX","YZ","ZY","circleXYColour","segments","increment","VertexBuilder","dampenReduction","completeSimulation","resetPhysics","isMoving","collisionIteration","physicSimulation","simulationId","collisionSize","modelPos","$physicsId","resolveCollision","_dx","_dy","collision","shouldTranslate","addDampener","collisionStopItThres","cancelSimulation","movementRotation","isBounded","updateLocBoundToBoundary","completePhysicsIteration","jumpSimulationId","gravitySimulationId","isMoveable","hasCollision","updateDeltaDistance","boundRect","coordinate","calcTotalDeltaDistance","translateTo","complete","directionalModifier","moveTo","colliding","moveToTime","totalTime","completeSim","runSimulation","moveSimulation","isRotateMove","dampeningProp","xSign","sign","ySign","addImpulse","contactTime","setVelocity","runPhysicsSimulation","TIME_STEP_MILLIS","isCollidingResolve","simulation","simulations","totalRunTime","propTime","translateCollision","isCollidingOffset2d","setMoveable","copyTexture","TextureUnit","Colour","RenderUnit","TextureRenderUnit","ColourRenderUnit","listeners","subscriptionId","callback","unlisten","publish","listener","flush","SubscriptionListeners","subscribers","subscription","getSubscriptionListeners","SubscriberPool","vertexUvCacheId","newVertexModelUv3d","normalDirection","BACKWARDS","FORWARD","nx","ny","nz","originZ","maxHeight","maxWidth","Position","fontChar","font","fontPos","repeat","isRepeat","expire","displayTime","isExpired","refresh","RenderFont","shallowCopy","modelPosition","metaData","fonts","renderFontState","renderFontPool","avgWidth","avgHeight","getFont","charCode","createRender","pop","refreshExpired","context","defaultRect","totalWidth","totalHeight","totalNo","fontIdx","uvs","createPlaneVertexModel","filename","FontChar","writeFont","cacheId","displayRect","$cacheId","isDirtyPos","isDirtyText","setWidth","_hidden","prevText","warningShown","fontCacheId","expireRenderFont","fontRef","fontCache","writeRef","fontManager","Font","MAX_FONT","calcTotalTextWidth","calculateFontSize","prevPos","createFonts","fontRefCache","FontManager","DefaultFont","pixelDensity","carryWidth","charIdx","charCodeAt","fontHeight","xOffset","yOffset","createRenderUnits","fillRenderUnits","renderUnit","createModel","TextureVertexModel","$hidden","generateId","features","_shaderEntity","feature","EngineObject","options","vecZero","parellelVec","vec1","perpVec","perp","posVec","atVec","atCross","posCross","vertexShaderContent","fragmentShaderContent","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","fragmentChar","vertexChar","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createProgram","attachShader","linkProgram","validateProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","useProgram","eventDown","touchDown","eventDownX","eventDownY","eventDownDx","eventDownDy","keyDownMap","prevEvent","prevTimeStamp","motionTimeStamp","orientationQuaternion","NULL_EVENT","prevEventType","rawEvent","isDown","isUp","boundedWindow","throttle","setThrottle","bindCanvas","bindWindow","handleOrientationChange","orientation","handleMotion","incrementQuaternion","tempEventDownX","tempEventDownY","handleEvent","ORIENTATION","accData","rotationRate","beta","gamma","alpha","eventQuaternion","getQuaternion","buildEvent","evt","DOWN","KeyboardEvent","resize","RESIZE","buildEventKey","keyCode","keyDown","preventDefault","keyUp","handleMouseUp","offsetX","offsetY","handleEventDown","handleEventMove","xUp","yUp","handleTouchEnd","handleTouchStart","HTMLElement","getBoundingClientRect","touches","clientX","clientY","cancelable","handleTouchMove","targetEvent","cb","addEventListener","isBodyFocus","_event","degtorad","radtodeg","_x","_y","_z","cX","cY","cZ","sX","sY","sZ","screenAccData","SYSTEM_EVENTS","setRenderType","lines","lineIdx","FontMeta","parseWidth","parseHeight","parseFilename","parseLineHeight","parseChar","match","FntFontReader","FONT_CHAR","FontCharacter","char","String","fromCharCode","HEIGHT","lineHeight","LINE_HEIGHT","WIDTH","FILENAME","RegExp","column","registerModel","vertexBufferId","addBufferCache","VertexModel","dirtyModel","dirtyQuat","dirtyPos","dirtyScale","dirtyOrigin","intermediateModels","initialMat4Temp","rotateQuatTemp","rotateMat4Temp","_buildModel","cachedModel","getPosition","centerCoord","_buildQuat","createMat4NoAlloc","createQuatNoAlloc","getIntermediateModel","org","_buildModelIntermediate","_dirty","negOrigin","degrees","glMatrix","toRadian","setRect2","show","reset","beforeShow","updatePosition","setShow","setEnabledPhysics","restore","entityData","configBuilder","parseMap","addEntities","EngineMap","toString","hasTexture","engineObject","ShaderEntity","entityOption","assign","ShaderEntityBuilder","isError","Texture","maxTextureUnits","getParameter","MAX_TEXTURE_IMAGE_UNITS","DEFAULT_MAX_TEXTURE_UNITS","loadImage","onError","handleTextureLoaded","image","newTextureUnit","maxUnits","bindTexture","sampler","uniform1i","activeTexture","TEXTURE0","createTextureFromImage","TEXTURE_2D","texParameterf","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","Promise","resolve","reject","document","createElement","crossOrigin","onload","onerror","_render3DShadowEntities","glSetShadowModelMatrix","TRIANGLES","_setupShadow","bindShadowTexture","setOriginalViewport","isShadowEnabled","prepareShadowTexture","revertShadowTexture","enable","cullFace","BACK","is2d","Entity3DProgram","isVisible","updateInterval","fpsCounter","lastFrameTime","performance","frameTimeHistory","renderCallCount","renderer","createDebugUI","startUpdating","enableDebugOnRightClick","hide","destroy","debugElement","parentElement","removeChild","style","cssText","createStaticStructure","parent","body","appendChild","innerHTML","toggleButton","textContent","onclick","toggle","setupCameraControlEventListeners","updateDisplay","calculateFPS","frameTime","shift","avgFrameTime","updateDebugInfo","debugInfo","gatherDebugInfo","renderDebugInfo","setReferences","setEngineHelper","buildEntityInfo","constructor","hasShaderEntity","textureRef","bufferId","getContext","webglInfo","faceCullingEnabled","depthTestEnabled","blendEnabled","BLEND","clearColor","getClearColorString","cameraInfo","flatMap","entityCount","renderCalls","lastError","color","COLOR_CLEAR_VALUE","perfContent","querySelector","updateCameraControls","webglContent","entityCountEl","updateEntitiesList","updateErrorDisplay","posX","posY","posZ","rotX","rotY","rotZ","activeElement","borderColor","container","scrollTop","entitiesHtml","join","errorDiv","errorContent","display","incrementRenderCalls","resetRenderCalls","logError","setCameraPosition","setCameraRotation","setCameraOrigin","resetBtn","lookAtBtn","resetOriginBtn","resetCamera","lookAtOrigin","resetCameraOrigin","debugMenu","contains","once","numValue","isNaN","queueMap","clearQueue","pushPayload","nodes","LinkedList","pushNotification","getBottom","shiftQueue","NotificationQueue","priority","updateFont","bufferCache","fontNameKeyReverse","uvCache","vertexUVCache","AppSubscription","GET_FPS","startIteration","START_ITERATION","shaderProgram","slice","renderWithCulling","renderCopy","isEntityWithinDistance","cameraPosition","maxDistance","entityPos","entityPosition","entitySize","cameraPos","entityPos3d","yawRad","pitchRad","cameraForward","toEntity","getFPS","getTotalPixelHeight","screen","getTotalPixelWidth","getScreenHeight","getScreenWidth","getTime","getVerticesById","updateBufferCache","verticesCacheId","promise","xhr","XMLHttpRequest","open","onreadystatechange","readyState","DONE","status","responseText","registerBuffer","meta","send","getAllResourcesLoading","all","getBuffer","getBufferModelData","getVertexBufferId","initFont","fontType","newVertexModel2d","cache","getUVCache","getVertexUvCache","vertexUv","isClickedObject","ModelObject3d","layer","Rect2d","newCenter","clearColour","setClearColor","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","frontFace","CCW","clearDepth","depthFunc","LEQUAL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","viewport","getWebGL2RenderingContext","ctx2","isWebGL2RenderingContext","createTransformFeedback","bindVertexArray","numAttribs","MAX_VERTEX_ATTRIBS","tmp","createBuffer","ARRAY_BUFFER","ii","vertexAttrib1f","vertexAttribDivisor","deleteBuffer","numTextureUnits","TEXTURE_CUBE_MAP","TEXTURE_2D_ARRAY","TEXTURE_3D","bindSampler","ELEMENT_ARRAY_BUFFER","bindFramebuffer","FRAMEBUFFER","bindRenderbuffer","RENDERBUFFER","DITHER","SCISSOR_TEST","blendColor","blendEquation","FUNC_ADD","ONE","ZERO","clearStencil","colorMask","LESS","depthMask","depthRange","hint","GENERATE_MIPMAP_HINT","DONT_CARE","lineWidth","pixelStorei","PACK_ALIGNMENT","UNPACK_ALIGNMENT","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_COLORSPACE_CONVERSION_WEBGL","BROWSER_DEFAULT_WEBGL","polygonOffset","sampleCoverage","scissor","stencilFunc","ALWAYS","stencilMask","stencilOp","KEEP","STENCIL_BUFFER_BIT","drawBuffers","readBuffer","COPY_READ_BUFFER","COPY_WRITE_BUFFER","PIXEL_PACK_BUFFER","PIXEL_UNPACK_BUFFER","numTransformFeedbacks","MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS","bindBufferBase","TRANSFORM_FEEDBACK_BUFFER","numUBOs","MAX_UNIFORM_BUFFER_BINDINGS","UNIFORM_BUFFER","RASTERIZER_DISCARD","UNPACK_IMAGE_HEIGHT","UNPACK_SKIP_IMAGES","UNPACK_ROW_LENGTH","UNPACK_SKIP_ROWS","UNPACK_SKIP_PIXELS","PACK_ROW_LENGTH","PACK_SKIP_ROWS","PACK_SKIP_PIXELS","FRAGMENT_SHADER_DERIVATIVE_HINT","programInfo","ACTIVE_ATTRIBUTES","attribInfo","getActiveAttrib","WebGLContext","resources","pause","resume","ModelData","_$ID","default","isFullScreen","restoreContentFn","measureElement","getAspectRatio","devicePixelRatio","documentElement","clientWidth","clientHeight","WebGLContainer","ready","isPaused","framesElapsed","setup","updater","debugger","onEvent","resizeScreen","animationFrame","notifyFrames","errorCallback","requestAnimationFrame","startRunLoop","initSystem","runApp","onRunError","startTime","resizeCanvas","getElementById","buildCanvas","appElement","toggleShow","togglePause","setFPS","toggleStepRender","EPSILON","ARRAY_TYPE","RANDOM","ANGLE_ORDER","setMatrixArrayType","degree","radian","toDegree","tolerance","EngineObjectHelper","boundedX","boundedY","element","isPointInGround","insideElement","createEntities","index2","Physics","physicsEntityIdCount","physicsEntities","deregisterPhysics","px","py","isCollidingPos2d","isCollidingPoint2d","physicsEntity","node","collidingX","collidingY","dxBoundary","dyBoundary","apply","pEntityRoot","generateSimulationId","simulationIdCurrent","pauseSimulation","resumeSimulation","force","cancelled","totalIterations","physicsLoop","simulationCount","runTime","simulationLoop","existingSimulationId","parabolicSimulation","parabolic","timeStep","ParabolicSimulation","PhysicsData","centre","equalCenter","equal","textureReference","lX","lY","mX","mY","Vector2d","vector","getVertexModel","setTextureSource","newInstance","shadowDepthTextureSize","isLightingEnabled","shadowMap","light1View","light1Projection","textureCoords","modelMtrx","tex2DSampler","light1Pos","light1Intensities","light1Attenu","light1AmbCoeff","isLightingEnabledUniform","initShadowProgram","shadowProgram","bindShadowProgram","shadowPos","shadowProjection","shadowView","shadowModel","shadowFramebuffer","createFramebuffer","createDepthTexture","shadowRenderBuffer","createRenderbuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","COLOR_ATTACHMENT0","shadowDepthTexture","framebufferRenderbuffer","DEPTH_ATTACHMENT","shadowTextureUnit","LINEAR","unbindShadowProgram","enableShadowAttribPointers","bindShadowAttributePointers","unbindShadowAttributePointers","uniform3fv","uniform1f","cameraFrustum","Shader3DProgram","bufferArray","verticeSize","deleted","isBuffered","bufferid","doubled","capped","ArrayBuffer","MAX_BUFFER_SIZE","maxSize","fill","bufferData","STATIC_DRAW","vertexSize","bufferSubData","BYTES_PER_ELEMENT","concat","lowPolyGirl","racingCar","clickedElement","cube2","sun","lowPolyTree","treeCreator","road","ExampleWorld","createExampleApp","ColourVertexModel","isPointInCube","evnt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","definition","defineProperty","enumerable","get","prototype","Symbol","toStringTag","games","description","createFunction","launchGame","gameKey","game","gameMenu","backButton","showGameMenu","gameMode","URLSearchParams","search"],"ignoreList":[],"sourceRoot":""}