{"version":3,"file":"index.js","mappings":"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","sources":["webpack://ExampleApp/webpack/universalModuleDefinition","webpack://ExampleApp/./src/Core/WebGL/Shaders/LightFragmentShader.glsl","webpack://ExampleApp/./src/Core/Common/Timer.ts","webpack://ExampleApp/./src/AssetLoader/VertexParser.ts","webpack://ExampleApp/./src/Manager/EntityManager.ts","webpack://ExampleApp/./node_modules/gl-matrix/esm/vec2.js","webpack://ExampleApp/./src/Core/EngineEntity/ModelObject2d.ts","webpack://ExampleApp/./src/Core/Physics/CollisionDetection.ts","webpack://ExampleApp/./src/Core/Camera.ts","webpack://ExampleApp/./src/Core/Builder/ConfigMapBuilder.ts","webpack://ExampleApp/./src/Entity/BasicSprite.ts","webpack://ExampleApp/./src/AssetLoader/BitmapConfigParser.ts","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat2.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat2d.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat3.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/mat4.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/vec3.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/vec4.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/quat.js","webpack://ExampleApp/./node_modules/gl-matrix/esm/quat2.js","webpack://ExampleApp/./src/AssetLoader/ResourceResolver.ts","webpack://ExampleApp/./src/Core/WebGL/ShaderProgram/ShaderColourProgram.ts","webpack://ExampleApp/./src/Core/WebGL/EntityProgram/EntityColorProgram.ts","webpack://ExampleApp/./src/Entity/SpriteMoveable.ts","webpack://ExampleApp/./src/Core/Data/RenderOption.ts","webpack://ExampleApp/./src/Core/WebGL/Base/ProgramReference.ts","webpack://ExampleApp/./src/Core/Data/Colour.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/ShadowLightFragmentShader.glsl","webpack://ExampleApp/./src/Core/Renderer.ts","webpack://ExampleApp/./ExampleApp/RacingGame.ts","webpack://ExampleApp/./ExampleApp/CrystalCollectorGame.ts","webpack://ExampleApp/./src/Manager/ObjectManager.ts","webpack://ExampleApp/./src/Entity/SpriteModel.ts","webpack://ExampleApp/./src/Core/Builder/VertexBuilder.ts","webpack://ExampleApp/./src/Entity/Moveable.ts","webpack://ExampleApp/./src/Core/Data/RenderUnit.ts","webpack://ExampleApp/./src/Core/Common/SubscriberPool.ts","webpack://ExampleApp/./src/Entity/Object3d.ts","webpack://ExampleApp/./src/Core/Data/PlaneType.ts","webpack://ExampleApp/./src/Core/EngineEntity/Position.ts","webpack://ExampleApp/./src/Core/Font/Font.ts","webpack://ExampleApp/./src/Core/Data/TextureVertexModel.ts","webpack://ExampleApp/./src/Core/EngineEntity/EngineObject.ts","webpack://ExampleApp/./src/Core/Data/Light.ts","webpack://ExampleApp/./src/Core/WebGL/Base/BaseProgram.ts","webpack://ExampleApp/./src/Core/Events.ts","webpack://ExampleApp/./src/Core/EngineEntity/ModelObject3d.ts","webpack://ExampleApp/./src/AssetLoader/FntFontReader.ts","webpack://ExampleApp/./src/Core/Data/VertexModel.ts","webpack://ExampleApp/./src/Core/Data/Resource.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/RGBVertexShader.glsl","webpack://ExampleApp/./src/Core/EngineEntity/ModelPosition.ts","webpack://ExampleApp/./src/Core/EngineEntity/EngineMap.ts","webpack://ExampleApp/./src/Core/Common/IdGenerator.ts","webpack://ExampleApp/./src/Core/Builder/ShaderEntityBuilder.ts","webpack://ExampleApp/./src/Core/Buffer/Texture.ts","webpack://ExampleApp/./src/Core/WebGL/EntityProgram/Entity3DProgram.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/PassthroughVertexShader.glsl","webpack://ExampleApp/./src/Core/EngineDebugger.ts","webpack://ExampleApp/./src/Core/Common/NotificationQueue.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/ShadowLightVertexShader.glsl","webpack://ExampleApp/./src/Entity/PlaneColour.ts","webpack://ExampleApp/./src/Manager/EntityManager2d.ts","webpack://ExampleApp/./src/Entity/TriangleColour2d.ts","webpack://ExampleApp/./src/Core/Data/FontMetaData.ts","webpack://ExampleApp/./src/Core/EngineEntity/ModelObjectRect3d.ts","webpack://ExampleApp/./src/Core/Updater.ts","webpack://ExampleApp/./src/Core/EngineHelper.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/LightVertexShader.glsl","webpack://ExampleApp/./src/Core/WebGL/Shaders/RGBFragmentShader.glsl","webpack://ExampleApp/./src/Entity/Plane3d.ts","webpack://ExampleApp/./ExampleApp/Sphere.ts","webpack://ExampleApp/./src/Core/Data/Rect2d.ts","webpack://ExampleApp/./src/Core/WebGL/Base/WebGLContext.ts","webpack://ExampleApp/./src/Core/WorldDelegate.ts","webpack://ExampleApp/./src/Core/Data/ModelData.ts","webpack://ExampleApp/./src/index.ts","webpack://ExampleApp/./src/Core/App.ts","webpack://ExampleApp/./node_modules/gl-matrix/esm/common.js","webpack://ExampleApp/./src/Core/Data/Coordinate.ts","webpack://ExampleApp/./src/Core/EngineEntity/EngineObjectHelper.ts","webpack://ExampleApp/./src/Core/Physics/EngineMath.ts","webpack://ExampleApp/./ExampleApp/Ground3d.ts","webpack://ExampleApp/./src/Core/Physics/Physics.ts","webpack://ExampleApp/./src/Core/Data/Rect3d.ts","webpack://ExampleApp/./src/Entity/Plane2d.ts","webpack://ExampleApp/./src/Entity/LineColour.ts","webpack://ExampleApp/./src/Core/Data/Vector2d.ts","webpack://ExampleApp/./src/Core/EngineEntity/ShaderEntity.ts","webpack://ExampleApp/./src/Core/WebGL/ShaderProgram/Shader3DProgram.ts","webpack://ExampleApp/./src/Core/WebGL/Shaders/ShadowDepthFragmentShader.glsl","webpack://ExampleApp/./src/Core/Buffer/ArrayBuffer.ts","webpack://ExampleApp/./ExampleApp/ExampleApp.ts","webpack://ExampleApp/./src/Core/Data/ColourVertexModel.ts","webpack://ExampleApp/./ExampleApp/Cube.ts","webpack://ExampleApp/webpack/bootstrap","webpack://ExampleApp/webpack/runtime/define property getters","webpack://ExampleApp/webpack/runtime/hasOwnProperty shorthand","webpack://ExampleApp/webpack/runtime/make namespace object","webpack://ExampleApp/./ExampleApp/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ExampleApp\"] = factory();\n\telse\n\t\troot[\"ExampleApp\"] = factory();\n})(self, () => {\nreturn ","export default \"precision mediump float;\\r\\nprecision mediump int;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\n\\r\\nuniform sampler2D texture;\\r\\nuniform sampler2D shadowMap;\\r\\nuniform float numLights;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n    gl_FragColor = surfaceColor;\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec3 n = normalize(v_normal);\\r\\n  vec3 l = normalize(v_light1_pos);\\r\\n  float cosTheta = clamp(dot(n, l), 0.0, 1.0);\\r\\n\\r\\n  vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n  vec3 diffuse = v_diffuseCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n  vec3 ambient = light1.ambientCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n\\r\\n  vec3 linearColor = ambient + v_attenuation * diffuse * cosTheta;\\r\\n\\r\\n  vec3 gamma = vec3(1.0 / 2.2);\\r\\n  gl_FragColor = vec4(pow(linearColor, gamma), surfaceColor.a);\\r\\n}\";","export default class Timer {\r\n  _start: number = Date.now();\r\n  _end: number;\r\n  start(): Timer {\r\n    this._start = Date.now();\r\n    return this;\r\n  }\r\n  peak(): number {\r\n    return Date.now() - this._start;\r\n  }\r\n  stop(): number {\r\n    this._end = Date.now();\r\n    const elapsed = this._end - this._start;\r\n    this._start = this._end;\r\n    return elapsed;\r\n  }\r\n}\r\n","class VertexParser {\r\n  vertices: number[];\r\n\r\n  constructor(raw: string | number[]) {\r\n    if (typeof raw === \"string\") {\r\n      this.vertices = raw.split(\",\").map(parseFloat);\r\n    } else if (raw instanceof Array) {\r\n      this.vertices = raw;\r\n    } else {\r\n      console.error(\"Unexpected obj type\");\r\n    }\r\n  }\r\n}\r\n\r\nexport default VertexParser;\r\n","import EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect3d from \"../Core/Data/Rect3d\";\r\nimport Position from \"../Core/EngineEntity/Position\";\r\n\r\nclass EntityManager extends EngineObject {\r\n  entities: EngineObject[] = [];\r\n\r\n  setPosition(position: Position) {\r\n    this.entities.forEach((e) => e.setPosition(position));\r\n  }\r\n\r\n  center(x: number, y: number, z: number) {\r\n    super.center(x, y, z);\r\n    this.entities.forEach((e) => e.center(x, y, z));\r\n  }\r\n\r\n  rotateOrigin(x: number, y: number, z: number) {\r\n    super.rotateOrigin(x, y, z);\r\n    this.entities.forEach((e) => e.rotateOrigin(x, y, z));\r\n  }\r\n\r\n  rotateOriginRect(rect: Rect3d) {\r\n    this.rotateOrigin(rect.x, rect.y, rect.z);\r\n  }\r\n\r\n  rotateX(x: number) {\r\n    this.angleX(x);\r\n  }\r\n\r\n  rotateY(y: number) {\r\n    this.angleY(y);\r\n  }\r\n\r\n  rotateZ(z: number) {\r\n    this.angleZ(z);\r\n  }\r\n\r\n  angleX(x: number) {\r\n    super.angleX(x);\r\n    this.entities.forEach((e) => e.angleX(x));\r\n  }\r\n\r\n  angleY(y: number) {\r\n    super.angleY(y);\r\n    this.entities.forEach((e) => e.angleY(y));\r\n  }\r\n\r\n  angleZ(z: number) {\r\n    super.angleZ(z);\r\n    this.entities.forEach((e) => e.angleZ(z));\r\n  }\r\n\r\n  scaleX(x: number) {\r\n    super.scaleX(x);\r\n    this.entities.forEach((e) => e.scaleX(x));\r\n  }\r\n\r\n  scaleY(y: number) {\r\n    super.scaleY(y);\r\n    this.entities.forEach((e) => e.scaleY(y));\r\n  }\r\n\r\n  scaleZ(z: number) {\r\n    super.scaleZ(z);\r\n    this.entities.forEach((e) => e.scaleZ(z));\r\n  }\r\n\r\n  scale(x: number, y: number, z: number) {\r\n    super.scale(x, y, z);\r\n    this.entities.forEach((e) => e.scale(x, y, z));\r\n  }\r\n\r\n  translate(dx: number, dy: number, dz: number) {\r\n    super.translate(dx, dy, dz);\r\n    this.entities.forEach((e) => e.translate(dx, dy, dz));\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    super.init(engineHelper);\r\n    this.entities.forEach((a) => a.init(engineHelper));\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    if (this.hidden) {\r\n      return;\r\n    }\r\n    this.entities.forEach((entity) => entity.render(engineHelper));\r\n    super.render(engineHelper);\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    if (this.hidden) {\r\n      return;\r\n    }\r\n    this.entities.forEach((entity) => entity.update(engineHelper));\r\n    super.update(engineHelper);\r\n  }\r\n\r\n  setTop(isTop: boolean) {\r\n    super.setTop(isTop);\r\n    this.entities.forEach((entity) => entity.setTop(isTop));\r\n  }\r\n\r\n  set hidden(value: boolean) {\r\n    super.setHidden(value);\r\n    this.entities.forEach((entity) => (entity.hidden = value));\r\n  }\r\n}\r\n\r\nexport default EntityManager;\r\n","import * as glMatrix from \"./common.js\";\n\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  return out;\n}\n\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n    y = b[1] - a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n    y = b[1] - a[1];\n  return x * x + y * y;\n}\n\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0],\n    y = a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0],\n    y = a[1];\n  return x * x + y * y;\n}\n\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\nexport function normalize(out, a) {\n  var x = a[0],\n    y = a[1];\n  var len = x * x + y * y;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n    ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec2} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n    p1 = a[1] - b[1],\n    sinC = Math.sin(rad),\n    cosC = Math.cos(rad);\n\n  //perform rotation and translate to correct position\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n\n/**\n * Get the smallest angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    bx = b[0],\n    by = b[1];\n  return Math.abs(Math.atan2(ay * bx - ax * by, ax * bx + ay * by));\n}\n\n/**\n * Get the signed angle in the interval [-pi,pi] between two 2D vectors (positive if `a` is to the right of `b`)\n * \n * @param {ReadonlyVec2} a The first vector\n * @param {ReadonlyVec2} b The second vector\n * @returns {number} The signed angle in radians\n */\nexport function signedAngle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    bx = b[0],\n    by = b[1];\n  return Math.atan2(ax * by - ay * bx, ax * bx + ay * by);\n}\n\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1];\n  var b0 = b[0],\n    b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n\n/**\n * Alias for {@link vec2.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 2;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n    return a;\n  };\n}();","import ShaderEntityBuilder from \"../Builder/ShaderEntityBuilder\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport RenderOption, { RenderType, ShaderType } from \"../Data/RenderOption\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport EngineObject from \"./EngineObject\";\r\n\r\nexport default class ModelObject2d extends EngineObject {\r\n  public vertexModel: TextureVertexModel;\r\n\r\n  constructor(rect: Rect2d, vertexModel: TextureVertexModel) {\r\n    super();\r\n    this.vertexModel = vertexModel;\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.RECTANGLE;\r\n    renderOpt.shaderType = ShaderType.TWO_DIMENSION;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .createTexture(this.vertexModel.textureSource)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import Vector2d from \"../Data/Vector2d\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport { vec2, vec4, mat4 } from \"gl-matrix\";\r\nimport Plane3d from \"../../Entity/Plane3d\";\r\nimport { BaseCamera } from \"../Camera\";\r\nimport Position from \"../EngineEntity/Position\";\r\n\r\nexport class Collision {\r\n  willIntersect: boolean;\r\n  isIntersect: boolean;\r\n  minDeintersectDistance: Vector2d;\r\n}\r\n\r\nexport class CollisionDetection {\r\n  static rotate(x: number, y: number, rotate: Position) {\r\n    const center: vec2 = vec2.fromValues(x, y);\r\n    vec2.rotate(\r\n      center,\r\n      center,\r\n      vec2.fromValues(rotate.originX, rotate.originY),\r\n      Math.PI * (2 - rotate.az / 180)\r\n    );\r\n    return { x: center[0], y: center[1] };\r\n  }\r\n  static getLength(x1: number, y1: number, x2: number, y2: number) {\r\n    return Math.sqrt(\r\n      Math.abs((x1 - x2) * (x1 - x2)) + Math.abs((y1 - y2) * (y1 - y2))\r\n    );\r\n  }\r\n  static isCollidingRect(\r\n    x1: number,\r\n    y1: number,\r\n    width1: number,\r\n    height1: number,\r\n    x2: number,\r\n    y2: number,\r\n    width2: number,\r\n    height2: number\r\n  ) {\r\n    return (\r\n      CollisionDetection.getLength(x1, 0, x2, 0) <\r\n        width1 / 2.0 + width2 / 2.0 &&\r\n      CollisionDetection.getLength(y1, 0, y2, 0) < height1 / 2.0 + height2 / 2.0\r\n    );\r\n  }\r\n\r\n  static isRectInRect(rect1: Rect2d, rect2: Rect2d): boolean {\r\n    return !(\r\n      rect1.x + rect1.width / 2.0 < rect2.x - rect2.width / 2.0 ||\r\n      rect1.y + rect1.height / 2.0 < rect2.y - rect2.height / 2.0 ||\r\n      rect1.x - rect1.width / 2.0 > rect2.x + rect2.width / 2.0 ||\r\n      rect1.y - rect1.height / 2.0 > rect2.y + rect2.height / 2.0\r\n    );\r\n  }\r\n\r\n  static isPointInRect(rect: Rect2d, coord: Coordinate): boolean {\r\n    return this.isCollidingRect(\r\n      rect.x,\r\n      rect.y,\r\n      rect.width,\r\n      rect.height,\r\n      coord.x,\r\n      coord.y,\r\n      0.01,\r\n      0.01\r\n    );\r\n  }\r\n  static isPointInPlane3d(\r\n    camera: BaseCamera,\r\n    obj: Plane3d,\r\n    x: number,\r\n    y: number\r\n  ): boolean {\r\n    const mvp = mat4.multiply(\r\n      mat4.create(),\r\n      camera.frustum,\r\n      mat4.multiply(mat4.create(), camera.viewMatrix, obj.getModel())\r\n    );\r\n\r\n    const r1: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[0].vertex,\r\n      mvp\r\n    );\r\n    if (r1[2] > 1.0) return false;\r\n\r\n    const r2: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[1].vertex,\r\n      mvp\r\n    );\r\n    if (r2[2] > 1.0) return false;\r\n\r\n    const r3: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[2].vertex,\r\n      mvp\r\n    );\r\n    if (r3[2] > 1.0) return false;\r\n\r\n    const r4: vec4 = this.toClipSpace(\r\n      obj.vertexModel.renderUnits[3].vertex,\r\n      mvp\r\n    );\r\n    if (r4[2] > 1.0) return false;\r\n\r\n    const rectPolygon = [\r\n      [r1[0], r1[1]],\r\n      [r2[0], r2[1]],\r\n      [r4[0], r4[1]],\r\n      [r3[0], r3[1]],\r\n    ];\r\n    return this.pointInPolygon([x, y], rectPolygon);\r\n  }\r\n  static pointInPolygon = (point: number[], polygon: number[][]) => {\r\n    const x = point[0];\r\n    const y = point[1];\r\n\r\n    let inside = false;\r\n    for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\r\n      const xi = polygon[i][0];\r\n      const yi = polygon[i][1];\r\n      const xj = polygon[j][0];\r\n      const yj = polygon[j][1];\r\n\r\n      const intersect =\r\n        yi > y != yj > y && x < ((xj - xi) * (y - yi)) / (yj - yi) + xi;\r\n      if (intersect) {\r\n        inside = !inside;\r\n      }\r\n    }\r\n\r\n    return inside;\r\n  };\r\n  static toClipSpace(pos: Coordinate, mvp: mat4) {\r\n    const vec4Trans = vec4.transformMat4(\r\n      vec4.create(),\r\n      vec4.set(vec4.create(), pos.x, pos.y, pos.z, 1.0),\r\n      mvp\r\n    );\r\n\r\n    const vec4Norm = vec4.scale(vec4.create(), vec4Trans, 1.0 / vec4Trans[3]);\r\n    return vec4.set(\r\n      vec4.create(),\r\n      (vec4Norm[0] + 1.0) / 2.0,\r\n      (vec4Norm[1] + 1.0) / 2.0,\r\n      vec4Norm[2],\r\n      1.0\r\n    );\r\n  }\r\n}\r\n\r\nexport class Polygon {\r\n  points: Vector2d[];\r\n  edges: Vector2d[];\r\n  center: Vector2d;\r\n  max = 0;\r\n  min = 0;\r\n  subtractCenter(p: Polygon): Vector2d {\r\n    return this.center.subtract(p.center);\r\n  }\r\n  offset(v: Vector2d) {\r\n    this.points.forEach((point) => point.add(v));\r\n  }\r\n  area(v1: Vector2d, v2: Vector2d): number {\r\n    return v1.x * v2.y - v2.x * v1.y;\r\n  }\r\n  calculateCentre(): Vector2d {\r\n    const centroid = Vector2d.newVector(0, 0);\r\n    let totalSignedArea = 0.0;\r\n    const vertexCount = this.points.length;\r\n    for (let i = 0; i < vertexCount; ++i) {\r\n      const vertex = this.points[i];\r\n      let nextVertex;\r\n      if (i == vertexCount - 1) {\r\n        nextVertex = this.points[0];\r\n      } else {\r\n        nextVertex = this.points[i + 1];\r\n      }\r\n      const area = this.area(vertex, nextVertex);\r\n      totalSignedArea += area;\r\n      centroid.x += (vertex.x + nextVertex.x) * area;\r\n      centroid.y += (vertex.y + nextVertex.y) * area;\r\n    }\r\n    centroid.x /= 3.0 * totalSignedArea;\r\n    centroid.y /= 3.0 * totalSignedArea;\r\n    return centroid;\r\n  }\r\n  polygonProjection(axis: Vector2d, polygon: Polygon) {\r\n    let dotProduct: number = axis.dot(polygon.points[0]);\r\n    polygon.min = dotProduct;\r\n    polygon.max = dotProduct;\r\n    for (let i = 0; i < polygon.points.length; i++) {\r\n      const point = polygon.points[i];\r\n      dotProduct = point.dot(axis);\r\n      if (dotProduct < polygon.min) {\r\n        polygon.min = dotProduct;\r\n      } else if (dotProduct > polygon.max) {\r\n        polygon.max = dotProduct;\r\n      }\r\n    }\r\n  }\r\n  boundaryDistance(\r\n    minA: number,\r\n    maxA: number,\r\n    minB: number,\r\n    maxB: number\r\n  ): number {\r\n    if (minA < minB) {\r\n      return minB - maxA;\r\n    } else {\r\n      return minA - maxB;\r\n    }\r\n  }\r\n  isCollision(polygonB: Polygon, velocity?: Vector2d): Collision {\r\n    const result = new Collision();\r\n    result.isIntersect = true;\r\n    result.willIntersect = true;\r\n    const edgeCountA: number = this.edges.length;\r\n    const edgeCountB: number = polygonB.edges.length;\r\n    let minIntervalDistance = Infinity;\r\n    let translationAxis = new Vector2d();\r\n    let edge: Vector2d;\r\n    for (let edgeIndex = 0; edgeIndex < edgeCountA + edgeCountB; edgeIndex++) {\r\n      if (edgeIndex < edgeCountA) {\r\n        edge = this.edges[edgeIndex];\r\n      } else {\r\n        edge = polygonB.edges[edgeIndex - edgeCountA];\r\n      }\r\n      const axis = Vector2d.newVector(-edge.y, edge.x).normalise();\r\n      this.polygonProjection(axis, this);\r\n      this.polygonProjection(axis, polygonB);\r\n\r\n      if (\r\n        this.boundaryDistance(this.min, this.max, polygonB.min, polygonB.max) >\r\n        0\r\n      ) {\r\n        result.isIntersect = false;\r\n      }\r\n\r\n      if (velocity) {\r\n        const velocityProjection: number = axis.dot(velocity);\r\n        if (velocityProjection < 0) {\r\n          this.min += velocityProjection;\r\n        } else {\r\n          this.max += velocityProjection;\r\n        }\r\n      }\r\n\r\n      let intervalDistance: number = this.boundaryDistance(\r\n        this.min,\r\n        this.max,\r\n        polygonB.min,\r\n        polygonB.max\r\n      );\r\n      if (intervalDistance > 0) {\r\n        result.willIntersect = false;\r\n      }\r\n\r\n      if (!result.isIntersect && !result.willIntersect) {\r\n        break;\r\n      }\r\n\r\n      intervalDistance = Math.abs(intervalDistance);\r\n      if (intervalDistance < minIntervalDistance) {\r\n        minIntervalDistance = intervalDistance;\r\n        translationAxis = axis;\r\n        const distance: Vector2d = this.subtractCenter(polygonB);\r\n        if (distance.dot(translationAxis) < 0) {\r\n          translationAxis = translationAxis.negate();\r\n        }\r\n      }\r\n    }\r\n    if (result.willIntersect) {\r\n      result.minDeintersectDistance = translationAxis.scale(\r\n        minIntervalDistance\r\n      ) as Vector2d;\r\n    }\r\n    return result;\r\n  }\r\n}\r\n","import { mat4, quat, vec3 } from \"gl-matrix\";\r\nimport ModelPosition from \"./EngineEntity/ModelPosition\";\r\nimport { EngineEvent } from \"./Events\";\r\nimport Coordinate from \"./Data/Coordinate\";\r\nimport Timer from \"./Common/Timer\";\r\nimport Rect3d from \"./Data/Rect3d\";\r\nimport Rect2d from \"./Data/Rect2d\";\r\nimport { CollisionDetection } from \"./Physics/CollisionDetection\";\r\n\r\nexport interface CameraOptions {\r\n  maxFov: number;\r\n  near: number;\r\n  far: number;\r\n  experimental?: {\r\n    enabled?: boolean;\r\n    inverseAngleY?: boolean;\r\n  };\r\n  isFovMax: boolean;\r\n  fov: number;\r\n  left?: number;\r\n  right?: number;\r\n  bottom?: number;\r\n  top?: number;\r\n  projection?: 'frustum' | 'perspective';\r\n  renderMode: '2d' | '3d';\r\n  aspect?: number;\r\n}\r\n\r\nexport class BaseCamera extends ModelPosition {\r\n  public aspect: number;\r\n  public frustum: mat4;\r\n  public viewMatrix: mat4;\r\n\r\n  protected zoomScale: Coordinate = { x: 2, y: 2, z: 2 };\r\n  protected baseTranslate: Coordinate = { x: -1, y: -1, z: 0 };\r\n  public fov: number;\r\n  public near: number;\r\n  public far: number;\r\n  protected cameraOptions: CameraOptions;\r\n\r\n  protected _isUpdateView = true;\r\n\r\n  private interval: NodeJS.Timeout | undefined;\r\n  private steps: number;\r\n  private _moveTime: number;\r\n  private dx: number;\r\n  private dy: number;\r\n  private dz: number;\r\n  private tx: number;\r\n  private ty: number;\r\n  private tz: number;\r\n  private timer: Timer = new Timer();\r\n\r\n\r\n\r\n  public clearPan() {\r\n    if (this.interval) {\r\n      clearInterval(this.interval);\r\n      this.interval = undefined;\r\n    }\r\n  }\r\n\r\n  protected pan(\r\n    time: number,\r\n    speed: number,\r\n    x?: number,\r\n    y?: number,\r\n    z?: number\r\n  ) {\r\n    this.clearPan();\r\n    this.steps = time;\r\n    this._moveTime = time;\r\n    if (x !== undefined) {\r\n      this.dx = x - this.position.x;\r\n      this.tx = x;\r\n    } else {\r\n      this.dx = 0;\r\n      this.tx = this.position.x;\r\n    }\r\n\r\n    if (y !== undefined) {\r\n      this.dy = y - this.position.y;\r\n      this.ty = y;\r\n    } else {\r\n      this.dy = 0;\r\n      this.ty = this.position.y;\r\n    }\r\n\r\n    if (z !== undefined) {\r\n      this.dz = z - this.position.z;\r\n      this.tz = z;\r\n    } else {\r\n      this.dz = 0;\r\n      this.tz = this.position.z;\r\n    }\r\n\r\n    this.timer.start();\r\n    this.interval = setInterval(() => {\r\n      const time = this.timer.peak();\r\n      if (this.steps > 0) {\r\n        this.steps -= time;\r\n\r\n        if (this.steps <= 0) {\r\n          this.position.x = this.tx;\r\n          this.position.y = this.ty;\r\n          this.position.z = this.tz;\r\n          this.clearPan();\r\n        } else {\r\n          this.position.x += (this.dx * time) / this._moveTime;\r\n          this.position.y += (this.dy * time) / this._moveTime;\r\n          this.position.z += (this.dz * time) / this._moveTime;\r\n        }\r\n        this.updateProjectionView();\r\n      } else {\r\n        this.position.x = this.tx;\r\n        this.position.y = this.ty;\r\n        this.position.z = this.tz;\r\n        this.clearPan();\r\n        this.updateProjectionView();\r\n      }\r\n      this.timer.start();\r\n    }, speed);\r\n  }\r\n\r\n  isOutOfBound(bound: Rect3d, pos: Rect3d): boolean {\r\n    return false;\r\n  }\r\n\r\n  updateProjectionView = () => {\r\n    this._isUpdateView = true;\r\n  };\r\n\r\n  isUpdateView() {\r\n    return this._isUpdateView;\r\n  }\r\n\r\n  commitProjectionView = () => {\r\n    this._isUpdateView = false;\r\n\r\n\r\n    let quatRotationxyz = quat.create();\r\n    quatRotationxyz = quat.rotateX(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ax)\r\n    );\r\n    quatRotationxyz = quat.rotateY(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ay)\r\n    );\r\n    quatRotationxyz = quat.rotateZ(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.az)\r\n    );\r\n    quatRotationxyz = quat.normalize(quatRotationxyz, quatRotationxyz);\r\n\r\n    const dest = mat4.create();\r\n\r\n    const quatMat = mat4.create();\r\n    mat4.fromQuat(quatMat, quatRotationxyz);\r\n    mat4.multiply(dest, dest, quatMat);\r\n\r\n    const pos = vec3.fromValues(\r\n      -this.position.x,\r\n      -this.position.y,\r\n      -this.position.z\r\n    );\r\n    mat4.translate(dest, dest, pos);\r\n\r\n    this.viewMatrix = dest;\r\n\r\n  };\r\n\r\n  frustumMatrix = (): mat4 => {\r\n    const left = this.cameraOptions.left ?? -this.aspect;\r\n    const right = this.cameraOptions.right ?? this.aspect;\r\n    const bottom = this.cameraOptions.bottom ?? -1;\r\n    const top = this.cameraOptions.top ?? 1;\r\n\r\n    return mat4.frustum(\r\n      mat4.create(),\r\n      left,\r\n      right,\r\n      bottom,\r\n      top,\r\n      this.near,\r\n      this.far\r\n    );\r\n  };\r\n\r\n  public perspective(): mat4 {\r\n    return mat4.perspective(\r\n      mat4.create(),\r\n      this.degreesToRadians(this.fov),\r\n      this.aspect,\r\n      this.near,\r\n      this.far\r\n    );\r\n  };\r\n\r\n  updateProjectionMatrix = () => {\r\n    if (this.cameraOptions?.projection === 'frustum') {\r\n      this.frustum = this.frustumMatrix();\r\n    } else {\r\n      this.frustum = this.perspective();\r\n    }\r\n  };\r\n\r\n  angleX(dx: number) {\r\n    this.position.ax -= dx;\r\n    if (this.position.ax > 90) {\r\n      const diff = 90;\r\n      this.position.ax = diff;\r\n    } else if (this.position.ax < -90) {\r\n      const diff = -90;\r\n      this.position.ax = diff;\r\n    }\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  angleZ(dz: number) {\r\n    this.position.az += dz;\r\n    if (this.position.az > 360) {\r\n      const diff = this.position.az - 360;\r\n      this.position.az = diff;\r\n    } else if (this.position.az < 0) {\r\n      const diff = this.position.az + 360;\r\n      this.position.az = diff;\r\n    }\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  angleY(dy: number) {\r\n    if (this.cameraOptions?.experimental?.inverseAngleY) {\r\n      if (dy) {\r\n        dy *= -1;\r\n      }\r\n    }\r\n    this.position.ay += dy;\r\n    if (this.position.ay > 360) {\r\n      const diff = this.position.ay - 360;\r\n      this.position.ay = diff;\r\n    } else if (this.position.ay < 0) {\r\n      const diff = this.position.ay + 360;\r\n      this.position.ay = diff;\r\n    }\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  zoomIn(delta: number) {\r\n    this.fov -= delta;\r\n    this.fov = Math.max(delta, this.fov);\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  zoomOut(delta: number) {\r\n    const maxFovAspect = (Math.atan(1.0 / this.aspect) * 360.0) / Math.PI;\r\n    this.fov += delta;\r\n    this.fov = Math.min(\r\n      Math.min(this.cameraOptions.maxFov || maxFovAspect, maxFovAspect),\r\n      this.fov\r\n    );\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  public setupCamera(\r\n    cameraOptions: CameraOptions,\r\n    aspectRatio: number,\r\n    canvas: HTMLCanvasElement\r\n  ) {\r\n    this.cameraOptions = cameraOptions || {};\r\n    const aspect = cameraOptions.aspect || canvas.width / canvas.height;\r\n\r\n    // Always update camera parameters from options\r\n    this.near = cameraOptions.near ?? 0.01;\r\n    this.far = cameraOptions.far ?? 1000.0;\r\n    this.aspect = aspect;\r\n\r\n    // Set frustum projection parameters if provided\r\n    if (cameraOptions.projection === 'frustum') {\r\n      // Ensure frustum values are properly set based on aspect ratio if not provided\r\n      if (!this.cameraOptions.left) {\r\n        this.cameraOptions.left = cameraOptions.left ?? -aspect;\r\n      }\r\n      if (!this.cameraOptions.right) {\r\n        this.cameraOptions.right = cameraOptions.right ?? aspect;\r\n      }\r\n      if (!this.cameraOptions.bottom) {\r\n        this.cameraOptions.bottom = cameraOptions.bottom ?? -1;\r\n      }\r\n      if (!this.cameraOptions.top) {\r\n        this.cameraOptions.top = cameraOptions.top ?? 1;\r\n      }\r\n    }\r\n\r\n    if (this.cameraOptions.experimental?.enabled) {\r\n      const width = canvas.offsetWidth;\r\n      const height = canvas.offsetHeight;\r\n      const zoom = {\r\n        x: width <= height ? 2 : (2 * aspectRatio) / (width / height),\r\n        y: height <= width ? 2 : (2 * aspectRatio) / (width / height),\r\n        z: 1,\r\n      };\r\n      this.setZoom(zoom);\r\n\r\n      this.setBaseTranslate({\r\n        x: -1 + (2 - zoom.x) / 2,\r\n        y: -1 + (2 - zoom.y) / 2,\r\n        z: 0,\r\n      });\r\n    }\r\n\r\n    if (cameraOptions.projection !== 'frustum') {\r\n      let fov = cameraOptions.fov ?? 45.0;\r\n      if (cameraOptions.isFovMax) {\r\n        const maxFovAspect = (Math.atan(1.0 / aspect) * 360.0) / Math.PI;\r\n        fov = maxFovAspect;\r\n      }\r\n      this.fov = fov;\r\n    }\r\n\r\n    this.updateProjectionMatrix();\r\n    this.updateProjectionView();\r\n  }\r\n\r\n  setZoom(zoom: Coordinate) {\r\n    this.zoomScale = zoom;\r\n  }\r\n\r\n  setBaseTranslate(baseTranslate: Coordinate) {\r\n    this.baseTranslate = baseTranslate;\r\n  }\r\n\r\n  /**\r\n   * Orients the camera to look at a target point in world space.\r\n   * @param targetX X coordinate of the target\r\n   * @param targetY Y coordinate of the target\r\n   * @param targetZ Z coordinate of the target\r\n   */\r\n  lookAt(targetX: number, targetY: number, targetZ: number) {\r\n    const dx = targetX - this.position.x;\r\n    const dy = targetY - this.position.y;\r\n    const dz = targetZ - this.position.z;\r\n\r\n    // Calculate yaw (ay) - rotation around Y axis\r\n    this.position.ay = Math.atan2(-dx, -dz) * 180 / Math.PI;\r\n\r\n    // Calculate pitch (ax) - rotation around X axis\r\n    const horizontalDistance = Math.sqrt(dx * dx + dz * dz);\r\n    this.position.ax = Math.atan2(-dy, horizontalDistance) * 180 / Math.PI;\r\n\r\n    // Reset roll (az) to 0\r\n    this.position.az = 0;\r\n\r\n    this.updateProjectionView();\r\n  }\r\n}\r\n\r\nclass Camera2d extends BaseCamera {\r\n  protected INTERVAL_TIME = 10;\r\n  protected bound = new Rect2d(0, 0, 1, 1);\r\n\r\n  public distanceEvent(event: EngineEvent): Coordinate {\r\n    return new Coordinate(event.x + this.position.x, this.position.y + event.y);\r\n  }\r\n\r\n  updateProjectionMatrix = () => {\r\n    const translateSpace = mat4.create();\r\n    mat4.translate(\r\n      translateSpace,\r\n      translateSpace,\r\n      vec3.fromValues(\r\n        this.baseTranslate.x,\r\n        this.baseTranslate.y,\r\n        this.baseTranslate.z\r\n      )\r\n    );\r\n    mat4.scale(\r\n      translateSpace,\r\n      translateSpace,\r\n      vec3.fromValues(this.zoomScale.x, this.zoomScale.y, 1.0)\r\n    );\r\n    this.frustum = translateSpace;\r\n  };\r\n\r\n  zoomIn(delta: number) {\r\n    this.zoomScale.x += delta;\r\n    this.zoomScale.y += delta;\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  zoomOut(delta: number) {\r\n    this.zoomScale.x = Math.max(0.1, this.zoomScale.x - delta);\r\n    this.zoomScale.y = Math.max(0.1, this.zoomScale.y - delta);\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  public isOutOfBound(pos: Rect2d): boolean {\r\n    this.bound.x = this.position.x + this.bound.width / 2.0;\r\n    this.bound.y = this.position.y + this.bound.height / 2.0;\r\n    return !CollisionDetection.isRectInRect(this.bound, pos);\r\n  }\r\n\r\n  public pan2d(time: number, x?: number, y?: number) {\r\n    super.pan(time, this.INTERVAL_TIME, x, y);\r\n  }\r\n\r\n  public pan2dDif(time: number, dx?: number, dy?: number) {\r\n    const { x, y } = this.position;\r\n    super.pan(time, this.INTERVAL_TIME, x + (dx ?? 0), y + (dy ?? 0));\r\n  }\r\n}\r\n\r\nclass Camera3d extends BaseCamera {\r\n  protected INTERVAL_TIME = 10;\r\n\r\n  public pan3d(time: number, x?: number, y?: number, z?: number) {\r\n    super.pan(time, this.INTERVAL_TIME, x, y, z);\r\n  }\r\n}\r\n\r\nclass Camera {\r\n  public camera3d = new Camera3d();\r\n  public camera2d = new Camera2d();\r\n  public height: number;\r\n  public width: number;\r\n  public renderMode: '2d' | '3d' = '2d'; // Default to 2D mode\r\n\r\n  public setupCamera(\r\n    cameraOptions: CameraOptions,\r\n    aspectRatio: number,\r\n    canvas: HTMLCanvasElement,\r\n    renderMode?: '2d' | '3d'\r\n  ) {\r\n    // Set render mode, default to 2D unless 3D is explicitly requested\r\n    this.renderMode = renderMode || cameraOptions.renderMode || '2d';\r\n\r\n    if (this.renderMode === '3d') {\r\n      this.camera3d.setupCamera(cameraOptions, aspectRatio || 1, canvas);\r\n    } else {\r\n      this.camera2d.setupCamera(cameraOptions, aspectRatio || 1, canvas);\r\n    }\r\n\r\n    this.height = canvas.height;\r\n    this.width = canvas.width;\r\n  }\r\n\r\n  public commitProjectionView() {\r\n    if (this.renderMode === '3d') {\r\n      if (this.camera3d.isUpdateView()) {\r\n        this.camera3d.commitProjectionView();\r\n      }\r\n    } else {\r\n      if (this.camera2d.isUpdateView()) {\r\n        this.camera2d.commitProjectionView();\r\n      }\r\n    }\r\n  }\r\n\r\n  public getActiveCamera(): BaseCamera {\r\n    return this.renderMode === '3d' ? this.camera3d : this.camera2d;\r\n  }\r\n\r\n  public getActiveFrustum(): any {\r\n    return this.renderMode === '3d' ? this.camera3d.frustum : this.camera2d.frustum;\r\n  }\r\n}\r\n\r\nexport default Camera;\r\n","import BasicSprite from \"../../Entity/BasicSprite\";\r\nimport LineColour from \"../../Entity/LineColour\";\r\nimport Moveable from \"../../Entity/Moveable\";\r\nimport Plane2d from \"../../Entity/Plane2d\";\r\nimport Plane3d from \"../../Entity/Plane3d\";\r\nimport PlaneColour from \"../../Entity/PlaneColour\";\r\nimport SpriteModel from \"../../Entity/SpriteModel\";\r\nimport SpriteMoveable from \"../../Entity/SpriteMoveable\";\r\nimport TriangleColour2d from \"../../Entity/TriangleColour2d\";\r\nimport Colour from \"../Data/Colour\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport PlaneType from \"../Data/PlaneType\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport EngineObject, { EngineEntity } from \"../EngineEntity/EngineObject\";\r\nimport Position from \"../EngineEntity/Position\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport Events, { EngineEvent } from \"../Events\";\r\nimport { FontReference } from \"../Font/Font\";\r\nimport Physics from \"../Physics/Physics\";\r\n\r\nexport type OnClickType = (\r\n  event: EngineEvent,\r\n  engineHelper: EngineHelper,\r\n  object: EngineObject\r\n) => boolean | undefined;\r\n\r\nclass ConfigMapBuilder {\r\n  engineHelper: EngineHelper;\r\n  objects: EngineObject[];\r\n  texts: FontReference[];\r\n  ref: { [key: string]: any };\r\n  anchor: { [key: string]: any };\r\n\r\n  constructor(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n    this.objects = [];\r\n    this.ref = {};\r\n    this.anchor = {};\r\n    this.texts = [];\r\n  }\r\n\r\n  build(map: any) {\r\n    for (const prop in map) {\r\n      if (map.hasOwnProperty(prop)) {\r\n        if (prop.startsWith(\"$\")) {\r\n          this.ref[prop] = map[prop];\r\n        } else if (prop.startsWith(\"+\")) {\r\n          this.anchor[prop] = map[prop];\r\n        } else {\r\n          let object = map[prop];\r\n          this.initObjectPosition(object);\r\n          if (object.$ref && this.ref[object.$ref]) {\r\n            // merge ref with object\r\n            object = {\r\n              ...this.ref[object.$ref],\r\n              ...object,\r\n            };\r\n          }\r\n          if (object.$anchor && this.anchor[object.$anchor]) {\r\n            const anchor = this.anchor[object.$anchor];\r\n            // translate anchor\r\n            if (object.type === \"Font\") {\r\n              object.position.x += anchor.position.x;\r\n              object.position.y += anchor.position.y;\r\n            } else {\r\n              object.position.x += anchor.position.x;\r\n              object.position.y += anchor.position.y;\r\n              object.position.width += anchor.position.width;\r\n              object.position.height += anchor.position.height;\r\n            }\r\n          }\r\n          this.buildModel(object);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  initObjectPosition(object: any) {\r\n    if (!object.position) {\r\n      object.position = { x: 0, y: 0, height: 0, width: 0 };\r\n    } else {\r\n      if (!object.position.x) {\r\n        object.position.x = 0;\r\n      }\r\n      if (!object.position.y) {\r\n        object.position.y = 0;\r\n      }\r\n      if (!object.position.width) {\r\n        object.position.width = 0;\r\n      }\r\n      if (!object.position.height) {\r\n        object.position.height = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  buildModel(\r\n    config: ConfigEntity\r\n  ): ConfigEntityConcreteType[ConfigEntity[\"type\"]] {\r\n    if (!config.type) {\r\n      console.error(\"unable to parse empty type for object\", config);\r\n      return null as any;\r\n    }\r\n    let obj: EngineObject | FontReference = null as any;\r\n    if (config.type === \"Plane2D\") {\r\n      obj = this.createPlane2D(\r\n        config.model,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Plane3D\") {\r\n      obj = this.createPlane3D(\r\n        config.model,\r\n        this.createRect3d(config.position, config.isCentre),\r\n        config.hasPhysics,\r\n        config.planeType\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Triangle\") {\r\n      obj = this.createTriangle(\r\n        config.rgba,\r\n        this.createRect2d(config.position, config.isCentre)\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"SpriteMoveable\") {\r\n      obj = this.createSpriteMoveable(\r\n        config.spriteModel,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics,\r\n        config.ticks\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Moveable\") {\r\n      obj = this.createMoveable(\r\n        config.model,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Sprite\") {\r\n      obj = this.createSprite(\r\n        config.spriteModel,\r\n        this.createRect2d(config.position, config.isCentre),\r\n        config.hasPhysics,\r\n        config.ticks\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Font\") {\r\n      obj = this.createText(\r\n        config.texture,\r\n        this.createCoordinate(config.position),\r\n        config.fontSize,\r\n        config.text\r\n      );\r\n      obj.id = config.id;\r\n    } else if (config.type === \"Colour\") {\r\n      obj = this.createColour(\r\n        config.rgba,\r\n        this.createRect2d(config.position, config.isCentre)\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else if (config.type === \"Line\") {\r\n      obj = this.createLineColour(\r\n        config.rgba,\r\n        config.point1,\r\n        config.point2,\r\n        config.thickness\r\n      );\r\n      this.hookCustomHandler(config, obj);\r\n    } else {\r\n      console.warn(`Unable to find entity of type ${config.type}`);\r\n    }\r\n    if (obj instanceof EngineObject) {\r\n      obj.$id = config.id || obj.$id;\r\n      obj.data = config.data;\r\n      obj.isLastEvent = config.isLastEvent || false;\r\n    }\r\n\r\n    if (obj instanceof EngineObject || obj instanceof FontReference) {\r\n      if (config.isTop) {\r\n        obj.setTop(true);\r\n      }\r\n    }\r\n\r\n    if (obj instanceof EngineObject && config.clone) {\r\n      obj.setClone(true);\r\n    }\r\n\r\n    // @ts-expect-error ignore\r\n    return obj;\r\n  }\r\n\r\n  hookCustomHandler(config: ConfigEntity, object: EngineObject) {\r\n    if (config.render) {\r\n      let _renderCustom;\r\n      if (typeof window[config.render] === \"function\") {\r\n        _renderCustom = window[config.render].bind(object);\r\n      } else if (typeof config.render === \"function\") {\r\n        _renderCustom = config.render;\r\n      } else {\r\n        _renderCustom = () => {};\r\n      }\r\n      const _render = object.render.bind(object);\r\n      object.render = (engineHelper: EngineHelper) => {\r\n        _render(engineHelper);\r\n        _renderCustom(engineHelper);\r\n      };\r\n    }\r\n    if (config.update) {\r\n      let _updateCustom;\r\n      if (typeof window[config.update] === \"function\") {\r\n        _updateCustom = window[config.update].bind(object);\r\n      } else if (typeof config.update === \"function\") {\r\n        _updateCustom = config.update;\r\n      } else {\r\n        _updateCustom = () => {};\r\n      }\r\n      const _update = object.update.bind(object);\r\n      object.update = (engineHelper: EngineHelper) => {\r\n        _update(engineHelper);\r\n        _updateCustom(engineHelper);\r\n      };\r\n    }\r\n\r\n    const onClickedDefined =\r\n      config.onClick && typeof config.onClick === \"function\";\r\n    if (config.event) {\r\n      let _eventCustom;\r\n      if (typeof window[config.event] === \"function\") {\r\n        _eventCustom = window[config.event].bind(object);\r\n      } else if (typeof config.event === \"function\") {\r\n        _eventCustom = config.event;\r\n      } else {\r\n        _eventCustom = () => {};\r\n      }\r\n      const _event = object.event.bind(object) as EngineEntity[\"event\"];\r\n      object.event = (event: EngineEvent, engineHelper: EngineHelper) => {\r\n        let shouldPropagate = true;\r\n        // only stop propagation if the event returns false\r\n        shouldPropagate =\r\n          shouldPropagate && _event(event, engineHelper) !== false;\r\n        shouldPropagate =\r\n          shouldPropagate &&\r\n          _eventCustom(event, engineHelper, object) !== false;\r\n        if (onClickedDefined) {\r\n          shouldPropagate =\r\n            shouldPropagate &&\r\n            this.isClicked(event, engineHelper, object, config.onClick) !==\r\n              false;\r\n        }\r\n        return shouldPropagate;\r\n      };\r\n    } else if (onClickedDefined) {\r\n      const _event = object.event.bind(object);\r\n      object.event = (event: EngineEvent, engineHelper: EngineHelper) => {\r\n        let shouldPropagate = _event(event, engineHelper) !== false;\r\n        shouldPropagate =\r\n          shouldPropagate &&\r\n          this.isClicked(event, engineHelper, object, config.onClick) !== false;\r\n        return shouldPropagate;\r\n      };\r\n    }\r\n  }\r\n\r\n  isClicked(\r\n    event: EngineEvent,\r\n    engineHelper: EngineHelper,\r\n    object: EngineObject,\r\n    onClick: OnClickType\r\n  ) {\r\n    if (\r\n      event.eventType === Events.UP &&\r\n      engineHelper.isClicked(event, object.getRect2()) &&\r\n      object.hidden === false\r\n    ) {\r\n      return onClick.bind(object)(event, engineHelper, object);\r\n    }\r\n  }\r\n\r\n  createRect2d(position: Position, isCentre: boolean): Rect2d {\r\n    const rect = new Rect2d(\r\n      Number(position.x),\r\n      Number(position.y),\r\n      Number(position.width),\r\n      Number(position.height),\r\n      0\r\n    );\r\n    return isCentre ? rect.center() : rect;\r\n  }\r\n\r\n  createRect3d(position: Position, isCentre: boolean): Rect3d {\r\n    const rect = new Rect3d(\r\n      Number(position.x),\r\n      Number(position.y),\r\n      Number(position.z),\r\n      Number(position.width),\r\n      Number(position.height),\r\n      Number(position.length)\r\n    );\r\n    return isCentre ? rect.center() : rect;\r\n  }\r\n\r\n  createCoordinate(position: any): Coordinate {\r\n    return new Coordinate(Number(position.x), Number(position.y), 0);\r\n  }\r\n\r\n  createText(\r\n    texture: string,\r\n    pos: Coordinate,\r\n    fontSize: number,\r\n    text: string\r\n  ): FontReference {\r\n    const textRef = FontReference.newFont(pos, texture, 0)\r\n      .setText(text)\r\n      .setFontSize(fontSize);\r\n    this.texts.push(textRef);\r\n    return textRef;\r\n  }\r\n\r\n  createLineColour(\r\n    rgba: Colour,\r\n    point1: Coordinate,\r\n    point2: Coordinate,\r\n    thickness: number\r\n  ): EngineObject {\r\n    const colour = new LineColour(point1, point2, thickness, rgba);\r\n    this.objects.push(colour);\r\n    return colour;\r\n  }\r\n\r\n  createColour(rgba: Colour, location: Rect2d): EngineObject {\r\n    const colour = new PlaneColour(location, rgba);\r\n    this.objects.push(colour);\r\n    return colour;\r\n  }\r\n\r\n  createSpriteMoveable(\r\n    model: string[],\r\n    location: Rect2d,\r\n    hasPhysics: boolean,\r\n    ticks: number\r\n  ): EngineObject {\r\n    const spriteModel = new SpriteModel(location, ticks || 120.0, model);\r\n    const obj = new SpriteMoveable(location, spriteModel);\r\n    spriteModel.position.z = -1;\r\n    spriteModel.scaleZ(0);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj, obj.physics);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createMoveable(\r\n    model: string,\r\n    location: Rect2d,\r\n    hasPhysics: boolean\r\n  ): EngineObject {\r\n    const obj = new Plane2d(location, model);\r\n    obj.setLayer(-1);\r\n\r\n    const moveable = new Moveable();\r\n    moveable.entities.push(obj);\r\n    moveable.rotateZ(180.0);\r\n    moveable.setRect(location);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(moveable, moveable.physics);\r\n    }\r\n    moveable.updatePhysicsPosition();\r\n    this.objects.push(moveable);\r\n    return moveable;\r\n  }\r\n\r\n  createSprite(\r\n    model: string[],\r\n    location: Rect2d,\r\n    hasPhysics: boolean,\r\n    ticks: number\r\n  ): EngineObject {\r\n    const spriteModel = new SpriteModel(location, ticks || 120.0, model);\r\n    const obj = new BasicSprite(location, spriteModel);\r\n    spriteModel.position.z = -1;\r\n    spriteModel.rotateZ(180.0);\r\n    spriteModel.scaleZ(0);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj, obj.physics);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createPlane2D(\r\n    model: string,\r\n    location: Rect2d,\r\n    hasPhysics: boolean\r\n  ): EngineObject {\r\n    const obj = new Plane2d(location, model);\r\n    obj.rotateZ(180.0);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createPlane3D(\r\n    model: string,\r\n    location: Rect3d,\r\n    hasPhysics: boolean,\r\n    plane: PlaneType\r\n  ): EngineObject {\r\n    const vertexModel = this.engineHelper.newVertexModel(model, plane);\r\n    const obj = new Plane3d(location, vertexModel);\r\n    if (hasPhysics) {\r\n      Physics.registerPhysics(obj);\r\n    }\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n\r\n  createTriangle(rgba: Colour, location: Rect2d): EngineObject {\r\n    const obj = new TriangleColour2d(location, rgba);\r\n    this.objects.push(obj);\r\n    return obj;\r\n  }\r\n}\r\n\r\nexport type ConfigEntityTypes = keyof ConfigEntityConcreteType;\r\n\r\nexport type ConfigEntityConcreteType = {\r\n  Line: LineColour;\r\n  Plane2D: Plane2d;\r\n  Colour: PlaneColour;\r\n  Font: FontReference;\r\n  Plane3D: Plane3d;\r\n  Triangle: TriangleColour2d;\r\n  SpriteMoveable: SpriteMoveable;\r\n  Moveable: Moveable;\r\n  Sprite: BasicSprite;\r\n};\r\n\r\nexport class ConfigEntity {\r\n  id: string;\r\n  type: ConfigEntityTypes;\r\n  position: Position;\r\n  point1: Coordinate;\r\n  point2: Coordinate;\r\n  thickness: number;\r\n  rgba: Colour;\r\n  model: string;\r\n  hasPhysics: boolean;\r\n  clone: boolean;\r\n  fontSize: number;\r\n  text: string;\r\n  ticks: number;\r\n  spriteModel: string[];\r\n  texture: string;\r\n  render: string;\r\n  update: string;\r\n  event: string;\r\n  script: string;\r\n  isTop: boolean;\r\n  onClick: OnClickType;\r\n  data: object;\r\n  isCentre: boolean;\r\n  planeType: PlaneType;\r\n  isLastEvent: boolean;\r\n}\r\n\r\nexport type ConfigBuilder = {\r\n  entity: { [key: string]: ConfigEntity };\r\n  script: string;\r\n};\r\n\r\nexport default ConfigMapBuilder;\r\n","import Rect2d from \"../Core/Data/Rect2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Moveable from \"./Moveable\";\r\nimport SpriteModel from \"./SpriteModel\";\r\n\r\nclass BasicSprite extends Moveable {\r\n  spriteModel: SpriteModel;\r\n\r\n  constructor(rect: Rect2d, spriteModel: SpriteModel) {\r\n    super();\r\n    this.spriteModel = spriteModel;\r\n    this.spriteModel.setRect(rect);\r\n    this.entities.push(this.spriteModel);\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.spriteModel.render(engineHelper);\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    this.spriteModel.update(engineHelper);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    super.init(engineHelper);\r\n    this.setRect(this.spriteModel.getRect());\r\n    this.updatePhysicsPosition();\r\n  }\r\n}\r\n\r\nexport default BasicSprite;\r\n","interface BitmapData {\r\n  [key: string]: number[];\r\n}\r\n\r\nclass BitmapConfigParser {\r\n  map: BitmapData;\r\n  raw: BitmapData;\r\n  private source: string;\r\n  private readonly SOURCE_KEY = \"$source =\";\r\n\r\n  constructor(\r\n    raw: string,\r\n    bitmapWidth: number,\r\n    bitmapHeight: number,\r\n    precision: number\r\n  ) {\r\n    this.map = raw\r\n      .split(\"\\n\")\r\n      .map((line) =>\r\n        this.processLine(bitmapWidth, bitmapHeight, precision, line)\r\n      )\r\n      .filter((e) => !!e)\r\n      .reduce((sum, next) => ({ ...sum, ...next }));\r\n\r\n    this.raw = raw\r\n      .split(\"\\n\")\r\n      .map((line) => this.processRawLine(line))\r\n      .filter((e) => !!e)\r\n      .reduce((sum, next) => ({ ...sum, ...next })) as BitmapData;\r\n  }\r\n\r\n  processRawLine(line: string) {\r\n    if (line.startsWith(this.SOURCE_KEY)) {\r\n      this.source = line\r\n        .substr(line.indexOf(this.SOURCE_KEY) + this.SOURCE_KEY.length)\r\n        .trim()\r\n        .replace(\"\\r\", \"\")\r\n        .replace(\"\\n\", \"\");\r\n\r\n      if (window.location.origin === \"file://\") {\r\n        console.info(\r\n          \"file based loading should not have ./ in front of the source\"\r\n        );\r\n      }\r\n\r\n      return;\r\n    } else {\r\n      return this.processTextureLine(line);\r\n    }\r\n  }\r\n\r\n  private processTextureLine(line: string) {\r\n    const seperator = \"\\u0020\";\r\n    const nameindex = line.indexOf(seperator);\r\n    const key = line.substr(0, nameindex);\r\n    let temp = line.substr(nameindex + 1);\r\n    temp = temp.substr(temp.indexOf(seperator) + 1);\r\n    const leftindex = temp.indexOf(seperator);\r\n    const left = parseFloat(temp.substr(0, leftindex + 1));\r\n    temp = temp.substr(leftindex + 1);\r\n    const topindex = temp.indexOf(seperator);\r\n    const top = parseFloat(temp.substr(0, topindex));\r\n    temp = temp.substr(topindex + 1);\r\n    const widthIndex = temp.indexOf(seperator);\r\n    const width = parseFloat(temp.substr(0, widthIndex));\r\n    temp = temp.substr(widthIndex);\r\n    const height = parseFloat(temp);\r\n    return {\r\n      [key]: [left, top, width, height],\r\n    };\r\n  }\r\n\r\n  processLine(\r\n    bitmapWidth: number,\r\n    bitmapHeight: number,\r\n    precision: number,\r\n    line: string\r\n  ) {\r\n    const seperator = \"\\u0020\";\r\n\r\n    const nameindex = line.indexOf(seperator);\r\n    const key = line.substr(0, nameindex);\r\n\r\n    let temp = line.substr(nameindex + 1);\r\n    temp = temp.substr(temp.indexOf(seperator) + 1);\r\n\r\n    const leftindex = temp.indexOf(seperator);\r\n    const left = parseFloat(temp.substr(0, leftindex + 1));\r\n\r\n    temp = temp.substr(leftindex + 1);\r\n    const topindex = temp.indexOf(seperator);\r\n    const top = parseFloat(temp.substr(0, topindex));\r\n\r\n    temp = temp.substr(topindex + 1);\r\n    const widthIndex = temp.indexOf(seperator);\r\n    const width = parseFloat(temp.substr(0, widthIndex));\r\n\r\n    temp = temp.substr(widthIndex);\r\n    const height = parseFloat(temp);\r\n\r\n    return {\r\n      [key]: [\r\n        (left + width) / bitmapWidth - precision,\r\n        (height + top) / bitmapHeight - precision,\r\n        (left + width) / bitmapWidth - precision,\r\n        top / bitmapHeight + precision,\r\n        left / bitmapWidth + precision,\r\n        top / bitmapHeight + precision,\r\n        left / bitmapWidth + precision,\r\n        (top + height) / bitmapHeight - precision,\r\n      ],\r\n    };\r\n  }\r\n\r\n  getMap(): BitmapData {\r\n    return this.map;\r\n  }\r\n\r\n  getTextureSource(): string {\r\n    return this.source;\r\n  }\r\n}\r\n\r\nexport default BitmapConfigParser;\r\n","import * as glMatrix from \"./common.js\";\n\n/**\n * 2x2 Matrix\n * @module mat2\n */\n\n/**\n * Creates a new identity mat2\n *\n * @returns {mat2} a new 2x2 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat2 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat2} a matrix to clone\n * @returns {mat2} a new 2x2 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Copy the values from one mat2 to another\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Set a mat2 to the identity matrix\n *\n * @param {mat2} out the receiving matrix\n * @returns {mat2} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Create a new mat2 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out A new 2x2 matrix\n */\nexport function fromValues(m00, m01, m10, m11) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n\n/**\n * Set the components of a mat2 to the given values\n *\n * @param {mat2} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out\n */\nexport function set(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n\n/**\n * Transpose the values of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n\n  // Calculate the determinant\n  var det = a0 * a3 - a2 * a1;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the source matrix\n * @returns {mat2} out\n */\nexport function adjoint(out, a) {\n  // Caching this value is necessary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat2\n *\n * @param {ReadonlyMat2} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n\n/**\n * Multiplies two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n\n/**\n * Rotates a mat2 by the given angle\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n\n/**\n * Scales the mat2 by the dimensions in the given vec2\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to rotate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat2} out\n **/\nexport function scale(out, a, v) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var v0 = v[0],\n    v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.rotate(dest, dest, rad);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.scale(dest, dest, vec);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat2} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n\n/**\n * Returns a string representation of a mat2\n *\n * @param {ReadonlyMat2} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat2\n *\n * @param {ReadonlyMat2} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3]);\n}\n\n/**\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\n * @param {ReadonlyMat2} L the lower triangular matrix\n * @param {ReadonlyMat2} D the diagonal matrix\n * @param {ReadonlyMat2} U the upper triangular matrix\n * @param {ReadonlyMat2} a the input matrix to factorize\n */\n\nexport function LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n\n/**\n * Adds two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @returns {mat2} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat2} a The first matrix.\n * @param {ReadonlyMat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat2} a The first matrix.\n * @param {ReadonlyMat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2} out the receiving matrix\n * @param {ReadonlyMat2} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n\n/**\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2} out the receiving vector\n * @param {ReadonlyMat2} a the first operand\n * @param {ReadonlyMat2} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n\n/**\n * Alias for {@link mat2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat2.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 2x3 Matrix\n * @module mat2d\n * @description\n * A mat2d contains six elements defined as:\n * <pre>\n * [a, b,\n *  c, d,\n *  tx, ty]\n * </pre>\n * This is a short form for the 3x3 matrix:\n * <pre>\n * [a, b, 0,\n *  c, d, 0,\n *  tx, ty, 1]\n * </pre>\n * The last column is ignored so the array is shorter and operations are faster.\n */\n\n/**\n * Creates a new identity mat2d\n *\n * @returns {mat2d} a new 2x3 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat2d initialized with values from an existing matrix\n *\n * @param {ReadonlyMat2d} a matrix to clone\n * @returns {mat2d} a new 2x3 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n\n/**\n * Copy the values from one mat2d to another\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {mat2d} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n\n/**\n * Set a mat2d to the identity matrix\n *\n * @param {mat2d} out the receiving matrix\n * @returns {mat2d} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n\n/**\n * Create a new mat2d with the given values\n *\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} A new mat2d\n */\nexport function fromValues(a, b, c, d, tx, ty) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n\n/**\n * Set the components of a mat2d to the given values\n *\n * @param {mat2d} out the receiving matrix\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} out\n */\nexport function set(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n\n/**\n * Inverts a mat2d\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {mat2d | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var aa = a[0],\n    ab = a[1],\n    ac = a[2],\n    ad = a[3];\n  var atx = a[4],\n    aty = a[5];\n  var det = aa * ad - ab * ac;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat2d\n *\n * @param {ReadonlyMat2d} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n\n/**\n * Multiplies two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n\n/**\n * Rotates a mat2d by the given angle\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n\n/**\n * Scales the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to translate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat2d} out\n **/\nexport function scale(out, a, v) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var v0 = v[0],\n    v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n\n/**\n * Translates the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to translate\n * @param {ReadonlyVec2} v the vec2 to translate the matrix by\n * @returns {mat2d} out\n **/\nexport function translate(out, a, v) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var v0 = v[0],\n    v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.rotate(dest, dest, rad);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n    c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.scale(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat2d} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.translate(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat2d} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n\n/**\n * Returns a string representation of a mat2d\n *\n * @param {ReadonlyMat2d} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat2d(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat2d\n *\n * @param {ReadonlyMat2d} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + 1);\n}\n\n/**\n * Adds two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @returns {mat2d} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2d} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2d} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n\n/**\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2d} out the receiving vector\n * @param {ReadonlyMat2d} a the first operand\n * @param {ReadonlyMat2d} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2d} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat2d} a The first matrix.\n * @param {ReadonlyMat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat2d} a The first matrix.\n * @param {ReadonlyMat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n\n/**\n * Alias for {@link mat2d.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat2d.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 3x3 Matrix\n * @module mat3\n */\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {ReadonlyMat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20;\n\n  // Calculate the determinant\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat3\n *\n * @param {ReadonlyMat3} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2];\n  var a10 = a[3],\n    a11 = a[4],\n    a12 = a[5];\n  var a20 = a[6],\n    a21 = a[7],\n    a22 = a[8];\n  var b00 = b[0],\n    b01 = b[1],\n    b02 = b[2];\n  var b10 = b[3],\n    b11 = b[4],\n    b12 = b[5];\n  var b20 = b[6],\n    b21 = b[7],\n    b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to translate\n * @param {ReadonlyVec2} v vector to translate by\n * @returns {mat3} out\n */\nexport function translate(out, a, v) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a10 = a[3],\n    a11 = a[4],\n    a12 = a[5],\n    a20 = a[6],\n    a21 = a[7],\n    a22 = a[8],\n    x = v[0],\n    y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a10 = a[3],\n    a11 = a[4],\n    a12 = a[5],\n    a20 = a[6],\n    a21 = a[7],\n    a22 = a[8],\n    s = Math.sin(rad),\n    c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat3} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n    c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat3} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to copy\n * @returns {mat3} out\n **/\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Calculates a 3x3 matrix from the given quaternion\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat3} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n\n/**\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n *\n * @returns {mat3} out\n */\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n\n/**\n * Generates a 2D projection matrix with the given bounds\n *\n * @param {mat3} out mat3 frustum matrix will be written into\n * @param {number} width Width of your gl context\n * @param {number} height Height of gl context\n * @returns {mat3} out\n */\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat3\n *\n * @param {ReadonlyMat3} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8]);\n}\n\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7],\n    a8 = a[8];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7],\n    b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n    var a12 = a[6],\n      a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b0 = a00 * a11 - a01 * a10;\n  var b1 = a00 * a12 - a02 * a10;\n  var b2 = a01 * a12 - a02 * a11;\n  var b3 = a20 * a31 - a21 * a30;\n  var b4 = a20 * a32 - a22 * a30;\n  var b5 = a21 * a32 - a22 * a31;\n  var b6 = a00 * b5 - a01 * b4 + a02 * b3;\n  var b7 = a10 * b5 - a11 * b4 + a12 * b3;\n  var b8 = a20 * b2 - a21 * b1 + a22 * b0;\n  var b9 = a30 * b2 - a31 * b1 + a32 * b0;\n\n  // Calculate the determinant\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n}\n\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n\n  // Cache only the current line of the second matrix\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\nexport function translate(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n  return out;\n}\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11];\n\n  // Construct the elements of the rotation matrix\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw;\n  //Only scale if it makes sense\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion parameter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n  return out;\n}\n\n/**\n * Decomposes a transformation matrix into its rotation, translation\n * and scale components. Returns only the rotation component\n * @param  {quat} out_r Quaternion to receive the rotation component\n * @param  {vec3} out_t Vector to receive the translation vector\n * @param  {vec3} out_s Vector to receive the scaling factor\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @returns {quat} out_r\n */\nexport function decompose(out_r, out_t, out_s, mat) {\n  out_t[0] = mat[12];\n  out_t[1] = mat[13];\n  out_t[2] = mat[14];\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  var is1 = 1 / out_s[0];\n  var is2 = 1 / out_s[1];\n  var is3 = 1 / out_s[2];\n  var sm11 = m11 * is1;\n  var sm12 = m12 * is2;\n  var sm13 = m13 * is3;\n  var sm21 = m21 * is1;\n  var sm22 = m22 * is2;\n  var sm23 = m23 * is3;\n  var sm31 = m31 * is1;\n  var sm32 = m32 * is2;\n  var sm33 = m33 * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out_r[3] = 0.25 * S;\n    out_r[0] = (sm23 - sm32) / S;\n    out_r[1] = (sm31 - sm13) / S;\n    out_r[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out_r[3] = (sm23 - sm32) / S;\n    out_r[0] = 0.25 * S;\n    out_r[1] = (sm12 + sm21) / S;\n    out_r[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out_r[3] = (sm31 - sm13) / S;\n    out_r[0] = (sm12 + sm21) / S;\n    out_r[1] = 0.25 * S;\n    out_r[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out_r[3] = (sm12 - sm21) / S;\n    out_r[0] = (sm31 + sm13) / S;\n    out_r[1] = (sm23 + sm32) / S;\n    out_r[2] = 0.25 * S;\n  }\n  return out_r;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     mat4.translate(dest, dest, origin);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *     mat4.translate(dest, dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n  return out;\n}\n\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\nexport var perspective = perspectiveNO;\n\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\nexport var ortho = orthoNO;\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} target Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n    eyey = eye[1],\n    eyez = eye[2],\n    upx = up[0],\n    upy = up[1],\n    upz = up[2];\n  var z0 = eyex - target[0],\n    z1 = eyey - target[1],\n    z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n  var x0 = upy * z2 - upz * z1,\n    x1 = upz * z0 - upx * z2,\n    x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8] + a[9] * a[9] + a[10] * a[10] + a[11] * a[11] + a[12] * a[12] + a[13] * a[13] + a[14] * a[14] + a[15] * a[15]);\n}\n\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var a8 = a[8],\n    a9 = a[9],\n    a10 = a[10],\n    a11 = a[11];\n  var a12 = a[12],\n    a13 = a[13],\n    a14 = a[14],\n    a15 = a[15];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  var b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  var b8 = b[8],\n    b9 = b[9],\n    b10 = b[10],\n    b11 = b[11];\n  var b12 = b[12],\n    b13 = b[13],\n    b14 = b[14],\n    b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  out[2] = glMatrix.round(a[2]);\n  return out;\n}\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n\n/**\n * Performs a spherical linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function slerp(out, a, b, t) {\n  var angle = Math.acos(Math.min(Math.max(dot(a, b), -1), 1));\n  var sinTotal = Math.sin(angle);\n  var ratioA = Math.sin((1 - t) * angle) / sinTotal;\n  var ratioB = Math.sin(t * angle) / sinTotal;\n  out[0] = ratioA * a[0] + ratioB * b[0];\n  out[1] = ratioA * a[1] + ratioB * b[1];\n  out[2] = ratioA * a[2] + ratioB * b[2];\n  return out;\n}\n\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec3} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q normalized quaternion to transform with\n * @returns {vec3} out\n */\nexport function transformQuat(out, a, q) {\n  // Fast Vector Rotation using Quaternions by Robert Eisele\n  // https://raw.org/proof/vector-rotation-using-quaternions/\n\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3];\n  var vx = a[0],\n    vy = a[1],\n    vz = a[2];\n\n  // t = q x v\n  var tx = qy * vz - qz * vy;\n  var ty = qz * vx - qx * vz;\n  var tz = qx * vy - qy * vx;\n\n  // t = 2t\n  tx = tx + tx;\n  ty = ty + ty;\n  tz = tz + tz;\n\n  // v + w t + q x t\n  out[0] = vx + qw * tx + qy * tz - qz * ty;\n  out[1] = vy + qw * ty + qz * tx - qx * tz;\n  out[2] = vz + qw * tz + qx * ty - qy * tx;\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2];\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    bx = b[0],\n    by = b[1],\n    bz = b[2],\n    mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz)),\n    cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 3;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  out[2] = glMatrix.round(a[2]);\n  out[3] = glMatrix.round(a[3]);\n  return out;\n}\n\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.sqrt(x * x + y * y + z * z + w * w);\n}\n\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} out the receiving vector\n * @param {ReadonlyVec4} u the first vector\n * @param {ReadonlyVec4} v the second vector\n * @param {ReadonlyVec4} w the third vector\n * @returns {vec4} result\n */\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n    B = v[0] * w[2] - v[2] * w[0],\n    C = v[0] * w[3] - v[3] * w[0],\n    D = v[1] * w[2] - v[2] * w[1],\n    E = v[1] * w[3] - v[3] * w[1],\n    F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec4} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n\n  // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n  var v1, v2, v3, v4;\n  var s1, s2;\n  var rand;\n  rand = glMatrix.RANDOM();\n  v1 = rand * 2 - 1;\n  v2 = (4 * glMatrix.RANDOM() - 2) * Math.sqrt(rand * -rand + rand);\n  s1 = v1 * v1 + v2 * v2;\n  rand = glMatrix.RANDOM();\n  v3 = rand * 2 - 1;\n  v4 = (4 * glMatrix.RANDOM() - 2) * Math.sqrt(rand * -rand + rand);\n  s2 = v3 * v3 + v4 * v4;\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2],\n    w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q normalized quaternion to transform with\n * @returns {vec4} out\n */\nexport function transformQuat(out, a, q) {\n  // Fast Vector Rotation using Quaternions by Robert Eisele\n  // https://raw.org/proof/vector-rotation-using-quaternions/\n\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3];\n  var vx = a[0],\n    vy = a[1],\n    vz = a[2];\n\n  // t = q x v\n  var tx = qy * vz - qz * vy;\n  var ty = qz * vx - qx * vz;\n  var tz = qx * vy - qy * vx;\n\n  // t = 2t\n  tx = tx + tx;\n  ty = ty + ty;\n  tz = tz + tz;\n\n  // v + w t + q x t\n  out[0] = vx + qw * tx + qy * tz - qz * ty;\n  out[1] = vy + qw * ty + qz * tx - qx * tz;\n  out[2] = vz + qw * tz + qx * ty - qy * tx;\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec4.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 4;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n\n/**\n * Quaternion in the format XYZW\n * @module quat\n */\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Set a quat to the identity quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n\n/**\n * Sets a quat from the given angle and rotation axis,\n * then returns it.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyVec3} axis the axis around which to rotate\n * @param {Number} rad the angle in radians\n * @returns {quat} out\n **/\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n\n/**\n * Gets the rotation axis and angle for a given\n *  quaternion. If a quaternion is created with\n *  setAxisAngle, this method will return the same\n *  values as providied in the original parameter list\n *  OR functionally equivalent values.\n * Example: The quaternion formed by axis [0, 0, 1] and\n *  angle -90 is the same as the quaternion formed by\n *  [0, 0, 1] and 270. This method favors the latter.\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\n * @return {Number}     Angle, in radians, of the rotation\n */\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n  return rad;\n}\n\n/**\n * Gets the angular distance between two unit quaternions\n *\n * @param  {ReadonlyQuat} a     Origin unit quaternion\n * @param  {ReadonlyQuat} b     Destination unit quaternion\n * @return {Number}     Angle, in radians, between the two quaternions\n */\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n\n/**\n * Multiplies two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n */\nexport function multiply(out, a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2],\n    bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bx = Math.sin(rad),\n    bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var by = Math.sin(rad),\n    bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n\n/**\n * Rotates a quaternion by the given angle about the Z axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bz = Math.sin(rad),\n    bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n\n/**\n * Calculates the W component of a quat from the X, Y, and Z components.\n * Assumes that quaternion is 1 unit in length.\n * Any existing W component will be ignored.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate W component of\n * @returns {quat} out\n */\nexport function calculateW(out, a) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n\n/**\n * Calculate the exponential of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\nexport function exp(out, a) {\n  var x = a[0],\n    y = a[1],\n    z = a[2],\n    w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n\n/**\n * Calculate the natural logarithm of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\nexport function ln(out, a) {\n  var x = a[0],\n    y = a[1],\n    z = a[2],\n    w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n\n/**\n * Calculate the scalar power of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @param {Number} b amount to scale the quaternion by\n * @returns {quat} out\n */\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n\n/**\n * Performs a spherical linear interpolation between two quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2],\n    bw = b[3];\n  var omega, cosom, sinom, scale0, scale1;\n\n  // calc cosine\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\n  // adjust signs (if necessary)\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  }\n  // calculate coefficients\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  }\n  // calculate final values\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n\n/**\n * Generates a random unit quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n\n/**\n * Calculates the inverse of a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate inverse of\n * @returns {quat} out\n */\nexport function invert(out, a) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0;\n\n  // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate conjugate of\n * @returns {quat} out\n */\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n\n/**\n * Creates a quaternion from the given 3x3 rotation matrix.\n *\n * NOTE: The resultant quaternion is not normalized, so you should be sure\n * to renormalize the quaternion yourself where necessary.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyMat3} m rotation matrix\n * @returns {quat} out\n * @function\n */\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n  return out;\n}\n\n/**\n * Creates a quaternion from the given euler angle x, y, z using the provided intrinsic order for the conversion.\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x Angle to rotate around X axis in degrees.\n * @param {Number} y Angle to rotate around Y axis in degrees.\n * @param {Number} z Angle to rotate around Z axis in degrees.\n * @param {'xyz'|'xzy'|'yxz'|'yzx'|'zxy'|'zyx'} order Intrinsic order for conversion, default is zyx.\n * @returns {quat} out\n * @function\n */\nexport function fromEuler(out, x, y, z) {\n  var order = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : glMatrix.ANGLE_ORDER;\n  var halfToRad = Math.PI / 360;\n  x *= halfToRad;\n  z *= halfToRad;\n  y *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  switch (order) {\n    case \"xyz\":\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n      break;\n    case \"xzy\":\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n      break;\n    case \"yxz\":\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n      break;\n    case \"yzx\":\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n      break;\n    case \"zxy\":\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n      break;\n    case \"zyx\":\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n      break;\n    default:\n      throw new Error('Unknown angle order ' + order);\n  }\n  return out;\n}\n\n/**\n * Returns a string representation of a quaternion\n *\n * @param {ReadonlyQuat} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\nexport var clone = vec4.clone;\n\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\nexport var fromValues = vec4.fromValues;\n\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the source quaternion\n * @returns {quat} out\n * @function\n */\nexport var copy = vec4.copy;\n\n/**\n * Set the components of a quat to the given values\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} out\n * @function\n */\nexport var set = vec4.set;\n\n/**\n * Adds two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n * @function\n */\nexport var add = vec4.add;\n\n/**\n * Alias for {@link quat.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Scales a quat by a scalar number\n *\n * @param {quat} out the receiving vector\n * @param {ReadonlyQuat} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {quat} out\n * @function\n */\nexport var scale = vec4.scale;\n\n/**\n * Calculates the dot product of two quat's\n *\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\nexport var dot = vec4.dot;\n\n/**\n * Performs a linear interpolation between two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n * @function\n */\nexport var lerp = vec4.lerp;\n\n/**\n * Calculates the length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport var length = vec4.length;\n\n/**\n * Alias for {@link quat.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Calculates the squared length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\nexport var squaredLength = vec4.squaredLength;\n\n/**\n * Alias for {@link quat.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\nexport var normalize = vec4.normalize;\n\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat} a The first quaternion.\n * @param {ReadonlyQuat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport var exactEquals = vec4.exactEquals;\n\n/**\n * Returns whether or not the quaternions point approximately to the same direction.\n *\n * Both quaternions are assumed to be unit length.\n *\n * @param {ReadonlyQuat} a The first unit quaternion.\n * @param {ReadonlyQuat} b The second unit quaternion.\n * @returns {Boolean} True if the quaternions are equal, false otherwise.\n */\nexport function equals(a, b) {\n  return Math.abs(vec4.dot(a, b)) >= 1 - glMatrix.EPSILON;\n}\n\n/**\n * Sets a quaternion to represent the shortest rotation from one\n * vector to another.\n *\n * Both vectors are assumed to be unit length.\n *\n * @param {quat} out the receiving quaternion.\n * @param {ReadonlyVec3} a the initial vector\n * @param {ReadonlyVec3} b the destination vector\n * @returns {quat} out\n */\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n\n/**\n * Performs a spherical linear interpolation with two control points\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {ReadonlyQuat} c the third operand\n * @param {ReadonlyQuat} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n\n/**\n * Sets the specified quaternion with values corresponding to the given\n * axes. Each axis is a vec3 and is expected to be unit length and\n * perpendicular to all other specified axes.\n *\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\n * @returns {quat} out\n */\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as quat from \"./quat.js\";\nimport * as mat4 from \"./mat4.js\";\n\n/**\n * Dual Quaternion<br>\n * Format: [real, dual]<br>\n * Quaternion format: XYZW<br>\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\n * @module quat2\n */\n\n/**\n * Creates a new identity dual quat\n *\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\n */\nexport function create() {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n  dq[3] = 1;\n  return dq;\n}\n\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat2} a dual quaternion to clone\n * @returns {quat2} new dual quaternion\n * @function\n */\nexport function clone(a) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n\n/**\n * Creates a new dual quat initialized with the given values\n *\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component\n * @param {Number} y2 Y component\n * @param {Number} z2 Z component\n * @param {Number} w2 W component\n * @returns {quat2} new dual quaternion\n * @function\n */\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n\n/**\n * Creates a new dual quat from the given values (quat and translation)\n *\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component (translation)\n * @param {Number} y2 Y component (translation)\n * @param {Number} z2 Z component (translation)\n * @returns {quat2} new dual quaternion\n * @function\n */\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n    ay = y2 * 0.5,\n    az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n\n/**\n * Creates a dual quat from a quaternion and a translation\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyQuat} q a normalized quaternion\n * @param {ReadonlyVec3} t translation vector\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\nexport function fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n    ay = t[1] * 0.5,\n    az = t[2] * 0.5,\n    bx = q[0],\n    by = q[1],\n    bz = q[2],\n    bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n\n/**\n * Creates a dual quat from a translation\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyVec3} t translation vector\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\nexport function fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n\n/**\n * Creates a dual quat from a quaternion\n *\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\n * @param {ReadonlyQuat} q the quaternion\n * @returns {quat2} dual quaternion receiving operation result\n * @function\n */\nexport function fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n\n/**\n * Creates a new dual quat from a matrix (4x4)\n *\n * @param {quat2} out the dual quaternion\n * @param {ReadonlyMat4} a the matrix\n * @returns {quat2} dual quat receiving operation result\n * @function\n */\nexport function fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = quat.create();\n  mat4.getRotation(outer, a);\n  var t = new glMatrix.ARRAY_TYPE(3);\n  mat4.getTranslation(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n\n/**\n * Copy the values from one dual quat to another\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the source dual quaternion\n * @returns {quat2} out\n * @function\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n\n/**\n * Set a dual quat to the identity dual quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @returns {quat2} out\n */\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n\n/**\n * Set the components of a dual quat to the given values\n *\n * @param {quat2} out the receiving quaternion\n * @param {Number} x1 X component\n * @param {Number} y1 Y component\n * @param {Number} z1 Z component\n * @param {Number} w1 W component\n * @param {Number} x2 X component\n * @param {Number} y2 Y component\n * @param {Number} z2 Z component\n * @param {Number} w2 W component\n * @returns {quat2} out\n * @function\n */\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n\n/**\n * Gets the real part of a dual quat\n * @param  {quat} out real part\n * @param  {ReadonlyQuat2} a Dual Quaternion\n * @return {quat} real part\n */\nexport var getReal = quat.copy;\n\n/**\n * Gets the dual part of a dual quat\n * @param  {quat} out dual part\n * @param  {ReadonlyQuat2} a Dual Quaternion\n * @return {quat} dual part\n */\nexport function getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n\n/**\n * Set the real component of a dual quat to the given quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat} q a quaternion representing the real part\n * @returns {quat2} out\n * @function\n */\nexport var setReal = quat.copy;\n\n/**\n * Set the dual component of a dual quat to the given quaternion\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat} q a quaternion representing the dual part\n * @returns {quat2} out\n * @function\n */\nexport function setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n\n/**\n * Gets the translation of a normalized dual quat\n * @param  {vec3} out translation\n * @param  {ReadonlyQuat2} a Dual Quaternion to be decomposed\n * @return {vec3} translation\n */\nexport function getTranslation(out, a) {\n  var ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n\n/**\n * Translates a dual quat by the given vector\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {quat2} out\n */\nexport function translate(out, a, v) {\n  var ax1 = a[0],\n    ay1 = a[1],\n    az1 = a[2],\n    aw1 = a[3],\n    bx1 = v[0] * 0.5,\n    by1 = v[1] * 0.5,\n    bz1 = v[2] * 0.5,\n    ax2 = a[4],\n    ay2 = a[5],\n    az2 = a[6],\n    aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n\n/**\n * Rotates a dual quat around the X axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\nexport function rotateX(out, a, rad) {\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateX(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat around the Y axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\nexport function rotateY(out, a, rad) {\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateY(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat around the Z axis\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {number} rad how far should the rotation be\n * @returns {quat2} out\n */\nexport function rotateZ(out, a, rad) {\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7],\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateZ(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat by a given quaternion (a * q)\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {ReadonlyQuat} q quaternion to rotate by\n * @returns {quat2} out\n */\nexport function rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3],\n    ax = a[0],\n    ay = a[1],\n    az = a[2],\n    aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n\n/**\n * Rotates a dual quat by a given quaternion (q * a)\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat} q quaternion to rotate by\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @returns {quat2} out\n */\nexport function rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3],\n    bx = a[0],\n    by = a[1],\n    bz = a[2],\n    bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n\n/**\n * Rotates a dual quat around a given axis. Does the normalisation automatically\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @param {Number} rad how far the rotation should be\n * @returns {quat2} out\n */\nexport function rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < glMatrix.EPSILON) {\n    return copy(out, a);\n  }\n  var axisLength = Math.sqrt(axis[0] * axis[0] + axis[1] * axis[1] + axis[2] * axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n    ay1 = a[1],\n    az1 = a[2],\n    aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n\n/**\n * Adds two dual quat's\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {quat2} out\n * @function\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n\n/**\n * Multiplies two dual quat's\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {quat2} out\n */\nexport function multiply(out, a, b) {\n  var ax0 = a[0],\n    ay0 = a[1],\n    az0 = a[2],\n    aw0 = a[3],\n    bx1 = b[4],\n    by1 = b[5],\n    bz1 = b[6],\n    bw1 = b[7],\n    ax1 = a[4],\n    ay1 = a[5],\n    az1 = a[6],\n    aw1 = a[7],\n    bx0 = b[0],\n    by0 = b[1],\n    bz0 = b[2],\n    bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n\n/**\n * Alias for {@link quat2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Scales a dual quat by a scalar number\n *\n * @param {quat2} out the receiving dual quat\n * @param {ReadonlyQuat2} a the dual quat to scale\n * @param {Number} b amount to scale the dual quat by\n * @returns {quat2} out\n * @function\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n\n/**\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\n *\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\nexport var dot = quat.dot;\n\n/**\n * Performs a linear interpolation between two dual quats's\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\n *\n * @param {quat2} out the receiving dual quat\n * @param {ReadonlyQuat2} a the first operand\n * @param {ReadonlyQuat2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat2} out\n */\nexport function lerp(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n\n/**\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a dual quat to calculate inverse of\n * @returns {quat2} out\n */\nexport function invert(out, a) {\n  var sqlen = squaredLength(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n\n/**\n * Calculates the conjugate of a dual quat\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\n *\n * @param {quat2} out the receiving quaternion\n * @param {ReadonlyQuat2} a quat to calculate conjugate of\n * @returns {quat2} out\n */\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n\n/**\n * Calculates the length of a dual quat\n *\n * @param {ReadonlyQuat2} a dual quat to calculate length of\n * @returns {Number} length of a\n * @function\n */\nexport var length = quat.length;\n\n/**\n * Alias for {@link quat2.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Calculates the squared length of a dual quat\n *\n * @param {ReadonlyQuat2} a dual quat to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\nexport var squaredLength = quat.squaredLength;\n\n/**\n * Alias for {@link quat2.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Normalize a dual quat\n *\n * @param {quat2} out the receiving dual quaternion\n * @param {ReadonlyQuat2} a dual quaternion to normalize\n * @returns {quat2} out\n * @function\n */\nexport function normalize(out, a) {\n  var magnitude = squaredLength(a);\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n  return out;\n}\n\n/**\n * Returns a string representation of a dual quaternion\n *\n * @param {ReadonlyQuat2} a dual quaternion to represent as a string\n * @returns {String} string representation of the dual quat\n */\nexport function str(a) {\n  return \"quat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \")\";\n}\n\n/**\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat2} a the first dual quaternion.\n * @param {ReadonlyQuat2} b the second dual quaternion.\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n\n/**\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\n *\n * @param {ReadonlyQuat2} a the first dual quat.\n * @param {ReadonlyQuat2} b the second dual quat.\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3],\n    a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}","import BMFontReader from \"./FntFontReader\";\r\nimport BitmapConfigParser from \"./BitmapConfigParser\";\r\nimport EngineHelper, { RetrieveResource } from \"../Core/EngineHelper\";\r\nimport VertexParser from \"./VertexParser\";\r\n\r\nclass ResourceResolver {\r\n  static bmFontResolver(_: EngineHelper) {\r\n    return (result: RetrieveResource) => {\r\n      result.registerFont(new BMFontReader(result.data));\r\n      return result;\r\n    };\r\n  }\r\n\r\n  static bitmapResolver(\r\n    engineHelper: EngineHelper,\r\n    bitmapWidth: number,\r\n    bitmapHeight: number,\r\n    precision: number\r\n  ) {\r\n    return (result: RetrieveResource) => {\r\n      const bitmapLoader = new BitmapConfigParser(\r\n        result.data,\r\n        bitmapWidth,\r\n        bitmapHeight,\r\n        precision\r\n      );\r\n      const textureSource = bitmapLoader.getTextureSource();\r\n      for (const key in bitmapLoader.getMap()) {\r\n        if (bitmapLoader.map.hasOwnProperty(key)) {\r\n          const uv = bitmapLoader.map[key];\r\n          engineHelper.addUVCache(textureSource, key, uv);\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n  }\r\n\r\n  static objResolverMultiple(\r\n    engineHelper: EngineHelper,\r\n    sources: { textureSource: string; name: string }[]\r\n  ) {\r\n    return (result: RetrieveResource) => {\r\n      sources.map(({ textureSource, name }) =>\r\n        engineHelper.addVertexUvCache(\r\n          textureSource,\r\n          name,\r\n          new VertexParser(result.data).vertices\r\n        )\r\n      );\r\n    };\r\n  }\r\n\r\n  static objResolver(\r\n    engineHelper: EngineHelper,\r\n    textureSource: string,\r\n    name: string\r\n  ) {\r\n    return (result: RetrieveResource) => {\r\n      engineHelper.addVertexUvCache(\r\n        textureSource,\r\n        name,\r\n        new VertexParser(result.data).vertices\r\n      );\r\n    };\r\n  }\r\n}\r\nexport default ResourceResolver;\r\n","import BaseProgram from \"../Base/BaseProgram\";\r\nimport RGBFragmentShader from \"../Shaders/RGBFragmentShader.glsl\";\r\nimport RGBVertexShader from \"../Shaders/RGBVertexShader.glsl\";\r\nimport ArrayBuffer from \"../../Buffer/ArrayBuffer\";\r\nimport ProgramReference from \"../Base/ProgramReference\";\r\n\r\nexport default class ShaderProgramColour extends BaseProgram {\r\n  static DRAW_VERTEX_SIZE = 7;\r\n  positionRef: ProgramReference;\r\n  colorRef: ProgramReference;\r\n  modelViewMatrixRef: ProgramReference;\r\n  viewMtrx: ProgramReference;\r\n  projMtrx: ProgramReference;\r\n  arrayBuffer: ArrayBuffer;\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    super(ctx);\r\n    this.arrayBuffer = new ArrayBuffer(ctx);\r\n    this.program = this.compileShaders(RGBVertexShader, RGBFragmentShader);\r\n    this.bindProgram();\r\n\r\n    this.positionRef = new ProgramReference(\r\n      \"a_position\",\r\n      ctx,\r\n      true,\r\n      this.program\r\n    );\r\n    this.colorRef = new ProgramReference(\"a_color\", ctx, true, this.program);\r\n    this.modelViewMatrixRef = new ProgramReference(\r\n      \"u_model\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.viewMtrx = new ProgramReference(\"u_view\", ctx, false, this.program);\r\n    this.projMtrx = new ProgramReference(\r\n      \"u_projection\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n  }\r\n\r\n  bindProgram() {\r\n    this._bindProgram(this.program);\r\n  }\r\n\r\n  unbindProgram() {\r\n    this._unbindProgram();\r\n  }\r\n\r\n  enableAttribPointers() {\r\n    const ctx = this.ctx;\r\n    ctx.enableVertexAttribArray(this.positionRef.ref);\r\n    ctx.enableVertexAttribArray(this.colorRef.ref);\r\n  }\r\n\r\n  bindAttributePointers() {\r\n    this.enableAttribPointers();\r\n    const ctx = this.ctx;\r\n    ctx.vertexAttribPointer(\r\n      this.positionRef.ref,\r\n      2,\r\n      ctx.FLOAT,\r\n      false,\r\n      4 * 7,\r\n      0\r\n    );\r\n    ctx.vertexAttribPointer(\r\n      this.colorRef.ref,\r\n      4,\r\n      ctx.FLOAT,\r\n      false,\r\n      4 * 7,\r\n      3 * 4\r\n    );\r\n  }\r\n\r\n  unbindAttributePointers() {\r\n    const ctx = this.ctx;\r\n    ctx.disableVertexAttribArray(this.positionRef.ref);\r\n    ctx.disableVertexAttribArray(this.colorRef.ref);\r\n  }\r\n\r\n  glSetProjectMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.projMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetModelViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.modelViewMatrixRef.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.viewMtrx.ref, false, matrixArray);\r\n  }\r\n}\r\n","import { ShaderType } from \"../../Data/RenderOption\";\r\nimport ShaderProgramColour from \"../ShaderProgram/ShaderColourProgram\";\r\nimport { ShaderEntity } from \"../../EngineEntity/ShaderEntity\";\r\nimport { mat4 } from \"gl-matrix\";\r\nimport { BaseCamera } from \"../../Camera\";\r\n\r\nclass EntityColourProgram {\r\n  program: ShaderProgramColour;\r\n  ctx: WebGLRenderingContext;\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n    this.program = new ShaderProgramColour(ctx);\r\n  }\r\n\r\n  delete() {\r\n    this.program.arrayBuffer.delete();\r\n    this.program.delete();\r\n  }\r\n\r\n  updateBuffer(entity: ShaderEntity, buffer: number[]) {\r\n    const opt = entity.getOpt();\r\n    if (ShaderType.COLOUR !== opt.shaderType) {\r\n      console.error(\r\n        \"Updating buffer for registered Colour Entity but with different shader type as RenderOptions\",\r\n        opt\r\n      );\r\n      return;\r\n    }\r\n\r\n    const buffReg =\r\n      this.program.arrayBuffer.bufferReg[entity.rendererBufferId!];\r\n    if (!buffer || buffer.length !== buffReg.verticesSize) {\r\n      console.error(\r\n        \"New Buffer data does not match initial buffer data!\",\r\n        entity,\r\n        buffer,\r\n        buffReg.verticesSize\r\n      );\r\n    }\r\n\r\n    this.program.arrayBuffer.bufferSub(\r\n      buffReg.offset,\r\n      buffer,\r\n      ShaderProgramColour.DRAW_VERTEX_SIZE\r\n    );\r\n  }\r\n\r\n  bindBuffer() {\r\n    this.program.arrayBuffer.bufferBind();\r\n  }\r\n\r\n  render(entities: [ShaderEntity, Float32List][], camera: BaseCamera) {\r\n    this.program.arrayBuffer.bind();\r\n    this.program.bindAttributePointers();\r\n    this.program.bindProgram();\r\n    this.program.glSetViewMatrix(camera.viewMatrix as Float32List);\r\n    if (this.ctx.isEnabled(this.ctx.CULL_FACE)) {\r\n      this.ctx.disable(this.ctx.CULL_FACE);\r\n    }\r\n    if (this.ctx.isEnabled(this.ctx.DEPTH_TEST)) {\r\n      this.ctx.disable(this.ctx.DEPTH_TEST);\r\n    }\r\n\r\n    for (let index = 0; index < entities.length; index++) {\r\n      const data = entities[index];\r\n      const entity = data[0];\r\n      const model = data[1];\r\n      if (!entity.rendererBufferId) {\r\n        throw new Error(\"Unregistered entity buffer\" + entity);\r\n      }\r\n      const buffReg =\r\n        this.program.arrayBuffer.bufferReg[entity.rendererBufferId];\r\n      this.program.glSetModelViewMatrix(model);\r\n      this.ctx.drawArrays(\r\n        this.ctx.TRIANGLE_STRIP,\r\n        buffReg.offset,\r\n        buffReg.size\r\n      );\r\n    }\r\n\r\n    this.program.arrayBuffer.unbind();\r\n    this.program.unbindAttributePointers();\r\n    this.program.unbindProgram();\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity, objBuffer: number[]) {\r\n    const size = objBuffer.length / ShaderProgramColour.DRAW_VERTEX_SIZE;\r\n    this.program.arrayBuffer.bufferReg[this.program.arrayBuffer.bufferRegId] = {\r\n      offset: this.program.arrayBuffer.length(),\r\n      size: size,\r\n      verticesSize: objBuffer.length,\r\n    };\r\n    this.program.arrayBuffer.push(objBuffer, size);\r\n    object.rendererBufferId = this.program.arrayBuffer.bufferRegId;\r\n    this.program.arrayBuffer.bufferRegId++;\r\n  }\r\n\r\n  updatePerspective(projectionMatrix: mat4) {\r\n    this.program.bindProgram();\r\n    this.program.glSetProjectMatrix(projectionMatrix as Float32List);\r\n  }\r\n}\r\n\r\nexport default EntityColourProgram;\r\n","import SpriteModel from \"./SpriteModel\";\r\nimport Moveable from \"./Moveable\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\n\r\nexport class SpriteMoveableModel extends SpriteModel {}\r\n\r\nclass SpriteMoveable extends Moveable {\r\n  spriteModel: SpriteModel;\r\n  constructor(rect: Rect2d, spriteModel: SpriteMoveableModel) {\r\n    super();\r\n    this.spriteModel = spriteModel;\r\n    this.spriteModel.setRect(rect);\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    this.spriteModel.render(engineHelper);\r\n  }\r\n  update(engineHelper: EngineHelper) {\r\n    this.spriteModel.update(engineHelper);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.entities.push(this.spriteModel);\r\n    super.init(engineHelper);\r\n    this.setRect(this.spriteModel.getRect());\r\n    this.updatePhysicsPosition();\r\n  }\r\n}\r\n\r\nexport default SpriteMoveable;\r\n","export class ShaderType {\r\n  static THREE_DIMENSION = 2;\r\n  static TWO_DIMENSION = 1;\r\n  static COLOUR = 3;\r\n}\r\n\r\nexport class RenderType {\r\n  static PLAIN = 4;\r\n  static TRIANGLE = 5;\r\n  static RECTANGLE = 6;\r\n}\r\n\r\nexport default class RenderOption {\r\n  shaderType: ShaderType;\r\n  renderType: RenderType;\r\n}\r\n","export default class ProgramReference {\r\n  ref: any | number | WebGLUniformLocation;\r\n\r\n  constructor(\r\n    key: string,\r\n    ctx: WebGLRenderingContext,\r\n    isAttribute: boolean,\r\n    program: WebGLProgram\r\n  ) {\r\n    if (isAttribute) {\r\n      this.ref = ctx.getAttribLocation(program, key);\r\n      if (this.ref === -1) {\r\n        throw new Error(\"Unable to find attribute shader key = \" + key);\r\n      }\r\n    } else {\r\n      this.ref = ctx.getUniformLocation(program, key);\r\n      if (this.ref === null) {\r\n        throw new Error(\"Unable to find uniform shader key = \" + key);\r\n      }\r\n    }\r\n  }\r\n}\r\n","class Colour {\r\n  r: number;\r\n  g: number;\r\n  b: number;\r\n  a: number;\r\n  constructor(r: number, g: number, b: number, a: number) {\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n    this.a = a;\r\n  }\r\n}\r\n\r\nexport default Colour;\r\n","export default \"\\r\\nprecision mediump float;\\r\\nprecision mediump int;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\nvarying vec4 v_shadow_pos;\\r\\n\\r\\nuniform sampler2D texture;\\r\\nuniform sampler2D shadowMap;\\r\\nuniform float numLights;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nfloat decodeFloat(vec4 color) {\\r\\n  const vec4 bitShift = vec4(\\r\\n    1.0 / (256.0 * 256.0 * 256.0),\\r\\n    1.0 / (256.0 * 256.0),\\r\\n    1.0 / 256.0,\\r\\n    1\\r\\n  );\\r\\n  return dot(color, bitShift);\\r\\n}\\r\\n\\r\\nfloat random(vec3 seed, int i) {\\r\\n  vec4 seed4 = vec4(seed, i);\\r\\n  float dot_product = dot(seed4, vec4(12.9898, 78.233, 45.164, 94.673));\\r\\n  return fract(sin(dot_product) * 43758.5453);\\r\\n}\\r\\n\\r\\nvec2 poisson(int index) {\\r\\n  if (index == 0)\\r\\n    return vec2(-0.94201624, -0.39906216);\\r\\n  if (index == 1)\\r\\n    return vec2(0.94558609, -0.76890725);\\r\\n  if (index == 2)\\r\\n    return vec2(-0.094184101, -0.92938870);\\r\\n  if (index == 3)\\r\\n    return vec2(0.34495938, 0.29387760);\\r\\n  if (index == 4)\\r\\n    return vec2(-0.91588581, 0.45771432);\\r\\n  if (index == 5)\\r\\n    return vec2(-0.81544232, -0.87912464);\\r\\n  if (index == 6)\\r\\n    return vec2(-0.38277543, 0.27676845);\\r\\n  if (index == 7)\\r\\n    return vec2(0.97484398, 0.75648379);\\r\\n  if (index == 8)\\r\\n    return vec2(0.44323325, -0.97511554);\\r\\n  if (index == 9)\\r\\n    return vec2(0.53742981, -0.47373420);\\r\\n  if (index == 10)\\r\\n    return vec2(-0.26496911, -0.41893023);\\r\\n  if (index == 11)\\r\\n    return vec2(0.79197514, 0.19090188);\\r\\n  if (index == 12)\\r\\n    return vec2(-0.24188840, 0.99706507);\\r\\n  if (index == 13)\\r\\n    return vec2(-0.81409955, 0.91437590);\\r\\n  if (index == 14)\\r\\n    return vec2(0.19984126, 0.78641367);\\r\\n  if (index == 15)\\r\\n    return vec2(0.14383161, -0.14100790);\\r\\n  return vec2(0, 0);\\r\\n}\\r\\n\\r\\nfloat unpackRGBAToDepth(const vec4 v) {\\r\\n  const float UnpackDownscale = 255. / 256.;\\r\\n  const vec3 PackFactors = vec3(256. * 256. * 256., 256. * 256., 256.);\\r\\n  const vec4 UnpackFactors = UnpackDownscale / vec4(PackFactors, 1.);\\r\\n  return dot(v, UnpackFactors);\\r\\n}\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n    gl_FragColor = surfaceColor;\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec4 surfaceColor = texture2D(texture, v_texture_coords);\\r\\n  vec3 diffuse = v_diffuseCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n  vec3 ambient = light1.ambientCoefficient * surfaceColor.rgb * light1.intensities;\\r\\n  vec3 n = normalize(v_normal);\\r\\n  vec3 l = normalize(v_light1_pos);\\r\\n  float cosTheta = clamp(dot(n, l), 0.0, 1.0);\\r\\n\\r\\n  const float texelSize = 1.0 / 1024.0;\\r\\n\\r\\n  float amountInLight = 0.0;\\r\\n\\r\\n  vec3 fragmentDepth = v_shadow_pos.xyz / v_shadow_pos.w;\\r\\n  const float shadowAcneRemover = 0.001;\\r\\n  fragmentDepth.z -= shadowAcneRemover;\\r\\n\\r\\n  float soften = 0.0;\\r\\n  for (int x = -1; x <= 1; x++) {\\r\\n    for (int y = -1; y <= 1; y++) {\\r\\n      float texelDepth = unpackRGBAToDepth(texture2D(shadowMap, fragmentDepth.xy + vec2(x, y) * texelSize));\\r\\n      soften += 1.0;\\r\\n      if (fragmentDepth.z < texelDepth) {\\r\\n        amountInLight += 1.0;\\r\\n      }\\r\\n    }\\r\\n  }\\r\\n\\r\\n  amountInLight /= soften;\\r\\n\\r\\n  vec3 linearColor = ambient + amountInLight * v_attenuation * diffuse * cosTheta;\\r\\n  vec3 gamma = vec3(1.0 / 2.2);\\r\\n  gl_FragColor = vec4(pow(linearColor, gamma), surfaceColor.a);\\r\\n}\\r\\n\";","import RenderOption, { ShaderType, RenderType } from \"./Data/RenderOption\";\r\nimport Entity3DProgram from \"./WebGL/EntityProgram/Entity3DProgram\";\r\nimport EntityColourProgram from \"./WebGL/EntityProgram/EntityColorProgram\";\r\nimport WebGLContext from \"./WebGL/Base/WebGLContext\";\r\nimport Texture from \"./Buffer/Texture\";\r\nimport NotificationQueue, {\r\n  Notification,\r\n  NotificationPayload,\r\n} from \"./Common/NotificationQueue\";\r\nimport WorldDelegate from \"./WorldDelegate\";\r\nimport Camera from \"./Camera\";\r\nimport { ShaderEntity } from \"./EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"./EngineHelper\";\r\nimport Light from \"./Data/Light\";\r\nimport { WebGLContainer } from \"./App\";\r\nimport SubscriberPool, { Subscription } from \"./Common/SubscriberPool\";\r\nimport ModelData from \"./Data/ModelData\";\r\n\r\nexport class RendererSubscription {\r\n  static CREATE_TEXTURE: Subscription = new Subscription(\r\n    \"Renderer#CreateTexture\"\r\n  );\r\n  static REGISTER_ENTITY: Subscription = new Subscription(\r\n    \"Renderer#RegisterEntity\"\r\n  );\r\n  static createTexturePayload = (\r\n    object: ShaderEntity,\r\n    resourcesLoading: Promise<any>[]\r\n  ) => [object, resourcesLoading];\r\n  static registerEntityPayload = (entity: ShaderEntity, buffer: ModelData) => [\r\n    entity,\r\n    buffer,\r\n  ];\r\n}\r\n\r\nexport class RendererNotification {\r\n  static NOTIFICATION_PRE_RENDER_KEY = \"Renderer#Prerender\";\r\n  static NOTIFICATION_RENDER_KEY = \"Renderer#Render\";\r\n  static NOTIFICATION_INIT_KEY = \"Renderer#Init\";\r\n  static UPDATE_PROJECTION_MATRIX: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"UPDATE_PROJECTION_MATRIX\"\r\n  );\r\n  static RESIZE_SCREEN: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"RESIZE_SCREEN\"\r\n  );\r\n  static CREATE_TEXTURE: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_INIT_KEY,\r\n    \"CREATE_TEXTURE\"\r\n  );\r\n  static REGISTER_ENTITY: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_INIT_KEY,\r\n    \"REGISTER_ENTITY\"\r\n  );\r\n  static registerEntity = (entity: ShaderEntity, modelData: ModelData) =>\r\n    NotificationPayload.from(RendererNotification.REGISTER_ENTITY, [\r\n      entity,\r\n      modelData,\r\n    ]);\r\n  static UPDATE_BUFFER: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"UPDATE_BUFFER\"\r\n  );\r\n  static updateBuffer = (entity: ShaderEntity, buffer: number[]) =>\r\n    NotificationPayload.from(RendererNotification.UPDATE_BUFFER, [\r\n      entity,\r\n      buffer,\r\n    ]);\r\n  static createTexture = (\r\n    object: ShaderEntity,\r\n    resourcesLoading: Promise<any>[]\r\n  ) =>\r\n    NotificationPayload.from(RendererNotification.CREATE_TEXTURE, [\r\n      object,\r\n      resourcesLoading,\r\n    ]);\r\n\r\n  static SET_LIGHTING: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_PRE_RENDER_KEY,\r\n    \"SET_LIGHTING\"\r\n  );\r\n  static setLighting = (light: Light) =>\r\n    NotificationPayload.from(RendererNotification.SET_LIGHTING, [light]);\r\n\r\n  static RENDER_ENTITY: Notification = new Notification(\r\n    RendererNotification.NOTIFICATION_RENDER_KEY,\r\n    \"RENDER_ENTITY\"\r\n  );\r\n  static renderEntity = (entity: ShaderEntity, model: Float32List) =>\r\n    NotificationPayload.from(RendererNotification.RENDER_ENTITY, [\r\n      entity,\r\n      model,\r\n    ]);\r\n}\r\n\r\nclass Renderer {\r\n  webGLContainer: WebGLContainer;\r\n  ctx: WebGLRenderingContext;\r\n  shader3DProgram: Entity3DProgram;\r\n  shaderColourProgram: EntityColourProgram;\r\n  textureReg: { [key: string]: any } = {};\r\n  world: WorldDelegate;\r\n  camera: Camera;\r\n  _renderEntities: { [key: number]: [ShaderEntity, Float32List][] } = {};\r\n  notificationQueue: NotificationQueue;\r\n  subscriberPool: SubscriberPool;\r\n  glContext: WebGLContext;\r\n  cachedModelData: { [key: number]: number } = {};\r\n  private enableLighting: boolean;\r\n\r\n  constructor(\r\n    args: { [key: string]: any },\r\n    webGLContainer: WebGLContainer,\r\n    camera: Camera,\r\n    notificationQueue: NotificationQueue,\r\n    subscriberPool: SubscriberPool\r\n  ) {\r\n    if (!args.world) {\r\n      throw new Error(\"world not defined\");\r\n    }\r\n    this.notificationQueue = notificationQueue;\r\n    this.subscriberPool = subscriberPool;\r\n    this.camera = camera;\r\n    this.world = args.world;\r\n    this.webGLContainer = webGLContainer;\r\n    this.ctx = this.webGLContainer.getCtx();\r\n    this.glContext = new WebGLContext(this.ctx);\r\n    this.glContext.setupDefault();\r\n    this.enableLighting = args.enableLighting !== undefined ? args.enableLighting : true;\r\n\r\n    this.subscriberPool.listen(RendererSubscription.CREATE_TEXTURE, (data) => {\r\n      const [object, resourcesLoading] = data;\r\n      this.createTexture(object, resourcesLoading);\r\n    });\r\n    this.subscriberPool.listen(RendererSubscription.REGISTER_ENTITY, (data) => {\r\n      const [entity, buffer] = data;\r\n      this.registerEntity(entity, buffer);\r\n    });\r\n  }\r\n\r\n  resizeViewPort = () => {\r\n    this.glContext.resizeViewPort(this.webGLContainer.canvas);\r\n  };\r\n\r\n  updatePerspective = () => {\r\n    if (this.camera.renderMode === '3d') {\r\n      if (this.shader3DProgram) {\r\n        this.shader3DProgram.updatePerspective(this.camera.camera3d.frustum);\r\n      }\r\n      if (this.shaderColourProgram) {\r\n        this.shaderColourProgram.updatePerspective(this.camera.camera3d.frustum);\r\n      }\r\n    } else {\r\n      if (this.shader3DProgram) {\r\n        this.shader3DProgram.updatePerspective(this.camera.camera2d.frustum);\r\n      }\r\n      if (this.shaderColourProgram) {\r\n        this.shaderColourProgram.updatePerspective(this.camera.camera2d.frustum);\r\n      }\r\n    }\r\n  };\r\n\r\n  delete = () => {\r\n    Object.values(this.textureReg).forEach((texReg: any) => {\r\n      const texture = texReg.texture;\r\n      if (texture.texture) {\r\n        this.glContext.deleteTexture(texture.texture);\r\n      }\r\n      texture.texture = undefined;\r\n      texture.texUnit = undefined;\r\n    });\r\n    Texture.textureCount = 0;\r\n\r\n    if (this.shader3DProgram) {\r\n      this.shader3DProgram.delete();\r\n    }\r\n    if (this.shaderColourProgram) {\r\n      this.shaderColourProgram.delete();\r\n    }\r\n    this.glContext.destroyWebGL();\r\n  };\r\n\r\n  setLighting = (light: Light) => {\r\n    if (this.shader3DProgram) {\r\n      const activeCamera = this.camera.renderMode === '3d' ? this.camera.camera3d : this.camera.camera2d;\r\n      this.shader3DProgram.setLight(light, activeCamera);\r\n    } else {\r\n      throw new Error(\"Lighting is set without any 3D entities\");\r\n    }\r\n  };\r\n\r\n  updateBuffer = (entity: ShaderEntity, buffer: number[]) => {\r\n    const opt = entity.getOpt();\r\n    const program = this._getProgramOpt(opt);\r\n    program.updateBuffer(entity, buffer);\r\n  };\r\n\r\n  _isPlain(opt: RenderOption) {\r\n    return opt.renderType === RenderType.PLAIN;\r\n  }\r\n\r\n  _getProgram3D = (opt: RenderOption) => {\r\n    let program;\r\n    if (this._isPlain(opt)) {\r\n      throw new Error(\"Plain no longer supported\");\r\n    } else {\r\n      program = this.shader3DProgram;\r\n    }\r\n    return program;\r\n  };\r\n\r\n  _getProgramOpt = (opt: RenderOption) => {\r\n    let program;\r\n    if (ShaderType.COLOUR === opt.shaderType) {\r\n      program = this.shaderColourProgram;\r\n    } else if (\r\n      ShaderType.THREE_DIMENSION === opt.shaderType ||\r\n      ShaderType.TWO_DIMENSION === opt.shaderType\r\n    ) {\r\n      program = this._getProgram3D(opt);\r\n    } else {\r\n      throw new Error(\"unsupported opt shader type\");\r\n    }\r\n    return program;\r\n  };\r\n\r\n  _defRenderTop(isTop: boolean) {\r\n    // render colour\r\n    const colourModel = this._renderEntities[ShaderType.COLOUR].filter(\r\n      (e) => !!e[0].isTop === isTop\r\n    );\r\n    if (colourModel.length > 0) {\r\n      this.shaderColourProgram.render(colourModel, this.camera.camera2d);\r\n    }\r\n\r\n    const model3d = this._renderEntities[ShaderType.THREE_DIMENSION].filter(\r\n      (e) => !!e[0].isTop === isTop\r\n    );\r\n    if (model3d.length > 0) {\r\n      this.shader3DProgram.render3DShadowMap(model3d, this.resizeViewPort);\r\n      this.shader3DProgram.render(\r\n        model3d,\r\n        this.camera.camera3d,\r\n        this.textureReg,\r\n        false\r\n      );\r\n    }\r\n\r\n    const model2d = this._renderEntities[ShaderType.TWO_DIMENSION].filter(\r\n      (e) => !!e[0].isTop === isTop\r\n    );\r\n    if (model2d.length > 0) {\r\n      this.shader3DProgram.render(\r\n        model2d,\r\n        this.camera.camera2d,\r\n        this.textureReg,\r\n        true\r\n      );\r\n    }\r\n  }\r\n\r\n  _defRender = () => {\r\n    this._defRenderTop(false);\r\n    this._defRenderTop(true);\r\n  };\r\n\r\n  init() {\r\n    this.readMessages(RendererNotification.NOTIFICATION_INIT_KEY);\r\n    this.shader3DProgram?.toggleLighting(this.enableLighting);\r\n  }\r\n\r\n  readMessages(key: string, isUniqueAction = false) {\r\n    let message: NotificationPayload | undefined;\r\n    const unique: { [key: string]: boolean | undefined } = {};\r\n    while ((message = this.notificationQueue.take(key))) {\r\n      if (!isUniqueAction || unique[message.action] === undefined) {\r\n        this.handleNotification(message);\r\n        if (isUniqueAction) {\r\n          unique[message.action] = true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _render = (entity: ShaderEntity, model: Float32List) => {\r\n    if (entity.hidden) {\r\n      return;\r\n    }\r\n\r\n    const opt = entity.getOpt();\r\n    const payload: [ShaderEntity, Float32List] = [entity, model];\r\n    if (ShaderType.COLOUR === opt.shaderType) {\r\n      this._renderEntities[ShaderType.COLOUR].push(payload);\r\n    } else if (ShaderType.THREE_DIMENSION === opt.shaderType) {\r\n      this._renderEntities[ShaderType.THREE_DIMENSION].push(payload);\r\n    } else if (ShaderType.TWO_DIMENSION === opt.shaderType) {\r\n      this._renderEntities[ShaderType.TWO_DIMENSION].push(payload);\r\n    }\r\n  };\r\n\r\n  bindBuffer = () => {\r\n    if (this.shader3DProgram) {\r\n      this.shader3DProgram.bindBuffer();\r\n    }\r\n    if (this.shaderColourProgram) {\r\n      this.shaderColourProgram.bindBuffer();\r\n    }\r\n  };\r\n\r\n  _lazyLoadProgram(opt: RenderOption) {\r\n    if (ShaderType.COLOUR === opt.shaderType) {\r\n      if (!this.shaderColourProgram) {\r\n        this.shaderColourProgram = new EntityColourProgram(this.ctx);\r\n      }\r\n    } else if (\r\n      ShaderType.THREE_DIMENSION === opt.shaderType ||\r\n      ShaderType.TWO_DIMENSION === opt.shaderType\r\n    ) {\r\n      if (!this.shader3DProgram) {\r\n        this.shader3DProgram = new Entity3DProgram(this.ctx);\r\n      }\r\n    } else {\r\n      console.error(this, opt);\r\n      throw new Error(\"unsupported opt shader type\");\r\n    }\r\n\r\n    this.updatePerspective();\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity, modelData: ModelData) {\r\n    const opt = object.getOpt();\r\n    this._lazyLoadProgram(opt);\r\n    const program = this._getProgramOpt(opt);\r\n    if (!this.cachedModelData[modelData.$id]) {\r\n      program.registerEntity(object, modelData.vertices);\r\n      this.cachedModelData[modelData.$id] = object.rendererBufferId!;\r\n    } else {\r\n      object.rendererBufferId = this.cachedModelData[modelData.$id];\r\n    }\r\n  }\r\n\r\n  _resetDefferred = () => {\r\n    this._renderEntities = {\r\n      [ShaderType.COLOUR]: [],\r\n      [ShaderType.THREE_DIMENSION]: [],\r\n      [ShaderType.TWO_DIMENSION]: [],\r\n    };\r\n  };\r\n\r\n  handleNotification = (notification: NotificationPayload) => {\r\n    let updatePerspective = false;\r\n    switch (notification.action) {\r\n      case RendererNotification.RENDER_ENTITY.action:\r\n        this._render(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.UPDATE_PROJECTION_MATRIX.action:\r\n        updatePerspective = true;\r\n        break;\r\n      case RendererNotification.RESIZE_SCREEN.action:\r\n        this.resizeViewPort();\r\n        updatePerspective = true;\r\n        break;\r\n      case RendererNotification.CREATE_TEXTURE.action:\r\n        this.createTexture(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.UPDATE_BUFFER.action:\r\n        this.updateBuffer(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.REGISTER_ENTITY.action:\r\n        this.registerEntity(notification.data[0], notification.data[1]);\r\n        break;\r\n      case RendererNotification.SET_LIGHTING.action:\r\n        this.setLighting(notification.data[0]);\r\n        break;\r\n      default:\r\n        console.error(\"unhandled notification: \", notification);\r\n        break;\r\n    }\r\n    if (updatePerspective) {\r\n      this.updatePerspective();\r\n    }\r\n  };\r\n\r\n  render(time: number, engineHelper: EngineHelper) {\r\n    this.glContext.clear();\r\n\r\n    this.readMessages(RendererNotification.NOTIFICATION_PRE_RENDER_KEY, true);\r\n\r\n    this.camera.commitProjectionView();\r\n\r\n    engineHelper.setTime(time);\r\n\r\n    // reinitialse next cycle\r\n    this._resetDefferred();\r\n\r\n    this.world.render();\r\n    engineHelper.renderFont();\r\n\r\n    this.readMessages(RendererNotification.NOTIFICATION_RENDER_KEY);\r\n\r\n    this._defRender();\r\n  }\r\n\r\n  createTexture(object: ShaderEntity, resourcesLoading: Promise<any>[]) {\r\n    const src = object.getTextureSource();\r\n    if (src === undefined) {\r\n      console.error(\"src is undefined when trying to create texture\", object);\r\n      throw new Error(\"src is undefined when trying to create texture\");\r\n    }\r\n    object.rendererTextureRef = src;\r\n    const textureReg = this.textureReg[src];\r\n    if (!textureReg) {\r\n      const texture = new Texture(src, this.ctx);\r\n      this.textureReg[src] = {\r\n        texture: texture,\r\n      };\r\n      resourcesLoading.push(texture.load);\r\n    } else if (textureReg.texture && textureReg.texture.error) {\r\n      console.error(\r\n        \"there was an error while trying to load texture\",\r\n        textureReg\r\n      );\r\n      throw new Error(\"there was an error while trying to load texture\");\r\n    }\r\n  }\r\n}\r\nexport default Renderer;\r\n","import {\r\n  App,\r\n  EngineEvent,\r\n  EngineObject,\r\n  Events,\r\n  Object3d,\r\n  ObjectManager,\r\n  Plane3d,\r\n  PlaneType,\r\n  Rect3d,\r\n  ResourceResolver,\r\n  FontReference,\r\n  Coordinate,\r\n  Light,\r\n  Moveable\r\n} from \"synaren-engine\";\r\nimport Cube from \"./Cube\";\r\nimport Sphere from \"./Sphere\";\r\n\r\ninterface RacingBot {\r\n  car: Moveable;  // Use Moveable for physics-based movement\r\n  position: { x: number, y: number, z: number };\r\n  speed: number;\r\n  currentWaypoint: number;\r\n  name: string;\r\n  rotation: number;\r\n  nameText: FontReference | any; // Allow any type for font fallback\r\n}\r\n\r\ninterface Waypoint {\r\n  x: number;\r\n  z: number;\r\n}\r\n\r\nexport default class RacingGame extends ObjectManager {\r\n  // Game state\r\n  gameStarted: boolean = false;\r\n  gameEnded: boolean = false;\r\n  raceTime: number = 0;\r\n  currentLap: number = 1;\r\n  totalLaps: number = 3;\r\n  raceFinished: boolean = false;\r\n\r\n  // Racing objects\r\n  playerCar: Object3d;\r\n  bots: RacingBot[] = [];\r\n  ground: Plane3d;\r\n  sky: Sphere;\r\n  trackBarriers: Cube[] = [];\r\n  waypointTiles: Cube[] = [];\r\n\r\n  // Movement speeds\r\n  crowd: Object3d[] = []; // Low poly girls as crowd\r\n  trees: Object3d[] = []; // Low poly trees for nature scenery\r\n\r\n  // Race track waypoints (defines the racing line) - Simplified track within 1000x1000 ground\r\n  waypoints: Waypoint[] = [\r\n    // Start/Finish line\r\n    { x: 0, z: 0 },\r\n    \r\n    // First sector - right turn\r\n    { x: 150, z: 0 },\r\n    { x: 250, z: 100 },\r\n    { x: 250, z: 200 },\r\n    \r\n    // Second sector - top straight and left turn\r\n    { x: 200, z: 300 },\r\n    { x: 50, z: 350 },\r\n    { x: -100, z: 300 },\r\n    \r\n    // Third sector - left side and hairpin\r\n    { x: -200, z: 200 },\r\n    { x: -250, z: 50 },\r\n    { x: -200, z: -100 },\r\n    \r\n    // Fourth sector - bottom straight and return\r\n    { x: -50, z: -150 },\r\n    { x: 100, z: -100 },\r\n    { x: 0, z: -50 },\r\n    \r\n    // Complete the loop back to start\r\n    { x: 0, z: 0 }\r\n  ];\r\n\r\n  // Player controls - Slower for better visibility\r\n  playerSpeed: number = 0;\r\n  maxSpeed: number = 0.4;  // Reduced from 0.8 to 0.4\r\n  acceleration: number = 0.015;  // Reduced acceleration\r\n  deceleration: number = 0.02;   // Reduced deceleration\r\n  turnSpeed: number = 0.025;     // Reduced turn speed\r\n  playerRotation: number = 0;\r\n  playerPosition: { x: number, y: number, z: number } = { x: 0, y: 0, z: 0 }; // Better starting position on ground\r\n  keys: { [key: string]: boolean } = {};\r\n\r\n  // Game timer\r\n  lastWaypoint: number = 0;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  createGameObjects() {\r\n    try {\r\n      console.log('Creating game objects...');\r\n\r\n      // Create simple ground plane\r\n      this.ground = new Plane3d(\r\n        new Rect3d(0.0, 0.0, 0.0, 1000, 0, 1000),\r\n        this.engineHelper.newVertexModel(\"grass\", PlaneType.XZ)\r\n      );\r\n      this.addEntity(this.ground);\r\n\r\n      // Create sky sphere\r\n      this.sky = new Sphere(\r\n        new Rect3d(0.0, 10.0, 0.0, 200.0, 200.0, 200.0),\r\n        \"background\"\r\n      );\r\n      this.addEntity(this.sky);\r\n\r\n      // Create player car\r\n      this.createPlayerCar();\r\n\r\n      // Create bot cars\r\n      this.createBotCars();\r\n\r\n      // Create fewer crowd members to reduce complexity\r\n      this.createSimpleCrowd();\r\n\r\n      // Create trees for atmosphere\r\n      this.createTrees();\r\n\r\n      console.log(' Game objects created successfully!');\r\n    } catch (error) {\r\n      console.error('Error creating game objects:', error);\r\n    }\r\n  }\r\n\r\n  createSimpleCrowd() {\r\n    // Create minimal crowd dynamically based on waypoints for performance\r\n    const crowdPositions: {x: number, z: number}[] = [];\r\n    \r\n    // Calculate the center point of the track\r\n    const centerX = this.waypoints.reduce((sum, wp) => sum + wp.x, 0) / this.waypoints.length;\r\n    const centerZ = this.waypoints.reduce((sum, wp) => sum + wp.z, 0) / this.waypoints.length;\r\n    \r\n    // Place crowd members around key waypoints (every 5th waypoint to reduce crowd)\r\n    for (let i = 0; i < this.waypoints.length; i += 5) {\r\n      const waypoint = this.waypoints[i];\r\n      \r\n      // Calculate direction from waypoint to track center\r\n      const dx = centerX - waypoint.x;\r\n      const dz = centerZ - waypoint.z;\r\n      const distance = Math.sqrt(dx * dx + dz * dz);\r\n      \r\n      if (distance > 0) {\r\n        // Normalize direction\r\n        const normalizedDx = dx / distance;\r\n        const normalizedDz = dz / distance;\r\n        \r\n        // Place crowd members on the inside of the track (toward center)\r\n        const crowdDistance = 15; // Distance from waypoint toward center\r\n        const crowdX = waypoint.x + normalizedDx * crowdDistance;\r\n        const crowdZ = waypoint.z + normalizedDz * crowdDistance;\r\n        \r\n        crowdPositions.push({ x: crowdX, z: crowdZ });\r\n        \r\n        // Add only one variation around each main position (was 2)\r\n        crowdPositions.push(\r\n          { x: crowdX + (Math.random() - 0.5) * 12, z: crowdZ + (Math.random() - 0.5) * 12 }\r\n        );\r\n      }\r\n    }\r\n    \r\n    // Add minimal crowd in the calculated center area (reduced from 8 to 4)\r\n    for (let i = 0; i < 4; i++) {\r\n      crowdPositions.push({\r\n        x: centerX + (Math.random() - 0.5) * 30,\r\n        z: centerZ + (Math.random() - 0.5) * 30\r\n      });\r\n    }\r\n\r\n    crowdPositions.forEach((pos, index) => {\r\n      try {\r\n        const crowdMember = new Object3d(\r\n          new Rect3d(pos.x, 1.5, pos.z, 2, 2, 2),\r\n          \"low_poly_girl\"\r\n        );\r\n        \r\n        crowdMember.scale(1, 1, 1);\r\n        crowdMember.angleY(Math.random() * 360);\r\n        \r\n        this.crowd.push(crowdMember);\r\n        this.addEntity(crowdMember);\r\n      } catch (error) {\r\n        console.warn('Failed to create crowd member:', error);\r\n      }\r\n    });\r\n\r\n    console.log(`Created ${this.crowd.length} crowd members dynamically based on waypoints`);\r\n    console.log(`Track center calculated at: (${centerX.toFixed(1)}, ${centerZ.toFixed(1)})`);\r\n  }\r\n\r\n  createTrees() {\r\n    // Create minimal trees dynamically based on waypoints for performance\r\n    const treePositions: {x: number, z: number}[] = [];\r\n    \r\n    // Calculate track bounds from waypoints\r\n    const minX = Math.min(...this.waypoints.map(wp => wp.x));\r\n    const maxX = Math.max(...this.waypoints.map(wp => wp.x));\r\n    const minZ = Math.min(...this.waypoints.map(wp => wp.z));\r\n    const maxZ = Math.max(...this.waypoints.map(wp => wp.z));\r\n    \r\n    // Calculate track center\r\n    const centerX = (minX + maxX) / 2;\r\n    const centerZ = (minZ + maxZ) / 2;\r\n    \r\n    // Create fewer perimeter trees around the track bounds (increased spacing)\r\n    const perimeterPadding = 60;\r\n    const treeSpacing = 50; // Increased from 25 to 50 for fewer trees\r\n    \r\n    // North and South perimeter (fewer trees)\r\n    for (let x = minX - perimeterPadding; x <= maxX + perimeterPadding; x += treeSpacing) {\r\n      treePositions.push(\r\n        { x: x, z: minZ - perimeterPadding },  // North\r\n        { x: x, z: maxZ + perimeterPadding }   // South\r\n      );\r\n    }\r\n    \r\n    // East and West perimeter (fewer trees)\r\n    for (let z = minZ - perimeterPadding; z <= maxZ + perimeterPadding; z += treeSpacing) {\r\n      treePositions.push(\r\n        { x: minX - perimeterPadding, z: z },  // West\r\n        { x: maxX + perimeterPadding, z: z }   // East\r\n      );\r\n    }\r\n    \r\n    // Create minimal trees around waypoints (every 4th waypoint instead of every 2nd)\r\n    for (let i = 0; i < this.waypoints.length - 1; i += 4) { // Reduced frequency\r\n      const current = this.waypoints[i];\r\n      const next = this.waypoints[i + 1];\r\n      \r\n      // Calculate perpendicular direction for placing trees beside the track\r\n      const dx = next.x - current.x;\r\n      const dz = next.z - current.z;\r\n      const length = Math.sqrt(dx * dx + dz * dz);\r\n      \r\n      if (length > 0) {\r\n        // Normalize direction vector\r\n        const normalizedDx = dx / length;\r\n        const normalizedDz = dz / length;\r\n        \r\n        // Perpendicular vectors for track sides\r\n        const perpX = -normalizedDz;\r\n        const perpZ = normalizedDx;\r\n        \r\n        const treeDistance = 25 + Math.random() * 10; // 25-35 units from track\r\n        \r\n        // Only one tree per side (not both sides)\r\n        treePositions.push({\r\n          x: current.x + perpX * treeDistance,\r\n          z: current.z + perpZ * treeDistance\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Create fewer forest clusters (reduced from 8 to 4 clusters)\r\n    const clusterCenters = [\r\n      { x: centerX + 120, z: centerZ + 120 },\r\n      { x: centerX - 120, z: centerZ + 120 },\r\n      { x: centerX + 120, z: centerZ - 120 },\r\n      { x: centerX - 120, z: centerZ - 120 }\r\n    ];\r\n    \r\n    clusterCenters.forEach(cluster => {\r\n      // Create fewer trees per cluster (3-5 instead of 8-12)\r\n      const treesPerCluster = 3 + Math.floor(Math.random() * 3);\r\n      for (let i = 0; i < treesPerCluster; i++) {\r\n        treePositions.push({\r\n          x: cluster.x + (Math.random() - 0.5) * 30,\r\n          z: cluster.z + (Math.random() - 0.5) * 30\r\n        });\r\n      }\r\n    });\r\n    \r\n    // Filter out trees that are too close to the racing line\r\n    const filteredTreePositions = treePositions.filter(treePos => {\r\n      // Check distance to all waypoints\r\n      return this.waypoints.every(waypoint => {\r\n        const distance = Math.sqrt(\r\n          Math.pow(treePos.x - waypoint.x, 2) + \r\n          Math.pow(treePos.z - waypoint.z, 2)\r\n        );\r\n        return distance > 12; // Minimum 12 units from racing line\r\n      });\r\n    });\r\n\r\n    filteredTreePositions.forEach((pos, index) => {\r\n      try {\r\n        const tree = new Object3d(\r\n          new Rect3d(pos.x, 0.5, pos.z, 6, 6, 6), // Trees at ground level\r\n          \"low_poly_tree\"\r\n        );\r\n        \r\n        // Make trees bigger and more varied\r\n        const scale = 2.5 + Math.random() * 2.0; // Scale between 2.5 and 4.5 (bigger trees)\r\n        tree.scale(scale, scale, scale);\r\n        tree.angleY(Math.random() * 360);\r\n        \r\n        this.trees.push(tree);\r\n        this.addEntity(tree);\r\n      } catch (error) {\r\n        console.warn('Failed to create tree:', error);\r\n      }\r\n    });\r\n\r\n    console.log(`Created ${this.trees.length} trees dynamically around the track`);\r\n    console.log(`Track bounds: X(${minX.toFixed(1)} to ${maxX.toFixed(1)}), Z(${minZ.toFixed(1)} to ${maxZ.toFixed(1)})`);\r\n    console.log(`Filtered ${treePositions.length - filteredTreePositions.length} trees too close to racing line`);\r\n  }\r\n\r\n \r\n  createPlayerCar() {\r\n    this.playerCar = new Object3d(\r\n      new Rect3d(this.playerPosition.x, this.playerPosition.y, this.playerPosition.z, 1.5, 1.5, 1.5),\r\n      \"racing_car\"\r\n    );\r\n    this.playerCar.scale(1.5, 1.5, 1.5); // Bigger player car - was 0.5, now 0.8\r\n    this.playerCar.angleY(90); // Start facing forward (0 degrees)\r\n    this.addEntity(this.playerCar);\r\n  }\r\n\r\n  createBotCars() {\r\n    const botNames = ['Speed Demon', 'Thunder Bolt', 'Turbo Racer', 'Lightning Fast'];\r\n\r\n    for (let i = 0; i < 4; i++) {\r\n      // Create simple bot name text (may not render if font system has issues)\r\n      let nameText: any = { center: () => {}, render: () => {} }; // Default fallback\r\n      \r\n      try {\r\n        nameText = FontReference.newFont(\r\n          new Coordinate(0.1 + (i * 0.2), 0.9, 0),\r\n          `bot-${i}-name`\r\n        );\r\n        nameText.setText(botNames[i])\r\n          .setFontSize(18)\r\n          .setTop(true);\r\n      } catch (error) {\r\n        console.warn('Font creation failed, using fallback:', error);\r\n      }\r\n\r\n      // Position bots in a line behind the start, spread out more\r\n      const startX = -12 + (i * 6); // Increased spread: was (i * 4), now (i * 6) for more separation\r\n      const startZ = -10 - (i * 2); // Stagger Z positions more: each bot further back\r\n\r\n      // Create the car as an Object3d\r\n      const carObject = new Object3d(\r\n        new Rect3d(startX, 0, startZ, 1.5, 1.5, 1.5),\r\n        \"racing_car\"\r\n      );\r\n      carObject.scale(0.6, 0.6, 0.6); // Slightly larger for visibility\r\n\r\n      // Create a Moveable wrapper for physics-based movement\r\n      const moveableCar = new Moveable();\r\n      moveableCar.entities.push(carObject);\r\n      moveableCar.center(startX, 0.5, startZ);\r\n      moveableCar.setRect(new Rect3d(startX, 0.5, startZ, 1.5, 1.5, 1.5)); // Set 3D collision bounds\r\n      moveableCar.updatePhysicsPosition();\r\n\r\n      const bot: RacingBot = {\r\n        car: moveableCar,\r\n        position: { x: startX, y: 0, z: startZ },\r\n        speed: 0.08 + (Math.random() * 0.08), // Increased variance: 0.08 to 0.16 (wider spread)\r\n        currentWaypoint: 0, // Start with waypoint 0 (origin)\r\n        name: botNames[i],\r\n        rotation: 0, // Start facing forward\r\n        nameText: nameText\r\n      };\r\n\r\n      this.bots.push(bot);\r\n      this.addEntity(bot.car);\r\n\r\n      console.log(`Created bot ${bot.name} at position (${startX}, ${startZ})`);\r\n    }\r\n  }\r\n\r\n  createCrowd() {\r\n    // Create crowd of low poly girls around the center of the track\r\n    const centerX = 0;\r\n    const centerZ = 27.5; // Center of the track loop\r\n    const crowdPositions = [\r\n      // Inner crowd circle\r\n      { x: centerX - 8, z: centerZ - 8 },\r\n      { x: centerX + 8, z: centerZ - 8 },\r\n      { x: centerX - 8, z: centerZ + 8 },\r\n      { x: centerX + 8, z: centerZ + 8 },\r\n      { x: centerX, z: centerZ - 10 },\r\n      { x: centerX, z: centerZ + 10 },\r\n      { x: centerX - 10, z: centerZ },\r\n      { x: centerX + 10, z: centerZ },\r\n      // Additional crowd around the track\r\n      { x: -15, z: 10 },\r\n      { x: 15, z: 10 },\r\n      { x: -15, z: 45 },\r\n      { x: 15, z: 45 },\r\n    ];\r\n\r\n    crowdPositions.forEach((pos, index) => {\r\n      const crowdMember = new Object3d(\r\n        new Rect3d(pos.x, 1.7, pos.z, 2, 2, 2),\r\n        \"low_poly_girl\"\r\n      );\r\n      \r\n      // Vary the scale and rotation for diversity\r\n      const scale = 0.8 + Math.random() * 0.4; // Scale between 0.8 and 1.2\r\n      crowdMember.scale(scale, scale, scale);\r\n      crowdMember.angleY(Math.random() * 360); // Random rotation\r\n      \r\n      this.crowd.push(crowdMember);\r\n      this.addEntity(crowdMember);\r\n    });\r\n\r\n    console.log(`Created ${this.crowd.length} crowd members`);\r\n  }\r\n\r\n  createWaypointTiles() {\r\n    try {\r\n      // Create bigger tiles to visualize the waypoint path\r\n      for (let i = 0; i < this.waypoints.length - 1; i++) { // -1 to avoid duplicate at start/end\r\n        const waypoint = this.waypoints[i];\r\n        \r\n        // Create a bigger cube tile at each waypoint\r\n        const tile = new Cube(\r\n          new Rect3d(waypoint.x, 0.2, waypoint.z, 5, 0.2, 5), // Bigger tiles: 5x5 instead of 3x3\r\n          \"sky\",\r\n          [\"sky\", \"sky\", \"sky\", \"sky\", \"sky\", \"sky\"]\r\n        );\r\n        \r\n        this.waypointTiles.push(tile);\r\n        this.addEntity(tile);\r\n        tile.init(this.engineHelper);\r\n      }\r\n      \r\n      // Create path connection tiles between waypoints\r\n      for (let i = 0; i < this.waypoints.length - 1; i++) {\r\n        const current = this.waypoints[i];\r\n        const next = this.waypoints[i + 1];\r\n        \r\n        // Calculate distance and direction between waypoints\r\n        const dx = next.x - current.x;\r\n        const dz = next.z - current.z;\r\n        const distance = Math.sqrt(dx * dx + dz * dz);\r\n        \r\n        // Create bigger tiles along the path between waypoints\r\n        const tilesPerSegment = Math.floor(distance / 4); // One tile every 4 units (was 3)\r\n        for (let j = 1; j < tilesPerSegment; j++) {\r\n          const progress = j / tilesPerSegment;\r\n          const x = current.x + dx * progress;\r\n          const z = current.z + dz * progress;\r\n          \r\n          const pathTile = new Cube(\r\n            new Rect3d(x, 0.1, z, 4, 0.1, 4), // Bigger path tiles: 4x4 instead of 3x3\r\n            \"ground\",\r\n            [\"ground\", \"ground\", \"ground\", \"ground\", \"ground\", \"ground\"]\r\n          );\r\n          \r\n          this.waypointTiles.push(pathTile);\r\n          this.addEntity(pathTile);\r\n          pathTile.init(this.engineHelper);\r\n        }\r\n      }\r\n      \r\n      // Create course walls around the track edges\r\n      this.createCourseWalls();\r\n      \r\n      console.log(`Created ${this.waypointTiles.length} bigger waypoint path tiles and course walls`);\r\n    } catch (error) {\r\n      console.error('Error creating waypoint tiles:', error);\r\n    }\r\n  }\r\n\r\n  createCourseWalls() {\r\n    // Create walls derived from waypoints\r\n    const wallHeight = 2;\r\n    const wallThickness = 1;\r\n    const trackWidth = 8; // Distance from track center to wall\r\n    \r\n    // Calculate bounding box from waypoints\r\n    let minX = Math.min(...this.waypoints.map(wp => wp.x));\r\n    let maxX = Math.max(...this.waypoints.map(wp => wp.x));\r\n    let minZ = Math.min(...this.waypoints.map(wp => wp.z));\r\n    let maxZ = Math.max(...this.waypoints.map(wp => wp.z));\r\n    \r\n    // Add padding around the track\r\n    const padding = 15;\r\n    minX -= padding;\r\n    maxX += padding;\r\n    minZ -= padding;\r\n    maxZ += padding;\r\n    \r\n    // Create outer boundary walls based on waypoint extents\r\n    const outerWalls = [\r\n      // North wall (top)\r\n      { x: (minX + maxX) / 2, z: minZ, width: maxX - minX, height: wallHeight, depth: wallThickness },\r\n      // South wall (bottom)\r\n      { x: (minX + maxX) / 2, z: maxZ, width: maxX - minX, height: wallHeight, depth: wallThickness },\r\n      // West wall (left)\r\n      { x: minX, z: (minZ + maxZ) / 2, width: wallThickness, height: wallHeight, depth: maxZ - minZ },\r\n      // East wall (right)\r\n      { x: maxX, z: (minZ + maxZ) / 2, width: wallThickness, height: wallHeight, depth: maxZ - minZ }\r\n    ];\r\n\r\n    outerWalls.forEach((wall, index) => {\r\n      try {\r\n        const wallCube = new Cube(\r\n          new Rect3d(wall.x, wall.height / 2, wall.z, wall.width, wall.height, wall.depth),\r\n          \"rock\", // Use a distinct texture for walls\r\n          [\"rock\", \"rock\", \"rock\", \"rock\", \"rock\", \"rock\"]\r\n        );\r\n        \r\n        this.trackBarriers.push(wallCube);\r\n        this.addEntity(wallCube);\r\n        wallCube.init(this.engineHelper);\r\n      } catch (error) {\r\n        console.warn('Failed to create course wall:', error);\r\n      }\r\n    });\r\n\r\n    // Create inner barriers along the track path\r\n    for (let i = 0; i < this.waypoints.length - 1; i++) {\r\n      const current = this.waypoints[i];\r\n      const next = this.waypoints[i + 1];\r\n      \r\n      // Calculate perpendicular direction for track width\r\n      const dx = next.x - current.x;\r\n      const dz = next.z - current.z;\r\n      const length = Math.sqrt(dx * dx + dz * dz);\r\n      \r\n      if (length > 0) {\r\n        // Normalize direction vector\r\n        const normalizedDx = dx / length;\r\n        const normalizedDz = dz / length;\r\n        \r\n        // Perpendicular vectors for track sides\r\n        const perpX = -normalizedDz;\r\n        const perpZ = normalizedDx;\r\n        \r\n        // Create barriers on both sides of track segments at turns\r\n        if (i % 3 === 0) { // Only at some waypoints to avoid cluttering\r\n          // Left side barrier\r\n          const leftBarrierX = current.x + perpX * trackWidth;\r\n          const leftBarrierZ = current.z + perpZ * trackWidth;\r\n          \r\n          // Right side barrier  \r\n          const rightBarrierX = current.x - perpX * trackWidth;\r\n          const rightBarrierZ = current.z - perpZ * trackWidth;\r\n          \r\n          [\r\n            { x: leftBarrierX, z: leftBarrierZ },\r\n            { x: rightBarrierX, z: rightBarrierZ }\r\n          ].forEach((barrierPos) => {\r\n            try {\r\n              const barrierCube = new Cube(\r\n                new Rect3d(barrierPos.x, wallHeight / 2, barrierPos.z, 2, wallHeight, 2),\r\n                \"rock\",\r\n                [\"rock\", \"rock\", \"rock\", \"rock\", \"rock\", \"rock\"]\r\n              );\r\n              \r\n              this.trackBarriers.push(barrierCube);\r\n              this.addEntity(barrierCube);\r\n              barrierCube.init(this.engineHelper);\r\n            } catch (error) {\r\n              console.warn('Failed to create track barrier:', error);\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log(`Created ${this.trackBarriers.length} course walls and barriers derived from ${this.waypoints.length} waypoints`);\r\n    console.log(`Track bounds: X(${minX.toFixed(1)} to ${maxX.toFixed(1)}), Z(${minZ.toFixed(1)} to ${maxZ.toFixed(1)})`);\r\n  }\r\n\r\n  startRace() {\r\n    this.gameStarted = true;\r\n    console.log(' Race started! Use WASD to control your car.');\r\n    console.log('Bot initial positions and targets:');\r\n    this.bots.forEach((bot, index) => {\r\n      const target = this.waypoints[bot.currentWaypoint];\r\n      console.log(`Bot ${index} (${bot.name}): pos(${bot.position.x}, ${bot.position.z}) -> waypoint ${bot.currentWaypoint} at (${target.x}, ${target.z})`);\r\n    });\r\n  }\r\n\r\n  updatePlayerMovement() {\r\n    if (!this.gameStarted || this.raceFinished) return;\r\n\r\n    // Handle acceleration/deceleration\r\n    if (this.keys['keyw']) {\r\n      this.playerSpeed = Math.min(this.playerSpeed + this.acceleration, this.maxSpeed);\r\n    } else if (this.keys['keys']) {\r\n      this.playerSpeed = Math.max(this.playerSpeed - this.deceleration, -this.maxSpeed * 0.5);\r\n    } else {\r\n      // Natural deceleration\r\n      if (this.playerSpeed > 0) {\r\n        this.playerSpeed = Math.max(0, this.playerSpeed - this.deceleration * 0.5);\r\n      } else {\r\n        this.playerSpeed = Math.min(0, this.playerSpeed + this.deceleration * 0.5);\r\n      }\r\n    }\r\n\r\n    // Handle turning - this will rotate the camera direction\r\n    if (this.keys['keya']) {\r\n      this.playerRotation += this.turnSpeed;\r\n    }\r\n    if (this.keys['keyd']) {\r\n      this.playerRotation -= this.turnSpeed;\r\n    }\r\n\r\n    // Position player car directly in front of camera based on camera direction\r\n    if (this.playerCar && this.engineHelper.camera.camera3d) {\r\n      const camera = this.engineHelper.camera.camera3d;\r\n      \r\n      // Calculate forward direction from camera rotation\r\n      const forwardX = -Math.sin(this.playerRotation);\r\n      const forwardZ = -Math.cos(this.playerRotation);\r\n      \r\n      // Move position forward based on speed\r\n      this.playerPosition.x += forwardX * this.playerSpeed;\r\n      this.playerPosition.z += forwardZ * this.playerSpeed;\r\n      \r\n      // Position car directly in front of camera\r\n      const carDistance = 5; // Distance in front of camera\r\n      this.playerCar.position.x = this.playerPosition.x + forwardX * carDistance;\r\n      this.playerCar.position.y = this.playerPosition.y;\r\n      this.playerCar.position.z = this.playerPosition.z + forwardZ * carDistance;\r\n      this.playerCar.angleY(this.playerRotation * (180 / Math.PI));\r\n    }\r\n\r\n    // Check waypoint progress\r\n    this.checkWaypoints();\r\n  }\r\n\r\n  updateBots() {\r\n    if (!this.gameStarted || this.raceFinished) return;\r\n\r\n    this.bots.forEach((bot, index) => {\r\n      const baseWaypoint = this.waypoints[bot.currentWaypoint];\r\n      \r\n      // Add variance to target waypoint to prevent bots from clustering\r\n      const lateralOffset = (index - 1.5) * 3; // Spread bots across track width (-4.5 to 4.5)\r\n      const randomVariance = (Math.sin(Date.now() * 0.002 + index * 3) * 2); // Small random movement\r\n      \r\n      // Calculate perpendicular direction for lateral positioning\r\n      const nextWaypointIndex = (bot.currentWaypoint + 1) % this.waypoints.length;\r\n      const nextWaypoint = this.waypoints[nextWaypointIndex];\r\n      const trackDx = nextWaypoint.x - baseWaypoint.x;\r\n      const trackDz = nextWaypoint.z - baseWaypoint.z;\r\n      const trackLength = Math.sqrt(trackDx * trackDx + trackDz * trackDz);\r\n      \r\n      let perpX = 0, perpZ = 0;\r\n      if (trackLength > 0) {\r\n        // Perpendicular to track direction for lateral offset\r\n        perpX = -trackDz / trackLength;\r\n        perpZ = trackDx / trackLength;\r\n      }\r\n      \r\n      // Create varied target waypoint\r\n      const targetWaypoint = {\r\n        x: baseWaypoint.x + perpX * (lateralOffset + randomVariance),\r\n        z: baseWaypoint.z + perpZ * (lateralOffset + randomVariance)\r\n      };\r\n\r\n      // Calculate direction to varied target waypoint\r\n      const dx = targetWaypoint.x - bot.position.x;\r\n      const dz = targetWaypoint.z - bot.position.z;\r\n      const distance = Math.sqrt(dx * dx + dz * dz);\r\n\r\n      // Debug logging for first bot (reduced frequency)\r\n      if (index === 0 && Math.random() < 0.01) { // Less frequent logging\r\n        console.log(`Bot ${bot.name}: pos(${bot.position.x.toFixed(1)}, ${bot.position.z.toFixed(1)}) -> varied waypoint ${bot.currentWaypoint} at (${targetWaypoint.x.toFixed(1)}, ${targetWaypoint.z.toFixed(1)}) distance: ${distance.toFixed(1)}`);\r\n      }\r\n\r\n      // Check if reached base waypoint (use original waypoint for progression)\r\n      const baseDistance = Math.sqrt(\r\n        Math.pow(bot.position.x - baseWaypoint.x, 2) + \r\n        Math.pow(bot.position.z - baseWaypoint.z, 2)\r\n      );\r\n      if (baseDistance < 5) { // Larger threshold for more reliable waypoint detection\r\n        bot.currentWaypoint = (bot.currentWaypoint + 1) % this.waypoints.length;\r\n        console.log(`Bot ${bot.name} reached waypoint, moving to waypoint ${bot.currentWaypoint}`);\r\n      }\r\n\r\n      // Direct movement for reliable bot AI with left-right variance\r\n      if (distance > 0.1 && distance < 200) { // Prevent extreme movements\r\n        // Normalize direction vector\r\n        const normalizedDx = dx / distance;\r\n        const normalizedDz = dz / distance;\r\n        \r\n        // Add left-right variance to prevent bots driving on top of each other\r\n        const lateralVariance = (Math.sin(Date.now() * 0.001 + index * 2) * 0.3) + (index - 1.5) * 0.1; // Different pattern per bot\r\n        const perpX = -normalizedDz; // Perpendicular to direction\r\n        const perpZ = normalizedDx;\r\n        \r\n        // Move bot towards target waypoint with lateral variance\r\n        bot.position.x += (normalizedDx * bot.speed) + (perpX * lateralVariance * 0.05);\r\n        bot.position.z += (normalizedDz * bot.speed) + (perpZ * lateralVariance * 0.05);\r\n\r\n        // Calculate rotation to face movement direction\r\n        // Fix the rotation calculation - use correct coordinate system\r\n        bot.rotation = Math.atan2(normalizedDx, normalizedDz) * (180 / Math.PI); // Fixed: removed negative from dz\r\n\r\n        // Update the Moveable car's position to match bot position\r\n        bot.car.center(bot.position.x, bot.position.y, bot.position.z);\r\n        bot.car.angleY(bot.rotation);\r\n        \r\n        // Also update the internal Object3d position for proper rendering\r\n        if (bot.car.entities.length > 0) {\r\n          const carObject = bot.car.entities[0];\r\n          carObject.center(bot.position.x, bot.position.y, bot.position.z);\r\n          carObject.angleY(bot.rotation);\r\n        }\r\n      }\r\n\r\n      // Update name text position (screen overlay)\r\n      if (bot.nameText) {\r\n        try {\r\n          const screenX = 0.1 + (index * 0.2); // Spread names across top\r\n          const screenY = 0.9; // Near top of screen\r\n          bot.nameText.center(screenX, screenY);\r\n        } catch (error) {\r\n          // Font system may not be ready, ignore silently\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  checkWaypoints() {\r\n    const currentWaypoint = this.waypoints[this.lastWaypoint];\r\n    const dx = this.playerPosition.x - currentWaypoint.x;\r\n    const dz = this.playerPosition.z - currentWaypoint.z;\r\n    const distance = Math.sqrt(dx * dx + dz * dz);\r\n\r\n    if (distance < 3) {\r\n      this.lastWaypoint = (this.lastWaypoint + 1) % this.waypoints.length;\r\n\r\n      // Check if completed a lap\r\n      if (this.lastWaypoint === 0) {\r\n        this.currentLap++;\r\n        console.log(` Lap ${this.currentLap - 1} completed!`);\r\n\r\n        if (this.currentLap > this.totalLaps) {\r\n          this.finishRace();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  finishRace() {\r\n    this.raceFinished = true;\r\n    console.log(' Race finished!');\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject, index: number) => ent.render(this.engineHelper));\r\n    \r\n    // Temporarily disable font rendering to focus on bot movement\r\n    // TODO: Re-enable when font system is stable\r\n    // if (this.gameStarted) {\r\n    //   this.bots.forEach((bot) => {\r\n    //     try {\r\n    //       bot.nameText.render(this.engineHelper);\r\n    //     } catch (error) {\r\n    //       console.warn('Font rendering error:', error);\r\n    //     }\r\n    //   });\r\n    // }\r\n  }\r\n\r\n  update() {\r\n    if (this.gameStarted && !this.raceFinished) {\r\n      this.raceTime += 1 / 60; // Assuming 60 FPS\r\n    }\r\n\r\n    this.updatePlayerMovement();\r\n    this.updateBots();\r\n\r\n    this.entities.forEach((ent: EngineObject) => ent.update(this.engineHelper));\r\n\r\n    // Update sky position to follow camera\r\n    const { x, y, z } = this.engineHelper.camera.camera3d.position;\r\n    if (this.sky) {\r\n      this.sky.center(x, y, z);\r\n    }\r\n\r\n    // Update camera to follow player - Fixed camera system\r\n    if (this.playerCar) {\r\n      const cameraOffset = 15;  // Distance behind car\r\n      const cameraHeight = 8;   // Height above car\r\n      \r\n      // Calculate camera position based on player position and rotation\r\n      const cameraX = this.playerPosition.x - Math.sin(this.playerRotation) * cameraOffset;\r\n      const cameraZ = this.playerPosition.z + Math.cos(this.playerRotation) * cameraOffset;\r\n      const cameraY = this.playerPosition.y + cameraHeight;\r\n\r\n      // Position camera behind player\r\n      this.engineHelper.camera.camera3d.center(cameraX, cameraY, cameraZ);\r\n      \r\n      // Look at the player position (not the car position which is offset)\r\n      this.engineHelper.camera.camera3d.lookAt(\r\n        this.playerPosition.x, \r\n        this.playerPosition.y + 1, \r\n        this.playerPosition.z\r\n      );\r\n      \r\n      this.engineHelper.camera.camera3d.updateProjectionView();\r\n    }\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    // Handle keyboard events\r\n    if (event.eventType === Events.KEY_DOWN) {\r\n      const keyEvent = event as any;\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = true;\r\n\r\n        // Start game on spacebar\r\n        if (keyEvent.code === 'Space' && !this.gameStarted && !this.gameEnded) {\r\n          this.startRace();\r\n        }\r\n      }\r\n    }\r\n\r\n    if (event.eventType === Events.KEY_UP) {\r\n      const keyEvent = event as any;\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = false;\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  init() {\r\n    // Simplified initialization\r\n    console.log(' Initializing Racing Game...');\r\n\r\n    // Set up basic lighting\r\n    this.engineHelper.setLighting(\r\n      new Light({\r\n        pos: [0.0, 20, 0],\r\n        in: [1.0, 1.0, 1.0],\r\n        attenuation: 0.02,\r\n        ambientCoeff: 0.4,\r\n        at: [0.0, 0.0, 0.0]\r\n      })\r\n    );\r\n\r\n    // Position camera for initial view\r\n    this.engineHelper.camera.camera3d.center(0, 5, 10);\r\n    this.engineHelper.camera.camera3d.lookAt(0, 0, 0);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n    this.engineHelper.camera.camera3d.commitProjectionView();\r\n    \r\n    // Create game objects\r\n    this.createGameObjects();\r\n    super.init();\r\n    \r\n    // Create waypoint tiles for visual debugging\r\n    this.createWaypointTiles();\r\n    \r\n    console.log(' Racing Game initialized! Press SPACE to start racing!');\r\n    console.log(' Controls: W/S - Accelerate/Brake, A/D - Turn Left/Right');\r\n    \r\n    // Auto-start the race after 2 seconds\r\n    setTimeout(() => {\r\n      if (!this.gameStarted) {\r\n        console.log(' Auto-starting race...');\r\n        this.startRace();\r\n      }\r\n    }, 2000);\r\n  }\r\n\r\n  loadResources() {\r\n    console.log('Loading Racing game resources...');\r\n\r\n    // Load font for bot names first\r\n    this.engineHelper\r\n      .getResource(\"assets/paprika.fnt\")\r\n      .then(ResourceResolver.bmFontResolver(this.engineHelper))\r\n      .then(() => {\r\n        console.log('Font resources loaded');\r\n        // Initialize bot fonts after font is loaded\r\n        this.bots.forEach((bot, index) => {\r\n          try {\r\n            bot.nameText.center(0.1 + (index * 0.2), 0.9);\r\n          } catch (error) {\r\n            console.warn('Font initialization warning:', error);\r\n          }\r\n        });\r\n      })\r\n      .catch(err => console.error('Font resource error:', err));\r\n\r\n    // Load missing texture fallback for cubes\r\n    this.engineHelper\r\n      .getResource(\"assets/missing-texture.txt\")\r\n      .then(ResourceResolver.bitmapResolver(this.engineHelper, 1184, 1184, 0))\r\n      .then(() => console.log('Missing texture fallback loaded'))\r\n      .catch(err => console.error('Missing texture resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/racing_car.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/racing_car.png\",\r\n          \"racing_car\"\r\n        )\r\n      ).then(() => {\r\n        console.log('Racing car resources loaded');\r\n      })\r\n      .catch(err => console.error('Racing car resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/atlas.txt\")\r\n      .then(\r\n        ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 20e-3)\r\n      ).then(() => console.log('Atlas resources loaded'))\r\n      .catch(err => console.error('Atlas resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/background.jpg\")\r\n      .then(ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 0))\r\n      .then(() => console.log('Background resources loaded'))\r\n      .catch(err => console.error('Background resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/sphere.txt\")\r\n      .then(\r\n        ResourceResolver.objResolverMultiple(this.engineHelper, [\r\n          { textureSource: \"assets/background.jpg\", name: \"background\" },\r\n          { textureSource: \"assets/sun.png\", name: \"sun\" }\r\n        ])\r\n      ).then(() => console.log('Sphere resources loaded'))\r\n      .catch(err => console.error('Sphere resource error:', err));\r\n\r\n    // Load low poly girl for crowd\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_girl.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_girl.png\",\r\n          \"low_poly_girl\"\r\n        )\r\n      ).then(() => console.log('Low poly girl resources loaded'))\r\n      .catch(err => console.error('Low poly girl resource error:', err));\r\n\r\n    // Load low poly tree for nature scenery\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_tree.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_tree.png\",\r\n          \"low_poly_tree\"\r\n        )\r\n      ).then(() => console.log('Low poly tree resources loaded'))\r\n      .catch(err => console.error('Low poly tree resource error:', err));\r\n\r\n  }\r\n}\r\n\r\n// Export function to create and launch the racing game\r\nexport const createRacingGame = (): void => {\r\n  console.log(' Starting Racing Game...');\r\n\r\n  const aspect = window.innerWidth / window.innerHeight;\r\n  const args = {\r\n    world: new RacingGame(),\r\n    elementId: \"app\",\r\n    canvasId: \"app-game\",\r\n    error: undefined,\r\n    subscribe: undefined,\r\n    renderMode: '3d',\r\n    camera: {\r\n      near: 0.01,\r\n      far: 1000.0,\r\n      fov: 60.0,\r\n      maxFov: 60.0,\r\n      isFovMax: false,\r\n      projection: 'perspective',\r\n      aspect\r\n    },\r\n    aspectRatio: aspect,\r\n    eventThrottle: 1000.0 / 60.0,\r\n    fps: 60,\r\n    isStepRender: false,\r\n  };\r\n  const app = new App(args);\r\n\r\n  // Expose game instance globally for UI updates\r\n  (window as any).gameInstance = args.world;\r\n\r\n  app.run().catch(console.error);\r\n  app.unpause();\r\n  window.onresize = () => {\r\n    location.reload();\r\n  };\r\n};\r\n","import {\r\n  App,\r\n  EngineEvent,\r\n  EngineObject,\r\n  Events,\r\n  Light,\r\n  ObjectManager,\r\n  Rect3d,\r\n  ResourceResolver\r\n} from \"synaren-engine\";\r\nimport Cube from \"./Cube\";\r\nimport Ground3d from \"./Ground3d\";\r\nimport Sphere from \"./Sphere\";\r\n\r\ninterface Crystal {\r\n  sphere: Sphere;\r\n  collected: boolean;\r\n  glowIntensity: number;\r\n  glowDirection: number;\r\n}\r\n\r\ninterface Obstacle {\r\n  cube: Cube;\r\n  rotationSpeed: number;\r\n}\r\n\r\nexport default class CrystalCollectorGame extends ObjectManager {\r\n  // Game state\r\n  score: number = 0;\r\n  timeLeft: number = 60; // 60 seconds game time\r\n  gameStarted: boolean = false;\r\n  gameEnded: boolean = false;\r\n  \r\n  // Game objects\r\n  player: Sphere;\r\n  crystals: Crystal[] = [];\r\n  obstacles: Obstacle[] = [];\r\n  ground: Ground3d;\r\n  sky: Sphere;\r\n  \r\n  // Player movement\r\n  playerSpeed: number = 0.1;\r\n  playerPosition: { x: number, y: number, z: number } = { x: 0, y: 1, z: 0 };\r\n  keys: { [key: string]: boolean } = {};\r\n  \r\n  // Game timer\r\n  gameTimer: number | null = null;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  startGame() {\r\n    this.gameStarted = true;\r\n    this.gameEnded = false;\r\n    this.score = 0;\r\n    this.timeLeft = 60;\r\n    \r\n    // Start countdown timer\r\n    this.gameTimer = window.setInterval(() => {\r\n      this.timeLeft--;\r\n      if (this.timeLeft <= 0) {\r\n        this.endGame();\r\n      }\r\n    }, 1000);\r\n    \r\n    // Reset crystals\r\n    this.crystals.forEach(crystal => {\r\n      crystal.collected = false;\r\n      // Reset crystal position to original\r\n      crystal.sphere.center(crystal.sphere.position.x, 1, crystal.sphere.position.z);\r\n    });\r\n    \r\n    // Reset player position\r\n    this.playerPosition = { x: 0, y: 1, z: 0 };\r\n    this.player.center(0, 1, 0);\r\n    \r\n    // Update camera to follow player\r\n    this.engineHelper.camera.camera3d.center(0, 3, 5);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n  }\r\n\r\n  endGame() {\r\n    this.gameEnded = true;\r\n    this.gameStarted = false;\r\n    \r\n    if (this.gameTimer) {\r\n      clearInterval(this.gameTimer);\r\n      this.gameTimer = null;\r\n    }\r\n  }\r\n\r\n  restartGame() {\r\n    this.gameEnded = false;\r\n    this.startGame();\r\n  }\r\n\r\n  checkCollisions() {\r\n    if (!this.gameStarted || this.gameEnded) return;\r\n    \r\n    // Check crystal collection\r\n    this.crystals.forEach((crystal, index) => {\r\n      if (!crystal.collected) {\r\n        const distance = Math.sqrt(\r\n          Math.pow(this.playerPosition.x - crystal.sphere.position.x, 2) +\r\n          Math.pow(this.playerPosition.y - crystal.sphere.position.y, 2) +\r\n          Math.pow(this.playerPosition.z - crystal.sphere.position.z, 2)\r\n        );\r\n        \r\n        if (distance < 1.5) {\r\n          crystal.collected = true;\r\n          // Move crystal far away instead of hiding it\r\n          crystal.sphere.center(1000, 1000, 1000);\r\n          this.score += 10;\r\n          \r\n          // Check if all crystals collected\r\n          if (this.crystals.every(c => c.collected)) {\r\n            this.score += this.timeLeft * 2; // Bonus points for time left\r\n            this.endGame();\r\n          }\r\n        }\r\n      }\r\n    });\r\n    \r\n    // Check obstacle collisions\r\n    this.obstacles.forEach(obstacle => {\r\n      const distance = Math.sqrt(\r\n        Math.pow(this.playerPosition.x - obstacle.cube.position.x, 2) +\r\n        Math.pow(this.playerPosition.y - obstacle.cube.position.y, 2) +\r\n        Math.pow(this.playerPosition.z - obstacle.cube.position.z, 2)\r\n      );\r\n      \r\n      if (distance < 2) {\r\n        // Penalty for hitting obstacle\r\n        this.score = Math.max(0, this.score - 5);\r\n        // Push player away\r\n        const dx = this.playerPosition.x - obstacle.cube.position.x;\r\n        const dz = this.playerPosition.z - obstacle.cube.position.z;\r\n        const length = Math.sqrt(dx * dx + dz * dz);\r\n        if (length > 0) {\r\n          this.playerPosition.x += (dx / length) * 2;\r\n          this.playerPosition.z += (dz / length) * 2;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  updatePlayer() {\r\n    if (!this.gameStarted || this.gameEnded) return;\r\n    \r\n    const newPosition = { ...this.playerPosition };\r\n    \r\n    // WASD movement using keyboard codes\r\n    if (this.keys['keyw']) newPosition.z -= this.playerSpeed;\r\n    if (this.keys['keys']) newPosition.z += this.playerSpeed;\r\n    if (this.keys['keya']) newPosition.x -= this.playerSpeed;\r\n    if (this.keys['keyd']) newPosition.x += this.playerSpeed;\r\n    \r\n    // Boundary checking (keep player in play area)\r\n    const boundary = 15;\r\n    newPosition.x = Math.max(-boundary, Math.min(boundary, newPosition.x));\r\n    newPosition.z = Math.max(-boundary, Math.min(boundary, newPosition.z));\r\n    \r\n    this.playerPosition = newPosition;\r\n    this.player.center(this.playerPosition.x, this.playerPosition.y, this.playerPosition.z);\r\n    \r\n    // Update camera to follow player\r\n    this.engineHelper.camera.camera3d.center(\r\n      this.playerPosition.x,\r\n      this.playerPosition.y + 3,\r\n      this.playerPosition.z + 5\r\n    );\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n  }\r\n\r\n  updateCrystals() {\r\n    this.crystals.forEach(crystal => {\r\n      if (!crystal.collected) {\r\n        // Glow effect\r\n        crystal.glowIntensity += crystal.glowDirection * 0.02;\r\n        if (crystal.glowIntensity >= 1) {\r\n          crystal.glowDirection = -1;\r\n        } else if (crystal.glowIntensity <= 0.3) {\r\n          crystal.glowDirection = 1;\r\n        }\r\n        \r\n        // Floating animation\r\n        const time = Date.now() * 0.001;\r\n        const floatOffset = Math.sin(time * 2) * 0.2;\r\n        crystal.sphere.position.y = 1 + floatOffset;\r\n        \r\n        // Slow rotation\r\n        crystal.sphere.angleY(time * 50);\r\n      }\r\n    });\r\n  }\r\n\r\n  updateObstacles() {\r\n    this.obstacles.forEach(obstacle => {\r\n      obstacle.cube.position.ay += obstacle.rotationSpeed;\r\n      obstacle.cube.planes?.forEach(plane => {\r\n        plane.angleY(obstacle.cube.position.ay);\r\n      });\r\n    });\r\n  }\r\n\r\n  updateUI() {\r\n    if (this.gameEnded) {\r\n      const allCrystalsCollected = this.crystals.every(c => c.collected);\r\n      if (allCrystalsCollected) {\r\n        console.log(` YOU WIN! Final Score: ${this.score} | Press R to restart`);\r\n      } else {\r\n        console.log(` TIME'S UP! Final Score: ${this.score} | Press R to restart`);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject, index: number) => ent.render(this.engineHelper));\r\n  }\r\n\r\n  update() {\r\n    this.entities.forEach((ent: EngineObject) => ent.update(this.engineHelper));\r\n    \r\n    // Update sky to follow camera\r\n    const { x, y, z } = this.engineHelper.camera.camera3d.position;\r\n    if (this.sky) {\r\n      this.sky.center(x, y, z);\r\n    }\r\n    \r\n    this.updatePlayer();\r\n    this.updateCrystals();\r\n    this.updateObstacles();\r\n    this.checkCollisions();\r\n    this.updateUI();\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    console.log(`Event: ${event.eventType}, Time: ${event.timeStamp} ms, keys: ${JSON.stringify(event)}`);\r\n    // Handle keyboard events\r\n    if (event.eventType === Events.KEY_DOWN) {\r\n      const keyEvent = event as any; // Cast to access keyboard properties\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = true;\r\n        \r\n        // Start game on spacebar\r\n        if (keyEvent.code === 'Space' && !this.gameStarted && !this.gameEnded) {\r\n          this.startGame();\r\n        }\r\n        \r\n        // Restart game on R\r\n        if (keyEvent.code === 'KeyR' && this.gameEnded) {\r\n          this.restartGame();\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (event.eventType === Events.KEY_UP) {\r\n      const keyEvent = event as any; // Cast to access keyboard properties\r\n      if (keyEvent.code) {\r\n        this.keys[keyEvent.code.toLowerCase()] = false;\r\n      }\r\n    }\r\n    \r\n    // Mouse look controls\r\n    if (event.eventType === Events.DRAG) {\r\n      this.engineHelper.camera.camera3d.angleY(-event.dxRaw * 0.5);\r\n      this.engineHelper.camera.camera3d.angleX(event.dyRaw * 0.5);\r\n      this.engineHelper.camera.camera3d.updateProjectionView();\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n\r\n  loadResources() {\r\n    console.log('Loading Crystal Collector game resources...');\r\n    \r\n    this.engineHelper\r\n      .getResource(\"assets/sphere.txt\")\r\n      .then(\r\n        ResourceResolver.objResolverMultiple(this.engineHelper, [\r\n          { textureSource: \"assets/background.jpg\", name: \"background\" },\r\n          { textureSource: \"assets/sun.png\", name: \"crystal\" }\r\n        ])\r\n      ).then(() => console.log('Sphere resources loaded'))\r\n      .catch(err => console.error('Sphere resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/atlas.txt\")\r\n      .then(\r\n        ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 20e-3)\r\n      ).then(() => console.log('Atlas resources loaded'))\r\n      .catch(err => console.error('Atlas resource error:', err));\r\n  }\r\n\r\n  init() {\r\n    const length = 30;\r\n    const width = 30;\r\n\r\n    // Initialize camera\r\n    this.engineHelper.camera.camera3d.center(0, 3, 5);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n\r\n    // Create sky\r\n    this.sky = new Sphere(\r\n      new Rect3d(0.0, 2.0, 0.0, 100.0, 100.0, 100.0),\r\n      \"background\"\r\n    );\r\n    this.addEntity(this.sky);\r\n\r\n    // Create ground\r\n    this.ground = new Ground3d(\r\n      new Rect3d(0.0, 0.0, 0.0, width, 0, length),\r\n      \"grass\"\r\n    );\r\n    this.addEntity(this.ground);\r\n\r\n    // Create player (blue sphere)\r\n    this.player = new Sphere(new Rect3d(0, 1, 0, 0.8, 0.8, 0.8), \"crystal\");\r\n    this.player.scale(0.5, 0.5, 0.5);\r\n    this.addEntity(this.player);\r\n\r\n    // Create crystals to collect (8 crystals placed around the map)\r\n    const crystalPositions = [\r\n      { x: 5, z: 5 }, { x: -5, z: 5 }, { x: 5, z: -5 }, { x: -5, z: -5 },\r\n      { x: 8, z: 0 }, { x: -8, z: 0 }, { x: 0, z: 8 }, { x: 0, z: -8 }\r\n    ];\r\n    \r\n    crystalPositions.forEach((pos, index) => {\r\n      const crystal = new Sphere(new Rect3d(pos.x, 1, pos.z, 0.6, 0.6, 0.6), \"crystal\");\r\n      const crystalData: Crystal = {\r\n        sphere: crystal,\r\n        collected: false,\r\n        glowIntensity: 0.5,\r\n        glowDirection: 1\r\n      };\r\n      this.crystals.push(crystalData);\r\n      this.addEntity(crystal);\r\n    });\r\n\r\n    // Create rotating obstacles (spinning cubes)\r\n    const obstaclePositions = [\r\n      { x: 3, z: 3 }, { x: -3, z: 3 }, { x: 3, z: -3 }, { x: -3, z: -3 },\r\n      { x: 6, z: -2 }, { x: -6, z: 2 }\r\n    ];\r\n    \r\n    obstaclePositions.forEach((pos, index) => {\r\n      const obstacle = new Cube(\r\n        new Rect3d(pos.x, 1, pos.z, 1.2, 1.2, 1.2), \r\n        \"assets/atlas.png\", \r\n        [\"rock\", \"rock\", \"rock\", \"rock\", \"rock\", \"rock\"]\r\n      );\r\n      \r\n      const obstacleData: Obstacle = {\r\n        cube: obstacle,\r\n        rotationSpeed: 2 + Math.random() * 3 // Random rotation speed\r\n      };\r\n      \r\n      this.obstacles.push(obstacleData);\r\n      this.addEntity(obstacle);\r\n    });\r\n\r\n    // Initialize all engine objects\r\n    super.init();\r\n\r\n    // Set up lighting\r\n    this.engineHelper.setLighting(\r\n      new Light({\r\n        pos: [0.0, 15, 0],\r\n        in: [1.0, 1.0, 1.0],\r\n        attenuation: 0.01,\r\n        ambientCoeff: 0.4,\r\n        at: [0.0, 0.0, 0.0]\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\nconst createCrystalCollectorApp = () => {\r\n  const aspect = window.innerWidth / window.innerHeight;\r\n  const args = {\r\n    world: new CrystalCollectorGame(),\r\n    elementId: \"app\",\r\n    canvasId: \"app-game\",\r\n    error: undefined,\r\n    subscribe: undefined,\r\n    renderMode: '3d',\r\n    camera: {\r\n      near: 0.01,\r\n      far: 1000.0,\r\n      fov: 75.0,\r\n      maxFov: 75.0,\r\n      isFovMax: false,\r\n      projection: 'perspective',\r\n      aspect\r\n    },\r\n    aspectRatio: aspect,\r\n    eventThrottle: 1000.0 / 60.0,\r\n    fps: 60,\r\n    isStepRender: false,\r\n  };\r\n  const app = new App(args);\r\n  \r\n  // Expose game instance globally for UI updates\r\n  (window as any).gameInstance = args.world;\r\n  \r\n  app.run().catch(console.error);\r\n  app.unpause();\r\n  window.onresize = () => {\r\n    location.reload();\r\n  };\r\n};\r\n\r\n// Export for use in other files\r\nexport { createCrystalCollectorApp, CrystalCollectorGame };\r\n\r\n","import WorldDelegate from \"../Core/WorldDelegate\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport { EngineEvent } from \"../Core/Events\";\r\n\r\nexport default class ObjectManager extends WorldDelegate {\r\n  entities: EngineObject[] = [];\r\n  deferred: Function[] = [];\r\n  isLoaded = false;\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject) => ent.render(this.engineHelper));\r\n  }\r\n\r\n  update() {\r\n    this.entities.forEach((ent: EngineObject) => ent.update(this.engineHelper));\r\n  }\r\n\r\n  addEntity(entity: EngineObject) {\r\n    this.entities.push(entity);\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    for (let entityIdx = 0; entityIdx < this.entities.length; entityIdx++) {\r\n      const shouldPropagate = this.entities[entityIdx].event(\r\n        event,\r\n        this.engineHelper\r\n      );\r\n      if (shouldPropagate === false) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  loadTexture(onLoad: Function) {\r\n    if (!this.isLoaded) {\r\n      this.deferred.push(onLoad);\r\n    } else {\r\n      onLoad();\r\n    }\r\n  }\r\n  init() {\r\n    for (let entityIdx = 0; entityIdx < this.entities.length; entityIdx++) {\r\n      this.entities[entityIdx].init(this.engineHelper);\r\n    }\r\n    this.deferred.forEach((def) => def());\r\n    this.isLoaded = true;\r\n  }\r\n}\r\n","import Plane2d from \"./Plane2d\";\r\nimport Timer from \"../Core/Common/Timer\";\r\nimport EntityManager2d from \"../Manager/EntityManager2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\n\r\nexport default class SpriteModel extends EntityManager2d {\r\n  spriteIdx = 0;\r\n  private timer = new Timer();\r\n  private ticks: number;\r\n  private textures: string[];\r\n  constructor(rect: Rect2d, ticks: number, textures: string[]) {\r\n    super();\r\n    this.setRect(rect);\r\n    this.ticks = ticks;\r\n    this.textures = textures;\r\n  }\r\n  update(_: EngineHelper) {}\r\n  render(engineHelper: EngineHelper) {\r\n    this.entities[this.spriteIdx]?.render(engineHelper);\r\n    this.calcSpriteIdx();\r\n  }\r\n  calcSpriteIdx() {\r\n    if (this.timer.peak() > this.ticks) {\r\n      const spriteLength = this.entities.length;\r\n      this.spriteIdx += Math.round(this.timer.peak() / this.ticks);\r\n      if (this.spriteIdx >= spriteLength) {\r\n        const idxFactor = this.spriteIdx / spriteLength;\r\n        this.spriteIdx = Math.round(\r\n          (idxFactor - Math.floor(idxFactor)) * spriteLength\r\n        );\r\n        if (this.spriteIdx >= spriteLength) {\r\n          console.error(\"index out of bound after shaping\", this.spriteIdx);\r\n          this.spriteIdx = 0;\r\n        }\r\n      }\r\n      this.timer.start();\r\n    }\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    if (!this.textures) {\r\n      return;\r\n    }\r\n    for (let index = 0; index < this.textures.length; index++) {\r\n      this.entities.push(new Plane2d(this.getRect(), this.textures[index]));\r\n    }\r\n    this.entities.forEach((e) => {\r\n      e.setTop(this.isTop);\r\n      e.hidden = this.hidden;\r\n    });\r\n    this.center(this.position.x, this.position.y, this.position.z);\r\n    this.rotateOrigin(this.position.x, this.position.y, this.position.z);\r\n    this.rotateZ(180);\r\n    super.init(engineHelper);\r\n    this.timer.start();\r\n  }\r\n}\r\n","import Colour from \"../Data/Colour\";\r\nimport PlaneType from \"../Data/PlaneType\";\r\nimport { ColourRenderUnit, TextureRenderUnit } from \"../Data/RenderUnit\";\r\n\r\nexport class VertexBuilder {\r\n  toArray2D(vertexes: TextureRenderUnit[]): number[] {\r\n    const vertexConstruct: number[] = [];\r\n    for (const key in vertexes) {\r\n      if (vertexes.hasOwnProperty(key)) {\r\n        const _vertex = vertexes[key];\r\n        vertexConstruct.push(_vertex.vertex.x);\r\n        vertexConstruct.push(_vertex.vertex.y);\r\n        vertexConstruct.push(_vertex.vertex.z);\r\n        vertexConstruct.push(_vertex.normal.x);\r\n        vertexConstruct.push(_vertex.normal.y);\r\n        vertexConstruct.push(_vertex.normal.z);\r\n        vertexConstruct.push(_vertex.texture.u);\r\n        vertexConstruct.push(_vertex.texture.v);\r\n      }\r\n    }\r\n    return vertexConstruct;\r\n  }\r\n  toTextureArray(vertexes: TextureRenderUnit[]): number[] {\r\n    const vertexConstruct: number[] = [];\r\n    for (const key in vertexes) {\r\n      if (vertexes.hasOwnProperty(key)) {\r\n        const _vertex = vertexes[key];\r\n        vertexConstruct.push(_vertex.vertex.x);\r\n        vertexConstruct.push(_vertex.vertex.y);\r\n        vertexConstruct.push(_vertex.vertex.z);\r\n        vertexConstruct.push(_vertex.normal.x);\r\n        vertexConstruct.push(_vertex.normal.y);\r\n        vertexConstruct.push(_vertex.normal.z);\r\n        vertexConstruct.push(_vertex.texture.u);\r\n        vertexConstruct.push(_vertex.texture.v);\r\n      }\r\n    }\r\n    return vertexConstruct;\r\n  }\r\n  toColourArray(vertexes: ColourRenderUnit[]): number[] {\r\n    const vertexConstruct: number[] = [];\r\n    for (const key in vertexes) {\r\n      if (vertexes.hasOwnProperty(key)) {\r\n        const _vertex = vertexes[key];\r\n        vertexConstruct.push(_vertex.vertex.x);\r\n        vertexConstruct.push(_vertex.vertex.y);\r\n        vertexConstruct.push(_vertex.vertex.z);\r\n        vertexConstruct.push(_vertex.colour.r);\r\n        vertexConstruct.push(_vertex.colour.g);\r\n        vertexConstruct.push(_vertex.colour.b);\r\n        vertexConstruct.push(_vertex.colour.a);\r\n      }\r\n    }\r\n    return vertexConstruct;\r\n  }\r\n  triangleXYColour(colour: Colour): number[] {\r\n    const r = colour.r / 255.0;\r\n    const g = colour.g / 255.0;\r\n    const b = colour.b / 255.0;\r\n    const a = colour.a / 255.0;\r\n    const _colour = [\r\n      1,\r\n      1,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0,\r\n      1,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0,\r\n      0,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n    ];\r\n    return _colour;\r\n  }\r\n  planeXYColour(colour: Colour): number[] {\r\n    const r = colour.r / 255.0;\r\n    const g = colour.g / 255.0;\r\n    const b = colour.b / 255.0;\r\n    const a = colour.a / 255.0;\r\n    const _colour = [\r\n      -0.5,\r\n      -0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0.5,\r\n      -0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      -0.5,\r\n      0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n      0.5,\r\n      0.5,\r\n      0,\r\n      r,\r\n      g,\r\n      b,\r\n      a,\r\n    ];\r\n    return _colour;\r\n  }\r\n  planeCCW(loc: number[], width: number, height: number) {\r\n    const left = loc[0];\r\n    const top = loc[1];\r\n    const right = loc[2];\r\n    const bottom = loc[3];\r\n    const uv = [\r\n      left / width,\r\n      bottom / height,\r\n      left / width,\r\n      top / height,\r\n      right / width,\r\n      top / height,\r\n      right / width,\r\n      bottom / height,\r\n    ];\r\n    return uv;\r\n  }\r\n  planeCW(loc: number[], width: number, height: number): number[] {\r\n    const left = loc[0];\r\n    const top = loc[1];\r\n    const right = loc[2];\r\n    const bottom = loc[3];\r\n    const uv = [\r\n      right / width,\r\n      bottom / height,\r\n      right / width,\r\n      top / height,\r\n      left / width,\r\n      top / height,\r\n      left / width,\r\n      bottom / height,\r\n    ];\r\n    return uv;\r\n  }\r\n  planeUV(vertices: TextureRenderUnit[], uv: number[]) {\r\n    vertices[0].texture.u = uv[4];\r\n    vertices[0].texture.v = uv[1];\r\n    vertices[2].texture.u = uv[4];\r\n    vertices[2].texture.v = uv[3];\r\n    vertices[1].texture.u = uv[0];\r\n    vertices[1].texture.v = uv[1];\r\n    vertices[3].texture.u = uv[0];\r\n    vertices[3].texture.v = uv[3];\r\n  }\r\n  planeXY(vertices: TextureRenderUnit[]) {\r\n    this.plane(vertices, PlaneType.XY);\r\n  }\r\n  plane(vertices: TextureRenderUnit[], PLANE: PlaneType) {\r\n    switch (PLANE) {\r\n      case PlaneType.XY: {\r\n        vertices[0].vertex.x = -1 / 2;\r\n        vertices[0].vertex.y = -1 / 2;\r\n        vertices[0].normal.z = -1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.y = 1 / 2;\r\n        vertices[1].normal.z = -1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.y = -1 / 2;\r\n        vertices[2].normal.z = -1;\r\n        vertices[3].vertex.x = 1 / 2;\r\n        vertices[3].vertex.y = 1 / 2;\r\n        vertices[3].normal.z = -1;\r\n        break;\r\n      }\r\n      case PlaneType.YX: {\r\n        vertices[0].vertex.x = 1 / 2;\r\n        vertices[0].vertex.y = 1 / 2;\r\n        vertices[0].normal.z = 1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.y = -1 / 2;\r\n        vertices[2].normal.z = 1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.y = 1 / 2;\r\n        vertices[1].normal.z = 1;\r\n        vertices[3].vertex.x = -1 / 2;\r\n        vertices[3].vertex.y = -1 / 2;\r\n        vertices[3].normal.z = 1;\r\n        break;\r\n      }\r\n      case PlaneType.XZ: {\r\n        vertices[0].vertex.x = -1 / 2;\r\n        vertices[0].vertex.z = -1 / 2;\r\n        vertices[0].normal.y = 1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.y = 1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.y = 1;\r\n        vertices[3].vertex.x = 1 / 2;\r\n        vertices[3].vertex.z = 1 / 2;\r\n        vertices[3].normal.y = 1;\r\n        break;\r\n      }\r\n      case PlaneType.ZX: {\r\n        vertices[0].vertex.x = 1 / 2;\r\n        vertices[0].vertex.z = 1 / 2;\r\n        vertices[0].normal.y = -1;\r\n        vertices[2].vertex.x = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.y = -1;\r\n        vertices[1].vertex.x = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.y = -1;\r\n        vertices[3].vertex.x = -1 / 2;\r\n        vertices[3].vertex.z = -1 / 2;\r\n        vertices[3].normal.y = -1;\r\n        break;\r\n      }\r\n      case PlaneType.YZ: {\r\n        vertices[0].vertex.y = -1 / 2;\r\n        vertices[0].vertex.z = -1 / 2;\r\n        vertices[0].normal.x = -1;\r\n        vertices[1].vertex.y = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.x = -1;\r\n        vertices[2].vertex.y = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.x = -1;\r\n        vertices[3].vertex.y = 1 / 2;\r\n        vertices[3].vertex.z = 1 / 2;\r\n        vertices[3].normal.x = -1;\r\n        break;\r\n      }\r\n      case PlaneType.ZY: {\r\n        vertices[0].vertex.y = 1 / 2;\r\n        vertices[0].vertex.z = 1 / 2;\r\n        vertices[0].normal.x = 1;\r\n        vertices[2].vertex.y = 1 / 2;\r\n        vertices[2].vertex.z = -1 / 2;\r\n        vertices[2].normal.x = 1;\r\n        vertices[1].vertex.y = -1 / 2;\r\n        vertices[1].vertex.z = 1 / 2;\r\n        vertices[1].normal.x = 1;\r\n        vertices[3].vertex.y = -1 / 2;\r\n        vertices[3].vertex.z = -1 / 2;\r\n        vertices[3].normal.x = 1;\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n  circleXYColour(segments: number, colour: Colour): number[] {\r\n    const r = colour.r / 255.0;\r\n    const g = colour.g / 255.0;\r\n    const b = colour.b / 255.0;\r\n    const a = colour.a / 255.0;\r\n    const increment = (2 * Math.PI) / segments;\r\n    const vertices: number[] = [];\r\n    for (let angle = -Math.PI / 2; angle < Math.PI / 2; angle += increment) {\r\n      const x = Math.sin(angle);\r\n      const y = Math.cos(angle);\r\n      vertices.push(x, y, 0);\r\n      vertices.push(r, g, b, a);\r\n      vertices.push(x, -y, 0);\r\n      vertices.push(r, g, b, a);\r\n    }\r\n    return vertices;\r\n  }\r\n}\r\n","import ModelPosition from \"../Core/EngineEntity/ModelPosition\";\r\nimport Physics from \"../Core/Physics/Physics\";\r\nimport EntityManager from \"../Manager/EntityManager\";\r\nimport Coordinate from \"../Core/Data/Coordinate\";\r\nimport Rect3d from \"../Core/Data/Rect3d\";\r\nimport EngineMath from \"../Core/Physics/EngineMath\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\n\r\nclass Moveable extends EntityManager {\r\n  physics: {\r\n    t: Coordinate;\r\n    d: Coordinate;\r\n    v: Coordinate;\r\n    a: Coordinate;\r\n    modelPos: ModelPosition;\r\n    isMoving: boolean;\r\n    collisionSize: Rect3d | undefined;\r\n    bound: Rect3d | undefined;\r\n    simulationId: number | undefined;\r\n    jumpSimulationId: number | undefined;\r\n    gravitySimulationId: number | undefined;\r\n    collisionIteration: number;\r\n    collisionStopItThres: number;\r\n  };\r\n  isBounded: boolean;\r\n  isMoveable: boolean;\r\n  isRotateMove: boolean;\r\n  hasCollision: boolean;\r\n  dampenReduction = 0.0;\r\n  constructor() {\r\n    super();\r\n    this.physics = {\r\n      t: new Coordinate(0, 0, 0),\r\n      d: new Coordinate(0, 0, 0),\r\n      v: new Coordinate(0, 0, 0),\r\n      a: new Coordinate(0, 0, 0),\r\n      modelPos: new ModelPosition(),\r\n      isMoving: false,\r\n      collisionSize: undefined,\r\n      bound: new Rect2d(0, 0, 1.0, 1.0),\r\n      simulationId: undefined,\r\n      jumpSimulationId: undefined,\r\n      gravitySimulationId: undefined,\r\n      collisionIteration: 0,\r\n      collisionStopItThres: 5,\r\n    };\r\n    this.isMoveable = true;\r\n    this.isBounded = true;\r\n    this.hasCollision = true;\r\n  }\r\n  updatePhysicsPosition() {\r\n    this.physics.t.x = this.position.x;\r\n    this.physics.t.y = this.position.y;\r\n    this.physics.t.z = this.position.z;\r\n  }\r\n  updateDeltaDistance(x?: number, y?: number, z?: number) {\r\n    if (x !== undefined) {\r\n      this.physics.d.x = x - this.position.x;\r\n      this.physics.t.x = x;\r\n    } else {\r\n      this.physics.d.x = this.physics.t.x - this.position.x;\r\n    }\r\n    if (y !== undefined) {\r\n      this.physics.d.y = y - this.position.y;\r\n      this.physics.t.y = y;\r\n    } else {\r\n      this.physics.d.y = this.physics.t.y - this.position.y;\r\n    }\r\n    if (z !== undefined) {\r\n      this.physics.d.z = z - this.position.z;\r\n      this.physics.t.z = z;\r\n    } else {\r\n      this.physics.d.z = this.physics.t.z - this.position.z;\r\n    }\r\n  }\r\n\r\n  updateLocBoundToBoundary() {\r\n    const pos = this.physics.collisionSize\r\n      ? this.physics.modelPos.position\r\n      : this.position;\r\n    const boundRect = this.physics.bound ?? new Rect2d(0, 0, 1, 1, 0);\r\n    const coordinate = EngineMath.boundRect(\r\n      boundRect,\r\n      this.physics.collisionSize\r\n        ? this.physics.modelPos.position\r\n        : this.position\r\n    );\r\n    let dx = 0;\r\n    let dy = 0;\r\n    if (pos.x !== coordinate.x) {\r\n      this.physics.v.x = 0;\r\n      dx = coordinate.x - pos.x;\r\n    }\r\n    if (pos.y !== coordinate.y) {\r\n      this.physics.v.y = 0;\r\n      dy = coordinate.y - pos.y;\r\n    }\r\n    this.center(this.position.x + dx, this.position.y + dy, this.position.z);\r\n  }\r\n\r\n  calcTotalDeltaDistance() {\r\n    return Math.sqrt(\r\n      this.physics.d.x * this.physics.d.x +\r\n        this.physics.d.y * this.physics.d.y +\r\n        this.physics.d.z * this.physics.d.z\r\n    );\r\n  }\r\n  translateTo(\r\n    velocity: number,\r\n    dx?: number,\r\n    dy?: number,\r\n    dz?: number,\r\n    complete?: () => void\r\n  ) {\r\n    const directionalModifier =\r\n      dx !== 0 ? 10e-6 * (this.physics.d.x < 0 ? -1 : 1) : 0;\r\n    this.physics.t.x += (dx || 0) + directionalModifier;\r\n    this.physics.t.y += dy || 0;\r\n    this.physics.t.z += dz || 0;\r\n    this.moveTo(\r\n      velocity,\r\n      this.physics.t.x,\r\n      this.physics.t.y,\r\n      this.physics.t.z,\r\n      complete\r\n    );\r\n  }\r\n  shouldTranslate(colliding: ModelPosition[]): boolean {\r\n    return colliding.length === 0;\r\n  }\r\n  moveToTime(\r\n    time: number,\r\n    x?: number,\r\n    y?: number,\r\n    z?: number,\r\n    complete?: () => void\r\n  ) {\r\n    Physics.cancelSimulation(this.physics.simulationId ?? 0, true);\r\n\r\n    if (!this.isMoveable) {\r\n      return;\r\n    }\r\n    const physics = this.physics;\r\n    this.updateDeltaDistance(x, y, z);\r\n\r\n    const totalTime = Math.max(time, 10e-6);\r\n    this.movementRotation(physics.d.x);\r\n\r\n    let completeSim = this.completeSimulation;\r\n    if (complete) {\r\n      completeSim = () => {\r\n        this.completeSimulation();\r\n        complete();\r\n      };\r\n    }\r\n\r\n    physics.simulationId = Physics.runSimulation(\r\n      totalTime,\r\n      this.moveSimulation.bind(this),\r\n      completeSim,\r\n      physics.simulationId\r\n    );\r\n  }\r\n  private movementRotation(dx: number) {\r\n    if (this.isRotateMove) {\r\n      if (dx > 0) {\r\n        this.rotateY(0);\r\n      } else if (dx < 0) {\r\n        this.rotateY(180);\r\n      }\r\n    }\r\n  }\r\n\r\n  moveTo(\r\n    velocity: number,\r\n    x?: number,\r\n    y?: number,\r\n    z?: number,\r\n    complete?: () => void\r\n  ) {\r\n    Physics.cancelSimulation(this.physics.simulationId ?? 0, true);\r\n\r\n    if (!this.isMoveable) {\r\n      return;\r\n    }\r\n    const physics = this.physics;\r\n    this.updateDeltaDistance(x, y, z);\r\n\r\n    const distance = this.calcTotalDeltaDistance();\r\n    const totalTime = distance / velocity;\r\n    this.movementRotation(physics.d.x);\r\n\r\n    let completeSim = this.completeSimulation;\r\n    if (complete) {\r\n      completeSim = () => {\r\n        this.completeSimulation();\r\n        complete();\r\n      };\r\n    }\r\n    physics.simulationId = Physics.runSimulation(\r\n      totalTime,\r\n      this.moveSimulation.bind(this),\r\n      completeSim,\r\n      physics.simulationId\r\n    );\r\n  }\r\n  completeSimulation = () => {\r\n    this.resetPhysics();\r\n  };\r\n  resetPhysics = () => {\r\n    this.physics.t.x = this.position.x;\r\n    this.physics.t.y = this.position.y;\r\n    this.physics.t.z = this.position.z;\r\n    this.physics.d.x = 0;\r\n    this.physics.d.y = 0;\r\n    this.physics.d.z = 0;\r\n    this.physics.isMoving = false;\r\n    this.physics.collisionIteration = 0;\r\n  };\r\n  addDampener(time) {\r\n    const dampeningProp = time / 1000.0;\r\n    const xSign = Math.sign(this.physics.v.x);\r\n    this.physics.v.x -= xSign * this.dampenReduction * dampeningProp;\r\n    if (xSign !== Math.sign(this.physics.v.x)) {\r\n      this.physics.v.x = 0;\r\n    }\r\n    const ySign = Math.sign(this.physics.v.y);\r\n    this.physics.v.y -= ySign * this.dampenReduction * dampeningProp;\r\n    if (ySign !== Math.sign(this.physics.v.y)) {\r\n      this.physics.v.y = 0;\r\n    }\r\n\r\n    if (Math.abs(this.physics.v.x) < 10e-6) {\r\n      this.physics.v.x = 0;\r\n    }\r\n    if (Math.abs(this.physics.v.y) < 10e-6) {\r\n      this.physics.v.y = 0;\r\n    }\r\n  }\r\n  addImpulse(acceleration: Coordinate, contactTime: number) {\r\n    this.physics.v.x += acceleration.x * contactTime;\r\n    this.physics.v.y += acceleration.y * contactTime;\r\n  }\r\n  setVelocity(velocity: Coordinate) {\r\n    this.physics.v.x = velocity.x;\r\n    this.physics.v.y = velocity.y;\r\n  }\r\n  runPhysicsSimulation(\r\n    simulationId: number,\r\n    totalTime: number = Physics.TIME_STEP_MILLIS * 2.0\r\n  ) {\r\n    Physics.runSimulation(\r\n      totalTime,\r\n      this.physicSimulation,\r\n      this.completeSimulation,\r\n      simulationId\r\n    );\r\n  }\r\n  physicSimulation = (simulationId: number, time: number, _: number) => {\r\n    const physics = this.physics;\r\n    physics.isMoving = true;\r\n\r\n    let dx = physics.v.x * time;\r\n    let dy = physics.v.y * time;\r\n\r\n    let model: ModelPosition = this;\r\n    if (physics.collisionSize) {\r\n      physics.modelPos.setRect(physics.collisionSize);\r\n      physics.modelPos.$physicsId = this.$physicsId;\r\n      model = physics.modelPos;\r\n    }\r\n    const [_dx, _dy, collision] = this.resolveCollision(model, dx, dy);\r\n    if (this.shouldTranslate(collision)) {\r\n      physics.collisionIteration = 0;\r\n    } else {\r\n      this.addDampener(time);\r\n      dx = _dx;\r\n      dy = _dy;\r\n      physics.collisionIteration++;\r\n      if (physics.collisionIteration > physics.collisionStopItThres) {\r\n        this.cancelSimulation(simulationId);\r\n      }\r\n    }\r\n\r\n    this.movementRotation(physics.v.x);\r\n\r\n    this.translate(dx, dy, 0);\r\n    if (physics.collisionSize) {\r\n      physics.modelPos.translate(dx, dy, 0);\r\n      physics.collisionSize.x += dx;\r\n      physics.collisionSize.y += dy;\r\n    }\r\n    if (this.isBounded) {\r\n      this.updateLocBoundToBoundary();\r\n    }\r\n\r\n    this.completePhysicsIteration(time);\r\n  };\r\n\r\n  completePhysicsIteration(_: number) {}\r\n\r\n  private resolveCollision(\r\n    model: ModelPosition,\r\n    dx: number,\r\n    dy: number\r\n  ): [number, number, ModelPosition[]] {\r\n    if (this.hasCollision) {\r\n      return Physics.isCollidingResolve(model, dx, dy);\r\n    } else {\r\n      return [dx, dy, []];\r\n    }\r\n  }\r\n\r\n  private cancelSimulation(simulationId: number) {\r\n    const simulation = Physics.simulations[simulationId];\r\n    if (simulation?.completeSimulation) {\r\n      simulation.completeSimulation();\r\n    }\r\n    Physics.cancelSimulation(simulationId);\r\n  }\r\n\r\n  moveSimulation(simulationId: number, time: number, totalRunTime: number) {\r\n    if (Math.abs(totalRunTime) < 10e-6) {\r\n      return;\r\n    }\r\n    const physics = this.physics;\r\n    physics.isMoving = true;\r\n    const propTime = Math.min(1.0, time / totalRunTime);\r\n\r\n    const dx = physics.d.x * propTime;\r\n    const dy = physics.d.y * propTime;\r\n    const dz = physics.d.z * propTime;\r\n\r\n    this.translateCollision(simulationId, dx, dy, dz);\r\n    this.completePhysicsIteration(time);\r\n  }\r\n\r\n  translateCollision(simulationId: number, dx: number, dy: number, dz: number) {\r\n    const physics = this.physics;\r\n    let model: ModelPosition = this;\r\n    if (physics.collisionSize) {\r\n      physics.modelPos.setRect(physics.collisionSize);\r\n      physics.modelPos.$physicsId = this.$physicsId;\r\n      model = physics.modelPos;\r\n    }\r\n    const colliding = Physics.isCollidingOffset2d(model, dx, dy);\r\n    if (this.shouldTranslate(colliding)) {\r\n      this.translate(dx, dy, dz);\r\n      if (physics.collisionSize) {\r\n        physics.modelPos.translate(dx, dy, 0);\r\n        physics.collisionSize.x += dx;\r\n        physics.collisionSize.y += dy;\r\n      }\r\n      if (this.isBounded) {\r\n        this.updateLocBoundToBoundary();\r\n      }\r\n      this.physics.collisionIteration = 0;\r\n    } else {\r\n      this.physics.collisionIteration++;\r\n      if (this.physics.collisionIteration > this.physics.collisionStopItThres) {\r\n        this.cancelSimulation(simulationId);\r\n      }\r\n    }\r\n  }\r\n\r\n  setMoveable(isMoving: boolean) {\r\n    this.isMoveable = isMoving;\r\n  }\r\n\r\n  copyTexture(obj: EngineObject) {\r\n    this.shaderEntity ? super.copyTexture(obj) : undefined;\r\n    this.entities.forEach((entity) => entity.copyTexture(obj));\r\n  }\r\n}\r\n\r\nexport default Moveable;\r\n","import Coordinate from \"./Coordinate\";\r\n\r\nexport class TextureUnit {\r\n  u = 0.0;\r\n  v = 0.0;\r\n}\r\n\r\nexport class Colour {\r\n  r = 0.0;\r\n  g = 0.0;\r\n  b = 0.0;\r\n  a = 0.0;\r\n}\r\n\r\nexport class RenderUnit {\r\n  vertex: Coordinate = new Coordinate(0, 0, 0);\r\n}\r\n\r\nexport class TextureRenderUnit extends RenderUnit {\r\n  texture: TextureUnit = new TextureUnit();\r\n  normal: Coordinate = new Coordinate(0, 0, 0);\r\n}\r\n\r\nexport class ColourRenderUnit extends RenderUnit {\r\n  colour: Colour = new Colour();\r\n}\r\n","export class Subscription {\r\n  key: string;\r\n\r\n  constructor(key: string) {\r\n    this.key = key;\r\n  }\r\n}\r\n\r\nexport class SubscriptionListeners extends Subscription {\r\n  listeners: { [key: number]: (data: any) => void } = {};\r\n  subscriptionId = 0;\r\n\r\n  constructor(key: string) {\r\n    super(key);\r\n  }\r\n\r\n  listen(callback: (data: any) => void): number {\r\n    this.listeners[this.subscriptionId++] = callback;\r\n    return this.subscriptionId - 1;\r\n  }\r\n\r\n  unlisten(subscriptionId: number) {\r\n    delete this.listeners[subscriptionId];\r\n  }\r\n\r\n  publish(data: any) {\r\n    Object.values(this.listeners).forEach((listener) => listener(data));\r\n  }\r\n\r\n  flush() {\r\n    this.listeners = {};\r\n  }\r\n}\r\n\r\nclass SubscriberPool {\r\n  subscribers: { [key: string]: SubscriptionListeners };\r\n\r\n  constructor() {\r\n    this.subscribers = {};\r\n  }\r\n\r\n  listen(subscription: Subscription, callback: (data: any) => void): number {\r\n    return this.getSubscriptionListeners(subscription).listen(callback);\r\n  }\r\n\r\n  getSubscriptionListeners(subscription: Subscription) {\r\n    const key = subscription.key;\r\n    if (!this.subscribers[key]) {\r\n      this.subscribers[key] = new SubscriptionListeners(key);\r\n    }\r\n    return this.subscribers[key];\r\n  }\r\n\r\n  publish(subscription: Subscription, data?: any) {\r\n    this.getSubscriptionListeners(subscription).publish(data);\r\n  }\r\n}\r\n\r\nexport default SubscriberPool;\r\n","import Rect3d from \"../Core/Data/Rect3d\";\r\nimport TextureVertexModel from \"../Core/Data/TextureVertexModel\";\r\nimport ModelObject3d from \"../Core/EngineEntity/ModelObject3d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class Object3d extends ModelObject3d {\r\n  vertexUvCacheId: string;\r\n  constructor(rect: Rect3d, vertexUvCacheId: string) {\r\n    super(rect, new TextureVertexModel());\r\n    this.vertexUvCacheId = vertexUvCacheId;\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = engineHelper.newVertexModelUv3d(this.vertexUvCacheId);\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n","export default class PlaneType {\r\n  static XY = new PlaneType(\"XY\", 0, 0, 0, 0);\r\n  static YX = new PlaneType(\"YX\", 0, 0, 0, 0);\r\n  static XZ = new PlaneType(\"XZ\", 0, 0, 0, 0);\r\n  static ZX = new PlaneType(\"ZX\", 0, 0, 0, 0);\r\n  static YZ = new PlaneType(\"YZ\", 0, 0, 0, 0);\r\n  static ZY = new PlaneType(\"ZY\", 0, 0, 0, 0);\r\n  static BACKWARDS = -1;\r\n  static FORWARD = 1;\r\n\r\n  name: string;\r\n  width: number;\r\n  height: number;\r\n  length: number;\r\n  normalDirection: number;\r\n\r\n  constructor(\r\n    name: string,\r\n    width: number,\r\n    height: number,\r\n    length: number,\r\n    normalDirection: number\r\n  ) {\r\n    this.name = name;\r\n    this.width = width;\r\n    this.height = height;\r\n    this.length = length;\r\n    this.normalDirection = normalDirection;\r\n  }\r\n}\r\n","import Rect2d from \"../Data/Rect2d\";\r\n\r\nclass Position extends Rect2d {\r\n  x = 0;\r\n  y = 0;\r\n  z = 0;\r\n  ax = 0;\r\n  ay = 0;\r\n  az = 0;\r\n  nx = 0;\r\n  ny = 0;\r\n  nz = 0;\r\n  width = 0;\r\n  height = 0;\r\n  length = 0;\r\n  scaleX = 1;\r\n  scaleY = 1;\r\n  scaleZ = 1;\r\n  originX = 0;\r\n  originY = 0;\r\n  originZ = 0;\r\n  maxHeight = 0;\r\n  maxWidth = 0;\r\n  constructor() {\r\n    super(0, 0, 0, 0, 0);\r\n  }\r\n}\r\n\r\nexport default Position;\r\n","import EntityManager from \"../../Manager/EntityManager\";\r\nimport Texture from \"../Buffer/Texture\";\r\nimport Timer from \"../Common/Timer\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\nimport FontMetaData, { FontCharacter } from \"../Data/FontMetaData\";\r\nimport PlaneType from \"../Data/PlaneType\";\r\nimport Rect2d from \"../Data/Rect2d\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\nimport { EngineEntity } from \"../EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"../EngineEntity/EngineObjectHelper\";\r\nimport ModelObject2d from \"../EngineEntity/ModelObject2d\";\r\nimport ModelPosition from \"../EngineEntity/ModelPosition\";\r\nimport { ShaderEntity } from \"../EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { RendererNotification } from \"../Renderer\";\r\n\r\nclass FontChar extends ModelObject2d {\r\n  fontChar: FontCharacter;\r\n  constructor(\r\n    fontChar: FontCharacter,\r\n    rect: Rect2d,\r\n    vertexModel: TextureVertexModel\r\n  ) {\r\n    super(rect, vertexModel);\r\n    this.fontChar = fontChar;\r\n  }\r\n}\r\n\r\nclass RenderFont {\r\n  shaderEntity?: ShaderEntity;\r\n  font?: FontChar;\r\n  displayTime?: number;\r\n  timer: Timer;\r\n  id: number;\r\n  modelPos: ModelPosition;\r\n  repeat = false;\r\n  static $id = 0;\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    if (this.isRepeat() && !this.repeat) {\r\n      return;\r\n    } else {\r\n      this.repeat = false;\r\n    }\r\n    if (this.shaderEntity) {\r\n      engineHelper.render(this.shaderEntity);\r\n    }\r\n  }\r\n\r\n  expire() {\r\n    this.displayTime = -1;\r\n    this.shaderEntity = undefined;\r\n    this.font = undefined;\r\n  }\r\n\r\n  isExpired() {\r\n    return (\r\n      this.displayTime !== undefined &&\r\n      !this.isRepeat() &&\r\n      this.displayTime < this.timer.peak()\r\n    );\r\n  }\r\n\r\n  refresh() {\r\n    this.repeat = true;\r\n  }\r\n\r\n  isRepeat() {\r\n    return this.displayTime === 0;\r\n  }\r\n\r\n  constructor(font: FontChar, fontPos: Rect2d, time?: number) {\r\n    this.newFont(font, fontPos, time);\r\n  }\r\n\r\n  newFont(font: FontChar, fontPos: Rect2d, time?: number) {\r\n    this.font = font;\r\n    this.displayTime = time;\r\n    this.timer = this.timer ? this.timer : new Timer();\r\n    this.timer.start();\r\n    this.id = this.id ? this.id : RenderFont.$id++;\r\n\r\n    this.shaderEntity = font.shaderEntity.shallowCopy();\r\n    const pos = new ModelPosition();\r\n    pos.centerRect(fontPos);\r\n    pos.rotateOriginRect(fontPos);\r\n    pos.rotateZ(180);\r\n    pos.scaleRect(fontPos);\r\n    this.shaderEntity.model = pos.getModel;\r\n    this.shaderEntity.modelPosition = () => pos.position;\r\n    this.modelPos = pos;\r\n  }\r\n}\r\n\r\nclass FontManager extends EntityManager {\r\n  metaData: FontMetaData;\r\n  fontBitmap: Texture;\r\n  fonts: { [key: number]: FontChar };\r\n  renderFontPool: RenderFont[];\r\n  renderFontState: { [key: number]: RenderFont };\r\n  avgWidth: number;\r\n  avgHeight: number;\r\n  count: number;\r\n\r\n  constructor(metaData: FontMetaData) {\r\n    super();\r\n    this.metaData = metaData;\r\n    this.fonts = {};\r\n    this.renderFontState = {};\r\n    this.renderFontPool = [];\r\n    this.avgWidth = 0;\r\n    this.avgHeight = 0;\r\n    this.count = 0;\r\n  }\r\n\r\n  getFont(charCode: number): FontChar {\r\n    return this.fonts[charCode];\r\n  }\r\n\r\n  createRender(font: FontChar, fontPos: Rect2d, time?: number): RenderFont {\r\n    let renderFont: RenderFont;\r\n    if (this.renderFontPool.length > 0) {\r\n      renderFont = this.renderFontPool.pop()!;\r\n      renderFont.newFont(font, fontPos, time);\r\n    } else {\r\n      renderFont = new RenderFont(font, fontPos, time);\r\n    }\r\n    this.renderFontState[renderFont.id] = renderFont;\r\n    return renderFont;\r\n  }\r\n\r\n  refreshExpired() {\r\n    Object.values(this.renderFontState).forEach((font) => {\r\n      if (font.isExpired()) {\r\n        delete this.renderFontState[font.id];\r\n        this.renderFontPool.push(font);\r\n      }\r\n    });\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    this.refreshExpired();\r\n    super.update(engineHelper);\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    const fonts = Object.values(this.renderFontState);\r\n    fonts.forEach((r) => r.render(engineHelper));\r\n    this.count = fonts.length;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const context = this.metaData.context;\r\n    const fonts = context.fonts;\r\n    const defaultRect = new Rect2d(0.5, 0.5, 1.0, 1.0, 1.0);\r\n    let totalWidth = 0.0;\r\n    let totalHeight = 0.0;\r\n    let totalNo = 0;\r\n    for (const fontIdx in fonts) {\r\n      const fontChar = fonts[fontIdx];\r\n      const pos = [\r\n        fontChar.x,\r\n        fontChar.y,\r\n        fontChar.x + fontChar.width,\r\n        fontChar.y + fontChar.height,\r\n      ];\r\n      const uvs = EngineObjectHelper.vertex.planeCW(\r\n        pos,\r\n        context.width,\r\n        context.height\r\n      );\r\n      const vertexModel = engineHelper.createPlaneVertexModel(\r\n        context.filename,\r\n        uvs,\r\n        PlaneType.YX\r\n      );\r\n      const font = new FontChar(fontChar, defaultRect, vertexModel);\r\n      this.fonts[fontChar.charCode] = font;\r\n      this.entities.push(font);\r\n\r\n      totalWidth += fontChar.width;\r\n      totalHeight += fontChar.height;\r\n      totalNo += 1;\r\n    }\r\n\r\n    this.avgHeight = totalHeight / totalNo;\r\n    this.avgWidth = totalWidth / totalNo;\r\n\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n\r\nexport class FontReference {\r\n  $id: number;\r\n  id?: string;\r\n  _hidden: boolean;\r\n  prevText?: string;\r\n  prevPos: Coordinate;\r\n  pos: Coordinate;\r\n  text: string;\r\n  fontSize: number;\r\n  width: number;\r\n  time?: number;\r\n  $cacheId?: number | string;\r\n  isDirtyPos: boolean;\r\n  isDirtyText: boolean;\r\n  isTop: boolean;\r\n  displayRect: Rect2d;\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.writeFont(this);\r\n  }\r\n  static newFont(\r\n    pos: Coordinate,\r\n    cacheId?: number | string,\r\n    time?: number\r\n  ): FontReference {\r\n    const ref = new FontReference();\r\n    ref.displayRect = new Rect2d(0, 0, 0, 0);\r\n    ref.pos = pos;\r\n    ref.time = time;\r\n    ref.$cacheId = cacheId;\r\n    ref.isDirtyPos = false;\r\n    ref.isDirtyText = false;\r\n    return ref;\r\n  }\r\n  setTop(isTop: boolean): FontReference {\r\n    this.isTop = isTop;\r\n    return this;\r\n  }\r\n  translate(dx: number, dy: number): FontReference {\r\n    this.pos.x += dx;\r\n    this.pos.y += dy;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  center(x: number, y: number): FontReference {\r\n    this.pos.x = x;\r\n    this.pos.y = y;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  setPosition(position: Coordinate): FontReference {\r\n    this.pos = new Coordinate(position.x, position.y);\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  setWidth(width: number): FontReference {\r\n    this.width = width;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  setText(text: string): FontReference {\r\n    if (this._hidden) {\r\n      this.prevText = text;\r\n      this.text = \"\";\r\n    } else {\r\n      this.text = text;\r\n      this.prevText = \"\";\r\n    }\r\n    this.isDirtyText = true;\r\n    return this;\r\n  }\r\n  setFontSize(fontSize: number): FontReference {\r\n    this.fontSize = fontSize;\r\n    this.isDirtyPos = true;\r\n    return this;\r\n  }\r\n  set hidden(hidden: boolean) {\r\n    if (!this._hidden && hidden) {\r\n      this.prevText = this.text;\r\n      this.text = \"\";\r\n      this.isDirtyText = true;\r\n    } else if (this._hidden && !hidden) {\r\n      this.text = this.prevText ?? \"\";\r\n      this.prevText = \"\";\r\n      this.isDirtyText = true;\r\n    }\r\n    this._hidden = hidden;\r\n  }\r\n}\r\n\r\nclass Font implements EngineEntity {\r\n  $id: string;\r\n  fontManager: FontManager;\r\n  static MAX_FONT = 1000;\r\n  static DefaultFont: Font;\r\n  warningShown = false;\r\n  fontCache: { [key: string]: RenderFont[] };\r\n  fontCacheId = 1;\r\n  engineHelper: EngineHelper;\r\n  fontRefCache: { [key: string]: FontReference };\r\n\r\n  private static readonly pixelDensity = 400.0;\r\n\r\n  constructor(metaData: FontMetaData) {\r\n    this.fontManager = new FontManager(metaData);\r\n    this.fontCache = {};\r\n    this.fontRefCache = {};\r\n    if (!Font.DefaultFont) {\r\n      Font.DefaultFont = this;\r\n    }\r\n  }\r\n\r\n  event(): boolean | undefined {\r\n    return;\r\n  }\r\n  update(engineHelper: EngineHelper) {\r\n    if (\r\n      engineHelper.notificationQueue.peak(\r\n        RendererNotification.RESIZE_SCREEN.key\r\n      )\r\n    ) {\r\n      Object.values(this.fontRefCache).forEach(this.expireRenderFont);\r\n      Object.values(this.fontRefCache).forEach(\r\n        (font) => (font.isDirtyText = true)\r\n      );\r\n      this.fontManager.refreshExpired();\r\n      Object.values(this.fontRefCache).forEach(this.writeRef);\r\n    }\r\n    this.fontManager.update(engineHelper);\r\n  }\r\n\r\n  expireRenderFont = (fontRef: FontReference) => {\r\n    this.fontCache[fontRef.$id].forEach((f) => f.expire());\r\n    this.fontCache[fontRef.$id] = [];\r\n  };\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.fontManager.render(engineHelper);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    this.fontManager.init(engineHelper);\r\n  }\r\n\r\n  writeRef = (fontRef: FontReference): FontReference => {\r\n    if (this.fontManager.count > Font.MAX_FONT) {\r\n      if (!this.warningShown) {\r\n        this.warningShown = true;\r\n        console.warn(\"Maximum font is being rendered\", this.fontManager.count);\r\n      }\r\n    }\r\n    if (!fontRef.fontSize) {\r\n      if (!fontRef.width) {\r\n        if (!this.warningShown) {\r\n          this.warningShown = true;\r\n          console.warn(\r\n            \"Either font size or width needs to be set in FontReference\"\r\n          );\r\n        }\r\n        return fontRef;\r\n      }\r\n      if (!fontRef.text) {\r\n        if (!this.warningShown) {\r\n          this.warningShown = true;\r\n          console.warn(\r\n            \"Font text must be set to calculate font size to fit width\"\r\n          );\r\n        }\r\n        return fontRef;\r\n      }\r\n      fontRef.fontSize = this.calculateFontSize(\r\n        fontRef.width,\r\n        fontRef.text.length\r\n      );\r\n    } else if (!fontRef.width) {\r\n      fontRef.width = this.calcTotalTextWidth(fontRef);\r\n    }\r\n\r\n    if (fontRef.isDirtyText && fontRef.$id) {\r\n      this.expireRenderFont(fontRef);\r\n    }\r\n\r\n    if (!fontRef.$id || fontRef.isDirtyText) {\r\n      if (!fontRef.$id) {\r\n        fontRef.$id = this.fontCacheId++;\r\n      }\r\n      fontRef.isDirtyText = false;\r\n      fontRef.isDirtyPos = false;\r\n      fontRef.prevPos = new Coordinate(fontRef.pos.x, fontRef.pos.y);\r\n\r\n      const fonts = this.createFonts(fontRef);\r\n      this.fontCache[fontRef.$id] = fonts;\r\n      this.fontRefCache[fontRef.$id] = fontRef;\r\n    } else if (fontRef.isDirtyPos) {\r\n      const fonts = this.fontCache[fontRef.$id];\r\n      const fontPos = fontRef.pos;\r\n      if (!fontRef.prevPos) {\r\n        fontRef.prevPos = new Coordinate(fontRef.pos.x, fontRef.pos.y);\r\n      }\r\n      const dx = fontRef.prevPos.x - fontPos.x;\r\n      const dy = fontRef.prevPos.y - fontPos.y;\r\n      fonts.forEach((font) => {\r\n        const modelPos = font.modelPos;\r\n        modelPos.translate(-dx, -dy, 0);\r\n        modelPos.rotateOrigin(\r\n          modelPos.position.x,\r\n          modelPos.position.y,\r\n          modelPos.position.z\r\n        );\r\n      });\r\n\r\n      fontRef.isDirtyPos = false;\r\n      fontRef.prevPos.x = fontRef.pos.x;\r\n      fontRef.prevPos.y = fontRef.pos.y;\r\n    }\r\n    this.fontCache[fontRef.$id].forEach((font) => {\r\n      font.refresh();\r\n      font.shaderEntity!.isTop = fontRef.isTop;\r\n    });\r\n    return fontRef;\r\n  };\r\n\r\n  calcTotalTextWidth(fontRef: FontReference) {\r\n    const text = fontRef.text;\r\n    const fontSize = fontRef.fontSize / Font.pixelDensity;\r\n    let carryWidth = 0;\r\n    for (let charIdx = 0; charIdx < text.length; charIdx++) {\r\n      const charCode = text.charCodeAt(charIdx);\r\n      const font = this.fontManager.getFont(charCode);\r\n      const height = fontSize;\r\n      const fontRatio =\r\n        Math.abs(font.fontChar.height) < 10e-6\r\n          ? 0.0\r\n          : font.fontChar.width / font.fontChar.height;\r\n      const width = height * fontRatio;\r\n      carryWidth += width;\r\n    }\r\n    return carryWidth;\r\n  }\r\n\r\n  calculateFontSize(width: number, length: number): number {\r\n    const fontRatio =\r\n      Math.abs(this.fontManager.avgHeight) < 10e-6\r\n        ? 0.0\r\n        : this.fontManager.avgWidth / this.fontManager.avgHeight;\r\n    const widthFactor = 3;\r\n    return ((width / fontRatio) * Font.pixelDensity) / length / widthFactor;\r\n  }\r\n\r\n  createFonts(fontRef: FontReference): RenderFont[] {\r\n    const pos = fontRef.pos;\r\n    const time = fontRef.time;\r\n    const text = fontRef.text;\r\n    const fontSize = Font.fontHeight(fontRef.fontSize);\r\n    const totalWidth = this.calcTotalTextWidth(fontRef);\r\n    let maxHeight = 0;\r\n    let carryWidth = -totalWidth / 2.0;\r\n    const fonts: RenderFont[] = [];\r\n    for (let charIdx = 0; charIdx < text.length; charIdx++) {\r\n      const charCode = text.charCodeAt(charIdx);\r\n      const font = this.fontManager.getFont(charCode);\r\n      const fontChar = font.fontChar;\r\n      const height = fontSize;\r\n      maxHeight = Math.max(maxHeight, height);\r\n      const fontRatio =\r\n        Math.abs(fontChar.height) < 10e-6\r\n          ? 0.0\r\n          : fontChar.width / fontChar.height;\r\n      const width = height * fontRatio;\r\n      carryWidth += width;\r\n      const fontPos = new Rect2d(\r\n        pos.x + carryWidth - width / 2.0 - fontChar.xOffset / 2.0,\r\n        pos.y + height / 2.0 - fontChar.yOffset / 2.0,\r\n        width,\r\n        height,\r\n        -1 * pos.z\r\n      );\r\n      const renderFont = this.fontManager.createRender(font, fontPos, time);\r\n      fonts.push(renderFont);\r\n    }\r\n\r\n    fontRef.displayRect.x = pos.x;\r\n    fontRef.displayRect.y = pos.y;\r\n    fontRef.displayRect.width = carryWidth;\r\n    fontRef.displayRect.height = maxHeight;\r\n\r\n    return fonts;\r\n  }\r\n\r\n  static fontHeight(fontSize: number) {\r\n    return fontSize / Font.pixelDensity;\r\n  }\r\n}\r\n\r\nexport default Font;\r\n","import { TextureRenderUnit } from \"./RenderUnit\";\r\nimport VertexModel from \"./VertexModel\";\r\nimport ModelData from \"./ModelData\";\r\nimport EngineObjectHelper from \"../EngineEntity/EngineObjectHelper\";\r\n\r\nclass TextureVertexModel extends VertexModel {\r\n  vertexBufferId: number;\r\n  renderUnits: TextureRenderUnit[];\r\n  textureSource: string;\r\n  createRenderUnits(count: number): TextureVertexModel {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < count; index++) {\r\n      this.renderUnits.push(new TextureRenderUnit());\r\n    }\r\n    return this;\r\n  }\r\n  fillRenderUnits(values: number[]) {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < values.length; index += 8) {\r\n      const renderUnit = new TextureRenderUnit();\r\n      renderUnit.vertex.x = values[index];\r\n      renderUnit.vertex.y = values[index + 1];\r\n      renderUnit.vertex.z = values[index + 2];\r\n      renderUnit.normal.x = values[index + 3];\r\n      renderUnit.normal.y = values[index + 4];\r\n      renderUnit.normal.z = values[index + 5];\r\n      renderUnit.texture.u = values[index + 6];\r\n      renderUnit.texture.v = values[index + 7];\r\n      this.renderUnits.push(renderUnit);\r\n    }\r\n    return this;\r\n  }\r\n  createModel(): ModelData {\r\n    const model = new ModelData();\r\n    model.vertices = EngineObjectHelper.vertex.toTextureArray(this.renderUnits);\r\n    return model;\r\n  }\r\n}\r\nexport default TextureVertexModel;\r\n","import ModelPosition from \"./ModelPosition\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { EngineEvent } from \"../Events\";\r\nimport { ShaderEntity } from \"./ShaderEntity\";\r\nimport { generateId } from \"../Common/IdGenerator\";\r\n\r\nabstract class EngineObject extends ModelPosition implements EngineEntity {\r\n  private $hidden = false;\r\n  data: object;\r\n  $id: string = generateId();\r\n  copyTexture(obj: EngineObject) {\r\n    this.shaderEntity.rendererTextureRef = obj.shaderEntity.rendererTextureRef;\r\n    this.shaderEntity.vertexModel = obj.shaderEntity.vertexModel;\r\n    this.shaderEntity.rendererBufferId = obj.shaderEntity.rendererBufferId;\r\n  }\r\n  set shaderEntity(shaderEntity: ShaderEntity) {\r\n    this._shaderEntity = shaderEntity;\r\n    this._shaderEntity.isTop = this.isTop;\r\n    this._shaderEntity.clone = this.clone;\r\n  }\r\n  get shaderEntity(): ShaderEntity {\r\n    if (\r\n      this._shaderEntity !== undefined &&\r\n      this._shaderEntity.hidden !== this.$hidden\r\n    ) {\r\n      this._shaderEntity.hidden = this.$hidden;\r\n    }\r\n    return this._shaderEntity;\r\n  }\r\n  private _shaderEntity: ShaderEntity;\r\n  type?: string | number;\r\n  clone = false;\r\n  isTop = false;\r\n  isLastEvent = false;\r\n  get hidden(): boolean {\r\n    return this.$hidden;\r\n  }\r\n  set hidden(value: boolean) {\r\n    this.setHidden(value);\r\n  }\r\n  setHidden(value: boolean) {\r\n    this.$hidden = value;\r\n    if (this.shaderEntity) {\r\n      this.shaderEntity.hidden = value;\r\n    }\r\n  }\r\n  setTop(isTop: boolean) {\r\n    this.isTop = isTop;\r\n    if (!this.shaderEntity) return;\r\n    this.shaderEntity.isTop = isTop;\r\n  }\r\n  setClone(clone: boolean) {\r\n    this.clone = clone;\r\n    if (!this.shaderEntity) return;\r\n    this.shaderEntity.clone = clone;\r\n  }\r\n  update(engineHelper: EngineHelper) {}\r\n  render(engineHelper: EngineHelper) {}\r\n  event(event: EngineEvent, engineHelper: EngineHelper): boolean | undefined {\r\n    return;\r\n  }\r\n  init(engineHelper: EngineHelper) {}\r\n}\r\n\r\nexport interface EngineEntity {\r\n  $id: string;\r\n  update(engineHelper: EngineHelper): void;\r\n  render(engineHelper: EngineHelper): void;\r\n  event(event: EngineEvent, engineHelper: EngineHelper): boolean | undefined;\r\n  init(engineHelper: EngineHelper): void;\r\n}\r\n\r\nexport default EngineObject;\r\n","import { mat4, vec3 } from \"gl-matrix\";\r\n\r\nexport interface LightOptions {\r\n  pos: number[];\r\n  in: number[];\r\n  ambientCoeff: number;\r\n  attenuation: number;\r\n  at: number[];\r\n  up?: vec3;\r\n}\r\n\r\nexport default class Light {\r\n  pos: number[];\r\n  in: number[];\r\n  ambientCoeff: number;\r\n  attenuation: number;\r\n  at: number[];\r\n  up: vec3;\r\n\r\n  constructor(options: LightOptions) {\r\n    this.pos = options.pos;\r\n    this.in = options.in;\r\n    this.attenuation = options.attenuation;\r\n    this.ambientCoeff = options.ambientCoeff;\r\n    this.at = options.at;\r\n  }\r\n\r\n  vecZero(vec: vec3) {\r\n    return vec3.equals(vec, vec3.fromValues(0, 0, 0));\r\n  }\r\n\r\n  parellelVec(vec1: vec3, vec2: vec3) {\r\n    return (\r\n      this.vecZero(vec1) !== true &&\r\n      this.vecZero(vec2) !== true &&\r\n      vec3.equals(\r\n        vec3.normalize(vec3.create(), vec1),\r\n        vec3.normalize(vec3.create(), vec2)\r\n      ) === true\r\n    );\r\n  }\r\n\r\n  perpVec(vec: vec3) {\r\n    let perp = vec3.fromValues(1.0, 0.0, 0.0);\r\n    if (this.parellelVec(vec, perp) === true) {\r\n      perp = vec3.fromValues(0.0, 0.0, 1.0);\r\n    }\r\n    return perp;\r\n  }\r\n\r\n  posVec() {\r\n    return vec3.fromValues(this.pos[0], this.pos[1], this.pos[2]);\r\n  }\r\n\r\n  atVec() {\r\n    return vec3.fromValues(this.at[0], this.at[1], this.at[2]);\r\n  }\r\n\r\n  lookAt() {\r\n    const pos = this.posVec();\r\n    const at = this.atVec();\r\n    let atCross = at;\r\n    let posCross = pos;\r\n\r\n    if (this.parellelVec(pos, at) === true) {\r\n      atCross = this.perpVec(pos);\r\n    } else {\r\n      if (this.vecZero(pos) === true) {\r\n        posCross = this.perpVec(at);\r\n      }\r\n      if (this.vecZero(at) === true) {\r\n        atCross = this.perpVec(pos);\r\n      }\r\n    }\r\n    this.up = vec3.cross(vec3.create(), posCross, atCross);\r\n    return mat4.lookAt(mat4.create(), pos, at, this.up);\r\n  }\r\n}\r\n","export default class BaseProgram {\r\n  program: WebGLProgram;\r\n  ctx: WebGLRenderingContext;\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n  }\r\n\r\n  compileShaders(\r\n    vertexShaderContent: string,\r\n    fragmentShaderContent: string\r\n  ): WebGLProgram {\r\n    const ctx = this.ctx;\r\n    const vertexShader = ctx.createShader(ctx.VERTEX_SHADER);\r\n    const fragmentShader = ctx.createShader(ctx.FRAGMENT_SHADER);\r\n\r\n    if (!vertexShader || !fragmentShader) {\r\n      throw new Error(\"Unable to create vertex or fragment shader\");\r\n    }\r\n\r\n    const fragmentChar = fragmentShaderContent;\r\n    const vertexChar = vertexShaderContent;\r\n\r\n    ctx.shaderSource(vertexShader, vertexChar);\r\n    ctx.compileShader(vertexShader);\r\n\r\n    ctx.shaderSource(fragmentShader, fragmentChar);\r\n    ctx.compileShader(fragmentShader);\r\n\r\n    if (!ctx.getShaderParameter(vertexShader, ctx.COMPILE_STATUS)) {\r\n      const error = \"could not compile vertex shader:\" + ctx.getShaderInfoLog(vertexShader);\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n\r\n    if (!ctx.getShaderParameter(fragmentShader, ctx.COMPILE_STATUS)) {\r\n      const error = \"could not compile fragment shader:\" + ctx.getShaderInfoLog(fragmentShader);\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n\r\n    const program: WebGLProgram = ctx.createProgram()!;\r\n    ctx.attachShader(program, vertexShader);\r\n    ctx.attachShader(program, fragmentShader);\r\n    ctx.linkProgram(program);\r\n\r\n    ctx.validateProgram(program);\r\n\r\n    if (!ctx.getProgramParameter(program, ctx.LINK_STATUS)) {\r\n      const error = \"Link failed: \" + ctx.getProgramInfoLog(program);\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n\r\n    console.log('Shader program compiled successfully');\r\n    return program;\r\n  }\r\n\r\n  delete() {\r\n    this.ctx.deleteProgram(this.program);\r\n  }\r\n\r\n  _bindProgram(program: WebGLProgram) {\r\n    this.ctx.useProgram(program);\r\n  }\r\n  _unbindProgram() {}\r\n}\r\n","import Coordinate from \"./Data/Coordinate\";\r\nimport { WebGLContainer } from \"./App\";\r\n\r\nexport type EngineEventCallback = (EngineEvent) => boolean;\r\n\r\nexport interface EngineEvent {\r\n  x: number;\r\n  y: number;\r\n  dx: number;\r\n  dy: number;\r\n  dxRaw: number;\r\n  dyRaw: number;\r\n  eventType: number;\r\n  prevEventType: number;\r\n  timeStamp: number;\r\n  prevTimeStamp: number;\r\n  orientationQuaternion: number[];\r\n  code?: string;\r\n  keyDown?: { [key: string]: boolean };\r\n  rawEvent?: Event;\r\n  isDown: boolean;\r\n  isUp: boolean;\r\n}\r\n\r\nexport default class Events {\r\n  private eventDown = false;\r\n  private touchDown = false;\r\n  private eventDownX = 0.0;\r\n  private eventDownY = 0.0;\r\n  private eventDownDx = 0.0;\r\n  private eventDownDy = 0.0;\r\n  private keyDownMap: { [key: string]: boolean } = {};\r\n  private prevEvent = 0.0;\r\n  private timeStamp = 0.0;\r\n  private prevTimeStamp = 0.0;\r\n  private motionTimeStamp = 0.0;\r\n  private orientationQuaternion = [0.0, 0.0, 0.0, 0.0];\r\n  private orientation: string | number;\r\n  private NULL_EVENT = {\r\n    x: 0,\r\n    y: 0,\r\n    dx: 0,\r\n    dy: 0,\r\n    dxRaw: 0,\r\n    dyRaw: 0,\r\n    eventType: -1,\r\n    prevEventType: -1,\r\n    timeStamp: 0,\r\n    prevTimeStamp: 0,\r\n    orientationQuaternion: [0, 0, 0, 0],\r\n    rawEvent: undefined,\r\n    isDown: false,\r\n    isUp: false,\r\n  };\r\n\r\n  static DOWN = 1;\r\n  static DRAG = 2;\r\n  static UP = 3;\r\n  static RESIZE = 4;\r\n  static ORIENTATION = 5;\r\n  static KEY_DOWN = 6;\r\n  static KEY_UP = 7;\r\n  static SYSTEM_EVENTS = 8;\r\n  boundedWindow = false;\r\n\r\n  callback: EngineEventCallback[] = [];\r\n  private webGLContainer: WebGLContainer;\r\n  private throttle = 1000.0 / 25.0;\r\n\r\n  setThrottle = (throttle: number) => {\r\n    if (throttle) {\r\n      this.throttle = throttle;\r\n    }\r\n  };\r\n\r\n  delete(cb: Function) {\r\n    this.callback = this.callback.filter((c) => c !== cb);\r\n  }\r\n\r\n  bindWindow() {\r\n    if (this.boundedWindow) {\r\n      return;\r\n    }\r\n\r\n    window.addEventListener(\r\n      \"mouseup\",\r\n      this.isBodyFocus(this.handleMouseUp),\r\n      true\r\n    );\r\n    window.addEventListener(\r\n      \"touchend\",\r\n      this.isBodyFocus(this.handleTouchEnd),\r\n      true\r\n    );\r\n    window.addEventListener(\"resize\", this.resize, true);\r\n    window.addEventListener(\"keydown\", this.isBodyFocus(this.keyDown), true);\r\n    window.addEventListener(\"keyup\", this.isBodyFocus(this.keyUp), true);\r\n\r\n    if (window.hasOwnProperty(\"DeviceMotionEvent\")) {\r\n      window.addEventListener(\"devicemotion\", this.handleMotion, true);\r\n    }\r\n\r\n    if (window.hasOwnProperty(\"DeviceOrientationEvent\")) {\r\n      window.addEventListener(\r\n        \"orientationchange\",\r\n        this.handleOrientationChange,\r\n        true\r\n      );\r\n    }\r\n    this.boundedWindow = true;\r\n  }\r\n\r\n  bindCanvas() {\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"mousedown\",\r\n      this.handleEventDown,\r\n      true\r\n    );\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"mousemove\",\r\n      this.handleEventMove,\r\n      true\r\n    );\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"touchstart\",\r\n      this.handleTouchStart,\r\n      true\r\n    );\r\n    this.webGLContainer.canvas.addEventListener(\r\n      \"touchmove\",\r\n      this.handleTouchMove,\r\n      true\r\n    );\r\n  }\r\n\r\n  isBodyFocus(callback: (event: any) => void): (event: any) => void {\r\n    return (_event: any[]) => {\r\n      // if (window.document.activeElement === window.document.body) {\r\n        callback(_event);\r\n      // } else {\r\n      //   console.trace('body is not focused when event triggered', event);\r\n      // }\r\n    };\r\n  }\r\n\r\n  bind = (callback: EngineEventCallback, webGLContainer: WebGLContainer) => {\r\n    this.callback.push(callback);\r\n    this.webGLContainer = webGLContainer;\r\n    this.bindCanvas();\r\n    this.bindWindow();\r\n  };\r\n\r\n  handleOrientationChange = () => {\r\n    this.orientation = window.orientation || 0;\r\n  };\r\n\r\n  getQuaternion(alpha: number, beta: number, gamma: number) {\r\n    const degtorad = Math.PI / 180.0;\r\n    const radtodeg = 180.0 / Math.PI;\r\n\r\n    const _x = beta ? beta * degtorad : 0;\r\n    const _y = gamma ? gamma * degtorad : 0;\r\n    const _z = alpha ? alpha * degtorad : 0;\r\n\r\n    const cX = Math.cos(_x / 2);\r\n    const cY = Math.cos(_y / 2);\r\n    const cZ = Math.cos(_z / 2);\r\n    const sX = Math.sin(_x / 2);\r\n    const sY = Math.sin(_y / 2);\r\n    const sZ = Math.sin(_z / 2);\r\n\r\n    const w = cX * cY * cZ - sX * sY * sZ;\r\n    const x = sX * cY * cZ - cX * sY * sZ;\r\n    const y = cX * sY * cZ + sX * cY * sZ;\r\n    const z = cX * cY * sZ + sX * sY * cZ;\r\n\r\n    const screenAccData = new Coordinate(0, 0, 0);\r\n\r\n    switch (this.orientation) {\r\n      case 90:\r\n        screenAccData.x = -x;\r\n        screenAccData.y = z;\r\n        break;\r\n      case 180:\r\n        screenAccData.x = -z;\r\n        screenAccData.y = -x;\r\n        break;\r\n      case 270:\r\n      case -90:\r\n        screenAccData.x = x;\r\n        screenAccData.y = -z;\r\n        break;\r\n      default:\r\n        screenAccData.x = z;\r\n        screenAccData.y = x;\r\n        break;\r\n    }\r\n    // convert to engine coords\r\n    return [\r\n      (screenAccData.x * radtodeg) / w,\r\n      (-1 * screenAccData.y * radtodeg) / w,\r\n      (y * radtodeg) / w,\r\n      1.0,\r\n    ];\r\n  }\r\n\r\n  handleMotion = (event: DeviceMotionEvent) => {\r\n    if (!this.motionTimeStamp) {\r\n      this.motionTimeStamp = event.timeStamp;\r\n    }\r\n    this.incrementQuaternion(event);\r\n    if (event && event.timeStamp - this.motionTimeStamp > this.throttle) {\r\n      const tempEventDownX = this.eventDownX;\r\n      const tempEventDownY = this.eventDownY;\r\n      this.eventDownX = this.orientationQuaternion[0];\r\n      this.eventDownY = this.orientationQuaternion[1];\r\n      this.handleEvent(event, Events.ORIENTATION);\r\n      this.eventDownX = tempEventDownX;\r\n      this.eventDownY = tempEventDownY;\r\n\r\n      this.prevEvent = Events.ORIENTATION;\r\n      this.motionTimeStamp = event.timeStamp;\r\n      this.orientationQuaternion = [0.0, 0.0, 0.0, 1.0];\r\n    }\r\n  };\r\n\r\n  incrementQuaternion = (event: DeviceMotionEvent) => {\r\n    const accData: any = event.rotationRate\r\n      ? event.rotationRate\r\n      : { beta: 0, gamma: 0, alpha: 0 };\r\n    const eventQuaternion = this.getQuaternion(\r\n      accData.alpha,\r\n      accData.beta,\r\n      accData.gamma\r\n    );\r\n    this.orientationQuaternion[0] += eventQuaternion[0];\r\n    this.orientationQuaternion[1] += eventQuaternion[1];\r\n    this.orientationQuaternion[2] += eventQuaternion[2];\r\n  };\r\n\r\n  buildEvent = (evt: Event, type: number): EngineEvent => {\r\n    if (!this.webGLContainer.canvas) return this.NULL_EVENT;\r\n    return {\r\n      x: this.eventDownX / this.webGLContainer.canvas.offsetWidth,\r\n      y: 1 - this.eventDownY / this.webGLContainer.canvas.offsetHeight,\r\n      dx: (2.0 * this.eventDownDx) / this.webGLContainer.canvas.offsetWidth,\r\n      dy: (2.0 * this.eventDownDy) / this.webGLContainer.canvas.offsetHeight,\r\n      dxRaw: this.eventDownDx,\r\n      dyRaw: this.eventDownDy,\r\n      eventType: type,\r\n      prevEventType: this.prevEvent,\r\n      timeStamp: this.timeStamp,\r\n      prevTimeStamp: this.prevTimeStamp,\r\n      orientationQuaternion: this.orientationQuaternion,\r\n      rawEvent: evt,\r\n      isDown: type === Events.DOWN,\r\n      isUp: type === Events.UP,\r\n      code: evt instanceof KeyboardEvent ? evt.code : undefined,\r\n    };\r\n  };\r\n\r\n  resize = (evt: Event) => {\r\n    this.handleEvent(evt, Events.RESIZE);\r\n  };\r\n\r\n  buildEventKey = (evt: KeyboardEvent, type: number) => {\r\n    return {\r\n      eventType: type,\r\n      keyCode: evt.key,\r\n      code: evt.code,\r\n      event: evt,\r\n      keyDown: this.keyDownMap,\r\n      isDown: type === Events.DOWN,\r\n      isUp: type === Events.UP,\r\n    };\r\n  };\r\n\r\n  keyDown = (evt: KeyboardEvent) => {\r\n    this.keyDownMap[evt.code] = true;\r\n    this.handleEvent(evt, Events.KEY_DOWN);\r\n    switch (evt.keyCode) {\r\n      // prevent arrow keys from scrolling window\r\n      case 37:\r\n      case 39:\r\n      case 38:\r\n      case 40:\r\n        evt.preventDefault();\r\n        break;\r\n    }\r\n  };\r\n\r\n  keyUp = (evt: KeyboardEvent) => {\r\n    this.keyDownMap[evt.code] = false;\r\n    this.handleEvent(evt, Events.KEY_UP);\r\n  };\r\n\r\n  handleMouseUp = (evt: MouseEvent) => {\r\n    this.eventDown = false;\r\n    this.timeStamp = evt.timeStamp;\r\n    this.eventDownX = evt.offsetX;\r\n    this.eventDownY = evt.offsetY;\r\n    this.handleEvent(evt, Events.UP);\r\n    this.prevEvent = Events.UP;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n  };\r\n\r\n  handleEventDown = (evt: MouseEvent) => {\r\n    this.eventDown = true;\r\n    this.eventDownX = evt.offsetX;\r\n    this.eventDownY = evt.offsetY;\r\n    this.timeStamp = evt.timeStamp;\r\n    this.handleEvent(evt, Events.DOWN);\r\n    this.prevEvent = Events.DOWN;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n  };\r\n\r\n  handleEventMove = (evt: MouseEvent) => {\r\n    if (this.eventDown && evt.timeStamp - this.timeStamp > this.throttle) {\r\n      const xUp = evt.offsetX;\r\n      const yUp = evt.offsetY;\r\n\r\n      this.eventDownDx = this.eventDownX - xUp;\r\n      this.eventDownDy = this.eventDownY - yUp;\r\n      this.eventDownX = xUp;\r\n      this.eventDownY = yUp;\r\n      this.timeStamp = evt.timeStamp;\r\n      this.handleEvent(evt, Events.DRAG);\r\n      this.prevEvent = Events.DRAG;\r\n      this.prevTimeStamp = evt.timeStamp;\r\n    }\r\n  };\r\n\r\n  handleTouchEnd = (evt: TouchEvent) => {\r\n    this.touchDown = false;\r\n    this.timeStamp = evt.timeStamp;\r\n    this.handleEvent(evt, Events.UP);\r\n    this.prevEvent = Events.UP;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n  };\r\n\r\n  handleTouchStart = (evt: TouchEvent) => {\r\n    this.touchDown = true;\r\n    this.timeStamp = evt.timeStamp;\r\n    if (evt.target instanceof HTMLElement) {\r\n      const rect = evt.target.getBoundingClientRect();\r\n      this.eventDownX = evt.touches[0].clientX - rect.left;\r\n      this.eventDownY = evt.touches[0].clientY - rect.top;\r\n    }\r\n    this.handleEvent(evt, Events.DOWN);\r\n    this.prevEvent = Events.DOWN;\r\n    this.prevTimeStamp = evt.timeStamp;\r\n    if (evt.cancelable) {\r\n      evt.preventDefault();\r\n    }\r\n  };\r\n\r\n  handleTouchMove = (evt: TouchEvent) => {\r\n    if (\r\n      this.touchDown &&\r\n      evt.timeStamp - this.timeStamp > this.throttle &&\r\n      evt.target instanceof HTMLElement\r\n    ) {\r\n      const rect = evt.target.getBoundingClientRect();\r\n      const xUp = evt.touches[0].clientX - rect.left;\r\n      const yUp = evt.touches[0].clientY - rect.top;\r\n\r\n      this.eventDownDx = (this.eventDownX - xUp) / 2.0;\r\n      this.eventDownDy = (this.eventDownY - yUp) / 2.0;\r\n      this.eventDownX = xUp;\r\n      this.eventDownY = yUp;\r\n      this.timeStamp = evt.timeStamp;\r\n      this.handleEvent(evt, Events.DRAG);\r\n      this.prevEvent = Events.DRAG;\r\n      this.prevTimeStamp = evt.timeStamp;\r\n    }\r\n    // prevent device scrolling\r\n    if (evt.cancelable) {\r\n      evt.preventDefault();\r\n    }\r\n  };\r\n\r\n  handleEvent = (evt: Event, event: Events[keyof Events]) => {\r\n    const targetEvent = this.buildEvent(evt, event);\r\n    for (let i = 0; i < this.callback.length; i++) {\r\n      const callbackPropagate = this.callback[i](targetEvent);\r\n      if (callbackPropagate === false) {\r\n        break;\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport const event = new Events();\r\n","import ShaderEntityBuilder from \"../Builder/ShaderEntityBuilder\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport RenderOption, { RenderType, ShaderType } from \"../Data/RenderOption\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport EngineObject from \"./EngineObject\";\r\n\r\nexport default class ModelObject3d extends EngineObject {\r\n  public vertexModel: TextureVertexModel;\r\n  protected renderType: RenderType;\r\n\r\n  constructor(rect: Rect3d, vertexModel: TextureVertexModel) {\r\n    super();\r\n    this.renderType = RenderType.TRIANGLE;\r\n    this.vertexModel = vertexModel;\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n  setRenderType(renderType: RenderType) {\r\n    this.renderType = renderType;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = this.renderType;\r\n    renderOpt.shaderType = ShaderType.THREE_DIMENSION;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .createTexture(this.vertexModel.textureSource)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import FontMetaData, {\r\n  FontCharacter,\r\n  FontMeta,\r\n} from \"../Core/Data/FontMetaData\";\r\n\r\nclass FntFontReader extends FontMetaData {\r\n  static FILENAME = /file=\"([\\w\\d\\W\\D]+)\"/;\r\n  static WIDTH = /scaleW=([\\d]+)/;\r\n  static HEIGHT = /scaleH=([\\d]+)/;\r\n  static LINE_HEIGHT = /lineHeight=([\\d]+)/;\r\n  static FONT_CHAR = new RegExp(\r\n    \"char[\\\\s]+\" +\r\n      [\"id\", \"x\", \"y\", \"width\", \"height\", \"xoffset\", \"yoffset\"]\r\n        .map((column) => `${column}=([-\\\\d]+)[\\\\s]+`)\r\n        .reduce((sum: string, str: string) => sum + str)\r\n  );\r\n\r\n  context: FontMeta;\r\n\r\n  constructor(raw: string) {\r\n    super();\r\n    const lines = raw.split(\"\\n\");\r\n    this.context = new FontMeta();\r\n    for (const lineIdx in lines) {\r\n      if (!lines.hasOwnProperty(lineIdx)) {\r\n        continue;\r\n      }\r\n      const line = lines[lineIdx];\r\n      this.parseWidth(this.context, line);\r\n      this.parseHeight(this.context, line);\r\n      this.parseFilename(this.context, line);\r\n      this.parseLineHeight(this.context, line);\r\n      this.parseChar(this.context, line);\r\n    }\r\n  }\r\n\r\n  parseChar(context: FontMeta, line: string) {\r\n    const match = line.match(FntFontReader.FONT_CHAR);\r\n    if (match) {\r\n      const font = new FontCharacter();\r\n      font.charCode = parseFloat(match[1]);\r\n      font.x = parseFloat(match[2]);\r\n      font.y = parseFloat(match[3]);\r\n      font.width = parseFloat(match[4]);\r\n      font.height = parseFloat(match[5]);\r\n      font.xOffset = parseFloat(match[6]) / context.width;\r\n      font.yOffset = parseFloat(match[7]) / context.height;\r\n      font.char = String.fromCharCode(font.charCode);\r\n      context.fonts[font.char] = font;\r\n    }\r\n  }\r\n\r\n  parseHeight(context: FontMeta, line: string) {\r\n    if (!context.height) {\r\n      const match = line.match(FntFontReader.HEIGHT);\r\n      if (match) {\r\n        context.height = parseFloat(match[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseLineHeight(context: FontMeta, line: string) {\r\n    if (!context.lineHeight) {\r\n      const match = line.match(FntFontReader.LINE_HEIGHT);\r\n      if (match) {\r\n        context.lineHeight = parseFloat(match[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseWidth(context: FontMeta, line: string) {\r\n    if (!context.width) {\r\n      const match = line.match(FntFontReader.WIDTH);\r\n      if (match) {\r\n        context.width = parseFloat(match[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  parseFilename(context: FontMeta, line: string) {\r\n    if (!context.filename) {\r\n      const match = line.match(FntFontReader.FILENAME);\r\n      if (match) {\r\n        context.filename = match[1];\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default FntFontReader;\r\n","import ModelData from \"./ModelData\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { RenderUnit } from \"./RenderUnit\";\r\n\r\nabstract class VertexModel {\r\n  public vertexBufferId: number;\r\n  public renderUnits: RenderUnit[];\r\n\r\n  public abstract createRenderUnits(count: number): VertexModel;\r\n  public abstract fillRenderUnits(vertexUV: number[]): void;\r\n  public abstract createModel(): ModelData;\r\n\r\n  public registerModel(engineHelper: EngineHelper) {\r\n    if (!this.vertexBufferId) {\r\n      this.vertexBufferId = engineHelper.addBufferCache(this.createModel());\r\n    }\r\n  }\r\n}\r\n\r\nexport default VertexModel;\r\n","export default class Resource {\r\n  location: string;\r\n  type: string;\r\n  width: number;\r\n  height: number;\r\n  precision: number;\r\n}\r\n","export default \"\\r\\nattribute vec3 a_position;\\r\\nattribute vec4 a_color;\\r\\nvarying vec4 v_color;\\r\\nuniform mat4 u_model;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_projection;\\r\\n\\r\\nvoid main(void) {\\r\\n  v_color = a_color;\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1);\\r\\n}\\r\\n\\r\\n\";","import { quat, mat4, glMatrix, ReadonlyVec3 } from \"gl-matrix\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport Position from \"./Position\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\n\r\nexport default class ModelPosition {\r\n  $physicsId: number;\r\n  position: Position = new Position();\r\n  cachedModel: mat4;\r\n  dirtyModel = true;\r\n  quatRotationxyz: mat4;\r\n  dirtyQuat = true;\r\n  dirtyPos = true;\r\n  dirtyScale = true;\r\n  dirtyOrigin = true;\r\n  intermediateModels: mat4[] = [\r\n    mat4.create(),\r\n    mat4.create(),\r\n    mat4.create(),\r\n    mat4.create(),\r\n  ];\r\n  // prevent memory reallocation of objects\r\n  initialMat4Temp = mat4.create();\r\n  rotateQuatTemp = quat.create();\r\n  rotateMat4Temp = mat4.create();\r\n\r\n  setPosition(position: Position) {\r\n    this.position = position;\r\n    this.dirtyOrigin = true;\r\n    this.dirtyQuat = true;\r\n    this.dirtyPos = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  pos() {\r\n    return [this.position.x, this.position.y, this.position.z];\r\n  }\r\n\r\n  centerRect(rect: Rect3d) {\r\n    this.center(rect.x, rect.y, rect.z);\r\n  }\r\n\r\n  rotateOriginRect(rect: Rect3d) {\r\n    this.rotateOrigin(rect.x, rect.y, rect.z);\r\n  }\r\n\r\n  centerCoord(coord: Coordinate) {\r\n    this.center(coord.x, coord.y, coord.z);\r\n  }\r\n\r\n  center(x: number, y: number, z: number) {\r\n    if (\r\n      this.position.x === x &&\r\n      this.position.y === y &&\r\n      this.position.z === z\r\n    ) {\r\n      return;\r\n    }\r\n    this.position.x = x;\r\n    this.position.y = y;\r\n    this.position.z = z;\r\n    this.dirtyPos = true;\r\n    this.dirtyModel = true;\r\n    this.rotateOrigin(x, y, z);\r\n  }\r\n\r\n  translate(dx: number, dy: number, dz: number) {\r\n    this.position.x += dx;\r\n    this.position.y += dy;\r\n    this.position.z += dz;\r\n    this.dirtyPos = true;\r\n    this.dirtyModel = true;\r\n    this.rotateOrigin(this.position.x, this.position.y, this.position.z);\r\n  }\r\n\r\n  rotateOrigin(x: number, y: number, z: number) {\r\n    if (\r\n      this.position.originX !== x ||\r\n      this.position.originY !== y ||\r\n      this.position.originZ !== z\r\n    ) {\r\n      this.position.originX = x;\r\n      this.position.originY = y;\r\n      this.position.originZ = z;\r\n      this.dirtyOrigin = true;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  angleX(x: number) {\r\n    if (this.position.ax !== x) {\r\n      this.position.ax = x;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  angleY(y: number) {\r\n    if (this.position.ay !== y) {\r\n      this.position.ay = y;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  angleZ(z: number) {\r\n    if (this.position.az !== z) {\r\n      this.position.az = z;\r\n      this.dirtyQuat = true;\r\n      this.dirtyModel = true;\r\n    }\r\n  }\r\n\r\n  rotateX(x: number) {\r\n    this.angleX(x);\r\n  }\r\n\r\n  rotateY(y: number) {\r\n    this.angleY(y);\r\n  }\r\n\r\n  rotateZ(z: number) {\r\n    this.angleZ(z);\r\n  }\r\n\r\n  scaleX(x: number) {\r\n    this.position.scaleX = x;\r\n    this.position.width = this.position.scaleX;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scaleY(y: number) {\r\n    this.position.scaleY = y;\r\n    this.position.height = this.position.scaleY;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scaleZ(z: number) {\r\n    this.position.scaleZ = z;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scale(x: number, y: number, z: number) {\r\n    if (\r\n      this.position.scaleX === x &&\r\n      this.position.scaleY === y &&\r\n      this.position.scaleZ === z\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.position.scaleX = x;\r\n    this.position.scaleY = y;\r\n    this.position.scaleZ = z;\r\n    this.position.width = x;\r\n    this.position.height = y;\r\n    this.position.length = z;\r\n    this.dirtyScale = true;\r\n    this.dirtyModel = true;\r\n  }\r\n\r\n  scaleRect(rect: Rect3d) {\r\n    this.scale(rect.width, rect.height, rect.length);\r\n  }\r\n\r\n  _buildQuat() {\r\n    const quatMat = this.createMat4NoAlloc(this.rotateMat4Temp);\r\n    let quatRotationxyz = this.createQuatNoAlloc(this.rotateQuatTemp);\r\n    quatRotationxyz = quat.rotateX(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ax)\r\n    );\r\n    quatRotationxyz = quat.rotateY(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.ay)\r\n    );\r\n    quatRotationxyz = quat.rotateZ(\r\n      quatRotationxyz,\r\n      quatRotationxyz,\r\n      this.degreesToRadians(this.position.az)\r\n    );\r\n    quatRotationxyz = quat.normalize(quatRotationxyz, quatRotationxyz);\r\n    return mat4.fromQuat(quatMat, quatRotationxyz);\r\n  }\r\n\r\n  getIntermediateModel(point: number, dest: mat4) {\r\n    const org = this.intermediateModels[point];\r\n    for (const index in dest) {\r\n      if (dest.hasOwnProperty(index)) {\r\n        dest[index] = org[index];\r\n      }\r\n    }\r\n    return dest;\r\n  }\r\n\r\n  _buildModelIntermediate(point: number, dest: mat4) {\r\n    // faster copy - preserve existing reference to prevent GC\r\n    const org = this.intermediateModels[point];\r\n    for (const index in dest) {\r\n      if (dest.hasOwnProperty(index)) {\r\n        org[index] = dest[index];\r\n      }\r\n    }\r\n    return dest;\r\n  }\r\n\r\n  createQuatNoAlloc(out: quat) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 1;\r\n    return out;\r\n  }\r\n\r\n  createMat4NoAlloc(out: mat4) {\r\n    out[0] = 1;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[5] = 1;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[10] = 1;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n    out[15] = 1;\r\n    return out;\r\n  }\r\n\r\n  _buildModel() {\r\n    let _dirty = false;\r\n    let dest = this.createMat4NoAlloc(this.initialMat4Temp);\r\n    if (this.dirtyOrigin) {\r\n      _dirty = true;\r\n      const origin: ReadonlyVec3 = [\r\n        this.position.originX,\r\n        this.position.originY,\r\n        this.position.originZ,\r\n      ];\r\n      mat4.translate(dest, dest, origin);\r\n\r\n      this._buildModelIntermediate(0, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(0, dest);\r\n    }\r\n\r\n    // cache this one as its heavy\r\n    if (this.dirtyQuat || _dirty) {\r\n      _dirty = true;\r\n      this.quatRotationxyz = this._buildQuat();\r\n      mat4.multiply(dest, dest, this.quatRotationxyz);\r\n      this._buildModelIntermediate(1, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(1, dest);\r\n    }\r\n\r\n    if (this.dirtyPos || _dirty) {\r\n      _dirty = true;\r\n      const negOrigin: ReadonlyVec3 = [\r\n        -1 * this.position.originX,\r\n        -1 * this.position.originY,\r\n        -1 * this.position.originZ,\r\n      ];\r\n      mat4.translate(dest, dest, negOrigin);\r\n\r\n      const pos: ReadonlyVec3 = [\r\n        this.position.x,\r\n        this.position.y,\r\n        this.position.z,\r\n      ];\r\n      mat4.translate(dest, dest, pos);\r\n\r\n      this._buildModelIntermediate(2, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(2, dest);\r\n    }\r\n\r\n    if (this.dirtyScale || _dirty) {\r\n      _dirty = true;\r\n      const scale: ReadonlyVec3 = [\r\n        this.position.scaleX,\r\n        this.position.scaleY,\r\n        this.position.scaleZ,\r\n      ];\r\n      mat4.scale(dest, dest, scale);\r\n\r\n      this._buildModelIntermediate(3, dest);\r\n    } else {\r\n      dest = this.getIntermediateModel(3, dest);\r\n    }\r\n\r\n    this.dirtyPos = false;\r\n    this.dirtyQuat = false;\r\n    this.dirtyScale = false;\r\n    this.dirtyOrigin = false;\r\n    this.cachedModel = dest;\r\n  }\r\n\r\n  getModel = () => {\r\n    if (this.dirtyModel) {\r\n      this.dirtyModel = false;\r\n      this._buildModel();\r\n    }\r\n    return this.cachedModel;\r\n  };\r\n\r\n  degreesToRadians(degrees: number) {\r\n    return Math.round(glMatrix.toRadian(degrees) * 100) / 100;\r\n  }\r\n  setRect(rect: Rect3d) {\r\n    this.scaleRect(rect);\r\n    this.centerRect(rect);\r\n  }\r\n\r\n  // memory optimised\r\n  setRect2(\r\n    x: number,\r\n    y: number,\r\n    z: number,\r\n    width: number,\r\n    height: number,\r\n    length: number\r\n  ) {\r\n    this.scale(width, height, length);\r\n    this.center(x, y, z);\r\n  }\r\n\r\n  // memory optimised\r\n  getRect2(): Rect3d {\r\n    return this.position;\r\n  }\r\n\r\n  getRect(): Rect3d {\r\n    return new Rect3d(\r\n      this.position.x,\r\n      this.position.y,\r\n      this.position.z,\r\n      this.position.width,\r\n      this.position.height,\r\n      this.position.length\r\n    );\r\n  }\r\n\r\n  getPosition = () => {\r\n    return this.position;\r\n  };\r\n}\r\n","import EngineObject, { EngineEntity } from \"./EngineObject\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport { EngineEvent } from \"../Events\";\r\nimport Physics from \"../Physics/Physics\";\r\nimport Position from \"./Position\";\r\nimport ConfigMapBuilder from \"../Builder/ConfigMapBuilder\";\r\nimport { FontReference } from \"../Font/Font\";\r\nimport EntityManager2d from \"../../Manager/EntityManager2d\";\r\n\r\nclass EngineMap extends EntityManager2d {\r\n  $ref: { [key: string]: { entity: EngineObject; position: Position } } = {};\r\n  show = false;\r\n  configBuilder?: ConfigMapBuilder;\r\n  engineHelper: EngineHelper;\r\n\r\n  reset() {\r\n    this.entities = [];\r\n    this.$ref = {};\r\n  }\r\n\r\n  beforeShow() {}\r\n\r\n  updatePosition(entity: EngineObject, position: Position) {\r\n    if (this.$ref[entity.$id]) {\r\n      this.$ref[entity.$id].position = position;\r\n    } else {\r\n      console.error(\"Trying to update position when entity not set\", this);\r\n    }\r\n  }\r\n\r\n  setShow(show: boolean) {\r\n    this.show = show;\r\n    if (this.show) {\r\n      this.beforeShow();\r\n    }\r\n    this.entities.forEach((ent: EngineObject) => {\r\n      Physics.setEnabledPhysics(ent, show);\r\n      ent.hidden = !show;\r\n    });\r\n    if (this.show) {\r\n      this.restore();\r\n    }\r\n  }\r\n\r\n  restore() {\r\n    for (const prop in this.$ref) {\r\n      if (this.$ref.hasOwnProperty(prop)) {\r\n        const entityData = this.$ref[prop];\r\n        entityData.entity.setPosition(entityData.position);\r\n      }\r\n    }\r\n  }\r\n\r\n  addEntity(entity: EngineObject): EngineMap {\r\n    if (!this.$ref[entity.$id]) {\r\n      this.entities.push(entity);\r\n      this.$ref[entity.$id] = {\r\n        entity: entity,\r\n        position: entity.position,\r\n      };\r\n    }\r\n    return this;\r\n  }\r\n\r\n  update(engineHelper: EngineHelper) {\r\n    if (!this.show) {\r\n      return;\r\n    }\r\n    this.entities.forEach((ent: EngineObject) => ent.update(engineHelper));\r\n    if (this.configBuilder) {\r\n      this.configBuilder.texts.forEach((fontRef: FontReference) =>\r\n        engineHelper.writeFont(fontRef)\r\n      );\r\n    }\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    if (!this.show) {\r\n      return;\r\n    }\r\n    this.entities.forEach((ent: EngineObject) => ent.render(engineHelper));\r\n  }\r\n\r\n  event(event: EngineEvent, engineHelper: EngineHelper): boolean | undefined {\r\n    if (!this.show) {\r\n      return;\r\n    }\r\n\r\n    for (const entities of this.entities) {\r\n      if (entities.isLastEvent) {\r\n        continue;\r\n      }\r\n\r\n      const shouldPropagate = entities.event(event, engineHelper);\r\n      if (shouldPropagate === false) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    for (const entities of this.entities) {\r\n      if (!entities.isLastEvent) {\r\n        continue;\r\n      }\r\n\r\n      const shouldPropagate = entities.event(event, engineHelper);\r\n      if (shouldPropagate === false) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n    this.entities.forEach((ent: EngineEntity) => ent.init(engineHelper));\r\n  }\r\n  parseMap(engineHelper: EngineHelper, map: any) {\r\n    this.configBuilder = new ConfigMapBuilder(engineHelper);\r\n    this.configBuilder.build(map);\r\n    this.addEntities();\r\n  }\r\n  addEntities() {\r\n    if (!this.configBuilder || !this.configBuilder.objects) return;\r\n    this.configBuilder.objects.forEach((ent: EngineObject) =>\r\n      this.addEntity(ent)\r\n    );\r\n  }\r\n}\r\n\r\nexport default EngineMap;\r\n","export function generateId() {\r\n  return \"xxxxxxxxx\".replace(/[x]/g, function (c) {\r\n    const r = (Math.random() * 16) | 0;\r\n    const v = c == \"x\" ? r : (r & 0x3) | 0x8;\r\n    return v.toString(16);\r\n  });\r\n}\r\n","import { ShaderEntity } from \"../EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport VertexModel from \"../Data/VertexModel\";\r\nimport EngineObject from \"../EngineEntity/EngineObject\";\r\nimport RenderOption from \"../Data/RenderOption\";\r\n\r\nclass ShaderEntityBuilder {\r\n  engineHelper: EngineHelper;\r\n  textureSource?: string;\r\n\r\n  vertexModel: VertexModel;\r\n  hasTexture: boolean;\r\n\r\n  constructor(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n  }\r\n\r\n  createTexture(textureSource: string): ShaderEntityBuilder {\r\n    this.textureSource = textureSource;\r\n    this.hasTexture = true;\r\n    return this;\r\n  }\r\n\r\n  addBuffer(vertexModel: VertexModel): ShaderEntityBuilder {\r\n    this.vertexModel = vertexModel;\r\n    return this;\r\n  }\r\n\r\n  build(engineObject: EngineObject, opt: RenderOption): ShaderEntity {\r\n    if (!this.vertexModel) {\r\n      console.error(\"VertexModel is undefined\", this);\r\n    }\r\n    const entity = new ShaderEntity();\r\n    const entityOption = entity.getOpt();\r\n    entityOption.renderType = opt.renderType;\r\n    entityOption.shaderType = opt.shaderType;\r\n    entity.model = engineObject.getModel;\r\n    entity.modelPosition = () => engineObject.position;\r\n    entity.vertexModel = this.vertexModel;\r\n    entity.vertexModel.registerModel(this.engineHelper);\r\n    this.engineHelper.registerEntity(entity);\r\n    if (this.hasTexture) {\r\n      entity.src = this.textureSource;\r\n      this.engineHelper.createTexture(entity);\r\n    }\r\n    return entity;\r\n  }\r\n\r\n  static clone(shaderEntity: ShaderEntity): ShaderEntity {\r\n    return Object.assign(new ShaderEntity(), shaderEntity);\r\n  }\r\n}\r\n\r\nexport default ShaderEntityBuilder;\r\n","class TextureLoader {\r\n  image: HTMLImageElement;\r\n\r\n  loadImage(src: string): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      this.image = document.createElement(\"img\");\r\n      if (window.location.origin !== \"file://\") {\r\n        this.image.crossOrigin = \"anonymous\";\r\n      }\r\n      this.image.onload = () => resolve();\r\n      this.image.onerror = (error) => reject(error);\r\n      this.image.src = src;\r\n    });\r\n  }\r\n}\r\n\r\nclass Texture extends TextureLoader {\r\n  texUnit: number;\r\n  width: number;\r\n  height: number;\r\n  texture: WebGLTexture;\r\n  isLoaded: boolean;\r\n  isError: boolean;\r\n  load: Promise<boolean>;\r\n\r\n  static textureCount = 0;\r\n  static maxTextureUnits: number | null = null;\r\n  static readonly DEFAULT_MAX_TEXTURE_UNITS = 10;\r\n  constructor(src: string, ctx: WebGLRenderingContext) {\r\n    super();\r\n    this.isLoaded = false;\r\n    this.isError = false;\r\n    \r\n    if (Texture.maxTextureUnits === null) {\r\n      Texture.maxTextureUnits =\r\n        ctx.getParameter(ctx.MAX_TEXTURE_IMAGE_UNITS) || Texture.DEFAULT_MAX_TEXTURE_UNITS;\r\n    }\r\n    \r\n    this.load = this.loadImage(src)\r\n      .then(() => this.onLoad(ctx))\r\n      .catch((error) => this.onError(error));\r\n  }\r\n\r\n  onError(error: Error): boolean {\r\n    this.isError = true;\r\n    this.isLoaded = false;\r\n    throw error;\r\n  }\r\n\r\n  onLoad(ctx: WebGLRenderingContext): boolean {\r\n    this.handleTextureLoaded(this.image, ctx);\r\n    this.isLoaded = true;\r\n    this.width = this.image.width;\r\n    this.height = this.image.height;\r\n    return true;\r\n  }\r\n\r\n  newTextureUnit(): number {\r\n    const maxUnits = Texture.maxTextureUnits || Texture.DEFAULT_MAX_TEXTURE_UNITS;\r\n    if (Texture.textureCount >= maxUnits) {\r\n      console.error(\r\n        `Texture units exceeded: requested index ${Texture.textureCount} >= max ${maxUnits}. Reusing texture units.`\r\n      );\r\n      return Texture.textureCount % maxUnits;\r\n    }\r\n    return Texture.textureCount++;\r\n  }\r\n\r\n  bindTexture(ctx: WebGLRenderingContext, sampler: WebGLUniformLocation) {\r\n    if (this.isLoaded) {\r\n      ctx.uniform1i(sampler, this.texUnit);\r\n    }\r\n  }\r\n\r\n  handleTextureLoaded(image: HTMLImageElement, ctx: WebGLRenderingContext) {\r\n    this.texUnit = this.newTextureUnit();\r\n    ctx.activeTexture(ctx.TEXTURE0 + this.texUnit);\r\n    this.texture = this.createTextureFromImage(image, ctx);\r\n  }\r\n\r\n  createTextureFromImage(\r\n    image: HTMLImageElement,\r\n    ctx: WebGLRenderingContext\r\n  ): WebGLTexture {\r\n    const texture = ctx.createTexture()!;\r\n    ctx.bindTexture(ctx.TEXTURE_2D, texture);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MIN_FILTER, ctx.NEAREST);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MAG_FILTER, ctx.NEAREST);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_WRAP_S, ctx.CLAMP_TO_EDGE);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_WRAP_T, ctx.CLAMP_TO_EDGE);\r\n    ctx.texImage2D(\r\n      ctx.TEXTURE_2D,\r\n      0,\r\n      ctx.RGBA,\r\n      ctx.RGBA,\r\n      ctx.UNSIGNED_BYTE,\r\n      image\r\n    );\r\n    return texture;\r\n  }\r\n}\r\n\r\nexport default Texture;\r\n","import Shader3DProgram from \"../ShaderProgram/Shader3DProgram\";\r\nimport { ShaderType, RenderType } from \"../../Data/RenderOption\";\r\nimport { mat4 } from \"gl-matrix\";\r\nimport Light from \"../../Data/Light\";\r\nimport { BaseCamera } from \"../../Camera\";\r\nimport { ShaderEntity } from \"../../EngineEntity/ShaderEntity\";\r\n\r\nclass Entity3DProgram {\r\n  program: Shader3DProgram;\r\n  ctx: WebGLRenderingContext;\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n    this.program = new Shader3DProgram(ctx);\r\n  }\r\n\r\n  updatePerspective(projectionMatrix: mat4) {\r\n    this.program.bindProgram();\r\n    this.program.glSetProjectMatrix(projectionMatrix as Float32List);\r\n  }\r\n\r\n  delete() {\r\n    this.program.arrayBuffer.delete();\r\n    this.program.delete();\r\n  }\r\n\r\n  setLight(light: Light, camera: BaseCamera) {\r\n    this.program.setLight(light, camera);\r\n  }\r\n\r\n  updateBuffer(entity: ShaderEntity, buffer: number[]) {\r\n    const opt = entity.getOpt();\r\n    if (ShaderType.THREE_DIMENSION !== opt.shaderType) {\r\n      console.error(\r\n        \"Updating buffer for registered 3D Entity but with different shader type as RenderOptions\",\r\n        opt\r\n      );\r\n      return;\r\n    }\r\n\r\n    const buffReg =\r\n      this.program.arrayBuffer.bufferReg[entity.rendererBufferId!];\r\n    if (!buffer || buffer.length !== buffReg.verticesSize) {\r\n      console.error(\r\n        \"New Buffer data does not match initial buffer data!\",\r\n        entity,\r\n        buffer,\r\n        buffReg.verticesSize\r\n      );\r\n    }\r\n\r\n    this.program.arrayBuffer.bufferSub(\r\n      buffReg.offset,\r\n      buffer,\r\n      Shader3DProgram.DRAW_VERTEX_SIZE\r\n    );\r\n  }\r\n\r\n  _render3DShadowEntities(entities: [ShaderEntity, Float32List][]) {\r\n    for (let index = 0; index < entities.length; index++) {\r\n      const data = entities[index];\r\n      const entity = data[0];\r\n      const model = data[1];\r\n      const opt = entity.getOpt();\r\n\r\n      this.program.glSetShadowModelMatrix(model);\r\n\r\n      if (!entity.rendererBufferId) {\r\n        throw new Error(\"Unregistered entity buffer\" + entity);\r\n      }\r\n\r\n      const buffReg =\r\n        this.program.arrayBuffer.bufferReg[entity.rendererBufferId];\r\n\r\n      if (opt.renderType === RenderType.TRIANGLE) {\r\n        this.ctx.drawArrays(this.ctx.TRIANGLES, buffReg.offset, buffReg.size);\r\n      } else {\r\n        this.ctx.drawArrays(\r\n          this.ctx.TRIANGLE_STRIP,\r\n          buffReg.offset,\r\n          buffReg.size\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  _setupShadow() {\r\n    this.program.bindShadowTexture();\r\n  }\r\n\r\n  render3DShadowMap(\r\n    entities: [ShaderEntity, Float32List][],\r\n    setOriginalViewport: Function\r\n  ) {\r\n    if (!this.program.isShadowEnabled) {\r\n      return;\r\n    }\r\n    this.ctx.disable(this.ctx.CULL_FACE);\r\n    this.program.prepareShadowTexture();\r\n    this._render3DShadowEntities(entities);\r\n    this.program.revertShadowTexture();\r\n    setOriginalViewport();\r\n    this.ctx.enable(this.ctx.CULL_FACE);\r\n    this.ctx.cullFace(this.ctx.BACK);\r\n    this._setupShadow();\r\n  }\r\n  render(\r\n    entities: [ShaderEntity, Float32List][],\r\n    camera: BaseCamera,\r\n    textureReg: { [key: string]: any },\r\n    is2d: boolean\r\n  ) {\r\n    this.program.arrayBuffer.bind();\r\n    this.program.bindAttributePointers();\r\n    this.program.bindProgram();\r\n    this.program.glSetViewMatrix(camera.viewMatrix as Float32List);\r\n\r\n    if (is2d) {\r\n      if (this.ctx.isEnabled(this.ctx.CULL_FACE)) {\r\n        this.ctx.disable(this.ctx.CULL_FACE);\r\n      }\r\n      if (this.ctx.isEnabled(this.ctx.DEPTH_TEST)) {\r\n        this.ctx.disable(this.ctx.DEPTH_TEST);\r\n      }\r\n    } else {\r\n      if (!this.ctx.isEnabled(this.ctx.CULL_FACE)) {\r\n        this.ctx.enable(this.ctx.CULL_FACE);\r\n      }\r\n      if (!this.ctx.isEnabled(this.ctx.DEPTH_TEST)) {\r\n        this.ctx.enable(this.ctx.DEPTH_TEST);\r\n      }\r\n    }\r\n\r\n    for (let index = 0; index < entities.length; index++) {\r\n      const data = entities[index];\r\n      const entity = data[0];\r\n      const model = data[1];\r\n      const opt = entity.getOpt();\r\n      if (!entity.rendererTextureRef) {\r\n        throw new Error(\"Unregistered entity texture\" + entity);\r\n      }\r\n\r\n      const texReg = textureReg[entity.rendererTextureRef];\r\n      this.program.bindTexture(texReg.texture);\r\n      this.program.glSetModelViewMatrix(model);\r\n\r\n      if (!entity.rendererBufferId) {\r\n        throw new Error(\"Unregistered entity buffer\" + entity);\r\n      }\r\n      const buffReg =\r\n        this.program.arrayBuffer.bufferReg[entity.rendererBufferId];\r\n      if (opt.renderType === RenderType.TRIANGLE) {\r\n        this.ctx.drawArrays(this.ctx.TRIANGLES, buffReg.offset, buffReg.size);\r\n      } else {\r\n        this.ctx.drawArrays(\r\n          this.ctx.TRIANGLE_STRIP,\r\n          buffReg.offset,\r\n          buffReg.size\r\n        );\r\n      }\r\n    }\r\n    this.program.arrayBuffer.unbind();\r\n    this.program.unbindAttributePointers();\r\n    this.program.unbindProgram();\r\n  }\r\n\r\n  bindBuffer() {\r\n    this.program.arrayBuffer.bufferBind();\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity, objBuffer: number[]) {\r\n    const size = objBuffer.length / Shader3DProgram.DRAW_VERTEX_SIZE;\r\n    this.program.arrayBuffer.bufferReg[this.program.arrayBuffer.bufferRegId] = {\r\n      offset: this.program.arrayBuffer.length(),\r\n      size: size,\r\n      verticesSize: objBuffer.length,\r\n    };\r\n    this.program.arrayBuffer.push(objBuffer, size);\r\n    object.rendererBufferId = this.program.arrayBuffer.bufferRegId;\r\n    this.program.arrayBuffer.bufferRegId++;\r\n  }\r\n\r\n  toggleLighting(enable: boolean) {\r\n    this.program.toggleLighting(enable);\r\n  }\r\n}\r\n\r\nexport default Entity3DProgram;\r\n","export default \"\\r\\nprecision mediump int;\\r\\nprecision mediump float;\\r\\n\\r\\nattribute vec3 a_position;\\r\\n\\r\\nuniform mat4 u_projection;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_model;\\r\\nvoid main(void) {\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n}\\r\\n\\r\\n\";","import EntityManager from \"../Manager/EntityManager\";\r\nimport ObjectManager from \"../Manager/ObjectManager\";\r\nimport Coordinate from \"./Data/Coordinate\";\r\nimport EngineObject from \"./EngineEntity/EngineObject\";\r\nimport EngineHelper from \"./EngineHelper\";\r\nimport Renderer from \"./Renderer\";\r\nimport WorldDelegate from \"./WorldDelegate\";\r\n\r\nexport interface DebugCameraInfo {\r\n  position: Coordinate;\r\n  rotation: { ax: number; ay: number; az: number };\r\n  origin: Coordinate;\r\n}\r\n\r\nexport interface DebugEntityInfo {\r\n  type: string;\r\n  position: Coordinate;\r\n  hidden: boolean;\r\n  hasShaderEntity: boolean;\r\n  textureRef?: string;\r\n  bufferId?: number;\r\n}\r\n\r\nexport interface DebugInfo {\r\n  fps: number;\r\n  frameTime: number;\r\n  entityCount: number;\r\n  camera: DebugCameraInfo;\r\n  entities: DebugEntityInfo[];\r\n  webglInfo: {\r\n    faceCullingEnabled: boolean;\r\n    depthTestEnabled: boolean;\r\n    blendEnabled: boolean;\r\n    clearColor: string;\r\n  };\r\n  renderCalls: number;\r\n  lastError?: string;\r\n}\r\n\r\nexport default class EngineDebugger {\r\n  private debugElement: HTMLDivElement;\r\n  private isVisible: boolean = true;\r\n  private updateInterval: number | null = null;\r\n  private fpsCounter: number = 0;\r\n  private lastFrameTime: number = performance.now();\r\n  private frameTimeHistory: number[] = [];\r\n  private renderCallCount: number = 0;\r\n  private lastError: string | undefined;\r\n  private world: WorldDelegate | null = null;\r\n  private engineHelper: EngineHelper | null = null;\r\n  private renderer: Renderer | null = null;\r\n\r\n  constructor(private canvas: HTMLCanvasElement) {\r\n    this.createDebugUI();\r\n    this.startUpdating();\r\n    this.enableDebugOnRightClick();\r\n    this.hide();\r\n  }\r\n\r\n  /**\r\n   * Cleans up debugger UI and keyboard controls.\r\n   */\r\n  public destroy(): void {\r\n    if (this.updateInterval) {\r\n      clearInterval(this.updateInterval);\r\n      this.updateInterval = null;\r\n    }\r\n\r\n    if (this.debugElement && this.debugElement.parentElement) {\r\n      this.debugElement.parentElement.removeChild(this.debugElement);\r\n    }\r\n  }\r\n\r\n  private createDebugUI(): void {\r\n    // Create debug overlay container\r\n    this.debugElement = document.createElement('div');\r\n    this.debugElement.id = 'engine-debugger';\r\n    this.debugElement.style.cssText = `\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 10px;\r\n      background: rgba(0, 0, 0, 0.9);\r\n      color: #ffffff;\r\n      font-family: 'Courier New', monospace;\r\n      font-size: 12px;\r\n      padding: 15px;\r\n      border-radius: 8px;\r\n      min-width: 400px;\r\n      max-width: 500px;\r\n      max-height: 80vh;\r\n      overflow-y: auto;\r\n      z-index: 10000;\r\n      border: 1px solid #333;\r\n      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\r\n      line-height: 1.4;\r\n    `;\r\n\r\n    // Create the static structure that won't be replaced\r\n    this.createStaticStructure();\r\n\r\n    // Add to canvas parent or body\r\n    const parent = this.canvas.parentElement || document.body;\r\n    parent.style.position = 'relative'; // Ensure parent can contain absolute positioned children\r\n    parent.appendChild(this.debugElement);\r\n  }\r\n\r\n  private createStaticStructure(): void {\r\n    this.debugElement.innerHTML = `\r\n      <div style=\"margin-top: 25px;\">\r\n        <h3 style=\"margin: 0 0 10px 0; color: #4CAF50; font-size: 14px;\"> Engine Debugger</h3>\r\n        \r\n        <div id=\"debug-performance\" style=\"margin-bottom: 10px;\">\r\n          <strong style=\"color: #FFD700;\">Performance:</strong><br>\r\n          <span id=\"perf-content\"></span>\r\n        </div>\r\n\r\n        <div id=\"debug-camera-controls\" style=\"margin-bottom: 15px; border: 1px solid #444; padding: 8px; border-radius: 4px;\">\r\n          <strong style=\"color: #FFD700;\"> Camera Controls:</strong><br>\r\n          <div style=\"margin: 8px 0;\">\r\n            <strong>Position:</strong><br>\r\n            <div style=\"display: flex; gap: 5px; margin: 5px 0;\">\r\n              <div style=\"flex: 1;\">\r\n                X: <input id=\"cam-pos-x\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Y: <input id=\"cam-pos-y\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Z: <input id=\"cam-pos-z\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style=\"margin: 8px 0;\">\r\n            <strong>Rotation:</strong><br>\r\n            <div style=\"display: flex; gap: 5px; margin: 5px 0;\">\r\n              <div style=\"flex: 1;\">\r\n                X: <input id=\"cam-rot-x\" type=\"number\" step=\"1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Y: <input id=\"cam-rot-y\" type=\"number\" step=\"1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Z: <input id=\"cam-rot-z\" type=\"number\" step=\"1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style=\"margin: 8px 0;\">\r\n            <strong>Origin:</strong><br>\r\n            <div style=\"display: flex; gap: 5px; margin: 5px 0;\">\r\n              <div style=\"flex: 1;\">\r\n                X: <input id=\"cam-origin-x\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Y: <input id=\"cam-origin-y\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n              <div style=\"flex: 1;\">\r\n                Z: <input id=\"cam-origin-z\" type=\"number\" step=\"0.1\" \r\n                   style=\"width: 60px; background: #333; color: white; border: 1px solid #555; padding: 2px;\">\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style=\"margin: 8px 0;\">\r\n            <button id=\"reset-camera-btn\" \r\n                    style=\"background: #4CAF50; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 11px;\">\r\n              Reset Camera\r\n            </button>\r\n            <button id=\"look-at-origin-btn\" \r\n                    style=\"background: #2196F3; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 11px; margin-left: 5px;\">\r\n              Look at Origin\r\n            </button>\r\n            <button id=\"reset-origin-btn\" \r\n                    style=\"background: #FF9800; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 11px; margin-left: 5px;\">\r\n              Fix Origin\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"debug-webgl\" style=\"margin-bottom: 10px;\">\r\n          <strong style=\"color: #FFD700;\">WebGL State:</strong><br>\r\n          <span id=\"webgl-content\"></span>\r\n        </div>\r\n\r\n        <div id=\"debug-entities\" style=\"margin-bottom: 10px;\">\r\n          <strong style=\"color: #FFD700;\"> Entities (<span id=\"entity-count\">0</span>):</strong><br>\r\n          <div id=\"entities-container\" style=\"max-height: 180px; overflow-y: auto; overflow-x: hidden; border: 1px solid #444; padding: 5px; margin-top: 5px; background: rgba(0,0,0,0.3);\">\r\n            <!-- Entities will be populated here -->\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"debug-error\" style=\"margin-bottom: 10px; display: none;\">\r\n          <strong style=\"color: #FF4444;\"> Last Error:</strong><br>\r\n          <span id=\"error-content\" style=\"color: #FF4444; font-size: 11px; word-break: break-word;\"></span>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    // Add toggle button\r\n    const toggleButton = document.createElement('button');\r\n    toggleButton.textContent = '';\r\n    toggleButton.style.cssText = `\r\n      position: absolute;\r\n      top: 5px;\r\n      right: 5px;\r\n      background: #ff4444;\r\n      color: white;\r\n      border: none;\r\n      border-radius: 3px;\r\n      width: 20px;\r\n      height: 20px;\r\n      cursor: pointer;\r\n      font-size: 14px;\r\n      line-height: 1;\r\n    `;\r\n    toggleButton.onclick = () => this.toggle();\r\n    this.debugElement.appendChild(toggleButton);\r\n\r\n    // Set up event listeners for camera controls\r\n    this.setupCameraControlEventListeners();\r\n  }\r\n\r\n  private startUpdating(): void {\r\n    this.updateInterval = window.setInterval(() => {\r\n      if (this.isVisible) {\r\n        this.updateDisplay();\r\n      }\r\n    }, 100); // Update 10 times per second\r\n  }\r\n\r\n  private calculateFPS(): number {\r\n    const now = performance.now();\r\n    const frameTime = now - this.lastFrameTime;\r\n    this.lastFrameTime = now;\r\n    \r\n    this.frameTimeHistory.push(frameTime);\r\n    if (this.frameTimeHistory.length > 60) {\r\n      this.frameTimeHistory.shift();\r\n    }\r\n    \r\n    const avgFrameTime = this.frameTimeHistory.reduce((a, b) => a + b, 0) / this.frameTimeHistory.length;\r\n    return Math.round(1000 / avgFrameTime);\r\n  }\r\n\r\n  public updateDebugInfo(engineHelper: EngineHelper | null): void {\r\n    this.fpsCounter = this.calculateFPS();\r\n    \r\n    if (!engineHelper || !this.isVisible) return;\r\n\r\n    const debugInfo = this.gatherDebugInfo(engineHelper);\r\n    this.renderDebugInfo(debugInfo);\r\n  }\r\n\r\n  public setReferences(world: WorldDelegate, renderer: Renderer): void {\r\n    this.world = world;\r\n    this.renderer = renderer;\r\n  }\r\n\r\n  public setEngineHelper(engineHelper: EngineHelper): void {\r\n    this.engineHelper = engineHelper;\r\n  }\r\n\r\n  private buildEntityInfo(entity: EngineObject): DebugEntityInfo {\r\n    return {\r\n      type: entity ? entity.constructor.name : 'null',\r\n      position: entity ? {\r\n        x: Math.round(entity.position.x * 100) / 100,\r\n        y: Math.round(entity.position.y * 100) / 100,\r\n        z: Math.round(entity.position.z * 100) / 100\r\n      } : { x: 0, y: 0, z: 0 },\r\n      hidden: entity ? entity.hidden : true,\r\n      hasShaderEntity: entity ? !!entity.shaderEntity : false,\r\n      textureRef: entity?.shaderEntity?.rendererTextureRef,\r\n      bufferId: entity?.shaderEntity?.rendererBufferId\r\n    };\r\n  }\r\n\r\n  private gatherDebugInfo(engineHelper: EngineHelper): DebugInfo {\r\n    const camera = engineHelper.camera;\r\n    \r\n    // Get WebGL context info from the canvas\r\n    const canvas = this.canvas;\r\n    const glContext = canvas.getContext('webgl') || canvas.getContext('experimental-webgl') as WebGLRenderingContext;\r\n    const webglInfo = glContext ? {\r\n      faceCullingEnabled: glContext.isEnabled(glContext.CULL_FACE),\r\n      depthTestEnabled: glContext.isEnabled(glContext.DEPTH_TEST),\r\n      blendEnabled: glContext.isEnabled(glContext.BLEND),\r\n      clearColor: this.getClearColorString(glContext)\r\n    } : {\r\n      faceCullingEnabled: false,\r\n      depthTestEnabled: false,\r\n      blendEnabled: false,\r\n      clearColor: 'unknown'\r\n    };\r\n\r\n    // Get camera info\r\n    const cameraInfo = {\r\n      position: { \r\n        x: Math.round(camera.getActiveCamera().position.x * 100) / 100, \r\n        y: Math.round(camera.getActiveCamera().position.y * 100) / 100, \r\n        z: Math.round(camera.getActiveCamera().position.z * 100) / 100 \r\n      },\r\n      rotation: { \r\n        ax: Math.round(camera.getActiveCamera().position.ax * 100) / 100, \r\n        ay: Math.round(camera.getActiveCamera().position.ay * 100) / 100, \r\n        az: Math.round(camera.getActiveCamera().position.az * 100) / 100 \r\n      },\r\n      origin: {\r\n        x: Math.round(camera.getActiveCamera().position.originX * 100) / 100,\r\n        y: Math.round(camera.getActiveCamera().position.originY * 100) / 100,\r\n        z: Math.round(camera.getActiveCamera().position.originZ * 100) / 100\r\n      }\r\n    };\r\n\r\n    const entities = this.world instanceof ObjectManager && this.world?.entities?.flatMap((entity: EngineObject, index) => {\r\n      if (entity instanceof EntityManager) {\r\n        return entity.entities.map(obj => this.buildEntityInfo(obj));\r\n      }\r\n      return this.buildEntityInfo(entity)\r\n    }) || [];\r\n\r\n    return {\r\n      fps: this.fpsCounter,\r\n      frameTime: this.frameTimeHistory.length > 0 ? \r\n        Math.round(this.frameTimeHistory[this.frameTimeHistory.length - 1] * 100) / 100 : 0,\r\n      entityCount: entities.length,\r\n      camera: cameraInfo,\r\n      entities: entities,\r\n      webglInfo: webglInfo,\r\n      renderCalls: this.renderCallCount,\r\n      lastError: this.lastError\r\n    };\r\n  }\r\n\r\n  private getClearColorString(ctx: WebGLRenderingContext): string {\r\n    const color = ctx.getParameter(ctx.COLOR_CLEAR_VALUE) as Float32Array;\r\n    return `rgba(${Math.round(color[0] * 255)}, ${Math.round(color[1] * 255)}, ${Math.round(color[2] * 255)}, ${color[3]})`;\r\n  }\r\n\r\n  private renderDebugInfo(info: DebugInfo): void {\r\n    const perfContent = this.debugElement.querySelector('#perf-content');\r\n    if (perfContent) {\r\n      perfContent.innerHTML = `\r\n        FPS: <span style=\"color: ${info.fps > 50 ? '#4CAF50' : info.fps > 30 ? '#FFA500' : '#FF4444'}\">${info.fps}</span><br>\r\n        Frame Time: ${info.frameTime}ms<br>\r\n        Render Calls: ${info.renderCalls}\r\n      `;\r\n    }\r\n\r\n    // Update camera controls with current values\r\n    this.updateCameraControls(info.camera);\r\n\r\n    // Update WebGL state\r\n    const webglContent = this.debugElement.querySelector('#webgl-content');\r\n    if (webglContent) {\r\n      webglContent.innerHTML = `\r\n        Face Culling: <span style=\"color: ${info.webglInfo.faceCullingEnabled ? '#4CAF50' : '#FF4444'}\">${info.webglInfo.faceCullingEnabled ? 'ON' : 'OFF'}</span><br>\r\n        Depth Test: <span style=\"color: ${info.webglInfo.depthTestEnabled ? '#4CAF50' : '#FF4444'}\">${info.webglInfo.depthTestEnabled ? 'ON' : 'OFF'}</span><br>\r\n        Blend: <span style=\"color: ${info.webglInfo.blendEnabled ? '#4CAF50' : '#FF4444'}\">${info.webglInfo.blendEnabled ? 'ON' : 'OFF'}</span><br>\r\n        Clear Color: ${info.webglInfo.clearColor}\r\n      `;\r\n    }\r\n\r\n    // Update entity count\r\n    const entityCountEl = this.debugElement.querySelector('#entity-count');\r\n    if (entityCountEl) {\r\n      entityCountEl.textContent = info.entityCount.toString();\r\n    }\r\n\r\n    // Update entities list efficiently - preserve scroll position\r\n    this.updateEntitiesList(info.entities);\r\n\r\n    // Update error display\r\n    this.updateErrorDisplay(info.lastError);\r\n  }\r\n\r\n  private updateCameraControls(camera: DebugInfo['camera']): void {\r\n    const posX = this.debugElement.querySelector('#cam-pos-x') as HTMLInputElement;\r\n    const posY = this.debugElement.querySelector('#cam-pos-y') as HTMLInputElement;\r\n    const posZ = this.debugElement.querySelector('#cam-pos-z') as HTMLInputElement;\r\n    const rotX = this.debugElement.querySelector('#cam-rot-x') as HTMLInputElement;\r\n    const rotY = this.debugElement.querySelector('#cam-rot-y') as HTMLInputElement;\r\n    const rotZ = this.debugElement.querySelector('#cam-rot-z') as HTMLInputElement;\r\n    \r\n    // Origin input elements\r\n    const originX = this.debugElement.querySelector('#cam-origin-x') as HTMLInputElement;\r\n    const originY = this.debugElement.querySelector('#cam-origin-y') as HTMLInputElement;\r\n    const originZ = this.debugElement.querySelector('#cam-origin-z') as HTMLInputElement;\r\n\r\n    if (posX && posX !== document.activeElement) {\r\n      posX.value = camera.position.x.toString();\r\n    }\r\n    if (posY && posY !== document.activeElement) {\r\n      posY.value = camera.position.y.toString();\r\n    }\r\n    if (posZ && posZ !== document.activeElement) {\r\n      posZ.value = camera.position.z.toString();\r\n    }\r\n    if (rotX && rotX !== document.activeElement) {\r\n      rotX.value = camera.rotation.ax.toString();\r\n    }\r\n    if (rotY && rotY !== document.activeElement) {\r\n      rotY.value = camera.rotation.ay.toString();\r\n    }\r\n    if (rotZ && rotZ !== document.activeElement) {\r\n      rotZ.value = camera.rotation.az.toString();\r\n    }\r\n\r\n    // Update origin input fields with proper styling based on values\r\n    if (originX && originX !== document.activeElement) {\r\n      originX.value = camera.origin.x.toString();\r\n      originX.style.borderColor = camera.origin.x === 0 ? '#4CAF50' : '#FF4444';\r\n    }\r\n    if (originY && originY !== document.activeElement) {\r\n      originY.value = camera.origin.y.toString();\r\n      originY.style.borderColor = camera.origin.y === 0 ? '#4CAF50' : '#FF4444';\r\n    }\r\n    if (originZ && originZ !== document.activeElement) {\r\n      originZ.value = camera.origin.z.toString();\r\n      originZ.style.borderColor = camera.origin.z === 0 ? '#4CAF50' : '#FF4444';\r\n    }\r\n  }\r\n\r\n  private updateEntitiesList(entities: DebugInfo['entities']): void {\r\n    const container = this.debugElement.querySelector('#entities-container');\r\n    if (!container) return;\r\n\r\n    // Save current scroll position\r\n    const scrollTop = container.scrollTop;\r\n\r\n    // Generate new content\r\n    const entitiesHtml = entities.map((entity, index) => `\r\n      <div style=\"margin-bottom: 5px; padding: 4px; border-left: 3px solid ${entity.hidden ? '#FF4444' : '#4CAF50'}; background: rgba(255,255,255,0.05); border-radius: 2px;\">\r\n        <strong style=\"color: #87CEEB;\">${index}: ${entity.type}</strong><br>\r\n        <span style=\"font-size: 11px;\">\r\n          Pos: (${entity.position.x}, ${entity.position.y}, ${entity.position.z})<br>\r\n          Hidden: ${entity.hidden ? '' : ''} | \r\n          Shader: ${entity.hasShaderEntity ? '' : ''}<br>\r\n          ${entity.textureRef ? `Texture: <span style=\"color: #90EE90;\">${entity.textureRef}</span><br>` : ''}\r\n          ${entity.bufferId !== undefined ? `Buffer ID: <span style=\"color: #FFB6C1;\">${entity.bufferId}</span>` : '<span style=\"color: #FF6B6B;\">No Buffer</span>'}\r\n        </span>\r\n      </div>\r\n    `).join('');\r\n\r\n    // Only update if content has changed\r\n    if (container.innerHTML !== entitiesHtml) {\r\n      container.innerHTML = entitiesHtml;\r\n      // Restore scroll position\r\n      container.scrollTop = scrollTop;\r\n    }\r\n  }\r\n\r\n  private updateErrorDisplay(lastError?: string): void {\r\n    const errorDiv = this.debugElement.querySelector('#debug-error') as HTMLElement;\r\n    const errorContent = this.debugElement.querySelector('#error-content') as HTMLElement;\r\n    \r\n    if (lastError && errorDiv && errorContent) {\r\n      errorDiv.style.display = 'block';\r\n      errorContent.textContent = lastError;\r\n    } else if (errorDiv) {\r\n      errorDiv.style.display = 'none';\r\n    }\r\n  }\r\n\r\n  private updateDisplay(): void {\r\n\r\n  }\r\n\r\n  public toggle(): void {\r\n    this.isVisible = !this.isVisible;\r\n    this.debugElement.style.display = this.isVisible ? 'block' : 'none';\r\n  }\r\n\r\n  public show(): void {\r\n    this.isVisible = true;\r\n    this.debugElement.style.display = 'block';\r\n  }\r\n\r\n  public hide(): void {\r\n    this.isVisible = false;\r\n    this.debugElement.style.display = 'none';\r\n  }\r\n\r\n  public incrementRenderCalls(): void {\r\n    this.renderCallCount++;\r\n  }\r\n\r\n  public resetRenderCalls(): void {\r\n    this.renderCallCount = 0;\r\n  }\r\n\r\n  public logError(error: string): void {\r\n    this.lastError = error;\r\n    console.error('Engine Error:', error);\r\n  }\r\n\r\n\r\n\r\n  private setupCameraControlEventListeners(): void {\r\n    // Position controls\r\n    const posX = this.debugElement.querySelector('#cam-pos-x') as HTMLInputElement;\r\n    const posY = this.debugElement.querySelector('#cam-pos-y') as HTMLInputElement;\r\n    const posZ = this.debugElement.querySelector('#cam-pos-z') as HTMLInputElement;\r\n    \r\n    posX?.addEventListener('change', (e) => this.setCameraPosition('x', (e.target as HTMLInputElement).value));\r\n    posY?.addEventListener('change', (e) => this.setCameraPosition('y', (e.target as HTMLInputElement).value));\r\n    posZ?.addEventListener('change', (e) => this.setCameraPosition('z', (e.target as HTMLInputElement).value));\r\n\r\n    // Rotation controls\r\n    const rotX = this.debugElement.querySelector('#cam-rot-x') as HTMLInputElement;\r\n    const rotY = this.debugElement.querySelector('#cam-rot-y') as HTMLInputElement;\r\n    const rotZ = this.debugElement.querySelector('#cam-rot-z') as HTMLInputElement;\r\n    \r\n    rotX?.addEventListener('change', (e) => this.setCameraRotation('ax', (e.target as HTMLInputElement).value));\r\n    rotY?.addEventListener('change', (e) => this.setCameraRotation('ay', (e.target as HTMLInputElement).value));\r\n    rotZ?.addEventListener('change', (e) => this.setCameraRotation('az', (e.target as HTMLInputElement).value));\r\n\r\n    // Origin controls\r\n    const originX = this.debugElement.querySelector('#cam-origin-x') as HTMLInputElement;\r\n    const originY = this.debugElement.querySelector('#cam-origin-y') as HTMLInputElement;\r\n    const originZ = this.debugElement.querySelector('#cam-origin-z') as HTMLInputElement;\r\n    \r\n    originX?.addEventListener('change', (e) => this.setCameraOrigin('x', (e.target as HTMLInputElement).value));\r\n    originY?.addEventListener('change', (e) => this.setCameraOrigin('y', (e.target as HTMLInputElement).value));\r\n    originZ?.addEventListener('change', (e) => this.setCameraOrigin('z', (e.target as HTMLInputElement).value));\r\n\r\n    // Buttons\r\n    const resetBtn = this.debugElement.querySelector('#reset-camera-btn') as HTMLButtonElement;\r\n    const lookAtBtn = this.debugElement.querySelector('#look-at-origin-btn') as HTMLButtonElement;\r\n    const resetOriginBtn = this.debugElement.querySelector('#reset-origin-btn') as HTMLButtonElement;\r\n    \r\n    resetBtn?.addEventListener('click', () => this.resetCamera());\r\n    lookAtBtn?.addEventListener('click', () => this.lookAtOrigin());\r\n    resetOriginBtn?.addEventListener('click', () => this.resetCameraOrigin());\r\n  }\r\n\r\n  public enableDebugOnRightClick(): void {\r\n    this.canvas.addEventListener('contextmenu', (event) => {\r\n      event.preventDefault();\r\n\r\n      const debugMenu = document.createElement('div');\r\n      debugMenu.style.cssText = `\r\n        position: absolute;\r\n        top: ${event.clientY}px;\r\n        left: ${event.clientX}px;\r\n        background: #333;\r\n        color: white;\r\n        border: 1px solid #555;\r\n        padding: 10px;\r\n        border-radius: 5px;\r\n        z-index: 10001;\r\n      `;\r\n      debugMenu.innerHTML = '<button id=\"debug-toggle\">Toggle Debug</button>';\r\n\r\n      document.body.appendChild(debugMenu);\r\n\r\n      const toggleButton = debugMenu.querySelector('#debug-toggle') as HTMLButtonElement;\r\n      toggleButton.addEventListener('click', () => {\r\n        this.toggle();\r\n        document.body.removeChild(debugMenu);\r\n      });\r\n\r\n      document.addEventListener('click', () => {\r\n        if (document.body.contains(debugMenu)) {\r\n          document.body.removeChild(debugMenu);\r\n        }\r\n      }, { once: true });\r\n    });\r\n  }\r\n\r\n  private setCameraPosition(axis: string, value: string): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    switch (axis) {\r\n      case 'x':\r\n        camera.position.x = numValue;\r\n        break;\r\n      case 'y':\r\n        camera.position.y = numValue;\r\n        break;\r\n      case 'z':\r\n        camera.position.z = numValue;\r\n        break;\r\n    }\r\n    camera.updateProjectionView();\r\n  }\r\n\r\n  private setCameraRotation(axis: string, value: string): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    switch (axis) {\r\n      case 'ax':\r\n        camera.position.ax = numValue;\r\n        break;\r\n      case 'ay':\r\n        camera.position.ay = numValue;\r\n        break;\r\n      case 'az':\r\n        camera.position.az = numValue;\r\n        break;\r\n    }\r\n    camera.updateProjectionView();\r\n  }\r\n\r\n  private setCameraOrigin(axis: string, value: string): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    switch (axis) {\r\n      case 'x':\r\n        camera.position.originX = numValue;\r\n        break;\r\n      case 'y':\r\n        camera.position.originY = numValue;\r\n        break;\r\n      case 'z':\r\n        camera.position.originZ = numValue;\r\n        break;\r\n    }\r\n    camera.dirtyOrigin = true;\r\n    camera.dirtyQuat = true;\r\n    camera.dirtyModel = true;\r\n    camera.updateProjectionView();\r\n  }\r\n\r\n  private resetCamera(): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    camera.center(0, 2, 5);\r\n    camera.position.ax = 0;\r\n    camera.position.ay = 0;\r\n    camera.position.az = 0;\r\n    camera.updateProjectionView();\r\n    console.log('Camera reset to default position');\r\n  }\r\n\r\n  private lookAtOrigin(): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    camera.lookAt(0, 0, 0);\r\n    camera.updateProjectionView();\r\n    console.log('Camera looking at origin');\r\n  }\r\n\r\n  private resetCameraOrigin(): void {\r\n    if (!this.engineHelper || !this.engineHelper.camera) return;\r\n    \r\n    const camera = this.engineHelper.camera.getActiveCamera();\r\n    camera.position.originX = 0;\r\n    camera.position.originY = 0;\r\n    camera.position.originZ = 0;\r\n    camera.dirtyOrigin = true;\r\n    camera.dirtyQuat = true;\r\n    camera.dirtyModel = true;\r\n    camera.updateProjectionView();\r\n    console.log('Camera rotation origin reset to (0,0,0)');\r\n  }\r\n}\r\n","export class Notification {\r\n  key: string;\r\n  action: string;\r\n\r\n  constructor(key: string, action: string) {\r\n    this.key = key;\r\n    this.action = action;\r\n  }\r\n}\r\n\r\nexport class NotificationPayload extends Notification {\r\n  data?: any;\r\n\r\n  constructor(key: string, action: string, data?: any) {\r\n    super(key, action);\r\n    this.data = data;\r\n  }\r\n\r\n  static from(notification: Notification, data?: any): NotificationPayload {\r\n    return new NotificationPayload(notification.key, notification.action, data);\r\n  }\r\n}\r\n\r\nclass LinkedList {\r\n  next?: LinkedList;\r\n  data: NotificationPayload;\r\n\r\n  constructor(data: NotificationPayload) {\r\n    this.data = data;\r\n  }\r\n}\r\n\r\nclass NotificationQueue {\r\n  queueMap: { [key: string]: { bottom?: LinkedList; top?: LinkedList } };\r\n\r\n  constructor() {\r\n    this.queueMap = {};\r\n  }\r\n\r\n  clearQueue() {\r\n    this.queueMap = {};\r\n  }\r\n\r\n  pushPayload(notification: NotificationPayload) {\r\n    const key = notification.key;\r\n    let nodes = this.queueMap[key];\r\n    if (!nodes) {\r\n      this.queueMap[key] = { bottom: undefined, top: undefined };\r\n      nodes = this.queueMap[key];\r\n    }\r\n    if (!nodes.bottom) {\r\n      nodes.bottom = new LinkedList(notification);\r\n      nodes.top = nodes.bottom;\r\n    } else if (nodes.top) {\r\n      nodes.top.next = new LinkedList(notification);\r\n      nodes.top = nodes.top.next;\r\n    } else {\r\n      throw new Error(\"Unexpected state for notification push payload\");\r\n    }\r\n  }\r\n\r\n  push(notification: Notification, data?: any) {\r\n    if (notification instanceof NotificationPayload) {\r\n      console.error(\"Please use pushPayload\");\r\n    }\r\n    this.pushPayload(\r\n      new NotificationPayload(notification.key, notification.action, data)\r\n    );\r\n  }\r\n\r\n  pushNotification(key: string, action: string) {\r\n    this.push(new Notification(key, action));\r\n  }\r\n\r\n  take(key: string): NotificationPayload | undefined {\r\n    const bottom = this.getBottom(key);\r\n    if (!bottom) {\r\n      return undefined;\r\n    }\r\n    const data = this.peak(key);\r\n    if (!data) {\r\n      throw new Error(\r\n        \"Expected data to appear when reading data from notification\"\r\n      );\r\n    }\r\n    this.shiftQueue(key);\r\n    return data;\r\n  }\r\n\r\n  shiftQueue(key: string) {\r\n    const nodes = this.queueMap[key];\r\n    const bottom = nodes.bottom;\r\n    if (bottom) {\r\n      nodes.bottom = bottom.next;\r\n      if (!nodes.bottom) {\r\n        nodes.top = undefined;\r\n      }\r\n    } else {\r\n      throw new Error(\"Trying to shift queue with bottom undefined\");\r\n    }\r\n  }\r\n\r\n  getBottom(key: string): LinkedList | undefined {\r\n    return this.queueMap[key] ? this.queueMap[key].bottom : undefined;\r\n  }\r\n\r\n  peak(key: string): NotificationPayload | undefined {\r\n    const bottom = this.getBottom(key);\r\n    return (bottom && bottom.data) || undefined;\r\n  }\r\n}\r\n\r\nexport default NotificationQueue;\r\n","export default \"\\r\\nprecision mediump int;\\r\\nprecision mediump float;\\r\\n\\r\\nattribute vec3 a_position;\\r\\nattribute vec2 a_texture_coords;\\r\\nattribute vec3 a_normal;\\r\\n\\r\\nuniform mat4 u_projection;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_model;\\r\\n\\r\\nuniform vec3 u_light1_pos;\\r\\nuniform vec3 u_light1_intensities;\\r\\nuniform float u_light1_attenuation;\\r\\nuniform float u_light1_ambient_coefficient;\\r\\nuniform mat4 u_light1_view;\\r\\nuniform mat4 u_light1_projection;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\n\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\nvarying vec4 v_shadow_pos;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nfloat transpose(float m) {\\r\\n  return m;\\r\\n}\\r\\n\\r\\nmat2 transpose(mat2 m) {\\r\\n  return mat2(m[0][0], m[1][0],\\r\\n    m[0][1], m[1][1]);\\r\\n}\\r\\n\\r\\nmat3 transpose(mat3 m) {\\r\\n  return mat3(m[0][0], m[1][0], m[2][0],\\r\\n    m[0][1], m[1][1], m[2][1],\\r\\n    m[0][2], m[1][2], m[2][2]);\\r\\n}\\r\\n\\r\\nmat4 transpose(mat4 m) {\\r\\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\\r\\n    m[0][1], m[1][1], m[2][1], m[3][1],\\r\\n    m[0][2], m[1][2], m[2][2], m[3][2],\\r\\n    m[0][3], m[1][3], m[2][3], m[3][3]);\\r\\n}\\r\\n\\r\\nfloat inverse(float m) {\\r\\n  return 1.0 / m;\\r\\n}\\r\\n\\r\\nmat2 inverse(mat2 m) {\\r\\n  return mat2(m[1][1], -m[0][1],\\r\\n    -m[1][0], m[0][0]) / (m[0][0] * m[1][1] - m[0][1] * m[1][0]);\\r\\n}\\r\\n\\r\\nmat3 inverse(mat3 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\\r\\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\\r\\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\\r\\n\\r\\n  float b01 = a22 * a11 - a12 * a21;\\r\\n  float b11 = -a22 * a10 + a12 * a20;\\r\\n  float b21 = a21 * a10 - a11 * a20;\\r\\n\\r\\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\\r\\n\\r\\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\\r\\n    b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\\r\\n    b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\\r\\n}\\r\\n\\r\\nmat4 inverse(mat4 m) {\\r\\n  float\\r\\n  a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n    a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n    a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n    a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\\r\\n\\r\\n    b00 = a00 * a11 - a01 * a10,\\r\\n    b01 = a00 * a12 - a02 * a10,\\r\\n    b02 = a00 * a13 - a03 * a10,\\r\\n    b03 = a01 * a12 - a02 * a11,\\r\\n    b04 = a01 * a13 - a03 * a11,\\r\\n    b05 = a02 * a13 - a03 * a12,\\r\\n    b06 = a20 * a31 - a21 * a30,\\r\\n    b07 = a20 * a32 - a22 * a30,\\r\\n    b08 = a20 * a33 - a23 * a30,\\r\\n    b09 = a21 * a32 - a22 * a31,\\r\\n    b10 = a21 * a33 - a23 * a31,\\r\\n    b11 = a22 * a33 - a23 * a32,\\r\\n\\r\\n    det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat4(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03,\\r\\n    a22 * b04 - a21 * b05 - a23 * b03,\\r\\n    a12 * b08 - a10 * b11 - a13 * b07,\\r\\n    a00 * b11 - a02 * b08 + a03 * b07,\\r\\n    a32 * b02 - a30 * b05 - a33 * b01,\\r\\n    a20 * b05 - a22 * b02 + a23 * b01,\\r\\n    a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a30 * b04 - a31 * b02 + a33 * b00,\\r\\n    a21 * b02 - a20 * b04 - a23 * b00,\\r\\n    a11 * b07 - a10 * b09 - a12 * b06,\\r\\n    a00 * b09 - a01 * b07 + a02 * b06,\\r\\n    a31 * b01 - a30 * b03 - a32 * b00,\\r\\n    a20 * b03 - a21 * b01 + a22 * b00) / det;\\r\\n}\\r\\n\\r\\nconst mat4 norm_shadow_coords = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n    v_texture_coords = a_texture_coords;\\r\\n    return;\\r\\n  }\\r\\n  \\r\\n  v_texture_coords = a_texture_coords;\\r\\n  v_position = a_position;\\r\\n  v_normal = a_normal;\\r\\n  v_model = u_model;\\r\\n\\r\\n  v_light1_pos = u_light1_pos;\\r\\n  v_light1_intensities = u_light1_intensities;\\r\\n  v_light1_attenuation = u_light1_attenuation;\\r\\n  v_light1_ambient_coefficient = u_light1_ambient_coefficient;\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec3 surfacePos = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  mat3 normalMatrix = transpose(inverse(mat3(v_model)));\\r\\n  vec3 normal = normalize(normalMatrix * v_normal);\\r\\n\\r\\n  vec3 fragPosition = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  vec3 surfaceToLight = light1.position - fragPosition;\\r\\n\\r\\n  float brightness = dot(normal, surfaceToLight) / (length(surfaceToLight) * length(normal));\\r\\n  if (brightness > 1.0) {\\r\\n    brightness = 1.0;\\r\\n  } else if (brightness < 0.0) {\\r\\n    brightness = 0.0;\\r\\n  }\\r\\n\\r\\n  float distanceToLight = length(light1.position - surfacePos);\\r\\n\\r\\n  v_diffuseCoefficient = max(0.0, dot(normal, surfaceToLight));\\r\\n  v_attenuation = 1.0 / (1.0 + light1.attenuation * pow(distanceToLight, 2.0));\\r\\n  v_shadow_pos = norm_shadow_coords * u_light1_projection * u_light1_view * u_model * vec4(a_position, 1.0);\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n}\\r\\n\\r\\n\";","import RenderOption, {\r\n  ShaderType,\r\n  RenderType,\r\n} from \"../Core/Data/RenderOption\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport ShaderEntityBuilder from \"../Core/Builder/ShaderEntityBuilder\";\r\nimport VertexModel from \"../Core/Data/VertexModel\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport Colour from \"../Core/Data/Colour\";\r\nimport ColourVertexModel from \"../Core/Data/ColourVertexModel\";\r\nimport EngineObjectHelper from \"../Core/EngineEntity/EngineObjectHelper\";\r\n\r\nexport default class PlaneColour extends EngineObject {\r\n  vertexModel: VertexModel;\r\n  constructor(rect: Rect2d, private rgba: Colour) {\r\n    super();\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = new ColourVertexModel().fillRenderUnits(\r\n      EngineObjectHelper.vertex.planeXYColour(\r\n        this.rgba || new Colour(0, 0, 0, 0)\r\n      )\r\n    );\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.TRIANGLE;\r\n    renderOpt.shaderType = ShaderType.COLOUR;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import EntityManager from \"./EntityManager\";\r\nimport Plane2d from \"../Entity/Plane2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class EntityManager2d extends EntityManager {\r\n  setLayer(priority: number): any {\r\n    this.entities.forEach((entity) => {\r\n      if (entity instanceof Plane2d) {\r\n        entity.setLayer(priority);\r\n      }\r\n    });\r\n    this.position.z = -1 * priority;\r\n    return this;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    super.init(engineHelper);\r\n    this.setLayer(-this.position.z);\r\n  }\r\n}\r\n","import ShaderEntityBuilder from \"../Core/Builder/ShaderEntityBuilder\";\r\nimport ColourVertexModel from \"../Core/Data/ColourVertexModel\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport RenderOption, {\r\n  RenderType,\r\n  ShaderType,\r\n} from \"../Core/Data/RenderOption\";\r\nimport { Colour } from \"../Core/Data/RenderUnit\";\r\nimport VertexModel from \"../Core/Data/VertexModel\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"../Core/EngineEntity/EngineObjectHelper\";\r\nimport { ShaderEntity } from \"../Core/EngineEntity/ShaderEntity\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class TriangleColour2d extends EngineObject {\r\n  vertexModel: VertexModel;\r\n  constructor(rect: Rect2d, rgba: Colour) {\r\n    super();\r\n    this.vertexModel = new ColourVertexModel().fillRenderUnits(\r\n      EngineObjectHelper.vertex.triangleXYColour(rgba)\r\n    );\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.TRIANGLE;\r\n    renderOpt.shaderType = ShaderType.COLOUR;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","export class FontMeta {\r\n  filename: string;\r\n  height: number;\r\n  width: number;\r\n  fonts: { [key: string]: FontCharacter } = {};\r\n  lineHeight: number;\r\n}\r\n\r\nexport class FontCharacter {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  charCode: number;\r\n  char: string;\r\n  xOffset: number;\r\n  yOffset: number;\r\n}\r\n\r\nclass FontMetaData {\r\n  context: FontMeta;\r\n}\r\n\r\nexport default FontMetaData;\r\n","import ShaderEntityBuilder from \"../Builder/ShaderEntityBuilder\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport RenderOption, { RenderType, ShaderType } from \"../Data/RenderOption\";\r\nimport EngineHelper from \"../EngineHelper\";\r\nimport EngineObject from \"./EngineObject\";\r\nimport { ShaderEntity } from \"./ShaderEntity\";\r\nimport TextureVertexModel from \"../Data/TextureVertexModel\";\r\n\r\nexport default class ModelObjectRect3d extends EngineObject {\r\n  public vertexModel: TextureVertexModel;\r\n\r\n  constructor(rect: Rect3d, vertexModel: TextureVertexModel) {\r\n    super();\r\n    this.vertexModel = vertexModel;\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n    this.scaleRect(rect);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.RECTANGLE;\r\n    renderOpt.shaderType = ShaderType.THREE_DIMENSION;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .createTexture(this.vertexModel.textureSource)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import WorldDelegate from \"./WorldDelegate\";\r\nimport EngineHelper from \"./EngineHelper\";\r\n\r\nexport default class Updater {\r\n  world: WorldDelegate;\r\n\r\n  constructor(args: { [key: string]: any }) {\r\n    if (!args.world) {\r\n      throw new Error(\"world not defined\");\r\n    }\r\n    this.world = args.world;\r\n  }\r\n\r\n  update(time: number, engineHelper: EngineHelper) {\r\n    engineHelper.setTime(time);\r\n    this.world.update();\r\n    engineHelper.updateFont();\r\n  }\r\n}\r\n","import { vec3 } from \"gl-matrix\";\r\nimport { ModelPosition } from \"..\";\r\nimport { AppSubscription } from \"./App\";\r\nimport Camera from \"./Camera\";\r\nimport NotificationQueue from \"./Common/NotificationQueue\";\r\nimport SubscriberPool from \"./Common/SubscriberPool\";\r\nimport FontMetaData from \"./Data/FontMetaData\";\r\nimport Light from \"./Data/Light\";\r\nimport ModelData from \"./Data/ModelData\";\r\nimport PlaneType from \"./Data/PlaneType\";\r\nimport Rect3d from \"./Data/Rect3d\";\r\nimport { ShaderType } from \"./Data/RenderOption\";\r\nimport TextureVertexModel from \"./Data/TextureVertexModel\";\r\nimport EngineObject from \"./EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"./EngineEntity/EngineObjectHelper\";\r\nimport Position from \"./EngineEntity/Position\";\r\nimport { ShaderEntity } from \"./EngineEntity/ShaderEntity\";\r\nimport { EngineEvent } from \"./Events\";\r\nimport Font, { FontReference } from \"./Font/Font\";\r\nimport { CollisionDetection } from \"./Physics/CollisionDetection\";\r\nimport { RendererNotification, RendererSubscription } from \"./Renderer\";\r\n\r\nexport default class EngineHelper {\r\n  notificationQueue: NotificationQueue;\r\n  subscriberPool: SubscriberPool;\r\n  resourcesLoading: Promise<RetrieveResource>[] = [];\r\n  bufferCache: { [key: number]: ModelData } = {};\r\n  fontCache: { [key: number]: { meta: FontMetaData; font: Font } } = {};\r\n  fontNameKeyReverse: { [key: string]: number } = {};\r\n  uvCache: { [key: string]: { source: string; uv: number[] } } = {};\r\n  vertexUVCache: { [key: string]: { source: string; uv: number[] } } = {};\r\n  camera: Camera;\r\n  time: number;\r\n  cacheId = 0;\r\n  fps: number;\r\n  \r\n  constructor(\r\n    notificationQueue: NotificationQueue,\r\n    subscriberPool: SubscriberPool,\r\n    camera: Camera\r\n  ) {\r\n    this.camera = camera;\r\n    this.notificationQueue = notificationQueue;\r\n    this.subscriberPool = subscriberPool;\r\n    subscriberPool.listen(AppSubscription.GET_FPS, (fps) => (this.fps = fps));\r\n  }\r\n\r\n  startIteration() {\r\n    this.subscriberPool.publish(AppSubscription.START_ITERATION);\r\n  }\r\n\r\n  render(entity: ShaderEntity) {\r\n    const shaderProgram = entity.opt.shaderType;\r\n    if (\r\n      this.camera.renderMode === '2d' &&\r\n      (shaderProgram === ShaderType.TWO_DIMENSION ||\r\n        shaderProgram === ShaderType.COLOUR) &&\r\n      this.camera.camera2d.isOutOfBound(entity.modelPosition())\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    let model = entity.getModel();\r\n    if (entity.clone) {\r\n      model = model.slice(0);\r\n    }\r\n\r\n    if (this.camera.renderMode === '3d') {\r\n      this.renderWithCulling(entity, model);\r\n      return;\r\n    }\r\n\r\n    this.notificationQueue.pushPayload(\r\n      RendererNotification.renderEntity(entity, model)\r\n    );\r\n  }\r\n\r\n  renderCopy(entity: EngineObject, pos: ModelPosition) {\r\n    this.render(entity.shaderEntity.renderCopy(pos));\r\n  }\r\n\r\n    /**\r\n   * Distance-based culling - objects beyond a certain distance are not rendered\r\n   * @param entity The engine object to test\r\n   * @param cameraPosition Camera position\r\n   * @param maxDistance Maximum rendering distance\r\n   * @returns true if the object should be rendered\r\n   */\r\n  isEntityWithinDistance(entity: EngineObject, cameraPosition: vec3, maxDistance: number): boolean {\r\n    if (!entity || !entity.position) {\r\n      return true;\r\n    }\r\n\r\n    const entityPos = vec3.fromValues(\r\n      entity.position.x || 0,\r\n      entity.position.y || 0,\r\n      entity.position.z || 0\r\n    );\r\n\r\n    const distance = vec3.distance(cameraPosition, entityPos);\r\n    return distance <= maxDistance;\r\n  }\r\n\r\n\r\n  /**\r\n   * Render an EngineObject with frustum and distance culling\r\n   * @param entity The EngineObject to render\r\n   * @returns true if the entity was rendered, false if culled\r\n   */\r\n  renderWithCulling(entity: ShaderEntity, model: Float32List): boolean {\r\n    if (!entity) {\r\n      return false;\r\n    }\r\n\r\n    const entityPosition = entity.modelPosition();\r\n    \r\n    const entitySize = Math.max(\r\n      entityPosition.width || 1,\r\n      entityPosition.height || 1,\r\n      entityPosition.length || 1\r\n    );\r\n    \r\n    // If entity is very large (> 100 units), likely a sky/background object - always render\r\n    if (entitySize > 100) {\r\n      this.notificationQueue.pushPayload(\r\n        RendererNotification.renderEntity(entity, model)\r\n      );\r\n      return true;\r\n    }\r\n\r\n    const camera3d = this.camera.camera3d;\r\n    \r\n    const cameraPos = vec3.fromValues(\r\n      camera3d.position.x || 0,\r\n      camera3d.position.y || 0,\r\n      camera3d.position.z || 0\r\n    );\r\n    \r\n    const entityPos3d = vec3.fromValues(\r\n      entityPosition.x || 0,\r\n      entityPosition.y || 0,\r\n      entityPosition.z || 0\r\n    );\r\n    \r\n    const yawRad = camera3d.degreesToRadians(camera3d.position.ay);\r\n    const pitchRad = camera3d.degreesToRadians(camera3d.position.ax);\r\n    \r\n    const cameraForward = vec3.fromValues(\r\n      Math.sin(yawRad) * Math.cos(pitchRad),\r\n      -Math.sin(pitchRad),\r\n      -Math.cos(yawRad) * Math.cos(pitchRad)\r\n    );\r\n    vec3.normalize(cameraForward, cameraForward);\r\n    \r\n    const toEntity = vec3.create();\r\n    vec3.subtract(toEntity, entityPos3d, cameraPos);\r\n    const distance = vec3.length(toEntity);\r\n    \r\n    if (distance < camera3d.near) {\r\n      this.notificationQueue.pushPayload(\r\n        RendererNotification.renderEntity(entity, model)\r\n      );\r\n      return true;\r\n    }\r\n    \r\n    if (distance > camera3d.far) {\r\n      return false;\r\n    }\r\n    \r\n    vec3.normalize(toEntity, toEntity);\r\n    \r\n    const dot = vec3.dot(cameraForward, toEntity);\r\n    \r\n    if (dot <= 0) {\r\n      return false;\r\n    }\r\n    \r\n    const angle = Math.acos(Math.max(0, Math.min(1, dot)));\r\n    \r\n    const fov = camera3d.fov;\r\n    const fovRadians = (fov * Math.PI) / 180;\r\n    const halfFov = fovRadians / 2;\r\n    \r\n    const angularSize = Math.atan(entitySize / Math.max(distance, 1));\r\n    const padding = angularSize + 0.3;\r\n    \r\n    const effectiveHalfFov = halfFov + padding;\r\n    \r\n    if (angle > effectiveHalfFov) {\r\n      return false;\r\n    }\r\n\r\n    this.notificationQueue.pushPayload(\r\n      RendererNotification.renderEntity(entity, model)\r\n    );\r\n    return true;\r\n  }\r\n\r\n  setLighting(light: Light) {\r\n    this.notificationQueue.pushPayload(RendererNotification.setLighting(light));\r\n  }\r\n\r\n  createTexture(object: ShaderEntity) {\r\n    this.subscriberPool.publish(\r\n      RendererSubscription.CREATE_TEXTURE,\r\n      RendererSubscription.createTexturePayload(object, this.resourcesLoading)\r\n    );\r\n  }\r\n\r\n  getFPS(): number {\r\n    return this.fps;\r\n  }\r\n\r\n  getTotalPixelHeight(): number {\r\n    return window.screen.height;\r\n  }\r\n\r\n  getTotalPixelWidth(): number {\r\n    return window.screen.width;\r\n  }\r\n\r\n  getScreenHeight(): number {\r\n    return this.camera.height;\r\n  }\r\n\r\n  getScreenWidth(): number {\r\n    return this.camera.width;\r\n  }\r\n\r\n  setTime(time: number) {\r\n    if (time) {\r\n      this.time = time;\r\n    }\r\n  }\r\n\r\n  getTime() {\r\n    return this.time;\r\n  }\r\n\r\n  getVerticesById(id: number): number[] {\r\n    if (this.bufferCache[id]) {\r\n      return this.bufferCache[id].vertices;\r\n    } else {\r\n      console.error(\"Unable to find src in cache\", id, this);\r\n      throw new Error(\"unable to find src in cache\");\r\n    }\r\n  }\r\n\r\n  updateBufferCache(buffer: ModelData, verticesCacheId: number): number {\r\n    buffer.cacheId = verticesCacheId;\r\n    this.bufferCache[verticesCacheId] = buffer;\r\n    return verticesCacheId;\r\n  }\r\n\r\n  addBufferCache(buffer: ModelData): number {\r\n    const cacheId = this.cacheId++;\r\n    this.bufferCache[cacheId] = buffer;\r\n    buffer.cacheId = cacheId;\r\n    return cacheId;\r\n  }\r\n\r\n  getResource(src: string): Promise<RetrieveResource> {\r\n    const promise = new Promise<RetrieveResource>((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      console.log(`Loading resource ${src}`);\r\n      xhr.open(\"GET\", src);\r\n      xhr.onreadystatechange = () => {\r\n        if (xhr.readyState === XMLHttpRequest.DONE) {\r\n          // handle file:// loading with status 0\r\n          if (xhr.status === 200 || xhr.status === 0) {\r\n            const cacheId = this.cacheId++;\r\n            resolve({\r\n              data: xhr.responseText,\r\n              engineHelper: this,\r\n              cacheId: cacheId,\r\n\r\n              registerBuffer: (obj: ModelData) => {\r\n                this.bufferCache[cacheId] = obj;\r\n              },\r\n\r\n              registerFont: (meta: FontMetaData) => {\r\n                const font = new Font(meta);\r\n                this.fontCache[cacheId] = {\r\n                  meta: meta,\r\n                  font: font,\r\n                };\r\n                this.fontNameKeyReverse[src] = cacheId;\r\n              },\r\n            });\r\n          } else {\r\n            reject(xhr.responseText);\r\n          }\r\n        }\r\n      };\r\n      xhr.send();\r\n    });\r\n    this.resourcesLoading.push(promise);\r\n    return promise;\r\n  }\r\n\r\n  getAllResourcesLoading(): Promise<RetrieveResource[]> {\r\n    return Promise.all(this.resourcesLoading);\r\n  }\r\n\r\n  updateBuffer(object: ShaderEntity) {\r\n    this.updateBufferCache(\r\n      object.vertexModel.createModel(),\r\n      object.vertexModel.vertexBufferId\r\n    );\r\n    const notification = RendererNotification.updateBuffer(\r\n      object,\r\n      this.getBuffer(object)\r\n    );\r\n    this.notificationQueue.pushPayload(notification);\r\n  }\r\n\r\n  getBufferModelData(object: ShaderEntity): ModelData {\r\n    return this.bufferCache[object.getVertexBufferId()];\r\n  }\r\n\r\n  getBuffer(object: ShaderEntity): number[] {\r\n    const buffer: number[] = this.getBufferModelData(object).vertices;\r\n    if (!buffer) {\r\n      throw new Error(\"No buffer was found for this entity\");\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  registerEntity(object: ShaderEntity) {\r\n    this.subscriberPool.publish(\r\n      RendererSubscription.REGISTER_ENTITY,\r\n      RendererSubscription.registerEntityPayload(\r\n        object,\r\n        this.getBufferModelData(object)\r\n      )\r\n    );\r\n  }\r\n\r\n  initFont() {\r\n    for (const fontType in this.fontCache) {\r\n      if (!this.fontCache.hasOwnProperty(fontType)) {\r\n        continue;\r\n      }\r\n      const font = this.fontCache[fontType].font;\r\n      font.init(this);\r\n    }\r\n  }\r\n\r\n  renderFont() {\r\n    for (const fontType in this.fontCache) {\r\n      if (!this.fontCache.hasOwnProperty(fontType)) {\r\n        continue;\r\n      }\r\n      const font = this.fontCache[fontType].font;\r\n      font.render(this);\r\n    }\r\n  }\r\n\r\n  updateFont() {\r\n    for (const fontType in this.fontCache) {\r\n      if (!this.fontCache.hasOwnProperty(fontType)) {\r\n        continue;\r\n      }\r\n      const font = this.fontCache[fontType].font;\r\n      font.update(this);\r\n    }\r\n  }\r\n\r\n  newVertexModel2d(cacheId: string): TextureVertexModel {\r\n    return this.newVertexModel(cacheId, PlaneType.YX);\r\n  }\r\n\r\n  newVertexModelUv3d(cacheId: string): TextureVertexModel {\r\n    const cache = this.vertexUVCache[cacheId];\r\n    const vertexModel = new TextureVertexModel().fillRenderUnits(cache.uv);\r\n    vertexModel.textureSource = cache.source;\r\n    return vertexModel;\r\n  }\r\n\r\n  createPlaneVertexModel(\r\n    src: string,\r\n    uv: number[],\r\n    plane: PlaneType\r\n  ): TextureVertexModel {\r\n    const vertexModel = new TextureVertexModel().createRenderUnits(4);\r\n    vertexModel.textureSource = src;\r\n    EngineObjectHelper.vertex.plane(vertexModel.renderUnits, plane);\r\n    EngineObjectHelper.vertex.planeUV(vertexModel.renderUnits, uv);\r\n    return vertexModel;\r\n  }\r\n\r\n  getUVCache(name: string): number[] {\r\n    return this.uvCache[name].uv;\r\n  }\r\n\r\n  addUVCache(source: string, name: string, uv: number[]) {\r\n    this.uvCache[name] = { source: source, uv: uv };\r\n  }\r\n\r\n  getVertexUvCache(name: string): number[] {\r\n    return this.vertexUVCache[name].uv;\r\n  }\r\n\r\n  newVertexModel(cacheId: string, plane: PlaneType): TextureVertexModel {\r\n    const cache = this.uvCache[cacheId];\r\n    if (!cache) {\r\n      const cache = this.uvCache[\"missing\"];\r\n      console.warn(\r\n        `texture ${cacheId} has not been loaded - loading default texture`\r\n      );\r\n      return this.createPlaneVertexModel(cache.source, cache.uv, plane);\r\n    }\r\n    return this.createPlaneVertexModel(cache.source, cache.uv, plane);\r\n  }\r\n\r\n  addVertexUvCache(textureSource: string, name: string, vertexUv: number[]) {\r\n    this.vertexUVCache[name] = { source: textureSource, uv: vertexUv };\r\n  }\r\n\r\n  writeFont(fontRef: FontReference): FontReference {\r\n    let fontCacheId: number | undefined = undefined;\r\n    if (typeof fontRef.$cacheId === \"string\") {\r\n      fontCacheId = this.fontNameKeyReverse[fontRef.$cacheId];\r\n    } else if (typeof fontRef.$cacheId === \"number\") {\r\n      fontCacheId = fontRef.$cacheId;\r\n    } else if (fontRef.$cacheId !== undefined) {\r\n      throw new Error(\"fontId is not a number or string\");\r\n    }\r\n    let font: Font;\r\n    if (fontCacheId === undefined) {\r\n      font = Font.DefaultFont;\r\n    } else {\r\n      font = this.fontCache[fontCacheId].font;\r\n    }\r\n    return font.writeRef(fontRef);\r\n  }\r\n\r\n  isClickedObject(event: EngineEvent, object: EngineObject) {\r\n    return this.isClicked(event, object.getRect2());\r\n  }\r\n\r\n  isClicked(event: EngineEvent, rect: Rect3d) {\r\n    const distance = this.camera.camera2d.distanceEvent(event);\r\n    return CollisionDetection.isPointInRect(rect, distance);\r\n  }\r\n\r\n  rotate(event: EngineEvent, rect: Position) {\r\n    const { x, y } = this.camera.camera2d.position;\r\n    return CollisionDetection.rotate(x + event.x, y + event.y, rect);\r\n  }\r\n\r\n  updateProjectionMatrix() {\r\n    this.notificationQueue.pushPayload(\r\n      RendererNotification.UPDATE_PROJECTION_MATRIX\r\n    );\r\n  }\r\n}\r\n\r\nexport declare interface RetrieveResource {\r\n  data: string;\r\n  engineHelper: EngineHelper;\r\n  cacheId: number;\r\n  registerBuffer: (obj: ModelData) => void;\r\n  registerFont: (font: FontMetaData) => void;\r\n}\r\n","export default \"precision mediump int;\\r\\nprecision mediump float;\\r\\n\\r\\nattribute vec3 a_position;\\r\\nattribute vec2 a_texture_coords;\\r\\nattribute vec3 a_normal;\\r\\n\\r\\nuniform mat4 u_projection;\\r\\nuniform mat4 u_view;\\r\\nuniform mat4 u_model;\\r\\n\\r\\nuniform vec3 u_light1_pos;\\r\\nuniform vec3 u_light1_intensities;\\r\\nuniform float u_light1_attenuation;\\r\\nuniform float u_light1_ambient_coefficient;\\r\\n\\r\\nuniform bool u_isLightingEnabled;\\r\\n\\r\\nvarying vec2 v_texture_coords;\\r\\nvarying vec3 v_position;\\r\\nvarying vec3 v_normal;\\r\\nvarying mat4 v_model;\\r\\n\\r\\nvarying vec3 v_light1_pos;\\r\\nvarying vec3 v_light1_intensities;\\r\\nvarying float v_light1_attenuation;\\r\\nvarying float v_light1_ambient_coefficient;\\r\\nvarying float v_diffuseCoefficient;\\r\\nvarying float v_attenuation;\\r\\n\\r\\nstruct Light {\\r\\n  vec3 position;\\r\\n  vec3 intensities;\\r\\n  float ambientCoefficient;\\r\\n  float attenuation;\\r\\n};\\r\\n\\r\\nfloat transpose(float m) {\\r\\n  return m;\\r\\n}\\r\\n\\r\\nmat2 transpose(mat2 m) {\\r\\n  return mat2(m[0][0], m[1][0],\\r\\n    m[0][1], m[1][1]);\\r\\n}\\r\\n\\r\\nmat3 transpose(mat3 m) {\\r\\n  return mat3(m[0][0], m[1][0], m[2][0],\\r\\n    m[0][1], m[1][1], m[2][1],\\r\\n    m[0][2], m[1][2], m[2][2]);\\r\\n}\\r\\n\\r\\nmat4 transpose(mat4 m) {\\r\\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\\r\\n    m[0][1], m[1][1], m[2][1], m[3][1],\\r\\n    m[0][2], m[1][2], m[2][2], m[3][2],\\r\\n    m[0][3], m[1][3], m[2][3], m[3][3]);\\r\\n}\\r\\n\\r\\nfloat inverse(float m) {\\r\\n  return 1.0 / m;\\r\\n}\\r\\n\\r\\nmat2 inverse(mat2 m) {\\r\\n  return mat2(m[1][1], -m[0][1],\\r\\n    -m[1][0], m[0][0]) / (m[0][0] * m[1][1] - m[0][1] * m[1][0]);\\r\\n}\\r\\n\\r\\nmat3 inverse(mat3 m) {\\r\\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\\r\\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\\r\\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\\r\\n\\r\\n  float b01 = a22 * a11 - a12 * a21;\\r\\n  float b11 = -a22 * a10 + a12 * a20;\\r\\n  float b21 = a21 * a10 - a11 * a20;\\r\\n\\r\\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\\r\\n\\r\\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\\r\\n    b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\\r\\n    b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\\r\\n}\\r\\n\\r\\nmat4 inverse(mat4 m) {\\r\\n  float\\r\\n  a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\\r\\n    a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\\r\\n    a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\\r\\n    a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\\r\\n\\r\\n    b00 = a00 * a11 - a01 * a10,\\r\\n    b01 = a00 * a12 - a02 * a10,\\r\\n    b02 = a00 * a13 - a03 * a10,\\r\\n    b03 = a01 * a12 - a02 * a11,\\r\\n    b04 = a01 * a13 - a03 * a11,\\r\\n    b05 = a02 * a13 - a03 * a12,\\r\\n    b06 = a20 * a31 - a21 * a30,\\r\\n    b07 = a20 * a32 - a22 * a30,\\r\\n    b08 = a20 * a33 - a23 * a30,\\r\\n    b09 = a21 * a32 - a22 * a31,\\r\\n    b10 = a21 * a33 - a23 * a31,\\r\\n    b11 = a22 * a33 - a23 * a32,\\r\\n\\r\\n    det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\\r\\n\\r\\n  return mat4(\\r\\n    a11 * b11 - a12 * b10 + a13 * b09,\\r\\n    a02 * b10 - a01 * b11 - a03 * b09,\\r\\n    a31 * b05 - a32 * b04 + a33 * b03,\\r\\n    a22 * b04 - a21 * b05 - a23 * b03,\\r\\n    a12 * b08 - a10 * b11 - a13 * b07,\\r\\n    a00 * b11 - a02 * b08 + a03 * b07,\\r\\n    a32 * b02 - a30 * b05 - a33 * b01,\\r\\n    a20 * b05 - a22 * b02 + a23 * b01,\\r\\n    a10 * b10 - a11 * b08 + a13 * b06,\\r\\n    a01 * b08 - a00 * b10 - a03 * b06,\\r\\n    a30 * b04 - a31 * b02 + a33 * b00,\\r\\n    a21 * b02 - a20 * b04 - a23 * b00,\\r\\n    a11 * b07 - a10 * b09 - a12 * b06,\\r\\n    a00 * b09 - a01 * b07 + a02 * b06,\\r\\n    a31 * b01 - a30 * b03 - a32 * b00,\\r\\n    a20 * b03 - a21 * b01 + a22 * b00) / det;\\r\\n}\\r\\n\\r\\nfloat pow3(float x, float y) {\\r\\n  return exp2(y * log2(x));\\r\\n}\\r\\n\\r\\nvec3 pow2(vec3 x, vec3 y) {\\r\\n  return vec3(pow3(x.x, y.x), pow3(x.y, y.y), pow3(x.z, y.z));\\r\\n}\\r\\n\\r\\n\\r\\nvoid main(void) {\\r\\n  if (!u_isLightingEnabled) {\\r\\n    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n    v_texture_coords = a_texture_coords;\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  v_texture_coords = a_texture_coords;\\r\\n  v_position = a_position;\\r\\n  v_normal = a_normal;\\r\\n  v_model = u_model;\\r\\n\\r\\n  v_light1_pos = u_light1_pos;\\r\\n  v_light1_intensities = u_light1_intensities;\\r\\n  v_light1_attenuation = u_light1_attenuation;\\r\\n  v_light1_ambient_coefficient = u_light1_ambient_coefficient;\\r\\n\\r\\n  Light light1;\\r\\n  light1.intensities = v_light1_intensities;\\r\\n  light1.position = v_light1_pos;\\r\\n  light1.attenuation = v_light1_attenuation;\\r\\n  light1.ambientCoefficient = v_light1_ambient_coefficient;\\r\\n\\r\\n  vec3 surfacePos = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  mat3 normalMatrix = transpose(inverse(mat3(v_model)));\\r\\n  vec3 normal = normalize(normalMatrix * v_normal);\\r\\n\\r\\n  vec3 fragPosition = vec3(v_model * vec4(v_position, 1));\\r\\n\\r\\n  vec3 surfaceToLight = light1.position - fragPosition;\\r\\n\\r\\n  float brightness = dot(normal, surfaceToLight) / (length(surfaceToLight) * length(normal));\\r\\n  if (brightness > 1.0) {\\r\\n    brightness = 1.0;\\r\\n  } else if (brightness < 0.0) {\\r\\n    brightness = 0.0;\\r\\n  }\\r\\n\\r\\n  float distanceToLight = length(light1.position - surfacePos);\\r\\n\\r\\n  v_diffuseCoefficient = max(0.0, dot(normal, surfaceToLight));\\r\\n  v_attenuation = 1.0 / (1.0 + light1.attenuation * pow3(distanceToLight, 2.0));\\r\\n  gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);\\r\\n}\";","export default \"\\r\\nprecision mediump float;\\r\\nvarying vec4 v_color;\\r\\nvoid main(void) {\\r\\n  gl_FragColor = v_color;\\r\\n}\\r\\n\\r\\n\";","import ModelObjectRect3d from \"../Core/EngineEntity/ModelObjectRect3d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport Rect3d from \"../Core/Data/Rect3d\";\r\nimport TextureVertexModel from \"../Core/Data/TextureVertexModel\";\r\n\r\nexport default class Plane3d extends ModelObjectRect3d {\r\n  constructor(rect: Rect3d, vertexModel: TextureVertexModel) {\r\n    super(rect, vertexModel);\r\n    if (!(vertexModel instanceof TextureVertexModel)) {\r\n      const error = \"Vertex model must of be type TextureVertexModel\";\r\n      console.error(error, vertexModel);\r\n      throw new Error(error);\r\n    }\r\n    if (!vertexModel.renderUnits || vertexModel.renderUnits.length !== 4) {\r\n      const error = \"Plane3d requires 4 vertexes\";\r\n      console.error(error, vertexModel);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n}\r\n","import {\r\n  ModelObject3d,\r\n  Rect3d,\r\n  TextureVertexModel,\r\n  EngineHelper\r\n} from \"synaren-engine\";\r\n\r\nexport default class Sphere extends ModelObject3d {\r\n  vertexUvCacheId: string;\r\n  constructor(rect: Rect3d, vertexUvCacheId: string) {\r\n    super(rect, new TextureVertexModel());\r\n    this.vertexUvCacheId = vertexUvCacheId;\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = engineHelper.newVertexModelUv3d(this.vertexUvCacheId);\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n","import Rect3d from \"./Rect3d\";\r\n\r\nexport default class Rect2d extends Rect3d {\r\n  constructor(\r\n    x: number,\r\n    y: number,\r\n    width: number,\r\n    height: number,\r\n    layer?: number\r\n  ) {\r\n    super(x, y, layer || 0, width, height, 1);\r\n  }\r\n\r\n  static create() {\r\n    return new Rect2d(0, 0, 0, 0, 0);\r\n  }\r\n\r\n  newCenter(): Rect2d {\r\n    return new Rect2d(\r\n      this.x + this.width / 2.0,\r\n      this.y + this.height / 2.0,\r\n      this.width,\r\n      this.height,\r\n      this.z\r\n    );\r\n  }\r\n}\r\n","import Colour from \"../../Data/Colour\";\r\n\r\nclass WebGLContext {\r\n  ctx: WebGLRenderingContext;\r\n  clearColour: Colour = new Colour(1.0, 1.0, 1.0, 1.0);\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.ctx = ctx;\r\n  }\r\n\r\n  setClearColor(colour: Colour) {\r\n    this.clearColour = colour;\r\n    this.ctx.clearColor(colour.r, colour.g, colour.b, colour.a);\r\n  }\r\n\r\n  setupDefault() {\r\n    this.setClearColor(this.clearColour);\r\n    this.ctx.enable(this.ctx.BLEND);\r\n    this.ctx.blendFunc(this.ctx.SRC_ALPHA, this.ctx.ONE_MINUS_SRC_ALPHA);\r\n    this.ctx.enable(this.ctx.CULL_FACE);\r\n    this.ctx.frontFace(this.ctx.CCW);\r\n    this.ctx.cullFace(this.ctx.BACK);\r\n    this.ctx.clearDepth(1);\r\n    this.ctx.enable(this.ctx.DEPTH_TEST);\r\n    this.ctx.depthFunc(this.ctx.LEQUAL);\r\n  }\r\n\r\n  clear() {\r\n    this.ctx.clear(this.ctx.COLOR_BUFFER_BIT | this.ctx.DEPTH_BUFFER_BIT);\r\n  }\r\n\r\n  deleteTexture(texture: WebGLTexture) {\r\n    this.ctx.deleteTexture(texture);\r\n  }\r\n\r\n  resizeViewPort(canvas: HTMLCanvasElement) {\r\n    this.ctx.viewport(0, 0, canvas.width, canvas.height);\r\n  }\r\n\r\n  getWebGL2RenderingContext(): WebGL2RenderingContext {\r\n    return this.ctx as WebGL2RenderingContext;\r\n  }\r\n\r\n  destroyWebGL() {\r\n    const ctx = this.ctx;\r\n    const ctx2 = this.getWebGL2RenderingContext();\r\n    const isWebGL2RenderingContext = !!ctx2.createTransformFeedback;\r\n\r\n    if (isWebGL2RenderingContext) {\r\n      ctx2.bindVertexArray(null);\r\n    }\r\n\r\n    const numAttribs = ctx.getParameter(ctx.MAX_VERTEX_ATTRIBS);\r\n    const tmp = ctx.createBuffer();\r\n    ctx.bindBuffer(ctx.ARRAY_BUFFER, tmp);\r\n    for (let ii = 0; ii < numAttribs; ++ii) {\r\n      ctx.disableVertexAttribArray(ii);\r\n      ctx.vertexAttribPointer(ii, 4, ctx.FLOAT, false, 0, 0);\r\n      ctx.vertexAttrib1f(ii, 0);\r\n      if (isWebGL2RenderingContext) {\r\n        ctx2.vertexAttribDivisor(ii, 0);\r\n      }\r\n    }\r\n    ctx.deleteBuffer(tmp);\r\n\r\n    const numTextureUnits = ctx.getParameter(ctx.MAX_TEXTURE_IMAGE_UNITS);\r\n    for (let ii = 0; ii < numTextureUnits; ++ii) {\r\n      ctx.activeTexture(ctx.TEXTURE0 + ii);\r\n      ctx.bindTexture(ctx.TEXTURE_CUBE_MAP, null);\r\n      ctx.bindTexture(ctx.TEXTURE_2D, null);\r\n      if (isWebGL2RenderingContext) {\r\n        ctx2.bindTexture(ctx2.TEXTURE_2D_ARRAY, null);\r\n        ctx2.bindTexture(ctx2.TEXTURE_3D, null);\r\n        ctx2.bindSampler(ii, null);\r\n      }\r\n    }\r\n\r\n    ctx.activeTexture(ctx.TEXTURE0);\r\n    ctx.useProgram(null);\r\n    ctx.bindBuffer(ctx.ARRAY_BUFFER, null);\r\n    ctx.bindBuffer(ctx.ELEMENT_ARRAY_BUFFER, null);\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\r\n    ctx.disable(ctx.BLEND);\r\n    ctx.disable(ctx.CULL_FACE);\r\n    ctx.disable(ctx.DEPTH_TEST);\r\n    ctx.disable(ctx.DITHER);\r\n    ctx.disable(ctx.SCISSOR_TEST);\r\n    ctx.blendColor(0, 0, 0, 0);\r\n    ctx.blendEquation(ctx.FUNC_ADD);\r\n    ctx.blendFunc(ctx.ONE, ctx.ZERO);\r\n    ctx.clearColor(0, 0, 0, 0);\r\n    ctx.clearDepth(1);\r\n    ctx.clearStencil(-1);\r\n    ctx.colorMask(true, true, true, true);\r\n    ctx.cullFace(ctx.BACK);\r\n    ctx.depthFunc(ctx.LESS);\r\n    ctx.depthMask(true);\r\n    ctx.depthRange(0, 1);\r\n    ctx.frontFace(ctx.CCW);\r\n    ctx.hint(ctx.GENERATE_MIPMAP_HINT, ctx.DONT_CARE);\r\n    ctx.lineWidth(1);\r\n    ctx.pixelStorei(ctx.PACK_ALIGNMENT, 4);\r\n    ctx.pixelStorei(ctx.UNPACK_ALIGNMENT, 4);\r\n    ctx.pixelStorei(ctx.UNPACK_FLIP_Y_WEBGL, 0);\r\n    ctx.pixelStorei(ctx.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\r\n\r\n    if (ctx.UNPACK_COLORSPACE_CONVERSION_WEBGL) {\r\n      ctx.pixelStorei(\r\n        ctx.UNPACK_COLORSPACE_CONVERSION_WEBGL,\r\n        ctx.BROWSER_DEFAULT_WEBGL\r\n      );\r\n    }\r\n    ctx.polygonOffset(0, 0);\r\n    ctx.sampleCoverage(1, false);\r\n    ctx.scissor(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n    ctx.stencilFunc(ctx.ALWAYS, 0, 0xffffffff);\r\n    ctx.stencilMask(0xffffffff);\r\n    ctx.stencilOp(ctx.KEEP, ctx.KEEP, ctx.KEEP);\r\n    ctx.viewport(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n    ctx.clear(\r\n      ctx.COLOR_BUFFER_BIT | ctx.DEPTH_BUFFER_BIT | ctx.STENCIL_BUFFER_BIT\r\n    );\r\n\r\n    if (isWebGL2RenderingContext) {\r\n      ctx2.drawBuffers([ctx2.BACK]);\r\n\r\n      ctx2.readBuffer(ctx2.BACK);\r\n\r\n      ctx2.bindBuffer(ctx2.COPY_READ_BUFFER, null);\r\n\r\n      ctx2.bindBuffer(ctx2.COPY_WRITE_BUFFER, null);\r\n\r\n      ctx2.bindBuffer(ctx2.PIXEL_PACK_BUFFER, null);\r\n\r\n      ctx2.bindBuffer(ctx2.PIXEL_UNPACK_BUFFER, null);\r\n      const numTransformFeedbacks = ctx.getParameter(\r\n        ctx2.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS\r\n      );\r\n      for (let ii = 0; ii < numTransformFeedbacks; ++ii) {\r\n        ctx2.bindBufferBase(ctx2.TRANSFORM_FEEDBACK_BUFFER, ii, null);\r\n      }\r\n\r\n      const numUBOs = ctx.getParameter(ctx2.MAX_UNIFORM_BUFFER_BINDINGS);\r\n      for (let ii = 0; ii < numUBOs; ++ii) {\r\n        ctx2.bindBufferBase(ctx2.UNIFORM_BUFFER, ii, null);\r\n      }\r\n\r\n      ctx2.disable(ctx2.RASTERIZER_DISCARD);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_IMAGE_HEIGHT, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_SKIP_IMAGES, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_ROW_LENGTH, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_SKIP_ROWS, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.UNPACK_SKIP_PIXELS, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.PACK_ROW_LENGTH, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.PACK_SKIP_ROWS, 0);\r\n\r\n      ctx2.pixelStorei(ctx2.PACK_SKIP_PIXELS, 0);\r\n\r\n      ctx2.hint(ctx2.FRAGMENT_SHADER_DERIVATIVE_HINT, ctx2.DONT_CARE);\r\n    }\r\n  }\r\n\r\n  programInfo(program: WebGLProgram) {\r\n    const numAttribs = this.ctx.getProgramParameter(\r\n      program,\r\n      this.ctx.ACTIVE_ATTRIBUTES\r\n    );\r\n    for (let ii = 0; ii < numAttribs; ++ii) {\r\n      const attribInfo = this.ctx.getActiveAttrib(program, ii);\r\n      if (!attribInfo) {\r\n        break;\r\n      }\r\n      console.log(\r\n        this.ctx.getAttribLocation(program, attribInfo.name),\r\n        attribInfo.name\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default WebGLContext;\r\n","import EngineHelper from \"./EngineHelper\";\r\nimport { EngineEvent } from \"../Core/Events\";\r\nimport Resource from \"./Data/Resource\";\r\n\r\nexport default class WorldDelegate {\r\n  engineHelper: EngineHelper;\r\n  setEngineHelper(engineHelper: EngineHelper) {\r\n    this.engineHelper = engineHelper;\r\n  }\r\n  loadResources(resources: Resource[]) {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  update() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  render() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  event(event: EngineEvent) {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  pause() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  resume() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  destroy() {\r\n    throw new Error(\"unimplemented method\");\r\n  }\r\n  reset() {}\r\n}\r\n","class ModelData {\r\n  vertices: number[];\r\n  cacheId?: number;\r\n  $id: number = ModelData._$ID++;\r\n\r\n  static _$ID = 1;\r\n}\r\n\r\nexport default ModelData;\r\n","import App from \"./Core/App\";\r\nexport { App };\r\nexport { default as EngineObject } from \"./Core/EngineEntity/EngineObject\";\r\nexport { default as EngineHelper } from \"./Core/EngineHelper\";\r\nexport { default as EngineMap } from \"./Core/EngineEntity/EngineMap\";\r\nexport { default as ObjectManager } from \"./Manager/ObjectManager\";\r\nexport { default as EntityManager } from \"./Manager/EntityManager\";\r\nexport { default as EntityManager2d } from \"./Manager/EntityManager2d\";\r\nexport { default as Font } from \"./Core/Font/Font\";\r\nexport { FontReference } from \"./Core/Font/Font\";\r\nexport { default as LineColour } from \"./Entity/LineColour\";\r\nexport { default as ResourceResolver } from \"./AssetLoader/ResourceResolver\";\r\nexport { default as Resource } from \"./Core/Data/Resource\";\r\nexport { default as Light, LightOptions } from \"./Core/Data/Light\";\r\nexport { default as PlaneType } from \"./Core/Data/PlaneType\";\r\nexport { default as Colour } from \"./Core/Data/Colour\";\r\nexport { default as Moveable } from \"./Entity/Moveable\";\r\nexport { default as Rect3d } from \"./Core/Data/Rect3d\";\r\nexport { default as Rect2d } from \"./Core/Data/Rect2d\";\r\nexport { default as ModelPosition } from \"./Core/EngineEntity/ModelPosition\";\r\nexport { default as Physics } from \"./Core/Physics/Physics\";\r\nexport { default as Position } from \"./Core/EngineEntity/Position\";\r\nexport { default as Timer } from \"./Core/Common/Timer\";\r\nexport { generateId } from \"./Core/Common/IdGenerator\";\r\nexport {\r\n  ConfigBuilder,\r\n  ConfigEntity,\r\n  ConfigEntityConcreteType,\r\n} from \"./Core/Builder/ConfigMapBuilder\";\r\nexport { default as Events, EngineEvent } from \"./Core/Events\";\r\nexport {\r\n  Collision,\r\n  CollisionDetection,\r\n  Polygon,\r\n} from \"./Core/Physics/CollisionDetection\";\r\nexport { default as Camera } from \"./Core/Camera\";\r\nexport { default as Coordinate } from \"./Core/Data/Coordinate\";\r\nexport { default as Plane3d } from \"./Entity/Plane3d\";\r\nexport { default as Plane2d } from \"./Entity/Plane2d\";\r\nexport { default as PlaneColour } from \"./Entity/PlaneColour\";\r\nexport { default as BitmapConfigParser } from \"./AssetLoader/BitmapConfigParser\";\r\nexport { default as ModelObject3d } from \"./Core/EngineEntity/ModelObject3d\";\r\nexport { default as Object3d } from \"./Entity/Object3d\";\r\nexport { RenderType } from \"./Core/Data/RenderOption\";\r\nexport { default as TextureVertexModel } from \"./Core/Data/TextureVertexModel\";\r\n","import Camera from \"./Camera\";\r\nimport Updater from \"./Updater\";\r\nimport Renderer, { RendererNotification } from \"./Renderer\";\r\nimport EngineHelper, { RetrieveResource } from \"./EngineHelper\";\r\nimport Events, { event } from \"./Events\";\r\nimport Timer from \"./Common/Timer\";\r\nimport NotificationQueue from \"./Common/NotificationQueue\";\r\nimport WorldDelegate from \"./WorldDelegate\";\r\nimport { EngineEvent } from \"../Core/Events\";\r\nimport SubscriberPool, { Subscription } from \"./Common/SubscriberPool\";\r\nimport Resource from \"./Data/Resource\";\r\nimport EngineDebugger from \"./EngineDebugger\";\r\n\r\nexport class WebGLContainer {\r\n  canvas: HTMLCanvasElement;\r\n  aspectRatio: number;\r\n  isFullScreen: boolean;\r\n  constructor(\r\n    elementId: string,\r\n    parentElement: HTMLElement,\r\n    aspectRatio: number,\r\n    isFullScreen: boolean,\r\n    restoreContentFn: () => any\r\n  ) {\r\n    this.isFullScreen = isFullScreen;\r\n    this.aspectRatio = aspectRatio;\r\n    this.canvas = document.createElement(\"canvas\");\r\n    if (elementId) {\r\n      this.canvas.id = elementId;\r\n    } else {\r\n      this.canvas.id = \"app\";\r\n    }\r\n    this.canvas.addEventListener(\r\n      \"webglcontextlost\",\r\n      (event) => event.preventDefault(),\r\n      false\r\n    );\r\n    this.canvas.addEventListener(\r\n      \"webglcontextrestored\",\r\n      restoreContentFn,\r\n      false\r\n    );\r\n    parentElement.appendChild(this.canvas);\r\n  }\r\n\r\n  delete() {\r\n    this.canvas.style.display = \"none\";\r\n    if (this.canvas.parentElement) {\r\n      this.canvas.parentElement.removeChild(this.canvas);\r\n    }\r\n  }\r\n\r\n  resize(measureElement: HTMLElement) {\r\n    let width = measureElement.offsetWidth;\r\n    let height = width / this.getAspectRatio();\r\n\r\n    if (this.isFullScreen) {\r\n      width = window.innerWidth;\r\n      height = window.innerHeight;\r\n    }\r\n\r\n    this.canvas.width = width * window.devicePixelRatio;\r\n    this.canvas.height = height * window.devicePixelRatio;\r\n\r\n    this.canvas.style.height = `${height}px`;\r\n    this.canvas.style.width = `${width}px`;\r\n  }\r\n\r\n  getAspectRatio() {\r\n    let aspectRatio = this.aspectRatio;\r\n    if (!aspectRatio) {\r\n      const width =\r\n        window.innerWidth ||\r\n        document.documentElement.clientWidth ||\r\n        document.body.clientWidth;\r\n      const height =\r\n        window.innerHeight ||\r\n        document.documentElement.clientHeight ||\r\n        document.body.clientHeight;\r\n      aspectRatio = width / height;\r\n    }\r\n    return aspectRatio;\r\n  }\r\n\r\n  getCtx(): WebGLRenderingContext {\r\n    const ctx =\r\n      this.canvas.getContext(\"webgl\") ||\r\n      this.canvas.getContext(\"experimental-webgl\");\r\n    if (!ctx) {\r\n      throw new Error(\"WebGL not avaliable\");\r\n    }\r\n    return ctx as WebGLRenderingContext;\r\n  }\r\n}\r\n\r\nexport class AppSubscription {\r\n  static START_ITERATION = new Subscription(\"App#StartIteration\");\r\n  static GET_FPS = new Subscription(\"App#GetFPS\");\r\n}\r\n\r\nexport default class App {\r\n  renderer: Renderer;\r\n  updater: Updater;\r\n  timer: Timer;\r\n  interval: any;\r\n  camera: Camera;\r\n  errorCallback: Function;\r\n  args: { [key: string]: any };\r\n  fps: number;\r\n  isStepRender: boolean;\r\n  ready = false;\r\n  engineHelper: EngineHelper;\r\n  isPaused = true;\r\n  frameTime = 0.0;\r\n  framesElapsed = 0;\r\n  webGLContainer: WebGLContainer;\r\n  world: WorldDelegate;\r\n  isVisible: boolean;\r\n  notificationQueue: NotificationQueue;\r\n  subscriberPool: SubscriberPool;\r\n  debugger?: EngineDebugger;\r\n\r\n  constructor(args: { [key: string]: any }) {\r\n    if (!args) {\r\n      throw new Error(\"no args passed into App\");\r\n    }\r\n    this.notificationQueue = new NotificationQueue();\r\n    this.subscriberPool = new SubscriberPool();\r\n    this.subscriberPool.listen(\r\n      AppSubscription.START_ITERATION,\r\n      this.startIteration\r\n    );\r\n\r\n    this.args = args;\r\n    this.buildCanvas(args);\r\n\r\n    this.isStepRender = args.isStepRender || false;\r\n    event.bind(this.onEvent, this.webGLContainer);\r\n    event.setThrottle(args.eventThrottle || 1000.0 / 25.0);\r\n\r\n    this.errorCallback = args.error;\r\n    this.setup();\r\n\r\n    if (args.clearColour) {\r\n      this.renderer.glContext.setClearColor(args.clearColour);\r\n    }\r\n\r\n    this.setFPS(args.fps);\r\n  }\r\n\r\n  setFPS(fps: number) {\r\n    this.fps = 1000.0 / fps || 1000.0 / 30.0;\r\n    this.subscriberPool.publish(AppSubscription.GET_FPS, this.fps);\r\n  }\r\n\r\n  setup = () => {\r\n    const args = this.args;\r\n    this.timer = new Timer();\r\n    this.camera = new Camera();\r\n    this.updater = new Updater(args);\r\n    this.renderer = new Renderer(\r\n      args,\r\n      this.webGLContainer,\r\n      this.camera,\r\n      this.notificationQueue,\r\n      this.subscriberPool\r\n    );\r\n\r\n    this.camera.setupCamera(\r\n      args.camera,\r\n      args.aspectRatio,\r\n      this.webGLContainer.canvas,\r\n      args.renderMode || args.camera?.renderMode || '2d' // Default to 2D mode\r\n    );\r\n    this.engineHelper = new EngineHelper(\r\n      this.notificationQueue,\r\n      this.subscriberPool,\r\n      this.camera\r\n    );\r\n\r\n    this.debugger = new EngineDebugger(this.webGLContainer.canvas);\r\n\r\n    this.world = this.args.world;\r\n    this.world.setEngineHelper(this.engineHelper);\r\n    \r\n    if (this.debugger) {\r\n      this.debugger.setReferences(this.world, this.renderer);\r\n      this.debugger.setEngineHelper(this.engineHelper);\r\n    }\r\n  };\r\n\r\n  onEvent = (event: EngineEvent): boolean => {\r\n    if (event.eventType === Events.RESIZE) {\r\n      this.resizeScreen();\r\n    }\r\n    if (this.world) {\r\n      this.world.event(event);\r\n    }\r\n    return true;\r\n  };\r\n\r\n  destroy = () => {\r\n    clearInterval(this.interval);\r\n    this.renderer.delete();\r\n    event.delete(this.onEvent);\r\n    \r\n\r\n    \r\n    if (this.debugger) {\r\n      this.debugger.destroy();\r\n      this.debugger = undefined;\r\n    }\r\n    \r\n    this.webGLContainer.delete();\r\n\r\n    console.log(\"destroying\", this);\r\n  };\r\n\r\n  animationFrame = () => {\r\n    if (!this.ready) {\r\n      return;\r\n    }\r\n    try {\r\n      this.updater.update(this.timer.peak(), this.engineHelper);\r\n      this.renderer.render(this.timer.peak(), this.engineHelper);\r\n      \r\n      if (this.debugger) {\r\n        this.debugger.resetRenderCalls();\r\n        this.debugger.updateDebugInfo(this.engineHelper);\r\n      }\r\n      \r\n      this.notifyFrames();\r\n      this.timer.start();\r\n    } catch (error) {\r\n      console.error(error);\r\n      if (this.debugger) {\r\n        this.debugger.logError(error.toString());\r\n      }\r\n      clearInterval(this.interval);\r\n      if (this.errorCallback) {\r\n        this.errorCallback(error);\r\n      }\r\n    }\r\n  };\r\n\r\n  startIteration = () => requestAnimationFrame(this.animationFrame);\r\n\r\n  notifyFrames = () => {\r\n    this.frameTime += this.timer.peak();\r\n    this.framesElapsed++;\r\n    if (this.framesElapsed === 60) {\r\n      if (this.args.subscribe) {\r\n        this.args.subscribe({\r\n          fps: (1000.0 / this.frameTime) * this.framesElapsed,\r\n        });\r\n      }\r\n      this.framesElapsed = 0;\r\n      this.frameTime = 0;\r\n    }\r\n  };\r\n\r\n  toggleStepRender(run = !this.isStepRender) {\r\n    this.isStepRender = run;\r\n    if (!this.isStepRender && !this.interval) {\r\n      this.startRunLoop();\r\n    }\r\n  }\r\n\r\n  startRunLoop = () => {\r\n    this.timer.start();\r\n    const fps = this.fps;\r\n    this.interval = setInterval(() => {\r\n      if (!this.isPaused) {\r\n        this.animationFrame();\r\n      }\r\n      if (this.isStepRender) {\r\n        clearInterval(this.interval);\r\n        this.interval = undefined;\r\n      }\r\n      if (this.fps !== fps) {\r\n        clearInterval(this.interval);\r\n        this.interval = undefined;\r\n        this.startRunLoop();\r\n      }\r\n    }, fps);\r\n  };\r\n\r\n  initSystem = (): Promise<RetrieveResource[]> => {\r\n    this.initFont();\r\n    this.world.init(this.engineHelper);\r\n    this.renderer.init();\r\n    return this.engineHelper.getAllResourcesLoading();\r\n  };\r\n\r\n  initFont() {\r\n    this.engineHelper.initFont();\r\n  }\r\n\r\n  loadResources = (resources: Resource[]): Promise<RetrieveResource[]> => {\r\n    this.world.loadResources(resources);\r\n    return this.engineHelper.getAllResourcesLoading();\r\n  };\r\n\r\n  runApp = () => {\r\n    this.ready = true;\r\n    if (!this.isStepRender) {\r\n      this.startRunLoop();\r\n    } else {\r\n      this.animationFrame();\r\n    }\r\n  };\r\n\r\n  onRunError = (error: Error) => {\r\n    clearInterval(this.interval);\r\n    console.error(error);\r\n    throw error;\r\n  };\r\n\r\n  run = () => {\r\n    console.log(\"Running\", this);\r\n    const startTime = new Date();\r\n    return this.loadResources(this.args.resources)\r\n      .then(this.initSystem)\r\n      .then(this.renderer.bindBuffer)\r\n      .then(this.runApp)\r\n      .then(() =>\r\n        console.log(\r\n          `startup time: ${new Date().getTime() - startTime.getTime()}`\r\n        )\r\n      )\r\n      .then(\r\n        () =>\r\n          new Promise(function (resolve) {\r\n            setTimeout(resolve, 1);\r\n          })\r\n      )\r\n      .catch(this.onRunError);\r\n  };\r\n\r\n  resizeCanvas = (measureElement: HTMLElement) => {\r\n    this.webGLContainer.resize(measureElement);\r\n  };\r\n\r\n  resizeScreen = () => {\r\n    const measureElement = document.getElementById(this.args.elementId)!;\r\n    this.resizeCanvas(measureElement);\r\n    this.camera.setupCamera(\r\n      this.args.camera,\r\n      this.args.aspectRatio,\r\n      this.webGLContainer.canvas,\r\n      this.args.renderMode || this.args.camera?.renderMode || '2d'\r\n    );\r\n    this.notificationQueue.push(RendererNotification.RESIZE_SCREEN);\r\n    if (this.isStepRender && this.ready) {\r\n      this.animationFrame();\r\n    }\r\n  };\r\n\r\n  buildCanvas = (args: { [key: string]: any }) => {\r\n    if (this.webGLContainer) {\r\n      return;\r\n    }\r\n    let appElement: HTMLElement = document.body;\r\n    if (args.elementId) {\r\n      appElement = document.getElementById(args.elementId)!;\r\n    }\r\n    this.webGLContainer = new WebGLContainer(\r\n      args.canvasId,\r\n      appElement,\r\n      args.aspectRatio,\r\n      args.isFullScreen,\r\n      this.setup\r\n    );\r\n    this.resizeCanvas(appElement);\r\n  };\r\n\r\n  reset = () => {\r\n    if (this.world) {\r\n      this.world.reset();\r\n    } else {\r\n      console.error(\"Game Delegate not ready to call reset\");\r\n    }\r\n  };\r\n\r\n  toggleShow = () => {\r\n    if (this.isVisible) {\r\n      this.hide();\r\n    } else {\r\n      this.show();\r\n    }\r\n  };\r\n\r\n  show = () => {\r\n    this.webGLContainer.canvas.style.display = \"initial\";\r\n    this.resizeScreen();\r\n    this.isVisible = true;\r\n  };\r\n\r\n  hide = () => {\r\n    this.webGLContainer.canvas.style.display = \"none\";\r\n    this.isVisible = false;\r\n  };\r\n\r\n  togglePause = () => {\r\n    this.isPaused = !this.isPaused;\r\n  };\r\n\r\n  pause = () => {\r\n    this.isPaused = true;\r\n  };\r\n\r\n  unpause = () => {\r\n    this.isPaused = false;\r\n  };\r\n}\r\n","/**\n * Common utilities\n * @module glMatrix\n */\n\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== \"undefined\" ? Float32Array : Array;\nexport var RANDOM = Math.random;\nexport var ANGLE_ORDER = \"zyx\";\n\n/**\n * Symmetric round\n * see https://www.npmjs.com/package/round-half-up-symmetric#user-content-detailed-background\n *\n * @param {Number} a value to round\n */\nexport function round(a) {\n  if (a >= 0) return Math.round(a);\n  return a % 0.5 === 0 ? Math.floor(a) : Math.round(a);\n}\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\nvar radian = 180 / Math.PI;\n\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\nexport function toRadian(a) {\n  return a * degree;\n}\n\n/**\n * Convert Radian To Degree\n *\n * @param {Number} a Angle in Radians\n */\nexport function toDegree(a) {\n  return a * radian;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a          The first number to test.\n * @param {Number} b          The second number to test.\n * @param {Number} tolerance  Absolute or relative tolerance (default glMatrix.EPSILON)\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  var tolerance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : EPSILON;\n  return Math.abs(a - b) <= tolerance * Math.max(1, Math.abs(a), Math.abs(b));\n}","class Coordinate {\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n\r\n  constructor(x: number, y: number, z?: number) {\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n    this.z = z || 0;\r\n  }\r\n}\r\n\r\nexport default Coordinate;\r\n","import { CollisionDetection } from \"../Physics/CollisionDetection\";\r\nimport { VertexBuilder } from \"../Builder/VertexBuilder\";\r\n\r\nexport default class EngineObjectHelper {\r\n  static vertex: VertexBuilder = new VertexBuilder();\r\n  static collision: CollisionDetection = new CollisionDetection();\r\n}\r\n","import Rect2d from \"../Data/Rect2d\";\r\nimport Coordinate from \"../Data/Coordinate\";\r\n\r\nexport default class EngineMath {\r\n  public static boundRect(bound: Rect2d, pos: Rect2d): Coordinate {\r\n    const boundedX = Math.max(\r\n      bound.x + pos.width / 2.0,\r\n      Math.min(bound.x + bound.width - pos.width / 2.0, pos.x)\r\n    );\r\n    const boundedY = Math.max(\r\n      bound.y + pos.height / 2.0,\r\n      Math.min(bound.y + bound.height - pos.height / 2.0, pos.y)\r\n    );\r\n    return new Coordinate(boundedX, boundedY, pos.z);\r\n  }\r\n  public static getLength(x1: number, y1: number, x2: number, y2: number) {\r\n    return Math.sqrt(\r\n      Math.abs((x1 - x2) * (x1 - x2)) + Math.abs((y1 - y2) * (y1 - y2))\r\n    );\r\n  }\r\n}\r\n","import {\r\n  Camera,\r\n  EntityManager,\r\n  Rect3d,\r\n  EngineHelper,\r\n  Coordinate,\r\n  Plane3d,\r\n  CollisionDetection,\r\n  PlaneType\r\n} from \"synaren-engine\";\r\n\r\nexport default class Ground3d extends EntityManager {\r\n  cacheId: string;\r\n  textureSource: string;\r\n  camera: Camera;\r\n\r\n  constructor(rect: Rect3d, cacheId: string) {\r\n    super();\r\n    this.cacheId = cacheId;\r\n    this.setRect(rect);\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.entities.forEach(element => element.render(engineHelper));\r\n  }\r\n\r\n  isPointInGround(coordinate: Coordinate): Plane3d | null {\r\n    let insideElement: Plane3d | null = null;\r\n    for (const key in this.entities) {\r\n      if (this.entities.hasOwnProperty(key)) {\r\n        const element = this.entities[key];\r\n        const isInside = CollisionDetection.isPointInPlane3d(\r\n          this.camera.camera3d,\r\n          element as Plane3d,\r\n          coordinate.x,\r\n          coordinate.y\r\n        );\r\n        if (isInside) {\r\n          insideElement = element as Plane3d;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return insideElement;\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    this.camera = engineHelper.camera;\r\n    this.createEntities(engineHelper);\r\n    this.rotateOriginRect(this.getRect());\r\n    this.angleX(this.position.ax);\r\n    this.angleY(this.position.ay);\r\n    this.angleZ(this.position.az);\r\n    super.init(engineHelper);\r\n  }\r\n\r\n  createEntities(engineHelper: EngineHelper) {\r\n    const width = this.position.width;\r\n    const length = this.position.length;\r\n    const x = this.position.x;\r\n    const y = this.position.y;\r\n    const z = this.position.z;\r\n    const vertexModel = engineHelper.newVertexModel(this.cacheId, PlaneType.XZ);\r\n    for (let index = 0; index < width; index++) {\r\n      for (let index2 = 0; index2 < length; index2++) {\r\n        const rect = new Rect3d(\r\n          x + index - width / 2.0,\r\n          y,\r\n          z + index2 - length / 2.0,\r\n          1,\r\n          1,\r\n          1\r\n        );\r\n        const plane = new Plane3d(rect, vertexModel);\r\n        this.entities.push(plane);\r\n      }\r\n    }\r\n  }\r\n\r\n  center(x: number, y: number, z: number) {\r\n    const originX = this.position.x;\r\n    const originZ = this.position.z;\r\n    if (Math.abs(originX - x) > 10e-6 || Math.abs(originZ - z) > 10e-6) {\r\n      for (let index = 0; index < this.entities.length; index++) {\r\n        const element = this.entities[index];\r\n        element.translate(x - originX, 0, z - originZ);\r\n      }\r\n      this.position.x = x;\r\n      this.position.z = z;\r\n    }\r\n  }\r\n}\r\n","import Coordinate from \"../Data/Coordinate\";\r\nimport Rect3d from \"../Data/Rect3d\";\r\nimport Timer from \"../Common/Timer\";\r\nimport ModelPosition from \"../EngineEntity/ModelPosition\";\r\nimport { CollisionDetection } from \"./CollisionDetection\";\r\n\r\nexport default class Physics {\r\n  static TIME_STEP_MILLIS = 10;\r\n  static simulations: {\r\n    [key: number]:\r\n      | {\r\n          pause: boolean;\r\n          timer: Timer;\r\n          totalRunTime: number;\r\n          runTime: number;\r\n          totalIterations: number;\r\n          simulation: (\r\n            simulationId: number,\r\n            timeStep: number,\r\n            totalRunTime: number,\r\n            totalIterations?: number\r\n          ) => void;\r\n          completeSimulation?: () => void;\r\n          cancelled: boolean;\r\n        }\r\n      | undefined;\r\n  } = {};\r\n  static simulationIdCurrent = 1;\r\n  static simulationLoop: ReturnType<typeof setInterval> | undefined;\r\n  static physicsEntities: {\r\n    [key: number]: {\r\n      entity: ModelPosition;\r\n      enabled: boolean;\r\n      physics: PhysicsData | undefined;\r\n    };\r\n  } = {};\r\n  static physicsEntityIdCount = 1;\r\n\r\n  static registerPhysics(\r\n    entity: ModelPosition,\r\n    physics: PhysicsData | undefined = undefined\r\n  ) {\r\n    if (!entity.$physicsId) {\r\n      entity.$physicsId = Physics.physicsEntityIdCount++;\r\n\r\n      this.physicsEntities[entity.$physicsId] = {\r\n        entity: entity,\r\n        enabled: true,\r\n        physics: physics,\r\n      };\r\n    }\r\n  }\r\n  static deregisterPhysics(entity: ModelPosition) {\r\n    if (\r\n      entity.$physicsId !== undefined &&\r\n      this.physicsEntities[entity.$physicsId]\r\n    ) {\r\n      delete this.physicsEntities[entity.$physicsId];\r\n    }\r\n  }\r\n  static setEnabledPhysics(entity: ModelPosition, enabled: boolean) {\r\n    if (this.physicsEntities[entity.$physicsId]) {\r\n      this.physicsEntities[entity.$physicsId].enabled = enabled;\r\n    }\r\n  }\r\n  static isCollidingOffset2d(\r\n    entity: ModelPosition,\r\n    dx: number,\r\n    dy: number\r\n  ): ModelPosition[] {\r\n    const px = entity.position.x + dx;\r\n    const py = entity.position.y + dy;\r\n    return Physics.isCollidingPos2d(entity, px, py);\r\n  }\r\n\r\n  static isCollidingPoint2d(entity: ModelPosition): ModelPosition[] {\r\n    const px = entity.position.x;\r\n    const py = entity.position.y;\r\n    return Physics.isCollidingPos2d(entity, px, py);\r\n  }\r\n\r\n  static isCollidingResolve(\r\n    entity: ModelPosition,\r\n    dx: number,\r\n    dy: number\r\n  ): [number, number, ModelPosition[]] {\r\n    const collision: ModelPosition[] = [];\r\n    const _dx: number[] = [];\r\n    const _dy: number[] = [];\r\n    for (const key in this.physicsEntities) {\r\n      if (this.physicsEntities.hasOwnProperty(key)) {\r\n        const physicsEntity = this.physicsEntities[key];\r\n        const node = physicsEntity.entity;\r\n        if (physicsEntity.enabled && node.$physicsId !== entity.$physicsId) {\r\n          const { x, y, width, height } =\r\n            physicsEntity.physics?.collisionSize || node.position;\r\n          const colliding = CollisionDetection.isCollidingRect(\r\n            x,\r\n            y,\r\n            width,\r\n            height,\r\n            entity.position.x + dx,\r\n            entity.position.y + dy,\r\n            entity.position.width,\r\n            entity.position.height\r\n          );\r\n          if (colliding) {\r\n            collision.push(physicsEntity.entity);\r\n            const collidingX = CollisionDetection.isCollidingRect(\r\n              x,\r\n              y,\r\n              width,\r\n              height,\r\n              entity.position.x + dx,\r\n              entity.position.y,\r\n              entity.position.width,\r\n              entity.position.height\r\n            );\r\n            const collidingY = CollisionDetection.isCollidingRect(\r\n              x,\r\n              y,\r\n              width,\r\n              height,\r\n              entity.position.x,\r\n              entity.position.y + dy,\r\n              entity.position.width,\r\n              entity.position.height\r\n            );\r\n            if (collidingX && collidingY) {\r\n              _dx.push(-Physics.dxBoundary(entity, x, width));\r\n              _dy.push(-Physics.dyBoundary(entity, y, height));\r\n            } else if (collidingX) {\r\n              _dx.push(Physics.dxBoundary(entity, x, width));\r\n            } else if (collidingY) {\r\n              _dy.push(Physics.dyBoundary(entity, y, height));\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (_dx.length > 0) {\r\n      dx = Math.min.apply(Math, _dx);\r\n    }\r\n    if (_dy.length > 0) {\r\n      dy = Math.min.apply(Math, _dy);\r\n    }\r\n    if (Math.abs(dx) < 10e-6) {\r\n      dx = 0;\r\n    }\r\n    if (Math.abs(dy) < 10e-6) {\r\n      dy = 0;\r\n    }\r\n    return [dx, dy, collision];\r\n  }\r\n\r\n  private static dyBoundary(entity: ModelPosition, y: number, height: number) {\r\n    let _dy = Math.abs(\r\n      CollisionDetection.getLength(entity.position.y, 0, y, 0) -\r\n        entity.position.height / 2 -\r\n        height / 2\r\n    );\r\n    _dy *= Math.sign(y - entity.position.y) * 0.9999999;\r\n    return _dy;\r\n  }\r\n\r\n  private static dxBoundary(entity: ModelPosition, x: number, width: number) {\r\n    let _dx = Math.abs(\r\n      CollisionDetection.getLength(entity.position.x, 0, x, 0) -\r\n        entity.position.width / 2 -\r\n        width / 2\r\n    );\r\n    _dx *= Math.sign(x - entity.position.x) * 0.9999999;\r\n    return _dx;\r\n  }\r\n\r\n  private static isCollidingPos2d(\r\n    entity: ModelPosition,\r\n    px: number,\r\n    py: number\r\n  ): ModelPosition[] {\r\n    const collision: ModelPosition[] = [];\r\n    for (const key in this.physicsEntities) {\r\n      if (this.physicsEntities.hasOwnProperty(key)) {\r\n        const physicsEntity = this.physicsEntities[key];\r\n        const pEntityRoot = physicsEntity.entity;\r\n        if (\r\n          physicsEntity.enabled &&\r\n          pEntityRoot.$physicsId !== entity.$physicsId\r\n        ) {\r\n          const colliding = CollisionDetection.isCollidingRect(\r\n            pEntityRoot.position.x,\r\n            pEntityRoot.position.y,\r\n            pEntityRoot.position.width,\r\n            pEntityRoot.position.height,\r\n            px,\r\n            py,\r\n            entity.position.width,\r\n            entity.position.height\r\n          );\r\n          if (colliding) {\r\n            collision.push(physicsEntity.entity);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return collision;\r\n  }\r\n\r\n  static generateSimulationId() {\r\n    const simulationId = this.simulationIdCurrent;\r\n    this.simulationIdCurrent += 1;\r\n    return simulationId;\r\n  }\r\n  static pauseSimulation(simulationId: number) {\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      return;\r\n    }\r\n    data.pause = true;\r\n  }\r\n  static resumeSimulation(simulationId: number) {\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      return;\r\n    }\r\n    data.pause = false;\r\n  }\r\n  static cancelSimulation(simulationId: number, force: boolean = false) {\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      return;\r\n    }\r\n    data.cancelled = true;\r\n    data.totalIterations = 0;\r\n    if (!force && data.completeSimulation) {\r\n      data.completeSimulation();\r\n    }\r\n  }\r\n  static physicsLoop() {\r\n    let simulationCount = 0;\r\n    for (const simulationId in this.simulations) {\r\n      if (this.simulations.hasOwnProperty(simulationId)) {\r\n        const data = this.simulations[simulationId];\r\n        if (!data) continue;\r\n        if (data.cancelled) {\r\n          continue;\r\n        }\r\n        if (data) {\r\n          if (data.pause) {\r\n            data.timer.start();\r\n            continue;\r\n          }\r\n          const time = data.timer.peak();\r\n          if (data.totalIterations === 0 || data.runTime < data.totalRunTime) {\r\n            data.simulation(\r\n              +simulationId,\r\n              time,\r\n              data.totalRunTime,\r\n              data.totalIterations\r\n            );\r\n            data.runTime += time;\r\n            data.timer.start();\r\n            data.totalIterations += 1;\r\n            simulationCount++;\r\n          } else {\r\n            this.cancelSimulation(simulationId as unknown as number);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (simulationCount === 0 && this.simulationLoop !== undefined) {\r\n      clearInterval(this.simulationLoop);\r\n      this.simulationLoop = undefined;\r\n    }\r\n  }\r\n\r\n  static runSimulation(\r\n    totalRunTime: number,\r\n    simulation: (\r\n      simulationId: number,\r\n      timeStep: number,\r\n      totalRunTime: number,\r\n      totalIterations?: number\r\n    ) => void,\r\n    completeSimulation?: () => void,\r\n    existingSimulationId?: number\r\n  ): number {\r\n    const simulationId = existingSimulationId || this.generateSimulationId();\r\n\r\n    const data = this.simulations[simulationId];\r\n    if (!data) {\r\n      this.simulations[simulationId] = {\r\n        pause: false,\r\n        timer: new Timer().start(),\r\n        simulation: simulation,\r\n        totalRunTime: totalRunTime,\r\n        completeSimulation: completeSimulation,\r\n        totalIterations: 0,\r\n        runTime: 0.0,\r\n        cancelled: false,\r\n      };\r\n    } else {\r\n      if (data.cancelled) {\r\n        data.pause = false;\r\n        data.timer.start();\r\n        data.simulation = simulation;\r\n        data.totalRunTime = totalRunTime;\r\n        data.completeSimulation = completeSimulation;\r\n        data.cancelled = false;\r\n      }\r\n      data.totalIterations = 0;\r\n      data.runTime = 0;\r\n    }\r\n\r\n    if (this.simulationLoop === undefined) {\r\n      this.simulationLoop = setInterval(\r\n        this.physicsLoop.bind(this),\r\n        this.TIME_STEP_MILLIS\r\n      );\r\n    }\r\n\r\n    return simulationId;\r\n  }\r\n  static parabolicSimulation(\r\n    parabolic: ParabolicSimulation,\r\n    simulation: (\r\n      simulationId: number,\r\n      timeStep: number,\r\n      dx: number,\r\n      dy: number\r\n    ) => void,\r\n    completeSimulation?: () => void\r\n  ): number {\r\n    return this.runSimulation(\r\n      parabolic.totalRunTime,\r\n      (simulationId: number, timeStep: number) => {\r\n        const data = this.simulations[simulationId];\r\n        if (data) {\r\n          const runTime = data.runTime;\r\n          const height = parabolic.height;\r\n          const width = parabolic.width;\r\n          const totalRunTime = parabolic.totalRunTime;\r\n          const a = ((1.0 / 3.0 + 1.0) * height) / width / width;\r\n          const b = a * width;\r\n          const vy = height / 2.0 / (totalRunTime / 2.0);\r\n          const x = (Math.sqrt(4 * a * vy * runTime + b * b) - b) / (2 * a);\r\n          const vx = -width / totalRunTime;\r\n          const y = -(a * vx * runTime * vx * runTime + b * vx * runTime);\r\n          const dx = x - parabolic.px;\r\n          const dy = y - parabolic.py;\r\n          parabolic.px = x;\r\n          parabolic.py = y;\r\n          simulation(simulationId, timeStep, dx, dy);\r\n        }\r\n      },\r\n      completeSimulation\r\n    );\r\n  }\r\n}\r\n\r\nexport class ParabolicSimulation {\r\n  totalRunTime: number;\r\n  height: number;\r\n  width: number;\r\n  px: number;\r\n  py: number;\r\n}\r\n\r\nexport class PhysicsData {\r\n  t: Coordinate;\r\n  d: Coordinate;\r\n  v: Coordinate;\r\n  a: Coordinate;\r\n  modelPos: ModelPosition;\r\n  isMoving: boolean;\r\n  collisionSize: Rect3d | undefined;\r\n  bound: Rect3d | undefined;\r\n  simulationId: number | undefined;\r\n  jumpSimulationId: number | undefined;\r\n  gravitySimulationId: number | undefined;\r\n  collisionIteration: number;\r\n  collisionStopItThres: number;\r\n}\r\n","import Coordinate from \"./Coordinate\";\r\n\r\nexport default class Rect3d extends Coordinate {\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n  width: number;\r\n  height: number;\r\n  length: number;\r\n  centre: Rect3d;\r\n  constructor(\r\n    x: number,\r\n    y: number,\r\n    z: number,\r\n    width: number,\r\n    height: number,\r\n    length: number\r\n  ) {\r\n    super(x, y, z);\r\n    this.width = width || 0;\r\n    this.height = height || 0;\r\n    this.length = length || 0;\r\n  }\r\n\r\n  center(): Rect3d {\r\n    if (!this.centre || !this.equalCenter(this.centre)) {\r\n      this.centre = this.newCenter();\r\n    }\r\n    return this.centre;\r\n  }\r\n\r\n  equal(r: Rect3d) {\r\n    return (\r\n      r.x === this.x &&\r\n      r.y === this.y &&\r\n      r.z === this.z &&\r\n      r.width === this.width &&\r\n      r.height === this.height &&\r\n      r.length === this.length\r\n    );\r\n  }\r\n\r\n  private equalCenter(c: Rect3d) {\r\n    return (\r\n      c.x === this.x + this.width / 2.0 &&\r\n      c.y === this.y + this.height / 2.0 &&\r\n      c.z === this.z + this.length / 2.0 &&\r\n      c.width === this.width &&\r\n      c.height === this.height &&\r\n      c.length === this.length\r\n    );\r\n  }\r\n\r\n  newCenter(): Rect3d {\r\n    return new Rect3d(\r\n      this.x + this.width / 2.0,\r\n      this.y + this.height / 2.0,\r\n      this.z + this.length / 2.0,\r\n      this.width,\r\n      this.height,\r\n      this.length\r\n    );\r\n  }\r\n}\r\n","import Rect2d from \"../Core/Data/Rect2d\";\r\nimport ModelObject2d from \"../Core/EngineEntity/ModelObject2d\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\nimport TextureVertexModel from \"../Core/Data/TextureVertexModel\";\r\n\r\nexport default class Plane2d extends ModelObject2d {\r\n  private textureReference: string;\r\n  constructor(rect: Rect2d, textureReference: string) {\r\n    super(rect, new TextureVertexModel());\r\n    this.textureReference = textureReference;\r\n  }\r\n  setLayer(layer: number) {\r\n    this.position.z = -layer;\r\n  }\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = engineHelper.newVertexModel2d(this.textureReference);\r\n    super.init(engineHelper);\r\n  }\r\n}\r\n","import ShaderEntityBuilder from \"../Core/Builder/ShaderEntityBuilder\";\r\nimport Colour from \"../Core/Data/Colour\";\r\nimport ColourVertexModel from \"../Core/Data/ColourVertexModel\";\r\nimport Coordinate from \"../Core/Data/Coordinate\";\r\nimport Rect2d from \"../Core/Data/Rect2d\";\r\nimport RenderOption, {\r\n  RenderType,\r\n  ShaderType,\r\n} from \"../Core/Data/RenderOption\";\r\nimport VertexModel from \"../Core/Data/VertexModel\";\r\nimport EngineObject from \"../Core/EngineEntity/EngineObject\";\r\nimport EngineObjectHelper from \"../Core/EngineEntity/EngineObjectHelper\";\r\nimport EngineHelper from \"../Core/EngineHelper\";\r\n\r\nexport default class LineColour extends EngineObject {\r\n  vertexModel: VertexModel;\r\n  constructor(\r\n    private point1: Coordinate,\r\n    private point2: Coordinate,\r\n    private thickness: number,\r\n    private rgba: Colour\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    engineHelper.render(this.shaderEntity);\r\n  }\r\n\r\n  updatePosition(point1: Coordinate, point2: Coordinate) {\r\n    this.point1 = point1;\r\n    this.point2 = point2;\r\n\r\n    const lX = point2.x - point1.x;\r\n    const lY = point2.y - point1.y;\r\n    const length = Math.sqrt(lX * lX + lY * lY);\r\n    const angle = Math.atan2(lY, lX) * (180 / Math.PI);\r\n\r\n    const mX = (point1.x + point2.x) / 2;\r\n    const mY = (point1.y + point2.y) / 2;\r\n\r\n    this.center(mX, mY, 0);\r\n    this.rotateOrigin(mX, mY, 0);\r\n    this.angleZ(angle);\r\n    this.scale(length, this.thickness, 1.0);\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    this.vertexModel = new ColourVertexModel().fillRenderUnits(\r\n      EngineObjectHelper.vertex.planeXYColour(\r\n        this.rgba || new Colour(0, 0, 0, 0)\r\n      )\r\n    );\r\n    this.updatePosition(this.point1, this.point2);\r\n    const renderOpt = new RenderOption();\r\n    renderOpt.renderType = RenderType.TRIANGLE;\r\n    renderOpt.shaderType = ShaderType.COLOUR;\r\n    this.shaderEntity = new ShaderEntityBuilder(engineHelper)\r\n      .addBuffer(this.vertexModel)\r\n      .build(this, renderOpt);\r\n  }\r\n}\r\n","import vec2 from \"gl-matrix/vec2\";\r\n\r\nclass Vector2d extends Float32Array {\r\n  set x(x: number) {\r\n    this[0] = x;\r\n  }\r\n  get x(): number {\r\n    return this[0];\r\n  }\r\n  set y(y: number) {\r\n    this[1] = y;\r\n  }\r\n  get y(): number {\r\n    return this[1];\r\n  }\r\n  normalise(): Vector2d {\r\n    return vec2.normalize(Vector2d.newVector(0.0, 0.0), this) as Vector2d;\r\n  }\r\n  dot(v: Vector2d): number {\r\n    return vec2.dot(this, v);\r\n  }\r\n  negate(): Vector2d {\r\n    return vec2.negate(Vector2d.newVector(0.0, 0.0), this) as Vector2d;\r\n  }\r\n  scale(s: number): vec2 {\r\n    return vec2.scale(Vector2d.newVector(0.0, 0.0), this, s);\r\n  }\r\n  subtract(v: Vector2d): Vector2d {\r\n    return vec2.subtract(Vector2d.newVector(0, 0), this, v) as Vector2d;\r\n  }\r\n  add(v: Vector2d): Vector2d {\r\n    return vec2.add(Vector2d.newVector(0, 0), this, v) as Vector2d;\r\n  }\r\n  static newVector(x: number, y: number): Vector2d {\r\n    const vector = new Vector2d();\r\n    vector.x = x;\r\n    vector.y = y;\r\n    return vector;\r\n  }\r\n}\r\n\r\nexport default Vector2d;\r\n","import RenderOption from \"../Data/RenderOption\";\r\nimport VertexModel from \"../Data/VertexModel\";\r\nimport { mat4 } from \"gl-matrix\";\r\nimport Position from \"./Position\";\r\nimport ModelPosition from \"./ModelPosition\";\r\n\r\nexport class ShaderEntity {\r\n  opt: RenderOption = new RenderOption();\r\n  vertexModel: VertexModel;\r\n  rendererBufferId?: number;\r\n  rendererTextureRef?: string;\r\n  src?: string;\r\n  hidden: boolean;\r\n  isTop: boolean;\r\n  clone = false;\r\n  modelPosition: () => Position;\r\n  model: () => mat4;\r\n\r\n  getVertexModel(): VertexModel {\r\n    return this.vertexModel;\r\n  }\r\n  getVertexBufferId(): number {\r\n    return this.vertexModel.vertexBufferId;\r\n  }\r\n  getOpt(): RenderOption {\r\n    return this.opt;\r\n  }\r\n  getModel(): Float32List {\r\n    return this.model() as Float32List;\r\n  }\r\n  getTextureSource(): string | undefined {\r\n    return this.src;\r\n  }\r\n  setTextureSource(src: string) {\r\n    this.src = src;\r\n  }\r\n  renderCopy(model: ModelPosition): ShaderEntity {\r\n    const newInstance = this.shallowCopy();\r\n    newInstance.model = model.getModel;\r\n    newInstance.modelPosition = model.getPosition;\r\n    return newInstance;\r\n  }\r\n  shallowCopy(): ShaderEntity {\r\n    const newInstance = new ShaderEntity();\r\n    newInstance.opt = this.opt;\r\n    newInstance.vertexModel = this.vertexModel;\r\n    newInstance.rendererBufferId = this.rendererBufferId;\r\n    newInstance.rendererTextureRef = this.rendererTextureRef;\r\n    newInstance.src = this.src;\r\n    newInstance.isTop = this.isTop;\r\n    newInstance.hidden = this.hidden;\r\n    return newInstance;\r\n  }\r\n}\r\n","import BaseProgram from \"../Base/BaseProgram\";\r\nimport ShadowDepthFragmentShader from \"../Shaders/ShadowDepthFragmentShader.glsl\";\r\nimport PassthroughVertexShader from \"../Shaders/PassthroughVertexShader.glsl\";\r\nimport ShadowLightVertexShader from \"../Shaders/ShadowLightVertexShader.glsl\";\r\nimport ShadowLightFragmentShader from \"../Shaders/ShadowLightFragmentShader.glsl\";\r\nimport LightFragmentShader from \"../Shaders/LightFragmentShader.glsl\";\r\nimport LightVertexShader from \"../Shaders/LightVertexShader.glsl\";\r\nimport ArrayBuffer from \"../../Buffer/ArrayBuffer\";\r\nimport { mat4, vec3 } from \"gl-matrix\";\r\nimport Texture from \"../../Buffer/Texture\";\r\nimport ProgramReference from \"../Base/ProgramReference\";\r\nimport Light from \"../../Data/Light\";\r\nimport { BaseCamera } from \"../../Camera\";\r\n\r\nexport default class Shader3DProgram extends BaseProgram {\r\n  static DRAW_VERTEX_SIZE = 8;\r\n  position: ProgramReference;\r\n  textureCoords: ProgramReference;\r\n  normal: ProgramReference;\r\n\r\n  projMtrx: ProgramReference;\r\n  modelMtrx: ProgramReference;\r\n  viewMtrx: ProgramReference;\r\n\r\n  light1Pos: ProgramReference;\r\n  light1Intensities: ProgramReference;\r\n  light1Attenu: ProgramReference;\r\n  light1AmbCoeff: ProgramReference;\r\n  light1View: ProgramReference;\r\n  light1Projection: ProgramReference;\r\n\r\n  shadowMap: ProgramReference;\r\n  tex2DSampler: ProgramReference;\r\n\r\n  arrayBuffer: ArrayBuffer;\r\n\r\n  // shadow program\r\n  shadowProgram: WebGLProgram;\r\n  shadowFramebuffer: WebGLFramebuffer;\r\n  shadowDepthTexture: WebGLTexture;\r\n  shadowRenderBuffer: WebGLRenderbuffer;\r\n\r\n  isLightingEnabledUniform: ProgramReference;\r\n  shadowPos: ProgramReference;\r\n  shadowProjection: ProgramReference;\r\n  shadowView: ProgramReference;\r\n  shadowModel: ProgramReference;\r\n\r\n  shadowTextureUnit: number;\r\n\r\n  isShadowEnabled: boolean = true;\r\n\r\n  light: Light;\r\n\r\n  // this must be changed in shader as well.\r\n  shadowDepthTextureSize = 1024.0;\r\n\r\n  isLightingEnabled: boolean = true;\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    super(ctx);\r\n    this.arrayBuffer = new ArrayBuffer(ctx);\r\n\r\n    if (this.isShadowEnabled) {\r\n      this.program = this.compileShaders(\r\n        ShadowLightVertexShader,\r\n        ShadowLightFragmentShader\r\n      );\r\n      this.bindProgram();\r\n      this.shadowMap = new ProgramReference(\r\n        \"shadowMap\",\r\n        ctx,\r\n        false,\r\n        this.program\r\n      );\r\n      this.light1View = new ProgramReference(\r\n        \"u_light1_view\",\r\n        ctx,\r\n        false,\r\n        this.program\r\n      );\r\n      this.light1Projection = new ProgramReference(\r\n        \"u_light1_projection\",\r\n        ctx,\r\n        false,\r\n        this.program\r\n      );\r\n    } else {\r\n      this.program = this.compileShaders(\r\n        LightVertexShader,\r\n        LightFragmentShader\r\n      );\r\n      this.bindProgram();\r\n    }\r\n    this.normal = new ProgramReference(\"a_normal\", ctx, true, this.program);\r\n    this.position = new ProgramReference(\"a_position\", ctx, true, this.program);\r\n    this.textureCoords = new ProgramReference(\r\n      \"a_texture_coords\",\r\n      ctx,\r\n      true,\r\n      this.program\r\n    );\r\n\r\n    this.projMtrx = new ProgramReference(\r\n      \"u_projection\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.viewMtrx = new ProgramReference(\"u_view\", ctx, false, this.program);\r\n    this.modelMtrx = new ProgramReference(\"u_model\", ctx, false, this.program);\r\n\r\n    this.tex2DSampler = new ProgramReference(\r\n      \"texture\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n\r\n    this.light1Pos = new ProgramReference(\r\n      \"u_light1_pos\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.light1Intensities = new ProgramReference(\r\n      \"u_light1_intensities\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.light1Attenu = new ProgramReference(\r\n      \"u_light1_attenuation\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n    this.light1AmbCoeff = new ProgramReference(\r\n      \"u_light1_ambient_coefficient\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n\r\n    this.isLightingEnabledUniform = new ProgramReference(\r\n      \"u_isLightingEnabled\",\r\n      ctx,\r\n      false,\r\n      this.program\r\n    );\r\n\r\n    if (this.isShadowEnabled) {\r\n      this.initShadowProgram();\r\n    }\r\n  }\r\n\r\n  initShadowProgram() {\r\n    const ctx = this.ctx;\r\n    this.shadowProgram = this.compileShaders(\r\n      PassthroughVertexShader,\r\n      ShadowDepthFragmentShader\r\n    );\r\n    this.bindShadowProgram();\r\n\r\n    this.shadowPos = new ProgramReference(\r\n      \"a_position\",\r\n      ctx,\r\n      true,\r\n      this.shadowProgram\r\n    );\r\n    this.shadowProjection = new ProgramReference(\r\n      \"u_projection\",\r\n      ctx,\r\n      false,\r\n      this.shadowProgram\r\n    );\r\n    this.shadowView = new ProgramReference(\r\n      \"u_view\",\r\n      ctx,\r\n      false,\r\n      this.shadowProgram\r\n    );\r\n    this.shadowModel = new ProgramReference(\r\n      \"u_model\",\r\n      ctx,\r\n      false,\r\n      this.shadowProgram\r\n    );\r\n\r\n    this.shadowFramebuffer = ctx.createFramebuffer()!;\r\n    this.createDepthTexture();\r\n\r\n    this.shadowRenderBuffer = ctx.createRenderbuffer()!;\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, this.shadowRenderBuffer);\r\n    ctx.renderbufferStorage(\r\n      ctx.RENDERBUFFER,\r\n      ctx.DEPTH_COMPONENT16,\r\n      this.shadowDepthTextureSize,\r\n      this.shadowDepthTextureSize\r\n    );\r\n\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, this.shadowFramebuffer);\r\n    ctx.framebufferTexture2D(\r\n      ctx.FRAMEBUFFER,\r\n      ctx.COLOR_ATTACHMENT0,\r\n      ctx.TEXTURE_2D,\r\n      this.shadowDepthTexture,\r\n      0\r\n    );\r\n    ctx.framebufferRenderbuffer(\r\n      ctx.FRAMEBUFFER,\r\n      ctx.DEPTH_ATTACHMENT,\r\n      ctx.RENDERBUFFER,\r\n      this.shadowRenderBuffer\r\n    );\r\n\r\n    ctx.bindTexture(ctx.TEXTURE_2D, null);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\r\n  }\r\n\r\n  createDepthTexture() {\r\n    const ctx = this.ctx;\r\n    this.shadowTextureUnit = Texture.textureCount;\r\n    ctx.activeTexture(ctx.TEXTURE0 + this.shadowTextureUnit);\r\n    Texture.textureCount += 1;\r\n\r\n    this.shadowDepthTexture = ctx.createTexture()!;\r\n    ctx.bindTexture(ctx.TEXTURE_2D, this.shadowDepthTexture);\r\n\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MIN_FILTER, ctx.LINEAR);\r\n    ctx.texParameterf(ctx.TEXTURE_2D, ctx.TEXTURE_MAG_FILTER, ctx.LINEAR);\r\n    ctx.texImage2D(\r\n      ctx.TEXTURE_2D,\r\n      0,\r\n      ctx.RGBA,\r\n      this.shadowDepthTextureSize,\r\n      this.shadowDepthTextureSize,\r\n      0,\r\n      ctx.RGBA,\r\n      ctx.UNSIGNED_BYTE,\r\n      null\r\n    );\r\n  }\r\n\r\n  bindShadowProgram() {\r\n    this._bindProgram(this.shadowProgram);\r\n  }\r\n\r\n  bindProgram() {\r\n    this._bindProgram(this.program);\r\n  }\r\n\r\n  unbindProgram() {\r\n    this._unbindProgram();\r\n  }\r\n\r\n  unbindShadowProgram() {}\r\n\r\n  enableAttribPointers() {\r\n    const ctx = this.ctx;\r\n    ctx.enableVertexAttribArray(this.position.ref);\r\n    ctx.enableVertexAttribArray(this.textureCoords.ref);\r\n    ctx.enableVertexAttribArray(this.normal.ref);\r\n  }\r\n\r\n  bindAttributePointers() {\r\n    this.enableAttribPointers();\r\n    const ctx = this.ctx;\r\n    ctx.vertexAttribPointer(this.position.ref, 3, ctx.FLOAT, false, 4 * 8, 0);\r\n    ctx.vertexAttribPointer(this.normal.ref, 3, ctx.FLOAT, true, 4 * 8, 3 * 4);\r\n    ctx.vertexAttribPointer(\r\n      this.textureCoords.ref,\r\n      2,\r\n      ctx.FLOAT,\r\n      true,\r\n      4 * 8,\r\n      6 * 4\r\n    );\r\n  }\r\n\r\n  enableShadowAttribPointers() {\r\n    this.ctx.enableVertexAttribArray(this.shadowPos.ref);\r\n  }\r\n\r\n  bindShadowAttributePointers() {\r\n    this.enableShadowAttribPointers();\r\n    const ctx = this.ctx;\r\n    ctx.vertexAttribPointer(this.shadowPos.ref, 3, ctx.FLOAT, false, 4 * 8, 0);\r\n  }\r\n\r\n  glSetShadowModelMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.shadowModel.ref, false, matrixArray);\r\n  }\r\n\r\n  unbindShadowAttributePointers() {\r\n    this.ctx.disableVertexAttribArray(this.shadowPos.ref);\r\n  }\r\n\r\n  setLight(light: Light, camera: BaseCamera) {\r\n    this.light = light;\r\n    const lookAt = light.lookAt();\r\n\r\n    this.bindProgram();\r\n    const ctx = this.ctx;\r\n    ctx.uniform1i(this.isLightingEnabledUniform.ref, this.isLightingEnabled ? 1 : 0);\r\n\r\n    ctx.uniform3fv(this.light1Pos.ref, light.pos);\r\n    ctx.uniform3fv(this.light1Intensities.ref, light.in);\r\n    ctx.uniform1f(this.light1AmbCoeff.ref, light.ambientCoeff);\r\n    ctx.uniform1f(this.light1Attenu.ref, light.attenuation);\r\n\r\n    if (this.isShadowEnabled) {\r\n      const cameraFrustum = mat4.frustum(\r\n        mat4.create(),\r\n        -1 * camera.aspect,\r\n        1 * camera.aspect,\r\n        -1 * camera.aspect,\r\n        1 * camera.aspect,\r\n        1,\r\n        vec3.squaredDistance(light.posVec(), light.atVec())\r\n      );\r\n\r\n      ctx.uniformMatrix4fv(this.light1View.ref, false, lookAt as Float32List);\r\n      ctx.uniformMatrix4fv(this.light1Projection.ref, false, cameraFrustum as Float32List);\r\n\r\n      this.bindShadowProgram();\r\n      ctx.uniformMatrix4fv(this.shadowView.ref, false, lookAt as Float32List);\r\n      ctx.uniformMatrix4fv(this.shadowProjection.ref, false, cameraFrustum as Float32List);\r\n    }\r\n  }\r\n\r\n  toggleLighting(enable: boolean) {\r\n    this.isLightingEnabled = enable;\r\n  }\r\n\r\n  prepareShadowTexture() {\r\n    const ctx = this.ctx;\r\n    ctx.activeTexture(ctx.TEXTURE0 + this.shadowTextureUnit);\r\n    ctx.bindTexture(ctx.TEXTURE_2D, this.shadowDepthTexture);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, this.shadowRenderBuffer);\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, this.shadowFramebuffer);\r\n    ctx.viewport(\r\n      0,\r\n      0,\r\n      this.shadowDepthTextureSize,\r\n      this.shadowDepthTextureSize\r\n    );\r\n    ctx.clear(ctx.COLOR_BUFFER_BIT | ctx.DEPTH_BUFFER_BIT);\r\n\r\n    this.arrayBuffer.bind();\r\n    this.bindShadowAttributePointers();\r\n    this.bindShadowProgram();\r\n  }\r\n\r\n  revertShadowTexture() {\r\n    const ctx = this.ctx;\r\n    ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\r\n    ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\r\n    this.arrayBuffer.unbind();\r\n    this.unbindShadowAttributePointers();\r\n    this.unbindShadowProgram();\r\n  }\r\n\r\n  bindShadowTexture() {\r\n    this.bindProgram();\r\n    this.ctx.uniform1i(this.shadowMap.ref, this.shadowTextureUnit);\r\n  }\r\n\r\n  unbindAttributePointers() {\r\n    const ctx = this.ctx;\r\n    ctx.disableVertexAttribArray(this.position.ref);\r\n    ctx.disableVertexAttribArray(this.textureCoords.ref);\r\n    ctx.disableVertexAttribArray(this.normal.ref);\r\n  }\r\n\r\n  glSetViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.viewMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetProjectMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.projMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  glSetModelViewMatrix(matrixArray: Float32List) {\r\n    this.ctx.uniformMatrix4fv(this.modelMtrx.ref, false, matrixArray);\r\n  }\r\n\r\n  bindTexture(texture: Texture) {\r\n    texture.bindTexture(this.ctx, this.tex2DSampler.ref);\r\n  }\r\n}\r\n","export default \"\\r\\nprecision mediump float;\\r\\n\\r\\nvec4 packDepthToRGBA(const float v) {\\r\\n  const float PackUpscale = 256. / 255.;\\r\\n  const vec3 PackFactors = vec3(256. * 256. * 256., 256. * 256., 256.);\\r\\n  const float ShiftRight8 = 1. / 256.;\\r\\n\\r\\n  vec4 r = vec4(fract(v * PackFactors), v);\\r\\n  r.yzw -= r.xyz * ShiftRight8; // tidy overflow\\r\\n  return r * PackUpscale;\\r\\n}\\r\\n\\r\\nvoid main(void) {\\r\\n  gl_FragColor = packDepthToRGBA(gl_FragCoord.z);\\r\\n}\\r\\n\\r\\n\";","export interface ArrayBufferMetaData {\r\n  offset: number;\r\n  size: number;\r\n  verticesSize: number;\r\n}\r\n\r\nclass ArrayBuffer {\r\n  bufferid: WebGLBuffer;\r\n  bufferArray: number[] = [];\r\n  verticeSize = 0;\r\n  bufferReg: {\r\n    [key: string]: ArrayBufferMetaData;\r\n  } = {};\r\n  bufferRegId = 1;\r\n  deleted = false;\r\n  maxSize: number;\r\n  private isBuffered = false;\r\n  private ctx: WebGLRenderingContext;\r\n  private static readonly MAX_BUFFER_SIZE = 10000000; // 10M floats (~40MB)\r\n\r\n  constructor(ctx: WebGLRenderingContext) {\r\n    this.bufferid = ctx.createBuffer()!;\r\n    this.ctx = ctx;\r\n    ctx.bindBuffer(ctx.ARRAY_BUFFER, this.bufferid);\r\n  }\r\n\r\n  delete() {\r\n    this.ctx.deleteBuffer(this.bufferid);\r\n    this.deleted = true;\r\n  }\r\n\r\n  bufferBind() {\r\n    if (this.deleted) {\r\n      return;\r\n    }\r\n    this.bind();\r\n\r\n    if (!this.isBuffered) {\r\n      const doubled = this.bufferArray.length * 2;\r\n      const capped = Math.min(doubled, ArrayBuffer.MAX_BUFFER_SIZE);\r\n      this.maxSize = Math.max(capped, this.bufferArray.length);\r\n    }\r\n\r\n    const buffer = new Float32Array(this.maxSize);\r\n    buffer.fill(0, this.bufferArray.length);\r\n    buffer.set(this.bufferArray);\r\n\r\n    this.ctx.bufferData(this.ctx.ARRAY_BUFFER, buffer, this.ctx.STATIC_DRAW);\r\n\r\n    this.isBuffered = true;\r\n  }\r\n\r\n  length() {\r\n    return this.verticeSize;\r\n  }\r\n\r\n  bufferSub(offset: number, data: number[], vertexSize: number) {\r\n    if (this.deleted) {\r\n      return;\r\n    }\r\n    this.bind();\r\n    this.ctx.bufferSubData(\r\n      this.ctx.ARRAY_BUFFER,\r\n      offset * Float32Array.BYTES_PER_ELEMENT * vertexSize,\r\n      new Float32Array(data)\r\n    );\r\n  }\r\n\r\n  reset() {\r\n    this.bufferArray = [];\r\n  }\r\n\r\n  push(vertices: number[], size: number) {\r\n    this.bufferArray = this.bufferArray.concat(vertices);\r\n    this.verticeSize += size;\r\n\r\n    if (this.isBuffered) {\r\n      if (this.bufferArray.length < this.maxSize) {\r\n        this.bufferSub(\r\n          this.verticeSize - size,\r\n          vertices,\r\n          vertices.length / size\r\n        );\r\n      } else {\r\n        this.bufferBind();\r\n        console.log(\"buffer resizing as limit has been reached\");\r\n      }\r\n    }\r\n  }\r\n\r\n  bind() {\r\n    if (this.deleted === true) {\r\n      return;\r\n    }\r\n    this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.bufferid);\r\n  }\r\n\r\n  unbind() {\r\n    // do nothing for now\r\n  }\r\n}\r\n\r\nexport default ArrayBuffer;\r\n","import {\r\n  App,\r\n  BitmapConfigParser,\r\n  Coordinate,\r\n  EngineEvent,\r\n  EngineHelper,\r\n  EngineObject,\r\n  Events,\r\n  Light,\r\n  ModelObject3d,\r\n  Object3d,\r\n  ObjectManager,\r\n  Plane3d,\r\n  PlaneType,\r\n  Rect3d,\r\n  ResourceResolver\r\n} from \"synaren-engine\";\r\nimport Cube from \"./Cube\";\r\nimport Ground3d from \"./Ground3d\";\r\nimport Sphere from \"./Sphere\";\r\n\r\nexport default class ExampleWorld extends ObjectManager {\r\n  fontCacheId: number;\r\n  bitmapLoader: BitmapConfigParser;\r\n  ground: Ground3d;\r\n  racingCar: ModelObject3d;\r\n  lowPolyGirl: ModelObject3d;\r\n  cube: Cube;\r\n  cube2: Cube;\r\n  sun: Sphere;\r\n  road: Plane3d;\r\n  lowPolyTree: ModelObject3d[];\r\n  sky: Sphere;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  render() {\r\n    this.entities.forEach((ent: EngineObject, index: number) => ent.render(this.engineHelper));\r\n  }\r\n\r\n  update() {\r\n    this.entities.forEach((ent: EngineObject) => ent.update(this.engineHelper));\r\n    const { x, y, z } = this.engineHelper.camera.camera3d.position;\r\n    if (this.sky) {\r\n      this.sky.center(x, y, z);\r\n    }\r\n  }\r\n\r\n  event(event: EngineEvent) {\r\n    super.event(event);\r\n    if (event.eventType === Events.DRAG) {\r\n      this.engineHelper.camera.camera3d.angleY(-event.dxRaw);\r\n      this.engineHelper.camera.camera3d.angleX(event.dyRaw);\r\n      this.engineHelper.camera.camera3d.updateProjectionView();\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  loadResources() {\r\n    console.log('Loading ExampleApp resources...');\r\n    \r\n    this.engineHelper\r\n      .getResource(\"assets/sphere.txt\")\r\n      .then(\r\n        ResourceResolver.objResolverMultiple(this.engineHelper, [\r\n          { textureSource: \"assets/background.jpg\", name: \"background\" },\r\n          { textureSource: \"assets/sun.png\", name: \"sun\" }\r\n        ])\r\n      ).then(() => console.log('Sphere resources loaded'))\r\n      .catch(err => console.error('Sphere resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_tree.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_tree.png\",\r\n          \"low_poly_tree\"\r\n        )\r\n      ).then(() => console.log('Tree resources loaded'))\r\n      .catch(err => console.error('Tree resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/low_poly_girl.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/low_poly_girl.png\",\r\n          \"low_poly_girl\"\r\n        )\r\n      ).then(() => console.log('Girl resources loaded'))\r\n      .catch(err => console.error('Girl resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/racing_car.txt\")\r\n      .then(\r\n        ResourceResolver.objResolver(\r\n          this.engineHelper,\r\n          \"assets/racing_car.png\",\r\n          \"racing_car\"\r\n        )\r\n      ).then(() => console.log('Car resources loaded'))\r\n      .catch(err => console.error('Car resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/paprika.fnt\")\r\n      .then(ResourceResolver.bmFontResolver(this.engineHelper))\r\n      .then(() => console.log('Font resources loaded'))\r\n      .catch(err => console.error('Font resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(\"assets/atlas.txt\")\r\n      .then(\r\n        ResourceResolver.bitmapResolver(this.engineHelper, 1024, 1024, 20e-3)\r\n      ).then(() => console.log('Atlas resources loaded'))\r\n      .catch(err => console.error('Atlas resource error:', err));\r\n\r\n    this.engineHelper\r\n      .getResource(`/assets/missing-texture.txt`)\r\n      .then(ResourceResolver.bitmapResolver(this.engineHelper, 1184, 1184, 0))\r\n      .then(() => console.log('Missing texture resources loaded'))\r\n      .catch(err => console.error('Missing texture resource error:', err));\r\n  }\r\n\r\n  init() {\r\n   const length = 30;\r\n    const width = 20;\r\n\r\n    this.engineHelper.camera.camera3d.center(0, 2, length / 2 - 4);\r\n    this.engineHelper.camera.camera3d.updateProjectionView();\r\n\r\n    this.sky = new Sphere(\r\n      new Rect3d(0.0, 2.0, 0.0, 100.0, 100.0, 100.0),\r\n      \"background\"\r\n    );\r\n    this.addEntity(this.sky);\r\n\r\n    this.lowPolyGirl = new Object3d(\r\n      new Rect3d(-4, 0.95, 5, 1.0, 1.0, 1.0),\r\n      \"low_poly_girl\"\r\n    );\r\n    this.lowPolyGirl.angleY(240);\r\n    this.lowPolyGirl.scale(0.7, 0.7, 0.7);\r\n    this.addEntity(this.lowPolyGirl);\r\n\r\n    this.racingCar = new Object3d(\r\n      new Rect3d(0, -0.25, 0, 1.5, 1.5, 1.5),\r\n      \"racing_car\"\r\n    );\r\n    this.racingCar.angleY(135);\r\n    this.addEntity(this.racingCar);\r\n\r\n    this.ground = new Ground3d(\r\n      new Rect3d(0.0, 0.0, 0.0, width, 0, length),\r\n      \"grass\"\r\n    );\r\n    this.ground.event = (\r\n      event: EngineEvent,\r\n      engineHelper: EngineHelper\r\n    ) => {\r\n      if (\r\n        event.eventType === Events.UP &&\r\n        event.prevEventType === Events.DOWN\r\n      ) {\r\n        const clickedElement = this.ground.isPointInGround(\r\n          new Coordinate(event.x, event.y, 0)\r\n        );\r\n        if (clickedElement) {\r\n          const cameraX = engineHelper.camera.camera3d.position.x;\r\n          const cameraZ = engineHelper.camera.camera3d.position.z;\r\n          const dx = Math.abs(cameraX - clickedElement.position.x);\r\n          const dz = Math.abs(cameraZ - clickedElement.position.z);\r\n          const totalDist = Math.sqrt(dx * dx + dz * dz);\r\n          const speed = 1 / 200;\r\n          const time = totalDist / speed;\r\n          engineHelper.camera.camera3d.pan3d(\r\n            time,\r\n            clickedElement.position.x,\r\n            undefined,\r\n            clickedElement.position.z\r\n          );\r\n        }\r\n      }\r\n      return true;\r\n    };\r\n    this.addEntity(this.ground);\r\n\r\n    this.cube = new Cube(new Rect3d(-4, 2, -12, 0.9, 0.9, 0.9), \"assets/atlas.png\", [\r\n      \"wood\",\r\n      \"cloth\",\r\n      \"sky\",\r\n      \"grass\",\r\n      \"paper\",\r\n      \"rock\"\r\n    ]);\r\n    this.cube.update = function() {\r\n      this.position.ay++;\r\n      this.position.ax++;\r\n      this.position.az++;\r\n      this.planes.forEach(element => {\r\n        element.angleY(this.position.ay);\r\n        element.angleX(this.position.ax);\r\n        element.angleZ(this.position.az);\r\n      });\r\n    };\r\n    this.addEntity(this.cube);\r\n\r\n    this.cube2 = new Cube(new Rect3d(-2.2, 2, 9, .9, .9, .9), \"assets/atlas.png\", [\r\n      \"wood\",\r\n      \"cloth\",\r\n      \"sky\",\r\n      \"grass\",\r\n      \"paper\",\r\n      \"rock\"\r\n    ]);\r\n    this.cube2.update = function() {\r\n      this.position.ay++;\r\n      this.position.ax++;\r\n      this.position.az++;\r\n      this.planes.forEach(element => {\r\n        element.angleY(this.position.ay);\r\n        element.angleX(this.position.ax);\r\n        element.angleZ(this.position.az);\r\n      });\r\n    };\r\n    this.addEntity(this.cube2);\r\n\r\n    this.sun = new Sphere(new Rect3d(0.0, 10, -15, 1.0, 1.0, 1.0), \"sun\");\r\n    this.sun.update = function() {\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.position.ay++;\r\n      this.angleY(this.position.ay);\r\n      this.angleX(this.position.ax);\r\n      this.angleZ(this.position.az);\r\n    };\r\n    this.addEntity(this.sun);\r\n\r\n    this.lowPolyTree = [];\r\n    const treeCreator = (l: number, w: number) => {\r\n      const tree = new Object3d(\r\n        new Rect3d(l, 0, w, 1.0, 1.0, 1.0),\r\n        \"low_poly_tree\"\r\n      );\r\n      const heightRand = Math.random() * 0.8 - 0.8;\r\n      const scale = 3.5 + heightRand;\r\n      tree.scale(scale, scale, scale);\r\n      this.lowPolyTree.push(tree);\r\n      this.addEntity(tree);\r\n    };\r\n    for (let l = 0; l < length; l += 4) {\r\n      treeCreator(-width / 2, l - length / 2);\r\n      treeCreator(width / 2 - 1, l - length / 2);\r\n    }\r\n    for (let w = 1; w < width - 1; w += 4) {\r\n      treeCreator(w - width / 2, -length / 2);\r\n      treeCreator(w - width / 2, length / 2 - 1);\r\n    }\r\n\r\n    const vertexModel = this.engineHelper.newVertexModel(\r\n      \"ground\",\r\n      PlaneType.XZ\r\n    );\r\n    this.road = new Plane3d(new Rect3d(0, 0.01, 0.0, 1, 1, 1), vertexModel);\r\n    this.road.scale(3, 1, (2 * width) / Math.sqrt(2));\r\n    this.road.angleY(-45);\r\n    this.road.center(-2, 0.01, -15);\r\n\r\n    this.addEntity(this.road);\r\n\r\n    // initialise all the engine objects\r\n    super.init();\r\n\r\n    this.engineHelper.setLighting(\r\n      new Light({\r\n        pos: [0.0, 10, -15],\r\n        // intensity and color in rgb\r\n        in: [1.0, 1.0, 1.0],\r\n        // rate of loss in light intensity from source pos\r\n        attenuation: 0.015,\r\n        // ambient lighting 0 - 1 where 0 is complete darkness\r\n        ambientCoeff: 0.3,\r\n        // the direction of light from pos to at to direct the shadowing\r\n        // note that it is only in one direction.\r\n        at: [0.0, 0.0, 0.0]\r\n      })\r\n    );\r\n    \r\n    console.log(\" Example App Loaded!\");\r\n    console.log(\" Features:\");\r\n    console.log(\"    3D scene with various objects\");\r\n    console.log(\"    Mouse drag to look around\");\r\n    console.log(\"    Click on ground to move camera\");\r\n    console.log(\"    Animated cubes and sun\");\r\n  }\r\n}\r\n\r\nconst createExampleApp = () => {\r\n  const aspect = window.innerWidth / window.innerHeight;\r\n  const args = {\r\n    world: new ExampleWorld(),\r\n    elementId: \"app\",\r\n    canvasId: \"app-game\",\r\n    error: undefined,\r\n    subscribe: undefined,\r\n    renderMode: '3d',\r\n    camera: {\r\n      near: 0.01,\r\n      far: 1000.0,\r\n      fov: 60.0,\r\n      maxFov: 60.0,\r\n      isFovMax: false,\r\n      projection: 'perspective',\r\n      aspect\r\n    },\r\n    aspectRatio: aspect,\r\n    eventThrottle: 1000.0 / 60.0,\r\n    fps: 30,\r\n    isStepRender: false,\r\n  };\r\n  const app = new App(args);\r\n  \r\n  // Expose app instance globally\r\n  (window as any).gameInstance = args.world;\r\n  \r\n  app.run().catch(console.error);\r\n  app.unpause();\r\n  window.onresize = () => {\r\n    location.reload();\r\n  };\r\n};\r\n\r\nexport { createExampleApp, ExampleWorld };\r\n","import { ColourRenderUnit } from \"./RenderUnit\";\r\nimport VertexModel from \"./VertexModel\";\r\nimport ModelData from \"./ModelData\";\r\nimport EngineObjectHelper from \"../EngineEntity/EngineObjectHelper\";\r\n\r\nclass ColourVertexModel extends VertexModel {\r\n  vertexBufferId: number;\r\n  renderUnits: ColourRenderUnit[];\r\n  createRenderUnits(count: number) {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < count; index++) {\r\n      this.renderUnits.push(new ColourRenderUnit());\r\n    }\r\n    return this;\r\n  }\r\n  fillRenderUnits(values: number[]) {\r\n    this.renderUnits = [];\r\n    for (let index = 0; index < values.length; index += 7) {\r\n      const renderUnit = new ColourRenderUnit();\r\n      renderUnit.vertex.x = values[index];\r\n      renderUnit.vertex.y = values[index + 1];\r\n      renderUnit.vertex.z = values[index + 2];\r\n      renderUnit.colour.r = values[index + 3];\r\n      renderUnit.colour.g = values[index + 4];\r\n      renderUnit.colour.b = values[index + 5];\r\n      renderUnit.colour.a = values[index + 6];\r\n      this.renderUnits.push(renderUnit);\r\n    }\r\n    return this;\r\n  }\r\n  createModel(): ModelData {\r\n    const model = new ModelData();\r\n    model.vertices = EngineObjectHelper.vertex.toColourArray(this.renderUnits);\r\n    return model;\r\n  }\r\n}\r\nexport default ColourVertexModel;\r\n","import { EntityManager, Plane3d, Rect3d, EngineHelper, EngineEvent, CollisionDetection, PlaneType } from \"synaren-engine\";\r\n\r\nexport default class Cube extends EntityManager {\r\n  planes: Plane3d[];\r\n  textureSource: string;\r\n  uvs: string[];\r\n\r\n  constructor(rect: Rect3d, textureSource: string, uvs: string[]) {\r\n    super();\r\n    this.setRect(rect);\r\n    this.textureSource = textureSource;\r\n    this.uvs = uvs;\r\n  }\r\n\r\n  render(engineHelper: EngineHelper) {\r\n    this.planes.forEach(element => element.render(engineHelper));\r\n  }\r\n\r\n  isPointInCube(evnt: EngineEvent, engineHelper: EngineHelper) {\r\n    return (\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[0],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[1],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[2],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[3],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[4],\r\n        evnt.x,\r\n        evnt.y\r\n      ) ||\r\n      CollisionDetection.isPointInPlane3d(\r\n        engineHelper.camera.camera3d,\r\n        this.planes[5],\r\n        evnt.x,\r\n        evnt.y\r\n      )\r\n    );\r\n  }\r\n\r\n  init(engineHelper: EngineHelper) {\r\n    const width = this.position.width;\r\n    const length = this.position.length;\r\n    const height = this.position.height;\r\n    const x = this.position.x;\r\n    const y = this.position.y;\r\n    const z = this.position.z;\r\n    const rect = new Rect3d(x, y, z, width, height, length);\r\n\r\n    this.planes = [\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[0], PlaneType.YX)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[1], PlaneType.XY)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[2], PlaneType.ZX)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[3], PlaneType.XZ)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[4], PlaneType.ZY)),\r\n      new Plane3d(rect, engineHelper.newVertexModel(this.uvs[5], PlaneType.YZ))\r\n    ];\r\n\r\n    this.planes.forEach(plane => this.entities.push(plane));\r\n\r\n    this.scaleRect(rect);\r\n    this.centerRect(rect);\r\n    this.rotateOriginRect(rect);\r\n\r\n    this.planes[0].center(x, y, z + length / 2);\r\n    this.planes[1].center(x, y, z - length / 2);\r\n    this.planes[2].center(x, y - height / 2, z);\r\n    this.planes[3].center(x, y + height / 2, z);\r\n    this.planes[4].center(x + width / 2, y, z);\r\n    this.planes[5].center(x - width / 2, y, z);\r\n\r\n    this.rotateOriginRect(this.getRect());\r\n\r\n    super.init(engineHelper);\r\n  }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { CrystalCollectorGame, createCrystalCollectorApp } from \"./CrystalCollectorGame\";\r\nimport { ExampleWorld, createExampleApp } from \"./ExampleApp\";\r\nimport { createRacingGame } from \"./RacingGame\";\r\n\r\n// Game registry\r\nconst games = {\r\n  'example': {\r\n    name: 'Example App',\r\n    description: '3D scene with various objects and interactions',\r\n    createFunction: createExampleApp\r\n  },\r\n  'crystal-collector': {\r\n    name: 'Crystal Collector 3D',\r\n    description: 'Collect crystals in a 3D world before time runs out!',\r\n    createFunction: createCrystalCollectorApp\r\n  },\r\n  'racing': {\r\n    name: '3D Racing Game',\r\n    description: 'Race against AI bots on a 3D track with realistic physics!',\r\n    createFunction: createRacingGame\r\n  }\r\n};\r\n\r\n// Main game launcher\r\nconst launchGame = (gameKey: string) => {\r\n  const game = games[gameKey];\r\n  if (game) {\r\n    console.log(` Launching ${game.name}...`);\r\n    \r\n    // Clear any existing game content\r\n    const appElement = document.getElementById('app');\r\n    if (appElement) {\r\n      appElement.innerHTML = '';\r\n    }\r\n    \r\n    // Launch the selected game\r\n    game.createFunction();\r\n    \r\n    // Hide game menu\r\n    const gameMenu = document.getElementById('game-menu');\r\n    if (gameMenu) {\r\n      gameMenu.style.display = 'none';\r\n    }\r\n    \r\n    // Show back button\r\n    const backButton = document.getElementById('back-button');\r\n    if (backButton) {\r\n      backButton.style.display = 'block';\r\n    }\r\n  } else {\r\n    console.error(`Game '${gameKey}' not found!`);\r\n  }\r\n};\r\n\r\n// Show game menu\r\nconst showGameMenu = () => {\r\n  const gameMenu = document.getElementById('game-menu');\r\n  const backButton = document.getElementById('back-button');\r\n  const appElement = document.getElementById('app');\r\n  \r\n  if (gameMenu) gameMenu.style.display = 'block';\r\n  if (backButton) backButton.style.display = 'none';\r\n  if (appElement) appElement.innerHTML = '';\r\n  \r\n  // Clear any running game instances\r\n  (window as any).gameInstance = null;\r\n};\r\n\r\n// Initialize the application\r\nwindow.onload = function () {\r\n  try {\r\n    // Check URL parameter to decide which game to load\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const gameMode = urlParams.get('game');\r\n    \r\n    if (gameMode && games[gameMode]) {\r\n      // Load specific game directly\r\n      launchGame(gameMode);\r\n    } else {\r\n      // Show game selection menu\r\n      showGameMenu();\r\n    }\r\n    \r\n    // Expose functions globally for HTML access\r\n    (window as any).launchGame = launchGame;\r\n    (window as any).showGameMenu = showGameMenu;\r\n    \r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n};\r\n"],"names":["root","factory","exports","module","define","amd","self","_start","Date","now","start","this","peak","stop","_end","elapsed","raw","vertices","split","map","parseFloat","Array","console","error","entities","setPosition","position","forEach","e","center","x","y","z","rotateOrigin","rotateOriginRect","rect","rotateX","angleX","rotateY","angleY","rotateZ","angleZ","scaleX","scaleY","scaleZ","scale","translate","dx","dy","dz","init","engineHelper","a","render","hidden","entity","update","setTop","isTop","value","setHidden","EntityManager","create","out","Float32Array","clone","fromValues","copy","set","add","b","subtract","multiply","divide","ceil","Math","floor","min","max","round","scaleAndAdd","distance","sqrt","squaredDistance","length","squaredLength","negate","inverse","normalize","len","dot","cross","lerp","t","ax","ay","random","undefined","r","PI","cos","sin","transformMat2","m","transformMat2d","transformMat3","transformMat4","rotate","rad","p0","p1","sinC","cosC","angle","bx","by","abs","atan2","signedAngle","zero","str","exactEquals","equals","a0","a1","b0","b1","vec","sub","mul","div","dist","sqrDist","sqrLen","stride","offset","count","fn","arg","i","l","vertexModel","centerRect","scaleRect","renderOpt","renderType","RenderType","RECTANGLE","shaderType","ShaderType","TWO_DIMENSION","shaderEntity","addBuffer","createTexture","textureSource","build","Collision","vec2","originX","originY","az","getLength","x1","y1","x2","y2","isCollidingRect","width1","height1","width2","height2","CollisionDetection","isRectInRect","rect1","rect2","width","height","isPointInRect","coord","isPointInPlane3d","camera","obj","mvp","mat4","frustum","viewMatrix","getModel","r1","toClipSpace","renderUnits","vertex","r2","r3","r4","rectPolygon","pointInPolygon","pos","vec4Trans","vec4","vec4Norm","point","polygon","inside","j","xi","yi","xj","yj","subtractCenter","p","v","points","area","v1","v2","calculateCentre","centroid","newVector","totalSignedArea","vertexCount","nextVertex","polygonProjection","axis","dotProduct","boundaryDistance","minA","maxA","minB","maxB","isCollision","polygonB","velocity","result","isIntersect","willIntersect","edge","edgeCountA","edges","edgeCountB","minIntervalDistance","Infinity","translationAxis","edgeIndex","normalise","velocityProjection","intervalDistance","minDeintersectDistance","Polygon","zoomScale","baseTranslate","_isUpdateView","timer","updateProjectionView","commitProjectionView","quatRotationxyz","quat","degreesToRadians","dest","quatMat","fromQuat","vec3","frustumMatrix","left","cameraOptions","aspect","right","bottom","top","near","far","updateProjectionMatrix","projection","perspective","clearPan","interval","clearInterval","pan","time","speed","steps","_moveTime","tx","ty","tz","setInterval","isOutOfBound","bound","isUpdateView","fov","diff","experimental","inverseAngleY","zoomIn","delta","zoomOut","maxFovAspect","atan","maxFov","setupCamera","aspectRatio","canvas","enabled","offsetWidth","offsetHeight","zoom","setZoom","setBaseTranslate","isFovMax","lookAt","targetX","targetY","targetZ","horizontalDistance","BaseCamera","INTERVAL_TIME","translateSpace","distanceEvent","event","pan2d","pan2dDif","pan3d","camera3d","Camera3d","camera2d","Camera2d","renderMode","getActiveCamera","getActiveFrustum","Camera","objects","ref","anchor","texts","prop","hasOwnProperty","startsWith","object","initObjectPosition","$ref","$anchor","type","buildModel","config","createPlane2D","model","createRect2d","isCentre","hasPhysics","hookCustomHandler","createPlane3D","createRect3d","planeType","createTriangle","rgba","createSpriteMoveable","spriteModel","ticks","createMoveable","createSprite","createText","texture","createCoordinate","fontSize","text","id","createColour","createLineColour","point1","point2","thickness","warn","$id","data","isLastEvent","FontReference","setClone","window","bind","onClickedDefined","onClick","shouldPropagate","isClicked","eventType","UP","getRect2","Number","textRef","newFont","setText","setFontSize","push","colour","location","registerPhysics","physics","setLayer","moveable","setRect","updatePhysicsPosition","plane","newVertexModel","ConfigEntity","ConfigMapBuilder","getRect","BasicSprite","bitmapWidth","bitmapHeight","precision","SOURCE_KEY","line","processLine","filter","reduce","sum","next","processRawLine","source","substr","indexOf","trim","replace","origin","info","processTextureLine","seperator","nameindex","key","temp","leftindex","topindex","widthIndex","getMap","getTextureSource","BitmapConfigParser","identity","m00","m01","m10","m11","transpose","invert","a2","a3","det","adjoint","determinant","b2","b3","s","c","v0","fromRotation","fromScaling","frob","LDU","L","D","U","multiplyScalar","multiplyScalarAndAdd","d","aa","ab","ac","ad","atx","aty","a4","a5","b4","b5","fromTranslation","fromMat4","m02","m12","m20","m21","m22","a01","a02","a12","a00","a10","a11","a20","a21","a22","b01","b11","b21","b00","b02","b10","b12","b20","b22","fromMat2d","q","w","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","a6","a7","a8","b6","b7","b8","m03","m13","m23","m30","m31","m32","m33","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bz","bw","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","decompose","out_r","out_t","out_s","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","rl","tb","nf","perspectiveNO","fovy","f","tan","perspectiveZO","perspectiveFromFieldOfView","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","orthoNO","lr","bt","ortho","orthoZO","eye","up","x0","y0","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","target","a9","a14","a15","b9","b13","b14","b15","slerp","acos","sinTotal","ratioA","ratioB","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformQuat","qx","qy","qz","qw","vx","vy","vz","mag","cosine","u","A","B","C","E","F","G","H","I","J","v3","v4","s1","s2","rand","setAxisAngle","getAxisAngle","out_axis","getAngle","dotproduct","calculateW","exp","et","ln","log","pow","omega","cosom","sinom","scale0","scale1","u1","u2","u3","sqrt1MinusU1","sqrtU1","invDot","conjugate","fromMat3","fRoot","fTrace","k","fromEuler","order","arguments","halfToRad","cx","cy","cz","Error","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","rotationTo","sqlerp","setAxes","view","dq","w1","w2","fromRotationTranslationValues","outer","getReal","getDual","setReal","setDual","ax1","ay1","az1","aw1","bx1","by1","bz1","ax2","ay2","az2","aw2","rotateByQuatAppend","rotateByQuatPrepend","rotateAroundAxis","axisLength","ax0","ay0","az0","aw0","bw1","bx0","by0","bz0","bw0","mt","sqlen","a_dot_b","bmFontResolver","_","registerFont","bitmapResolver","bitmapLoader","uv","addUVCache","objResolverMultiple","sources","name","addVertexUvCache","objResolver","ResourceResolver","ctx","arrayBuffer","program","compileShaders","bindProgram","positionRef","colorRef","modelViewMatrixRef","viewMtrx","projMtrx","_bindProgram","unbindProgram","_unbindProgram","enableAttribPointers","enableVertexAttribArray","bindAttributePointers","vertexAttribPointer","FLOAT","unbindAttributePointers","disableVertexAttribArray","glSetProjectMatrix","matrixArray","uniformMatrix4fv","glSetModelViewMatrix","glSetViewMatrix","DRAW_VERTEX_SIZE","ShaderProgramColour","delete","updateBuffer","buffer","opt","getOpt","COLOUR","buffReg","bufferReg","rendererBufferId","verticesSize","bufferSub","bindBuffer","bufferBind","isEnabled","CULL_FACE","disable","DEPTH_TEST","index","drawArrays","TRIANGLE_STRIP","size","unbind","registerEntity","objBuffer","bufferRegId","updatePerspective","projectionMatrix","EntityColourProgram","SpriteMoveableModel","SpriteMoveable","THREE_DIMENSION","PLAIN","TRIANGLE","isAttribute","getAttribLocation","getUniformLocation","g","CREATE_TEXTURE","Subscription","REGISTER_ENTITY","createTexturePayload","resourcesLoading","registerEntityPayload","RendererSubscription","NOTIFICATION_PRE_RENDER_KEY","NOTIFICATION_RENDER_KEY","NOTIFICATION_INIT_KEY","UPDATE_PROJECTION_MATRIX","Notification","RendererNotification","RESIZE_SCREEN","modelData","NotificationPayload","from","UPDATE_BUFFER","SET_LIGHTING","setLighting","light","RENDER_ENTITY","renderEntity","args","webGLContainer","notificationQueue","subscriberPool","textureReg","_renderEntities","cachedModelData","resizeViewPort","glContext","shader3DProgram","shaderColourProgram","Object","values","texReg","deleteTexture","texUnit","textureCount","destroyWebGL","activeCamera","setLight","_getProgramOpt","_getProgram3D","_isPlain","_defRender","_defRenderTop","_render","payload","_resetDefferred","handleNotification","notification","action","world","getCtx","setupDefault","enableLighting","listen","colourModel","model3d","render3DShadowMap","model2d","readMessages","toggleLighting","isUniqueAction","message","unique","take","_lazyLoadProgram","clear","setTime","renderFont","src","rendererTextureRef","load","Renderer","gameStarted","gameEnded","raceTime","currentLap","totalLaps","raceFinished","bots","trackBarriers","waypointTiles","crowd","trees","waypoints","playerSpeed","maxSpeed","acceleration","deceleration","turnSpeed","playerRotation","playerPosition","keys","lastWaypoint","createGameObjects","ground","Plane3d","Rect3d","PlaneType","XZ","addEntity","sky","createPlayerCar","createBotCars","createSimpleCrowd","createTrees","crowdPositions","centerX","wp","centerZ","waypoint","normalizedDx","normalizedDz","crowdX","crowdZ","crowdMember","Object3d","toFixed","treePositions","minX","maxX","minZ","maxZ","perimeterPadding","current","perpX","perpZ","treeDistance","cluster","treesPerCluster","filteredTreePositions","treePos","every","tree","playerCar","botNames","nameText","Coordinate","startX","startZ","carObject","moveableCar","Moveable","bot","car","currentWaypoint","rotation","createCrowd","createWaypointTiles","tile","tilesPerSegment","progress","pathTile","createCourseWalls","depth","wall","wallCube","barrierPos","barrierCube","wallHeight","startRace","updatePlayerMovement","forwardX","forwardZ","checkWaypoints","updateBots","baseWaypoint","lateralOffset","randomVariance","nextWaypointIndex","nextWaypoint","trackDx","trackDz","trackLength","targetWaypoint","lateralVariance","finishRace","ent","cameraX","cameraZ","cameraY","keyEvent","Events","KEY_DOWN","code","toLowerCase","KEY_UP","Light","in","attenuation","ambientCoeff","at","setTimeout","loadResources","getResource","then","catch","err","ObjectManager","createRacingGame","innerWidth","innerHeight","RacingGame","elementId","canvasId","subscribe","eventThrottle","fps","isStepRender","app","App","gameInstance","run","unpause","onresize","reload","score","timeLeft","crystals","obstacles","gameTimer","startGame","endGame","crystal","collected","sphere","player","restartGame","checkCollisions","obstacle","cube","updatePlayer","newPosition","updateCrystals","glowIntensity","glowDirection","floatOffset","updateObstacles","rotationSpeed","planes","updateUI","timeStamp","JSON","stringify","DRAG","dxRaw","dyRaw","crystalData","obstacleData","CrystalCollectorGame","createCrystalCollectorApp","deferred","isLoaded","entityIdx","loadTexture","onLoad","def","textures","spriteIdx","calcSpriteIdx","spriteLength","idxFactor","toArray2D","vertexes","vertexConstruct","_vertex","normal","toTextureArray","toColourArray","triangleXYColour","planeXYColour","planeCCW","loc","planeCW","planeUV","planeXY","XY","PLANE","YX","ZX","YZ","ZY","circleXYColour","segments","increment","VertexBuilder","dampenReduction","completeSimulation","resetPhysics","isMoving","collisionIteration","physicSimulation","simulationId","collisionSize","modelPos","$physicsId","resolveCollision","_dx","_dy","collision","shouldTranslate","addDampener","collisionStopItThres","cancelSimulation","movementRotation","isBounded","updateLocBoundToBoundary","completePhysicsIteration","jumpSimulationId","gravitySimulationId","isMoveable","hasCollision","updateDeltaDistance","boundRect","coordinate","calcTotalDeltaDistance","translateTo","complete","directionalModifier","moveTo","colliding","moveToTime","totalTime","completeSim","runSimulation","moveSimulation","isRotateMove","dampeningProp","xSign","sign","ySign","addImpulse","contactTime","setVelocity","runPhysicsSimulation","TIME_STEP_MILLIS","isCollidingResolve","simulation","simulations","totalRunTime","propTime","translateCollision","isCollidingOffset2d","setMoveable","copyTexture","TextureUnit","Colour","RenderUnit","TextureRenderUnit","ColourRenderUnit","listeners","subscriptionId","callback","unlisten","publish","listener","flush","SubscriptionListeners","subscribers","subscription","getSubscriptionListeners","SubscriberPool","vertexUvCacheId","newVertexModelUv3d","normalDirection","BACKWARDS","FORWARD","nx","ny","nz","originZ","maxHeight","maxWidth","Position","fontChar","font","fontPos","repeat","isRepeat","expire","displayTime","isExpired","refresh","RenderFont","shallowCopy","modelPosition","metaData","fonts","renderFontState","renderFontPool","avgWidth","avgHeight","getFont","charCode","createRender","pop","refreshExpired","context","defaultRect","totalWidth","totalHeight","totalNo","fontIdx","uvs","createPlaneVertexModel","filename","FontChar","writeFont","cacheId","displayRect","$cacheId","isDirtyPos","isDirtyText","setWidth","_hidden","prevText","warningShown","fontCacheId","expireRenderFont","fontRef","fontCache","writeRef","fontManager","Font","MAX_FONT","calcTotalTextWidth","calculateFontSize","prevPos","createFonts","fontRefCache","FontManager","DefaultFont","pixelDensity","carryWidth","charIdx","charCodeAt","fontHeight","xOffset","yOffset","createRenderUnits","fillRenderUnits","renderUnit","createModel","TextureVertexModel","$hidden","generateId","_shaderEntity","EngineObject","options","vecZero","parellelVec","vec1","perpVec","perp","posVec","atVec","atCross","posCross","vertexShaderContent","fragmentShaderContent","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","fragmentChar","vertexChar","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createProgram","attachShader","linkProgram","validateProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","useProgram","eventDown","touchDown","eventDownX","eventDownY","eventDownDx","eventDownDy","keyDownMap","prevEvent","prevTimeStamp","motionTimeStamp","orientationQuaternion","NULL_EVENT","prevEventType","rawEvent","isDown","isUp","boundedWindow","throttle","setThrottle","bindCanvas","bindWindow","handleOrientationChange","orientation","handleMotion","incrementQuaternion","tempEventDownX","tempEventDownY","handleEvent","ORIENTATION","accData","rotationRate","beta","gamma","alpha","eventQuaternion","getQuaternion","buildEvent","evt","DOWN","KeyboardEvent","resize","RESIZE","buildEventKey","keyCode","keyDown","preventDefault","keyUp","handleMouseUp","offsetX","offsetY","handleEventDown","handleEventMove","xUp","yUp","handleTouchEnd","handleTouchStart","HTMLElement","getBoundingClientRect","touches","clientX","clientY","cancelable","handleTouchMove","targetEvent","cb","addEventListener","isBodyFocus","_event","degtorad","radtodeg","_x","_y","_z","cX","cY","cZ","sX","sY","sZ","screenAccData","SYSTEM_EVENTS","setRenderType","lines","lineIdx","FontMeta","parseWidth","parseHeight","parseFilename","parseLineHeight","parseChar","match","FntFontReader","FONT_CHAR","FontCharacter","char","String","fromCharCode","HEIGHT","lineHeight","LINE_HEIGHT","WIDTH","FILENAME","RegExp","column","registerModel","vertexBufferId","addBufferCache","VertexModel","dirtyModel","dirtyQuat","dirtyPos","dirtyScale","dirtyOrigin","intermediateModels","initialMat4Temp","rotateQuatTemp","rotateMat4Temp","_buildModel","cachedModel","getPosition","centerCoord","_buildQuat","createMat4NoAlloc","createQuatNoAlloc","getIntermediateModel","org","_buildModelIntermediate","_dirty","negOrigin","degrees","glMatrix","toRadian","setRect2","show","reset","beforeShow","updatePosition","setShow","setEnabledPhysics","restore","entityData","configBuilder","parseMap","addEntities","EngineMap","toString","hasTexture","engineObject","ShaderEntity","entityOption","assign","ShaderEntityBuilder","isError","Texture","maxTextureUnits","getParameter","MAX_TEXTURE_IMAGE_UNITS","DEFAULT_MAX_TEXTURE_UNITS","loadImage","onError","handleTextureLoaded","image","newTextureUnit","maxUnits","bindTexture","sampler","uniform1i","activeTexture","TEXTURE0","createTextureFromImage","TEXTURE_2D","texParameterf","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","Promise","resolve","reject","document","createElement","crossOrigin","onload","onerror","_render3DShadowEntities","glSetShadowModelMatrix","TRIANGLES","_setupShadow","bindShadowTexture","setOriginalViewport","isShadowEnabled","prepareShadowTexture","revertShadowTexture","enable","cullFace","BACK","is2d","Entity3DProgram","isVisible","updateInterval","fpsCounter","lastFrameTime","performance","frameTimeHistory","renderCallCount","renderer","createDebugUI","startUpdating","enableDebugOnRightClick","hide","destroy","debugElement","parentElement","removeChild","style","cssText","createStaticStructure","parent","body","appendChild","innerHTML","toggleButton","textContent","onclick","toggle","setupCameraControlEventListeners","updateDisplay","calculateFPS","frameTime","shift","avgFrameTime","updateDebugInfo","debugInfo","gatherDebugInfo","renderDebugInfo","setReferences","setEngineHelper","buildEntityInfo","constructor","hasShaderEntity","textureRef","bufferId","getContext","webglInfo","faceCullingEnabled","depthTestEnabled","blendEnabled","BLEND","clearColor","getClearColorString","cameraInfo","flatMap","entityCount","renderCalls","lastError","color","COLOR_CLEAR_VALUE","perfContent","querySelector","updateCameraControls","webglContent","entityCountEl","updateEntitiesList","updateErrorDisplay","posX","posY","posZ","rotX","rotY","rotZ","activeElement","borderColor","container","scrollTop","entitiesHtml","join","errorDiv","errorContent","display","incrementRenderCalls","resetRenderCalls","logError","setCameraPosition","setCameraRotation","setCameraOrigin","resetBtn","lookAtBtn","resetOriginBtn","resetCamera","lookAtOrigin","resetCameraOrigin","debugMenu","contains","once","numValue","isNaN","queueMap","clearQueue","pushPayload","nodes","LinkedList","pushNotification","getBottom","shiftQueue","NotificationQueue","priority","updateFont","bufferCache","fontNameKeyReverse","uvCache","vertexUVCache","AppSubscription","GET_FPS","startIteration","START_ITERATION","shaderProgram","slice","renderWithCulling","renderCopy","isEntityWithinDistance","cameraPosition","maxDistance","entityPos","entityPosition","entitySize","cameraPos","entityPos3d","yawRad","pitchRad","cameraForward","toEntity","getFPS","getTotalPixelHeight","screen","getTotalPixelWidth","getScreenHeight","getScreenWidth","getTime","getVerticesById","updateBufferCache","verticesCacheId","promise","xhr","XMLHttpRequest","open","onreadystatechange","readyState","DONE","status","responseText","registerBuffer","meta","send","getAllResourcesLoading","all","getBuffer","getBufferModelData","getVertexBufferId","initFont","fontType","newVertexModel2d","cache","getUVCache","getVertexUvCache","vertexUv","isClickedObject","ModelObject3d","layer","Rect2d","newCenter","clearColour","setClearColor","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","frontFace","CCW","clearDepth","depthFunc","LEQUAL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","viewport","getWebGL2RenderingContext","ctx2","isWebGL2RenderingContext","createTransformFeedback","bindVertexArray","numAttribs","MAX_VERTEX_ATTRIBS","tmp","createBuffer","ARRAY_BUFFER","ii","vertexAttrib1f","vertexAttribDivisor","deleteBuffer","numTextureUnits","TEXTURE_CUBE_MAP","TEXTURE_2D_ARRAY","TEXTURE_3D","bindSampler","ELEMENT_ARRAY_BUFFER","bindFramebuffer","FRAMEBUFFER","bindRenderbuffer","RENDERBUFFER","DITHER","SCISSOR_TEST","blendColor","blendEquation","FUNC_ADD","ONE","ZERO","clearStencil","colorMask","LESS","depthMask","depthRange","hint","GENERATE_MIPMAP_HINT","DONT_CARE","lineWidth","pixelStorei","PACK_ALIGNMENT","UNPACK_ALIGNMENT","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_COLORSPACE_CONVERSION_WEBGL","BROWSER_DEFAULT_WEBGL","polygonOffset","sampleCoverage","scissor","stencilFunc","ALWAYS","stencilMask","stencilOp","KEEP","STENCIL_BUFFER_BIT","drawBuffers","readBuffer","COPY_READ_BUFFER","COPY_WRITE_BUFFER","PIXEL_PACK_BUFFER","PIXEL_UNPACK_BUFFER","numTransformFeedbacks","MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS","bindBufferBase","TRANSFORM_FEEDBACK_BUFFER","numUBOs","MAX_UNIFORM_BUFFER_BINDINGS","UNIFORM_BUFFER","RASTERIZER_DISCARD","UNPACK_IMAGE_HEIGHT","UNPACK_SKIP_IMAGES","UNPACK_ROW_LENGTH","UNPACK_SKIP_ROWS","UNPACK_SKIP_PIXELS","PACK_ROW_LENGTH","PACK_SKIP_ROWS","PACK_SKIP_PIXELS","FRAGMENT_SHADER_DERIVATIVE_HINT","programInfo","ACTIVE_ATTRIBUTES","attribInfo","getActiveAttrib","WebGLContext","resources","pause","resume","ModelData","_$ID","default","isFullScreen","restoreContentFn","measureElement","getAspectRatio","devicePixelRatio","documentElement","clientWidth","clientHeight","WebGLContainer","ready","isPaused","framesElapsed","setup","updater","debugger","onEvent","resizeScreen","animationFrame","notifyFrames","errorCallback","requestAnimationFrame","startRunLoop","initSystem","runApp","onRunError","startTime","resizeCanvas","getElementById","buildCanvas","appElement","toggleShow","togglePause","setFPS","toggleStepRender","EPSILON","ARRAY_TYPE","RANDOM","ANGLE_ORDER","setMatrixArrayType","degree","radian","toDegree","tolerance","EngineObjectHelper","boundedX","boundedY","element","isPointInGround","insideElement","createEntities","index2","Physics","physicsEntityIdCount","physicsEntities","deregisterPhysics","px","py","isCollidingPos2d","isCollidingPoint2d","physicsEntity","node","collidingX","collidingY","dxBoundary","dyBoundary","apply","pEntityRoot","generateSimulationId","simulationIdCurrent","pauseSimulation","resumeSimulation","force","cancelled","totalIterations","physicsLoop","simulationCount","runTime","simulationLoop","existingSimulationId","parabolicSimulation","parabolic","timeStep","ParabolicSimulation","PhysicsData","centre","equalCenter","equal","textureReference","lX","lY","mX","mY","Vector2d","vector","getVertexModel","setTextureSource","newInstance","shadowDepthTextureSize","isLightingEnabled","shadowMap","light1View","light1Projection","textureCoords","modelMtrx","tex2DSampler","light1Pos","light1Intensities","light1Attenu","light1AmbCoeff","isLightingEnabledUniform","initShadowProgram","shadowProgram","bindShadowProgram","shadowPos","shadowProjection","shadowView","shadowModel","shadowFramebuffer","createFramebuffer","createDepthTexture","shadowRenderBuffer","createRenderbuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","COLOR_ATTACHMENT0","shadowDepthTexture","framebufferRenderbuffer","DEPTH_ATTACHMENT","shadowTextureUnit","LINEAR","unbindShadowProgram","enableShadowAttribPointers","bindShadowAttributePointers","unbindShadowAttributePointers","uniform3fv","uniform1f","cameraFrustum","Shader3DProgram","bufferArray","verticeSize","deleted","isBuffered","bufferid","doubled","capped","ArrayBuffer","MAX_BUFFER_SIZE","maxSize","fill","bufferData","STATIC_DRAW","vertexSize","bufferSubData","BYTES_PER_ELEMENT","concat","lowPolyGirl","racingCar","clickedElement","cube2","sun","lowPolyTree","treeCreator","road","ExampleWorld","createExampleApp","ColourVertexModel","isPointInCube","evnt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","definition","defineProperty","enumerable","get","prototype","Symbol","toStringTag","games","description","createFunction","launchGame","gameKey","game","gameMenu","backButton","showGameMenu","gameMode","URLSearchParams","search"],"ignoreList":[],"sourceRoot":""}